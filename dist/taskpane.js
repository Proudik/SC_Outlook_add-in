/*! For license information please see taskpane.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{5338:function(e,t,n){var r=n(40961);t.H=r.createRoot,r.hydrateRoot},11584:function(e,t,n){n.r(t),n.d(t,{checkFiledStatusByConversationAndSubject:function(){return E},createDirectory:function(){return x},ensureOutlookAddinFolder:function(){return I},findDocumentBySubject:function(){return C},getCaseRootDirectoryId:function(){return S},getDocumentMeta:function(){return m},listDirectory:function(){return k},normalizeSubject:function(){return N},renameDocument:function(){return h},uploadDocumentToCase:function(){return g},uploadDocumentVersion:function(){return v}});var r=n(41114),o=n(50134),a=n(50466),i=n(64583).Promise,c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c.apply(this,arguments)},s=function(e,t,n,r){return new(n||(n=i))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},l=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function u(){return s(this,void 0,void 0,function(){var e,t,n;return l(this,function(r){switch(r.label){case 0:return console.log("[resolveApiBaseUrl] Reading workspaceHost from storage key:",a.d.workspaceHost),[4,(0,o.wv)(a.d.workspaceHost)];case 1:if(e=r.sent(),console.log("[resolveApiBaseUrl] Raw stored host:",e),t=function(e){var t=(e||"").trim().toLowerCase();return t?t.replace(/^https?:\/\//i,"").split("/")[0]:""}(e||""),console.log("[resolveApiBaseUrl] Normalized host:",t),!t)throw console.error("[resolveApiBaseUrl] Workspace host is missing"),new Error("Workspace host is missing.");return n="/singlecase/".concat(encodeURIComponent(t),"/publicapi/v1"),console.log("[resolveApiBaseUrl] Resolved base URL:",n),[2,n]}})})}function d(){return s(this,void 0,void 0,function(){var e,t;return l(this,function(n){switch(n.label){case 0:return(null==(e=(0,r.xI)())?void 0:e.token)?(console.log("[getToken] Using sessionStorage token"),[2,e.token]):(console.log("[getToken] sessionStorage token not available, trying OfficeRuntime.storage"),[4,(0,r.Ly)()]);case 1:if(null==(t=n.sent())?void 0:t.token)return console.log("[getToken] Using OfficeRuntime.storage token"),[2,t.token];throw console.error("[getToken] No token found in either sessionStorage or OfficeRuntime.storage"),new Error("Missing auth token.")}})})}function f(e,t){return s(this,void 0,void 0,function(){var n,r;return l(this,function(o){switch(o.label){case 0:return[4,e.text().catch(function(){return""})];case 1:if(n=o.sent(),!e.ok){if(423===e.status)throw new Error("Dokument je momentÃ¡lnÄ› uzamÄen. NÄ›kdo jej prÃ¡vÄ› upravuje. PoÄkejte prosÃ­m, neÅ¾ se dokument odemkne, a zkuste to znovu.");throw new Error("".concat(t," (").concat(e.status,"): ").concat(n||e.statusText))}if(!(r=e.headers.get("content-type")||"").includes("application/json"))throw new Error("".concat(t,": expected JSON but got ").concat(r||"no content-type","."));return[2,JSON.parse(n)]}})})}function m(e){return s(this,void 0,void 0,function(){var t,n,r,o,a;return l(this,function(i){switch(i.label){case 0:return[4,d()];case 1:return t=i.sent(),[4,u()];case 2:return n=i.sent(),r="".concat(n,"/documents/").concat(encodeURIComponent(String(e))),[4,fetch(r,{method:"GET",headers:{Authentication:t,"Content-Type":"application/json","Accept-Encoding":"identity"}})];case 3:return 404===(o=i.sent()).status?[2,null]:[4,f(o,"Get document failed")];case 4:return a=i.sent(),[2,{id:String(a.id||e),name:String(a.name||""),case_id:String(a.case_id||"")}]}})})}function v(e){return s(this,void 0,void 0,function(){var t,n,r,o,a,i,c,s,m,v,g,p,h,b,y,w;return l(this,function(l){switch(l.label){case 0:return t=e.documentId,n=e.fileName,r=e.mimeType,o=e.dataBase64,a=e.directoryId,[4,d()];case 1:return i=l.sent(),[4,u()];case 2:c=l.sent(),s=encodeURIComponent(String(t)),m={name:n,mime_type:r,data_base64:o},a&&(m.dir_id=a),v=JSON.stringify(m),g=[{url:"".concat(c,"/documents/").concat(s,"/version"),method:"POST"},{url:"".concat(c,"/documents/").concat(s,"/versions"),method:"POST"},{url:"".concat(c,"/documents/").concat(s,"/versions"),method:"PUT"},{url:"".concat(c,"/documents/").concat(s,"/version"),method:"PUT"},{url:"".concat(c,"/documents/").concat(s,"/versions"),method:"PATCH"},{url:"".concat(c,"/documents/").concat(s,"/version"),method:"PATCH"}],p=null,h=0,b=g,l.label=3;case 3:return h<b.length?(y=b[h],[4,fetch(y.url,{method:y.method,headers:{"Content-Type":"application/json",Authentication:i,"Accept-Encoding":"identity"},body:v})]):[3,7];case 4:return 404===(w=l.sent()).status||405===w.status?(p=new Error("Endpoint not available: ".concat(y.method," ").concat(y.url," (").concat(w.status,")")),[3,6]):[4,f(w,"Upload version failed")];case 5:return[2,l.sent()];case 6:return h++,[3,3];case 7:throw p instanceof Error?p:new Error("Upload version failed: no supported endpoint found")}})})}function g(e){return s(this,void 0,void 0,function(){var t,n,r,o,a,i,s,m,v,g,p,h,b,y,w,S,k,x;return l(this,function(l){switch(l.label){case 0:t=e.caseId,n=e.fileName,r=e.mimeType,o=e.dataBase64,a=e.directoryId,i=e.metadata,console.log("[uploadDocumentToCase] Starting upload",{caseId:t,fileName:n,mimeType:r,dataLength:o.length}),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,d()];case 2:return s=l.sent(),console.log("[uploadDocumentToCase] Token retrieved",{hasToken:!!s,tokenPrefix:s.slice(0,10)}),[3,4];case 3:throw m=l.sent(),console.error("[uploadDocumentToCase] Failed to get token:",m),m;case 4:return l.trys.push([4,6,,7]),[4,u()];case 5:return v=l.sent(),console.log("[uploadDocumentToCase] Base URL resolved:",v),[3,7];case 6:throw g=l.sent(),console.error("[uploadDocumentToCase] Failed to resolve base URL:",g),g;case 7:p="".concat(v,"/documents"),console.log("[uploadDocumentToCase] Full URL:",p),h={case_id:t,documents:[c(c({name:n,mime_type:r,data_base64:o},a?{dir_id:a}:{}),i?{metadata:i}:{})]},console.log("[uploadDocumentToCase] Payload structure:",{case_id:h.case_id,documentCount:h.documents.length,firstDoc:{name:h.documents[0].name,mime_type:h.documents[0].mime_type,data_base64_length:h.documents[0].data_base64.length}}),l.label=8;case 8:return l.trys.push([8,10,,11]),[4,fetch(p,{method:"POST",headers:{"Content-Type":"application/json",Authentication:s,"Accept-Encoding":"identity"},body:JSON.stringify(h)})];case 9:return b=l.sent(),console.log("[uploadDocumentToCase] Fetch completed",{status:b.status,statusText:b.statusText,ok:b.ok}),[3,11];case 10:throw y=l.sent(),console.error("[uploadDocumentToCase] Fetch failed:",y),new Error("Network request failed: ".concat(y instanceof Error?y.message:String(y)));case 11:return b.ok?[3,13]:[4,b.text().catch(function(){return""})];case 12:w=l.sent(),S=w.slice(0,300),console.error("[uploadDocumentToCase] Upload failed",{status:b.status,statusText:b.statusText,url:p,responseSnippet:S}),l.label=13;case 13:return[4,f(b,"Upload failed")];case 14:return k=l.sent(),console.log("[uploadDocumentToCase] Upload successful",{documentIds:null===(x=k.documents)||void 0===x?void 0:x.map(function(e){return e.id})}),[2,k]}})})}function p(e,t,n,r){return s(this,void 0,void 0,function(){var o,a;return l(this,function(i){switch(i.label){case 0:return[4,fetch(e,{method:t,headers:{"Content-Type":"application/json",Authentication:n,"Accept-Encoding":"identity"},body:JSON.stringify({name:r})})];case 1:return(o=i.sent()).ok?(o.headers.get("content-type")||"").includes("application/json")?[2,o.json()]:[2,{}]:404===o.status||405===o.status?[2,null]:[4,o.text().catch(function(){return""})];case 2:throw a=i.sent(),new Error("Rename document failed (".concat(o.status,"): ").concat(a||o.statusText))}})})}function h(e){return s(this,void 0,void 0,function(){var t,n,r,o,a,i,c;return l(this,function(s){switch(s.label){case 0:return[4,u()];case 1:t=s.sent(),n=encodeURIComponent(String(e.documentId)),r=[{url:"".concat(t,"/documents/").concat(n),method:"PUT"},{url:"".concat(t,"/documents/").concat(n),method:"PATCH"},{url:"".concat(t,"/documents/").concat(n,"/rename"),method:"POST"},{url:"".concat(t,"/documents/").concat(n,"/name"),method:"PUT"}],o=0,a=r,s.label=2;case 2:return o<a.length?[4,p((i=a[o]).url,i.method,e.token,e.name)]:[3,5];case 3:if(c=s.sent())return[2,c];s.label=4;case 4:return o++,[3,2];case 5:throw new Error("Rename document failed: API endpoint not found or not allowed")}})})}var b="Outlook add-in";function y(e){return s(this,void 0,void 0,function(){var t,n,r;return l(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,(0,o.wv)(a.d.outlookFolderCache)];case 1:return(t=i.sent())?(n=JSON.parse(String(t)),[2,(r=n[String(e)])?String(r):null]):[2,null];case 2:return i.sent(),[2,null];case 3:return[2]}})})}function w(e,t){return s(this,void 0,void 0,function(){var n,r,i;return l(this,function(c){switch(c.label){case 0:return c.trys.push([0,3,,4]),[4,(0,o.wv)(a.d.outlookFolderCache)];case 1:return n=c.sent(),(r=n?JSON.parse(String(n)):{})[String(e)]=String(t),[4,(0,o.Kg)(a.d.outlookFolderCache,JSON.stringify(r))];case 2:return c.sent(),[3,4];case 3:return i=c.sent(),console.warn("[cacheFolderId] Failed to cache folder ID:",i),[3,4];case 4:return[2]}})})}function S(e){return s(this,void 0,void 0,function(){var t,n,r,o,a,i;return l(this,function(c){switch(c.label){case 0:return[4,d()];case 1:return t=c.sent(),[4,u()];case 2:return n=c.sent(),r="".concat(n,"/cases/").concat(encodeURIComponent(e)),[4,fetch(r,{method:"GET",headers:{Authentication:t,"Content-Type":"application/json","Accept-Encoding":"identity"}})];case 3:return(o=c.sent()).ok?[4,o.json()]:(console.warn("[getCaseRootDirectoryId] Failed to get case:",o.status),[2,null]);case 4:return a=c.sent(),[2,(i=(null==a?void 0:a.root_directory_id)||(null==a?void 0:a.documents_directory_id))?String(i):null]}})})}function k(e){return s(this,void 0,void 0,function(){var t,n,r,o,a,i,c,s,f,m;return l(this,function(l){switch(l.label){case 0:return[4,d()];case 1:return t=l.sent(),[4,u()];case 2:return n=l.sent(),r="".concat(n,"/directories/").concat(encodeURIComponent(e)),[4,fetch(r,{method:"GET",headers:{Authentication:t,"Content-Type":"application/json","Accept-Encoding":"identity"}})];case 3:if(!(o=l.sent()).ok)throw new Error("List directory failed (".concat(o.status,"): ").concat(o.statusText));return[4,o.json()];case 4:for(a=l.sent(),i=[],c=(null==a?void 0:a.items)||(null==a?void 0:a.children)||[],s=0,f=c;s<f.length;s++)m=f[s],i.push({id:String(m.id||m._id),name:String(m.name||""),type:"directory"===m.type||m.is_directory?"directory":"file",parent_id:m.parent_id});return[2,{items:i,parent_id:null==a?void 0:a.id}]}})})}function x(e,t){return s(this,void 0,void 0,function(){var n,r,o,a,i,c,s,f,m,v,g,p;return l(this,function(l){switch(l.label){case 0:return[4,d()];case 1:return n=l.sent(),[4,u()];case 2:r=l.sent(),o={name:t,parent_id:e},a=[{url:"".concat(r,"/directories"),method:"POST"},{url:"".concat(r,"/directories/").concat(encodeURIComponent(e),"/subdirectories"),method:"POST"},{url:"".concat(r,"/folders"),method:"POST"}],i=null,c=0,s=a,l.label=3;case 3:if(!(c<s.length))return[3,11];f=s[c],l.label=4;case 4:return l.trys.push([4,9,,10]),[4,fetch(f.url,{method:f.method,headers:{Authentication:n,"Content-Type":"application/json","Accept-Encoding":"identity"},body:JSON.stringify(o)})];case 5:return 404===(m=l.sent()).status||405===m.status?[3,10]:m.ok?[3,7]:[4,m.text().catch(function(){return""})];case 6:return v=l.sent(),i=new Error("Create directory failed (".concat(m.status,"): ").concat(v||m.statusText)),[3,10];case 7:return[4,m.json()];case 8:return g=l.sent(),[2,{id:String(g.id||g._id),name:String(g.name||t),parent_id:g.parent_id}];case 9:return p=l.sent(),i=p instanceof Error?p:new Error(String(p)),[3,10];case 10:return c++,[3,3];case 11:throw i||new Error("Create directory failed: no supported endpoint found")}})})}function I(e){return s(this,void 0,void 0,function(){var t,n,r,o,a,i;return l(this,function(c){switch(c.label){case 0:return console.log("[ensureOutlookAddinFolder] Starting for case:",e),[4,y(e)];case 1:return(t=c.sent())?(console.log("[ensureOutlookAddinFolder] Using cached folder ID:",t),[2,t]):[4,S(e)];case 2:if(!(n=c.sent()))return console.warn("[ensureOutlookAddinFolder] Case has no root directory"),[2,null];console.log("[ensureOutlookAddinFolder] Root directory ID:",n),c.label=3;case 3:return c.trys.push([3,9,,10]),[4,k(n)];case 4:return r=c.sent(),console.log("[ensureOutlookAddinFolder] Found",r.items.length,"items in root"),(o=r.items.find(function(e){return"directory"===e.type&&e.name===b}))?(console.log("[ensureOutlookAddinFolder] Folder already exists:",o.id),[4,w(e,String(o.id))]):[3,6];case 5:return c.sent(),[2,String(o.id)];case 6:return console.log("[ensureOutlookAddinFolder] Creating folder:",b),[4,x(n,b)];case 7:return a=c.sent(),console.log("[ensureOutlookAddinFolder] Folder created:",a.id),[4,w(e,String(a.id))];case 8:return c.sent(),[2,String(a.id)];case 9:return i=c.sent(),console.error("[ensureOutlookAddinFolder] Failed:",i),[2,null];case 10:return[2]}})})}function N(e,t){if(void 0===t&&(t=!0),!e)return"";var n=e.trim().toLowerCase();if(n=n.replace(/\s+/g," "),t){var r=void 0;do{r=n.length,n=n.replace(/^(re|fw|fwd):\s*/i,"")}while(n.length!==r&&n.length>0)}return n.trim()}function C(e,t){return s(this,void 0,void 0,function(){var n,r,o,a,i,c,s,f,m,v,g,p,h,b,y,w,S,k,x,I;return l(this,function(l){switch(l.label){case 0:return console.log("[findDocumentBySubject] Searching for subject in case",{caseId:e,subject:t}),[4,d()];case 1:return n=l.sent(),[4,u()];case 2:r=l.sent(),o=["".concat(r,"/cases/").concat(encodeURIComponent(e),"/documents"),"".concat(r,"/documents?case_id=").concat(encodeURIComponent(e)),"".concat(r,"/cases/").concat(encodeURIComponent(e),"/files")],a=[],i=0,c=o,l.label=3;case 3:if(!(i<c.length))return[3,11];s=c[i],l.label=4;case 4:return l.trys.push([4,9,,10]),[4,fetch(s,{method:"GET",headers:{Authentication:n,"Content-Type":"application/json","Accept-Encoding":"identity"}})];case 5:return 404===(f=l.sent()).status||405===f.status?[3,10]:f.ok?[3,7]:[4,f.text().catch(function(){return""})];case 6:return m=l.sent(),new Error("List documents failed (".concat(f.status,"): ").concat(m||f.statusText)),[3,10];case 7:return[4,f.json()];case 8:return v=l.sent(),(a=Array.isArray(v)?v:Array.isArray(v.documents)?v.documents:Array.isArray(v.files)?v.files:Array.isArray(v.items)?v.items:[]).length>=0?(console.log("[findDocumentBySubject] Found",a.length,"documents in case"),[3,11]):[3,10];case 9:return(g=l.sent())instanceof Error||new Error(String(g)),[3,10];case 10:return i++,[3,3];case 11:if(0===a.length)return console.log("[findDocumentBySubject] No documents found in case"),[2,null];if(p=N(t),console.log("[findDocumentBySubject] Normalized search subject:",p),!p)return console.warn("[findDocumentBySubject] Empty normalized subject, skipping"),[2,null];for(h=0,b=a;h<b.length;h++)if(y=b[h],(w=String(y.name||y.filename||"")).toLowerCase().endsWith(".eml")&&((S=(null===(x=y.metadata)||void 0===x?void 0:x.subject)||y.subject||(null===(I=y.properties)||void 0===I?void 0:I.subject)||"")||(S=w.replace(/\.eml$/i,"")),k=N(S),console.log("[findDocumentBySubject] Comparing",{fileName:w,docSubject:S,normalizedDocSubject:k,matches:k===p}),k===p))return console.log("[findDocumentBySubject] Match found!",{id:y.id,name:w}),[2,{id:String(y.id||y._id),name:w,subject:S}];return console.log("[findDocumentBySubject] No matching document found"),[2,null]}})})}function E(e,t){return s(this,void 0,void 0,function(){var n,r,o,a,i,c,s,f,m,v,g,p,h,b,y,w,S;return l(this,function(l){switch(l.label){case 0:if(!e)return console.log("[checkFiledStatusByConversationAndSubject] No conversationId provided"),[2,null];if(!t)return console.log("[checkFiledStatusByConversationAndSubject] No subject provided"),[2,null];n=N(t),console.log("[checkFiledStatusByConversationAndSubject] Checking:",{conversationId:e.substring(0,30)+"...",subject:t,normalizedSubject:n}),l.label=1;case 1:return l.trys.push([1,11,,12]),[4,d()];case 2:return r=l.sent(),[4,u()];case 3:o=l.sent(),console.log("[checkFiledStatusByConversationAndSubject] Fetching recent documents for matching"),a="".concat(o,"/documents?limit=200&sort=-modified_at"),i=[],l.label=4;case 4:return l.trys.push([4,9,,10]),[4,fetch(a,{method:"GET",headers:{Authentication:r,"Content-Type":"application/json","Accept-Encoding":"identity"}})];case 5:return(c=l.sent()).ok?[4,c.json()]:[3,7];case 6:return s=l.sent(),i=Array.isArray(s)?s:Array.isArray(s.documents)?s.documents:[],console.log("[checkFiledStatusByConversationAndSubject] Fetched",i.length,"documents for manual search"),[3,8];case 7:return console.warn("[checkFiledStatusByConversationAndSubject] Failed to fetch documents:",c.status),[2,null];case 8:return[3,10];case 9:return f=l.sent(),console.error("[checkFiledStatusByConversationAndSubject] Fetch failed:",f),[2,null];case 10:for(m=0,v=i;m<v.length;m++)if(g=v[m],(p=String(g.name||g.filename||"")).toLowerCase().endsWith(".eml")&&(h=null===(w=g.metadata)||void 0===w?void 0:w.conversationId)&&String(h).trim()===e.trim()&&((b=(null===(S=g.metadata)||void 0===S?void 0:S.subject)||g.subject||"")||(b=p.replace(/\.eml$/i,"")),N(b)===n))return console.log("[checkFiledStatusByConversationAndSubject] Match found!",{documentId:g.id,caseId:g.case_id,subject:b,conversationIdMatch:!0,subjectMatch:!0}),[2,{documentId:String(g.id||g._id),caseId:String(g.case_id||g.caseId),caseName:g.case_name||g.caseName,caseKey:g.case_key||g.caseKey,subject:b}];return console.log("[checkFiledStatusByConversationAndSubject] No match found (checked",i.length,"documents)"),[2,null];case 11:return y=l.sent(),console.error("[checkFiledStatusByConversationAndSubject] Error:",y),[2,null];case 12:return[2]}})})}},21020:function(e,t,n){var r=n(96540),o=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,a={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!s.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:u,props:a,_owner:c.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},22799:function(e,t){if("function"==typeof Symbol&&Symbol.for){var n=Symbol.for;n("react.element"),n("react.portal"),n("react.fragment"),n("react.strict_mode"),n("react.profiler"),n("react.provider"),n("react.context"),n("react.forward_ref"),n("react.suspense"),n("react.suspense_list"),n("react.memo"),n("react.lazy"),n("react.block"),n("react.server.block"),n("react.fundamental"),n("react.debug_trace_mode"),n("react.legacy_hidden")}},26312:function(e,t,n){function r(e){return Array.isArray(e)?e:[e]}n.d(t,{J:function(){return m}});var o=n(45614);const a=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,n)=>(e[t]=n,e),{});function i(e,t,n,r,i={}){var c,s;const l="m"===e,u=null!==(c=i.m)&&void 0!==c?c:"0",d=null!==(s=i.p)&&void 0!==s?s:0,f=function(e,t,n){return("m"===e?e+t:e)+n}(e,u,d);if(!r.stylesheets[f]){const c=t&&t.createElement("style"),s=function(e,t,n,r){const a=[];if(r[o.ed]=t,r[o.EJ]=String(n),e)for(const t in r)e.setAttribute(t,r[t]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):a.push(t)},element:e,bucketName:t,cssRules(){return(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):a}}}(c,e,d,Object.assign({},r.styleElementAttributes,l&&{media:u}));r.stylesheets[f]=s,(null==t?void 0:t.head)&&c&&t.head.insertBefore(c,function(e,t,n,r,i={}){var c,s;const l=a[n],u=null!==(c=i.m)&&void 0!==c?c:"",d=null!==(s=i.p)&&void 0!==s?s:0;let f=e=>l-a[e.getAttribute(o.ed)],m=e.head.querySelectorAll(`[${o.ed}]`);if("m"===n){const t=e.head.querySelectorAll(`[${o.ed}="${n}"]`);t.length&&(m=t,f=e=>r.compareMediaQueries(u,e.media))}const v=e=>function(e,t,n){var r,a;return t+(null!==(r=n.m)&&void 0!==r?r:"")===e.getAttribute(o.ed)+(null!==(a=e.media)&&void 0!==a?a:"")}(e,n,i)?d-Number(e.getAttribute("data-priority")):f(e),g=m.length;let p=g-1;for(;p>=0;){const e=m.item(p);if(v(e)>0)return e.nextSibling;p--}return g>0?m.item(0):t?t.nextSibling:null}(t,n,e,r,i))}return r.stylesheets[f]}function c(e,t){try{e.insertRule(t)}catch(e){}}let s=0;const l=(e,t)=>e<t?-1:e>t?1:0;function u(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:n,unstable_filterCSSRule:o,insertionPoint:a,styleElementAttributes:u,compareMediaQueries:d=l}=t,f={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(u),compareMediaQueries:d,id:"d"+s++,insertCSSRules(t){for(const n in t){const s=t[n];for(let t=0,l=s.length;t<l;t++){const[l,u]=r(s[t]),d=i(n,e,a||null,f,u);f.insertionCache[l]||(f.insertionCache[l]=n,o?o(l)&&c(d,l):c(d,l))}}}};return f}var d=n(96540);const f=d.createContext(u());function m(){return d.useContext(f)}},29255:function(e,t,n){n.d(t,{G:function(){return a}});var r=n(35137),o=n(45614);function a(e,t,n=[]){return o.fj+function(e){const t=e.length;if(t===o.ez)return e;for(let n=t;n<o.ez;n++)e+="0";return e}((0,r.A)(e+t))}},33088:function(e,t,n){var r=n(96540),o=n.t(r,2),a=n(5338),i=n(44541);var c=(0,i.n)({root:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"8px",width:"100%"},logo:{width:"100%",maxWidth:"420px",height:"auto",objectFit:"contain"},logoSmall:{maxWidth:"260px"},message:{fontSize:"var(--fontSizeBase500)",fontWeight:"var(--fontWeightSemibold)",margin:0}}),s=function(e){var t=e.logo,n=e.title,o=e.message,a=e.size,i=void 0===a?"default":a,s=c();return r.createElement("div",{className:s.root},r.createElement("img",{src:t,alt:n,className:"".concat(s.logo," ").concat("small"===i?s.logoSmall:"")}),o?r.createElement("h1",{className:s.message},o):null)},l=n(50134),u=n(50466),d=n(64583).Promise,f=function(e,t,n,r){return new(n||(n=d))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},m=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},v=(0,i.n)({root:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"rgb(240, 240, 240)"},content:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"24px 16px 0",boxSizing:"border-box"},headerWrap:{marginTop:"36px",display:"flex",justifyContent:"center",width:"100%"},scaleImage:{width:"100%",maxWidth:"320px",margin:"64px auto 24px",opacity:.6,display:"block",pointerEvents:"none",userSelect:"none"},actionsWrap:{position:"sticky",bottom:"20px",width:"100%",display:"flex",justifyContent:"center"},actionsInner:{width:"100%",maxWidth:"420px",padding:"0 16px",display:"flex",flexDirection:"column",gap:"14px"},formWrap:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},label:{fontSize:"12px",opacity:.8},input:{height:"40px",borderRadius:"12px",border:"1px solid rgba(0,0,0,0.12)",padding:"0 12px",outline:"none",background:"rgba(255,255,255,0.9)",boxSizing:"border-box",width:"100%"},error:{borderRadius:"10px",padding:"10px 12px",border:"1px solid rgba(180, 0, 0, 0.25)",background:"rgba(220, 0, 0, 0.06)",color:"rgba(120, 0, 0, 0.95)",fontSize:"13px",lineHeight:1.35},primaryBtn:{height:"44px",borderRadius:"12px",border:"none",padding:"0 16px",background:"#00204A",color:"white",cursor:"pointer",fontWeight:600,width:"100%"},secondaryBtn:{height:"44px",borderRadius:"12px",border:"1px solid rgba(0,0,0,0.12)",padding:"0 16px",background:"transparent",cursor:"pointer",fontWeight:500,width:"100%"},legalRow:{marginTop:"8px",fontSize:"12px",lineHeight:"1.35",opacity:.75,textAlign:"center"},legalLink:{border:"none",background:"transparent",padding:0,cursor:"pointer",textDecoration:"underline",fontSize:"12px",fontWeight:700,color:"#00204A"}});function g(e){var t=this,n=e.title,o=e.onOpenLoginDialog,a=v(),i=r.useState(""),c=i[0],d=i[1],g=r.useState(null),p=g[0],h=g[1];r.useEffect(function(){f(t,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,(0,l.wv)(u.d.workspaceHost)];case 1:return(e=t.sent())&&d(e),[2]}})})},[]);var b=function(e){var t=(e||"").trim();if(!t)return"";var n=t;return(n=(n=(n=(n=n.replace(/^https?:\/\//i,"")).split("/")[0]).split("?")[0]).split("#")[0])&&!n.includes(".")&&(n="".concat(n,".singlecase.com")),n.toLowerCase()}(c),y=b.length>0,w=function(e){var t,n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.ui;(null==n?void 0:n.openBrowserWindow)?n.openBrowserWindow(e):window.open(e,"_blank","noopener,noreferrer")};return r.createElement("div",{className:a.root},r.createElement("div",{className:a.content},r.createElement("div",{className:a.headerWrap},r.createElement(s,{logo:"assets/SingleCaseFullLogo.svg",title:n,size:"small"})),r.createElement("img",{src:"assets/Scale.webp",alt:"",className:a.scaleImage})),r.createElement("div",{className:a.actionsWrap},r.createElement("div",{className:a.actionsInner},r.createElement("div",{className:a.formWrap},r.createElement("div",null,r.createElement("div",{className:a.label},"Workspace URL"),r.createElement("input",{className:a.input,value:c,onChange:function(e){return d(e.target.value)},placeholder:"acme.singlecase.com or acme",autoComplete:"off",spellCheck:!1})),p?r.createElement("div",{className:a.error},p):null),r.createElement("button",{className:a.primaryBtn,onClick:function(){return f(t,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return h(null),b?[4,(0,l.wv)(u.d.publicToken)]:(h("Please enter a workspace URL."),[2]);case 1:return e=n.sent(),(t=(e||"").trim())?[4,(0,l.Kg)(u.d.workspaceHost,b)]:(h("Missing public token in local storage."),[2]);case 2:return n.sent(),o({workspaceHost:b,token:t}),[2]}})})},disabled:!y,type:"button"},"Continue"),r.createElement("button",{className:a.secondaryBtn,onClick:function(){var e,t=b?"https://".concat(b):"https://singlecase.com",n=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.ui;(null==n?void 0:n.openBrowserWindow)?n.openBrowserWindow(t):window.open(t,"_blank","noopener,noreferrer")},type:"button"},"Open workspace"),r.createElement("div",{className:a.legalRow},r.createElement("button",{type:"button",className:a.legalLink,onClick:function(){return w("https://singlecase.com/terms")}},"Terms")," ","and"," ",r.createElement("button",{type:"button",className:a.legalLink,onClick:function(){return w("https://singlecase.com/privacy")}},"Privacy Policy")))))}var p=(0,i.n)({card:{border:"1px solid ".concat("rgba(0, 0, 0, 0.08)"),borderRadius:"16px",padding:"14px",backgroundColor:"rgba(255, 255, 255, 0.7)",color:"#111827"}});function h(e){var t=p();return r.createElement("div",{className:t.card},e.children)}var b=n(64583).Promise;function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var w=function(e,t,n,r){return new(n||(n=b))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},S=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function k(e){var t,n,r=null==e?void 0:e.status,o=null===(n=null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.Office)||void 0===t?void 0:t.AsyncResultStatus)||void 0===n?void 0:n.Succeeded;return void 0!==o?r===o:"succeeded"===String(r||"").toLowerCase()}function x(e,t){return"read"===t?b.resolve(String((null==e?void 0:e.subject)||"")):new b(function(t){var n;try{var r=null===(n=null==e?void 0:e.subject)||void 0===n?void 0:n.getAsync;if("function"!=typeof r)return void t("");r.call(e.subject,function(e){try{k(e)?t(String((null==e?void 0:e.value)||"")):t("")}catch(e){t("")}})}catch(e){t("")}})}function I(e,t,n){var r=String((null==e?void 0:e.conversationId)||"").trim();if(r)return b.resolve("cid:".concat(r));var o=null==e?void 0:e.getConversationIndexAsync;return"read"===n&&"function"==typeof o?new b(function(e){try{o(function(n){try{if(k(n)){var r=String((null==n?void 0:n.value)||"").trim();e(r?"cidx:".concat(r):t?"item:".concat(t):"")}else e(t?"item:".concat(t):"")}catch(n){e(t?"item:".concat(t):"")}})}catch(n){e(t?"item:".concat(t):"")}}):b.resolve(t?"item:".concat(t):"")}function N(){var e=this,t=(0,r.useState)(null),n=t[0],o=t[1],a=(0,r.useState)([]),i=a[0],c=a[1],s=(0,r.useState)(!1),l=s[0],u=s[1],d=(0,r.useState)(null),f=d[0],m=d[1],v=(0,r.useRef)(""),g=(0,r.useRef)(null),p=(0,r.useRef)(!1),h=(0,r.useCallback)(function(){return w(e,void 0,void 0,function(){var e,t,n,r,a,i,s,l,d,f,g,h,b,w,k,N,C;return S(this,function(S){switch(S.label){case 0:if(p.current)return[2];p.current=!0,S.label=1;case 1:return S.trys.push([1,4,5,6]),m(null),e=null===globalThis||void 0===globalThis?void 0:globalThis.Office,(t=null===(w=null===(b=null==e?void 0:e.context)||void 0===b?void 0:b.mailbox)||void 0===w?void 0:w.item)?(n=function(e){var t=null==e?void 0:e.subject;return t&&"object"===y(t)&&"function"==typeof t.getAsync?"compose":"read"}(t),r=String((null==t?void 0:t.itemId)||""),a="compose:".concat(String((null==t?void 0:t.conversationId)||""),":").concat(String((null==t?void 0:t.dateTimeCreated)||"")).trim(),(i=r||a||"compose:".concat(Date.now()))&&i===v.current?[2]:(v.current=i,[4,x(t,n)])):[2];case 2:return s=S.sent(),l="",d="","read"===n?(l=String((null===(k=null==t?void 0:t.from)||void 0===k?void 0:k.displayName)||""),d=String((null===(N=null==t?void 0:t.from)||void 0===N?void 0:N.emailAddress)||(null===(C=null==t?void 0:t.from)||void 0===C?void 0:C.address)||"")):(f=function(){var e,t;try{var n=null===globalThis||void 0===globalThis?void 0:globalThis.Office,r=null===(t=null===(e=null==n?void 0:n.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile;return{name:(null==r?void 0:r.displayName)?String(r.displayName):void 0,email:(null==r?void 0:r.emailAddress)?String(r.emailAddress):void 0}}catch(e){return{}}}(),l=String(f.name||""),d=String(f.email||"")),[4,I(t,r,n)];case 3:return g=S.sent(),o({itemId:r,itemKey:i,mode:n,subject:s,fromName:l,fromEmail:d,conversationKey:g}),u(!0),c([]),[3,6];case 4:return h=S.sent(),m(h instanceof Error?h.message:String(h)),c([]),[3,6];case 5:return u(!1),p.current=!1,[7];case 6:return[2]}})})},[]);return(0,r.useEffect)(function(){var t=!1;return w(e,void 0,void 0,function(){var e,n,r,o;return S(this,function(a){switch(a.label){case 0:return[4,new b(function(e){try{var t=null===globalThis||void 0===globalThis?void 0:globalThis.Office;t&&"function"==typeof t.onReady?t.onReady(function(){return e()}):e()}catch(t){e()}})];case 1:return a.sent(),t?[2]:[4,h()];case 2:if(a.sent(),t)return[2];if(e=null===globalThis||void 0===globalThis?void 0:globalThis.Office,!(null==(n=null===(o=null==e?void 0:e.context)||void 0===o?void 0:o.mailbox)?void 0:n.addHandlerAsync))return[2];r=function(){try{h()}catch(e){}},g.current=r;try{n.addHandlerAsync(e.EventType.ItemChanged,r,function(){})}catch(e){}return[2]}})}),function(){var e;t=!0;try{var n=null===globalThis||void 0===globalThis?void 0:globalThis.Office,r=null===(e=null==n?void 0:n.context)||void 0===e?void 0:e.mailbox,o=g.current;(null==r?void 0:r.removeHandlerAsync)&&o&&r.removeHandlerAsync(n.EventType.ItemChanged,{handler:o},function(){})}catch(e){}g.current=null,v.current="",p.current=!1}},[h]),{email:n,suggestions:i,isLoading:l,error:f,refresh:h}}var C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},C.apply(this,arguments)},E=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function B(e){return String(e||"").trim().toLowerCase()}function O(){return"sc_case_suggest:".concat(function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile;return String((null==n?void 0:n.emailAddress)||"").toLowerCase().trim()||"default"}catch(e){return"default"}}())}var T={version:1,threadToCase:{},senderToCase:{},domainToCase:{},recentCases:[]};function A(){try{var e=localStorage.getItem(O());if(!e)return T;var t=JSON.parse(e);return t&&1===t.version?C(C(C({},T),t),{threadToCase:t.threadToCase||{},senderToCase:t.senderToCase||{},domainToCase:t.domainToCase||{},recentCases:Array.isArray(t.recentCases)?t.recentCases:[]}):T}catch(e){return T}}function j(e,t,n){var r=Object.keys(e);if(r.length>t){var o=r.map(function(t){var n=e[t]||{};return[t,Math.max.apply(Math,E([0],Object.values(n).map(function(e){return e.lastSeenAt||0}),!1))]});o.sort(function(e,t){return t[1]-e[1]});for(var a=new Set(o.slice(0,t).map(function(e){return e[0]})),i=0,c=r;i<c.length;i++){var s=c[i];a.has(s)||delete e[s]}}for(var l=0,u=Object.keys(e);l<u.length;l++){var d=u[l],f=e[d]||{},m=Object.entries(f);m.length<=n||(m.sort(function(e,t){return(t[1].lastSeenAt||0)-(e[1].lastSeenAt||0)}),e[d]=Object.fromEntries(m.slice(0,n)))}}function _(e){var t,n=B(e);return n&&(null===(t=A().threadToCase[n])||void 0===t?void 0:t.caseId)||""}function z(e){return String(e||"").trim().toLowerCase()}function D(e){return String((null==e?void 0:e.case_id_visible)||(null==e?void 0:e.caseIdVisible)||(null==e?void 0:e.caseIdVisibleText)||(null==e?void 0:e.visibleId)||"").trim()}function F(e){return String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||(null==e?void 0:e.case_name)||(null==e?void 0:e.caseName)||(null==e?void 0:e.case_name_visible)||(null==e?void 0:e.caseNameVisible)||"").trim()}function R(e){return z(function(e){try{return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}catch(t){return e}}(e)).replace(/[^a-z0-9\s.:-]/g," ").replace(/\s+/g," ").trim()}function P(e){return R(e).replace(/-/g," ").replace(/\s+/g," ").trim()}function L(e){return P(e).split(" ").map(function(e){return e.trim()}).filter(function(e){return e.length>=3})}function M(e,t){if(!e.length)return{hits:0,total:0};for(var n=" ".concat(P(t)," "),r=0,o=0,a=e;o<a.length;o++){var i=a[o];n.includes(" ".concat(i," "))&&(r+=1)}return{hits:r,total:e.length}}function H(e,t,n){return Math.max(t,Math.min(n,e))}function q(e){return Math.log(1+Math.max(0,e))}function W(e,t){var n,r,o,a=null!==(n=e[t])&&void 0!==n?n:0,i=null!==(r=e[0])&&void 0!==r?r:0,c=null!==(o=e[1])&&void 0!==o?o:0,s=H(a/120,0,1),l=0===t?c:i,u=H(Math.max(0,a-l)/60,0,1);return H(Math.round(100*(.65*s+.35*u)),0,100)}function U(e){var t=e.enabled,n=e.emailItemId,o=e.conversationKey,a=e.subject,i=e.bodySnippet,c=e.fromEmail,s=e.attachments,l=e.cases,u=e.selectedCaseId,d=e.selectedSource,f=e.onAutoSelectCaseId,m=e.topK,v=r.useState([]),g=v[0],p=v[1],h=r.useState(""),b=h[0],y=h[1],w=r.useRef();r.useEffect(function(){w.current=f},[f]);var S=r.useMemo(function(){return(s||[]).filter(function(e){return!(null==e?void 0:e.isInline)}).map(function(e){return String((null==e?void 0:e.name)||"")}).join("|")},[s]),k=r.useMemo(function(){return(l||[]).map(function(e){var t;return String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"")}).join("|")},[l]),x=r.useRef({emailItemId:"",caseId:""});return r.useEffect(function(){var e;if(!t||!n||!(null==l?void 0:l.length))return p([]),void y("");var r=(s||[]).filter(function(e){return!e.isInline}).map(function(e){return e.name}),f=function(e){var t,n,r,o,a=null!==(t=e.topK)&&void 0!==t?t:2,i=String(e.conversationKey||"").trim(),c=String(e.subject||""),s=P(c),l=String(e.bodySnippet||""),u=P(l),d=(e.attachmentNames||[]).map(function(e){return R(e)}),f=z(e.fromEmail||""),m=(r=(n=z(f)).lastIndexOf("@"))>=0?n.slice(r+1):"",v={threadToCase:(o=A()).threadToCase,senderToCase:o.senderToCase,domainToCase:o.domainToCase,recentCases:o.recentCases},g=v.senderToCase,p=v.domainToCase,h=v.recentCases,b={},y={},w=function(e,t,n){e&&(y[e]=(y[e]||0)+t,n&&(b[e]||(b[e]=[]),b[e].includes(n)||b[e].push(n)))};if(i){var S=_(i);S&&w(S,100,"Same email thread previously attached to this case.")}for(var k=R(c),x=R(l),I=function(e){var t=e,n=String((null==t?void 0:t.id)||""),r=R(D(t));if(!n||!r)return"continue";var o=k.includes(r),a=x.includes(r),i=d.some(function(e){return e.includes(r)});(o||a||i)&&w(n,95,"Case reference found in the email.")},N=0,C=e.cases;N<C.length;N++)I(C[N]);for(var E=0,B=e.cases;E<B.length;E++){var O=B[E];if(Y=String((null==O?void 0:O.id)||"")){var T=F(O),j=P(T);if(j){var U=L(T);if(s&&(j===s||j.includes(s)||s.includes(j)))w(Y,98,"Email subject matches the case name.");else{if(U.length>0&&c){var K=M(U,c);if(K.hits>=2){var $=60+30*H(K.total>0?K.hits/K.total:0,0,1);w(Y,$,"Case name matches the email subject.")}}if(l&&U.length>0){var G=j.length>=4&&u.includes(j);if(U.length<=2)G&&w(Y,45,"Case name mentioned in the email body.");else{var V=M(U,l);V.hits>=2?($=35+25*H(V.total>0?V.hits/V.total:0,0,1),w(Y,$,"Case name mentioned in the email body.")):G&&w(Y,40,"Case name mentioned in the email body.")}}}}}}if(f&&g[f])for(var J=0,X=Object.entries(g[f]);J<X.length;J++){var Z=X[J],Y=Z[0];($=30*q(Z[1].count||0))>0&&w(Y,$,"You often attach emails from this sender to this case.")}if(m&&p[m])for(var Q=0,ee=Object.entries(p[m]);Q<ee.length;Q++){var te=ee[Q];Y=te[0],($=20*q(te[1].count||0))>0&&w(Y,$,"This domain often maps to this case.")}for(var ne=Date.now(),re=0,oe=h||[];re<oe.length;re++){var ae=oe[re];($=12*H(1-(ne-(ae.lastUsedAt||0))/864e5/14,0,1))>0&&w(ae.caseId,$,"Recently used.")}var ie=Object.entries(y).map(function(e){var t=e[0];return{caseId:t,score:e[1],reasons:b[t]||[]}}).sort(function(e,t){return t.score-e.score}),ce=ie.map(function(e){return e.score});ie.length>0?console.log("[suggestCasesLocal] ðŸ” Top scores (before filtering):",ie.slice(0,5).map(function(e){return{caseId:e.caseId,score:e.score.toFixed(1),reasons:e.reasons}})):(console.log("[suggestCasesLocal] âš ï¸ No cases scored any points!"),console.log("[suggestCasesLocal] Input:",{subjectLoose:s,bodyLoose:u.substring(0,100),casesCount:e.cases.length}));var se=ie.map(function(e,t){return{caseId:e.caseId,score:e.score,confidencePct:W(ce,t),reasons:e.reasons}}).filter(function(e){return e.confidencePct>=10}).slice(0,a),le=se[0];return{suggestions:se,autoSelectCaseId:le&&le.confidencePct>=70?le.caseId:""}}({conversationKey:o||"",subject:a,bodySnippet:i,attachmentNames:r,fromEmail:c,cases:l,topK:null!=m?m:2});console.log("[SC suggest] cases:",l.length),console.log("[SC suggest] subject:",a),console.log("[SC suggest] bodySnippet:",i),console.log("[SC suggest] suggestions:",f.suggestions.map(function(e){return{caseId:e.caseId,pct:e.confidencePct,score:e.score}}));var v=(l||[]).some(function(e){var t=String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||(null==e?void 0:e.case_name_visible)||(null==e?void 0:e.caseNameVisible)||"").toLowerCase();return t.includes("internal")&&t.includes("know")&&t.includes("how")});if(!(console.log("[SC suggest] has Internal Know How in cases[]:",v),console.log("[SC suggest] case titles sample:",(l||[]).slice(0,15).map(function(e){var t;return{id:String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""),title:String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||"")}})),console.log("[SC suggest] case titles sample:",(l||[]).slice(0,15).map(function(e){var t;return{id:String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""),title:String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||"")}})),p(function(e){var t=(e||[]).map(function(e){var t;return"".concat(String((null==e?void 0:e.caseId)||""),":").concat(String(null!==(t=null==e?void 0:e.score)&&void 0!==t?t:""))}).join("|"),n=(f.suggestions||[]).map(function(e){var t;return"".concat(String((null==e?void 0:e.caseId)||""),":").concat(String(null!==(t=null==e?void 0:e.score)&&void 0!==t?t:""))}).join("|");return t===n?e:f.suggestions}),y(function(e){return e===f.autoSelectCaseId?e:f.autoSelectCaseId}),"manual"===d||u&&"remembered"!==d&&"suggested"!==d&&""!==d&&void 0!==d)){var g=String(f.autoSelectCaseId||"");g&&String(u||"")!==g&&(x.current.emailItemId===String(n)&&x.current.caseId===g||(x.current={emailItemId:String(n),caseId:g},null===(e=w.current)||void 0===e||e.call(w,g)))}},[t,n,o,a,c,i,S,k,u,d,m]),{suggestions:g,autoSelectCaseId:b}}var K=n(64583).Promise,$=function(e,t,n,r){return new(n||(n=K))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},G=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function V(){return $(this,void 0,void 0,function(){var e,t;return G(this,function(n){switch(n.label){case 0:return[4,(0,l.wv)(u.d.workspaceHost)];case 1:if(e=n.sent(),!(t=function(e){var t=(e||"").trim().toLowerCase();return t?t.replace(/^https?:\/\//i,"").split("/")[0]:""}(e||"")))throw new Error("Workspace host is missing. Please enter a workspace URL first.");return[2,"/singlecase/".concat(encodeURIComponent(t),"/publicapi/v1")]}})})}function J(e,t,n,r,o){return $(this,void 0,void 0,function(){var a,i,c,s,l;return G(this,function(u){switch(u.label){case 0:if(!n)throw new Error("SingleCase token is missing");return[4,V()];case 1:if(!(a=u.sent()))throw new Error("SingleCase base url is missing");return i="".concat(a).concat(t).concat(function(e){void 0===e&&(e={});for(var t=new URLSearchParams,n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],a=o[0],i=o[1];null!=i&&""!==i&&(Array.isArray(i)?t.set(a,i.join(",")):t.set(a,String(i)))}var c=t.toString();return c?"?".concat(c):""}(o)),[4,fetch(i,{method:e,headers:{Authentication:n,"Content-Type":"application/json"},body:void 0!==r?JSON.stringify(r):void 0})];case 2:return c=u.sent(),s=c.headers.get("content-type")||"",[4,c.text()];case 3:if(l=u.sent(),!c.ok)throw new Error("SingleCase ".concat(c.status,": ").concat(l||c.statusText));if(!s.includes("application/json")){if(!l)return[2,void 0];throw new Error("SingleCase returned non JSON (".concat(s||"no content-type","). First bytes: ").concat(l.slice(0,200)))}return[2,JSON.parse(l)]}})})}function X(e,t,n){return $(this,void 0,void 0,function(){return G(this,function(r){return[2,J("GET",e,t,void 0,n)]})})}function Z(e){var t,n,r,o=null!=e.client_id?String(e.client_id):null!=e.clientId?String(e.clientId):null!=(null===(t=e.client)||void 0===t?void 0:t.id)?String(e.client.id):void 0,a=e.case_id_visible?String(e.case_id_visible):"",i=e.name?String(e.name):"",c=a?"".concat(a," Â· ").concat(i||"Case ".concat(e.id)):i||"Case ".concat(e.id);return{id:String(e.id),title:c,clientId:o,client:(null===(n=e.client)||void 0===n?void 0:n.name)||e.client_name||void 0,status:(null===(r=e.status)||void 0===r?void 0:r.name)||e.status||void 0}}function Y(e){return $(this,arguments,void 0,function(e,t){var n,r,o;return void 0===t&&(t="my"),G(this,function(t){switch(t.label){case 0:return[4,X("/cases",e)];case 1:return n=t.sent(),[2,(Array.isArray(n)?n:null!==(o=null!==(r=n.items)&&void 0!==r?r:n.data)&&void 0!==o?o:[]).map(Z)]}})})}function Q(e){return{id:String(e.id),name:String(e.name||"")}}function ee(e){return $(this,void 0,void 0,function(){var t,n,r;return G(this,function(o){switch(o.label){case 0:return[4,X("/clients",e)];case 1:return t=o.sent(),[2,(Array.isArray(t)?t:null!==(r=null!==(n=t.items)&&void 0!==n?n:t.data)&&void 0!==r?r:[]).map(Q).filter(function(e){return e.id&&e.name})]}})})}function te(e,t){return $(this,void 0,void 0,function(){return G(this,function(e){switch(e.label){case 0:return[4,new K(function(e){return setTimeout(e,500)})];case 1:return e.sent(),[2,{ok:!0,singlecaseRecordId:"mail_".concat(Date.now()),payload:t}]}})})}function ne(e){return{id:String(e.id),firstName:String(e.first_name||""),lastName:String(e.last_name||""),username:String(e.username||"")}}function re(e){return $(this,void 0,void 0,function(){var t,n,r;return G(this,function(o){switch(o.label){case 0:return[4,J("GET","/users",e)];case 1:return t=o.sent(),[2,(Array.isArray(t)?t:null!==(r=null!==(n=t.items)&&void 0!==n?n:t.data)&&void 0!==r?r:[]).map(ne)]}})})}function oe(e){return{"filter[user_id]":e.userId,"filter[project_id]":e.projectId,"filter[from]":e.from,"filter[to]":e.to}}function ae(e){return e?{id:null!=e.id?String(e.id):null!=e.timer_id?String(e.timer_id):null!=e.timerId?String(e.timerId):void 0,user_id:null!=e.user_id?String(e.user_id):String(e.userId||""),project_id:null!=e.project_id?String(e.project_id):String(e.projectId||""),date:String(e.date||""),total_time:Number(e.total_time||0),total_billed_time:Number(e.total_billed_time||0),sheet_activity_id:null!=e.sheet_activity_id?String(e.sheet_activity_id):null!=e.sheetActivityId?String(e.sheetActivityId):void 0,note:null!=e.note?String(e.note):""}:e}function ie(e,t){return $(this,void 0,void 0,function(){var n,r,o;return G(this,function(a){switch(a.label){case 0:return[4,J("GET","/timers",e,void 0,oe(t))];case 1:return n=a.sent(),[2,(Array.isArray(n)?n:null!==(o=null!==(r=n.items)&&void 0!==r?r:n.data)&&void 0!==o?o:[]).map(ae)]}})})}function ce(e,t){return $(this,void 0,void 0,function(){return G(this,function(n){return[2,J("POST","/timers",e,t)]})})}function se(e,t,n){return $(this,void 0,void 0,function(){return G(this,function(r){return[2,J("PUT","/timers/".concat(encodeURIComponent(t)),e,n)]})})}function le(e){var t=e.emailError,n=e.emailItemId,o=e.fromName,a=e.fromEmail,i=e.subject,c=e.isSwitchingEmail,s=r.useState(!1),l=s[0],u=s[1];if(r.useEffect(function(){u(!1)},[n]),t)return r.createElement("div",{className:"email-context-panel-error"},t);if(!n)return r.createElement("div",{className:"email-context-panel-empty"},"Open an email first.");var d=c?"Updatingâ€¦":"".concat(o).concat(a?" (".concat(a,")"):"");return r.createElement("button",{type:"button",className:["email-context-compact",l?"email-context-compact--expanded":""].filter(Boolean).join(" "),onClick:function(){return u(function(e){return!e})},"aria-expanded":l},r.createElement("div",{className:"email-context-compact-left"},r.createElement("div",{className:"email-context-compact-row"},r.createElement("span",{className:"email-context-compact-label"},"From:"),r.createElement("span",{className:"email-context-compact-value"},d)),l?r.createElement("div",{className:"email-context-compact-row email-context-compact-row--secondary"},r.createElement("span",{className:"email-context-compact-label"},"Subject:"),r.createElement("span",{className:"email-context-compact-value"},c?"Updatingâ€¦":i)):null),r.createElement("div",{className:"email-context-compact-chevron","aria-hidden":"true"},l?"âŒƒ":"âŒ„"))}function ue(e){var t=function(e){return String((null==e?void 0:e.case_id_visible)||(null==e?void 0:e.caseIdVisible)||"")}(e),n=function(e){return String((null==e?void 0:e.title)||(null==e?void 0:e.name)||"")}(e);return t?"".concat(t," Â· ").concat(n):n}function de(e){var t,n,r,o,a,i,c,s,l,u="string"==typeof(null==e?void 0:e.client)&&e.client.trim()||"string"==typeof(null==e?void 0:e.client_name)&&e.client_name.trim()||"string"==typeof(null==e?void 0:e.clientName)&&e.clientName.trim()||"string"==typeof(null==e?void 0:e.client_title)&&e.client_title.trim(),d="string"==typeof(null===(t=null==e?void 0:e.client)||void 0===t?void 0:t.name)&&e.client.name.trim()||"string"==typeof(null===(n=null==e?void 0:e.client)||void 0===n?void 0:n.title)&&e.client.title.trim(),f=u||d,m=null!==(s=null!==(i=null!==(o=null!==(r=null==e?void 0:e.client_id)&&void 0!==r?r:null==e?void 0:e.clientId)&&void 0!==o?o:null===(a=null==e?void 0:e.client)||void 0===a?void 0:a.id)&&void 0!==i?i:null===(c=null==e?void 0:e.client)||void 0===c?void 0:c.client_id)&&void 0!==s?s:null===(l=null==e?void 0:e.client)||void 0===l?void 0:l.clientId,v=null!=m?String(m):"";return f?{key:"name:".concat(f),label:f,id:v||void 0}:v?{key:"id:".concat(v),label:"Client ".concat(v),id:v}:{key:"other",label:"Other"}}function fe(e){return e>=90?"case-selector-confidence-pill case-selector-confidence-pill--high":e>=80?"case-selector-confidence-pill case-selector-confidence-pill--mid":e>=70?"case-selector-confidence-pill case-selector-confidence-pill--low":"case-selector-confidence-pill case-selector-confidence-pill--none"}function me(e){return["case-selector-chip",e?"case-selector-chip--active":""].filter(Boolean).join(" ")}function ve(e){return String(e||"").toLowerCase().trim()}function ge(e){var t=e.title,n=void 0===t?"Case":t,o=e.scope,a=e.onScopeChange,i=e.selectedCaseId,c=e.onSelectCaseId,s=e.cases,l=e.isLoadingCases,u=e.clientNamesById,d=e.suggestions,f=e.contentSuggestions,m=e.isLoadingContentSuggestions,v=r.useState(""),g=v[0],p=v[1],h=r.useRef(null),b=r.useMemo(function(){return function(e,t){for(var n=new Map,r=0,o=e;r<o.length;r++){var a=o[r],i=de(a),c=n.get(i.key);c?c.items.push(a):n.set(i.key,{key:i.key,label:i.label,id:i.id,items:[a]})}for(var s=Array.from(n.keys()).sort(function(e,t){return"other"===e?1:"other"===t?-1:e.localeCompare(t,"cs")}),l=[],u=function(e){var r=n.get(e);if(!r)return"continue";var o=function(e,t){return e.key.startsWith("name:")?e.label:e.id&&(null==t?void 0:t[e.id])?t[e.id]:e.label}({key:r.key,label:r.label,id:r.id},t),a=r.items.map(function(e){var t=e,n=String(t.id||""),a=ue(t);return{kind:"case",clientLabel:o,clientId:r.id,caseId:n,label:a}}).sort(function(e,t){return"case"!==e.kind||"case"!==t.kind?0:e.label.localeCompare(t.label,"cs",{sensitivity:"base"})});if(0===a.length)return"continue";l.push({kind:"client",clientLabel:o,count:a.length}),l.push.apply(l,a)},d=0,f=s;d<f.length;d++)u(f[d]);return l}(s,u)},[s,u]),y=r.useMemo(function(){return b.filter(function(e){return"case"===e.kind})},[b]),w=r.useMemo(function(){var e=(d||[]).slice(0,10);return e.length?e.map(function(e){var t=y.find(function(t){return t.caseId===e.caseId});return t?{caseId:e.caseId,confidencePct:"number"==typeof e.confidencePct?e.confidencePct:0,reasons:e.reasons||[],label:t.label,clientLabel:t.clientLabel}:null}).filter(Boolean):[]},[d,y]),S=r.useMemo(function(){var e=(f||[]).slice(0,10);return e.length?e.map(function(e){var t=y.find(function(t){return t.caseId===e.caseId});return t?{caseId:e.caseId,confidencePct:"number"==typeof e.confidencePct?e.confidencePct:0,reasons:e.reasons||[],label:t.label,clientLabel:t.clientLabel}:null}).filter(Boolean):[]},[f,y]),k=w.length?w[0]:null,x=r.useMemo(function(){var e=w[1];return e?e.caseId===(null==k?void 0:k.caseId)||(e.confidencePct||0)<1?null:e:null},[w,null==k?void 0:k.caseId]),I=r.useMemo(function(){var e=new Set;return(null==k?void 0:k.caseId)&&e.add(k.caseId),(null==x?void 0:x.caseId)&&e.add(x.caseId),e},[null==k?void 0:k.caseId,null==x?void 0:x.caseId]),N=r.useMemo(function(){return k?w.slice(1).filter(function(e){return!I.has(e.caseId)}).filter(function(e){return e.confidencePct>=60}):[]},[w,k,I]),C=r.useMemo(function(){return y.filter(function(e){return!I.has(e.caseId)})},[y,I]),E=N.length>0?N:C,B=r.useMemo(function(){var e=ve(g);return e?E.filter(function(t){var n=ve(String(t.label||"")),r=ve(String(t.clientLabel||""));return n.includes(e)||r.includes(e)}).slice(0,20):[]},[E,g]),O=r.useMemo(function(){if(!i)return"";var e=s.find(function(e){return String((null==e?void 0:e.id)||"")===i});return e?ue(e):""},[s,i]),T=function(e){c(e),p("")};r.useEffect(function(){p("")},[i,o]),r.useEffect(function(){f&&f.length>0&&console.log("[CaseSelector] ðŸ“„ Content suggestions received:",{count:f.length,mapped:S.length,suggestions:f.map(function(e){return{caseId:e.caseId,pct:e.confidencePct}})})},[null==f?void 0:f.length]);var A=y.length>0;r.useEffect(function(){A&&h.current&&h.current.focus()},[A]);var j=function(e,t){var n,o=i===e.caseId;return r.createElement("button",{type:"button",className:["case-selector-suggested-btn","secondary"===t?"case-selector-suggested-btn--secondary":"",o?"case-selector-suggested-btn--active":""].filter(Boolean).join(" "),onClick:function(){return T(e.caseId)}},r.createElement("div",{className:"case-selector-suggested-topline"},r.createElement("div",{className:"case-selector-suggested-primary"},e.label),r.createElement("div",{className:fe(e.confidencePct)},e.confidencePct,"%")),r.createElement("div",{className:"case-selector-suggested-secondary"},e.clientLabel),(null===(n=e.reasons)||void 0===n?void 0:n.length)?r.createElement("div",{className:"case-selector-suggested-reason"},e.reasons[0]):null)};return r.createElement("div",{className:"case-selector-wrap"},r.createElement("div",{className:"case-selector-top-row"},r.createElement("div",{className:"case-selector-title"},n),r.createElement("div",{className:"case-selector-chips"},r.createElement("button",{className:me("favourites"===o),onClick:function(){return a("favourites")},type:"button"},"Favourites"),r.createElement("button",{className:me("all"===o),onClick:function(){return a("all")},type:"button"},"All"))),O?r.createElement("div",{className:"case-selector-selected-hint"},"Iâ€™ve noticed that this email or its attachments were deleted from SingleCase. ",O):null,l?r.createElement("div",{className:"case-selector-loading"},"Loadingâ€¦"):A?r.createElement("div",{className:"case-selector-suggested-card"},m?r.createElement("div",{className:"case-selector-loading",style:{marginBottom:12}},"HledÃ¡m odpovÃ­dajÃ­cÃ­ spisyâ€¦"):null,!m&&S.length>0?r.createElement("div",{style:{marginBottom:16}},r.createElement("div",{style:{fontSize:12,fontWeight:600,color:"#616161",marginBottom:8}},"ðŸ“„ NÃ¡vrhy podle obsahu emailu"),S.slice(0,3).map(function(e,t){return r.createElement("div",{key:"content-".concat(e.caseId),style:{marginBottom:4}},j(e,0===t?"primary":"secondary"))})):null,S.length>0&&k?r.createElement("div",{style:{fontSize:12,fontWeight:600,color:"#616161",marginBottom:8}},"ðŸ•’ NÃ¡vrhy podle historie"):null,k?r.createElement(r.Fragment,null,j(k,"primary"),x?j(x,"secondary"):null):m||0!==S.length?null:r.createElement("div",{className:"case-selector-empty",style:{marginBottom:8}},"No suggestions yet. Search for a case below."),r.createElement("div",{className:"case-selector-other-list"},r.createElement("input",{ref:h,className:"case-selector-input case-selector-input--search",value:g,onChange:function(e){return p(e.target.value)},onKeyDown:function(e){"Escape"===e.key?(p(""),e.currentTarget.blur()):"Enter"===e.key&&B.length>0&&T(B[0].caseId)},placeholder:"Search other cases or clients"}),g.trim().length>0&&r.createElement(r.Fragment,null,B.map(function(e){var t=String(e.caseId||""),n=String(e.label||""),o=String(e.clientLabel||""),a="number"==typeof e.confidencePct?e.confidencePct:0;return r.createElement("button",{key:"o-".concat(t),type:"button",className:["case-selector-other-item",i===t?"case-selector-other-item--active":""].filter(Boolean).join(" "),onClick:function(){return T(t)}},r.createElement("div",{className:"case-selector-other-left"},r.createElement("div",{className:"case-selector-other-primary"},n),r.createElement("div",{className:"case-selector-other-secondary"},o)),a>0?r.createElement("div",{className:fe(a)},a,"%"):r.createElement("div",{className:"case-selector-other-spacer"}))}),0===B.length&&r.createElement("div",{className:"case-selector-empty"},"No matches found.")))):r.createElement("div",{className:"case-selector-empty"},"No cases available."))}function pe(e){var t=e.enabled,n=e.attachments,o=e.selectedAttachmentIds,a=e.isLoadingAttachments,i=e.onToggleAttachment,c=e.onSelectAll,s=e.onClearAll;return t?r.createElement("div",{className:"attachments-picker-wrap"},r.createElement("div",{className:"attachments-picker-top"},r.createElement("div",{className:"attachments-picker-section-title"},"Attachments"),n.length?r.createElement("div",{className:"attachments-picker-actions"},r.createElement("button",{type:"button",onClick:c,className:"attachments-picker-small-btn",disabled:a},"Select all"),r.createElement("button",{type:"button",onClick:s,className:"attachments-picker-small-btn",disabled:a},"Clear")):null),a?r.createElement("div",{className:"attachments-picker-loading"},"Loading attachments..."):0===n.length?r.createElement("div",{className:"attachments-picker-empty"},"No attachments detected."):r.createElement("div",{className:"attachments-picker-list"},n.map(function(e){var t=o.has(e.id);return r.createElement("label",{key:e.id,className:"attachments-picker-item"},r.createElement("input",{type:"checkbox",checked:t,onChange:function(){return i(e.id)}}),r.createElement("div",{className:"attachments-picker-item-body"},r.createElement("div",{className:"attachments-picker-item-name",title:e.name},e.name),r.createElement("div",{className:"attachments-picker-item-meta",title:"".concat(e.size?"".concat(Math.round(e.size/1024)," KB"):"Size unknown").concat(e.contentType?" Â· ".concat(e.contentType):"")},e.size?"".concat(Math.round(e.size/1024)," KB"):"Size unknown",e.contentType?" Â· ".concat(e.contentType):"")))}))):null}function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}var be=function(){return be=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},be.apply(this,arguments)},ye=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function we(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile;return String((null==n?void 0:n.emailAddress)||"").toLowerCase().trim()||"default"}catch(e){return"default"}}function Se(){return"sc_case_intake_last_case:".concat(we())}function ke(){return"sc_case_intake_attached_cache:".concat(we())}function xe(){return"sc_ever_filed_v1:".concat(we())}function Ie(e){if(e){var t=function(){try{var e=localStorage.getItem(xe()),t=e?JSON.parse(e):{};return t&&"object"===he(t)?t:{}}catch(e){return{}}}();t[e]=Date.now(),function(e){try{localStorage.setItem(xe(),JSON.stringify(e))}catch(e){}}(t)}}function Ne(){try{var e=localStorage.getItem(ke());return e?JSON.parse(e):{}}catch(e){return{}}}function Ce(e){try{localStorage.setItem(ke(),JSON.stringify(e))}catch(e){}}function Ee(e){return"sc_case_intake_discarded:".concat(we(),":").concat(String(e||"").trim())}function Be(e,t){try{if(!e)return;localStorage.setItem(Ee(e),t?"true":"false")}catch(e){}}var Oe=n(11584),Te=(0,i.n)({pill:{height:"24px",borderRadius:"999px",padding:"0 10px",display:"inline-flex",alignItems:"center",gap:"8px",fontSize:"12px",fontWeight:700,border:"1px solid rgba(0,0,0,0.10)",background:"rgba(255,255,255,0.6)",color:"rgba(17,24,39,0.9)",userSelect:"none",whiteSpace:"nowrap"},dot:{width:"8px",height:"8px",borderRadius:"999px",background:"rgba(0,0,0,0.35)",flex:"0 0 auto"},versionBadge:{marginLeft:"4px",height:"18px",borderRadius:"999px",padding:"0 8px",display:"inline-flex",alignItems:"center",fontSize:"11px",fontWeight:800,border:"1px solid rgba(0,0,0,0.10)",background:"rgba(255,255,255,0.55)",opacity:.9},success:{border:"1px solid rgba(16,185,129,0.28)",background:"rgba(16,185,129,0.10)",color:"rgb(6,95,70)"},successDot:{background:"rgb(16,185,129)"},info:{border:"1px solid rgba(37,99,235,0.25)",background:"rgba(37,99,235,0.08)",color:"rgba(29,78,216,0.95)"},infoDot:{background:"rgba(37,99,235,0.95)"}});function Ae(e){var t=e.label,n=e.tone,o=void 0===n?"neutral":n,a=e.title,i=e.version,c=Te(),s="success"===o?c.success:"info"===o?c.info:void 0,l="success"===o?c.successDot:"info"===o?c.infoDot:c.dot,u="number"==typeof i&&i>=2;return r.createElement("span",{className:[c.pill,s].filter(Boolean).join(" "),title:a},r.createElement("span",{className:l}),r.createElement("span",null,t),u?r.createElement("span",{className:c.versionBadge},"v".concat(i)):null)}var je=n(64583).Promise;function _e(e){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_e(e)}var ze=function(){return ze=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ze.apply(this,arguments)},De=function(e,t,n,r){return new(n||(n=je))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},Fe=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function Re(e){return"".concat("sc:sent:").concat(e)}function Pe(e){if(!e||"object"!==_e(e))return null;var t=e,n="string"==typeof t.filedBy?t.filedBy:void 0,r=Boolean(t.sent),o="string"==typeof t.atIso?t.atIso:void 0,a="string"==typeof t.caseId?t.caseId:void 0,i="string"==typeof t.singlecaseRecordId?t.singlecaseRecordId:void 0,c="string"==typeof t.documentId?t.documentId:"number"==typeof t.documentId?String(t.documentId):void 0,s="number"==typeof t.revisionNumber?t.revisionNumber:"string"==typeof t.revisionNumber?Number(t.revisionNumber):void 0,l=Number.isFinite(s)?s:void 0;return ze(ze(ze(ze(ze(ze({sent:r},o?{atIso:o}:{}),a?{caseId:a}:{}),i?{singlecaseRecordId:i}:{}),c?{documentId:c}:{}),void 0!==l?{revisionNumber:l}:{}),n?{filedBy:n}:{})}function Le(e){return De(this,void 0,void 0,function(){var t;return Fe(this,function(n){switch(n.label){case 0:return e?[4,(0,l.wv)(Re(e))]:[2,null];case 1:if(!(t=n.sent())||""===t.trim())return[2,null];try{return[2,Pe(JSON.parse(t))]}catch(e){return[2,null]}}})})}function Me(e,t){return De(this,void 0,void 0,function(){var n,r;return Fe(this,function(o){switch(o.label){case 0:return e?(n=null!==(r=Pe(t))&&void 0!==r?r:{sent:Boolean(t.sent)},[4,(0,l.Kg)(Re(e),JSON.stringify(n))]):[2];case 1:return o.sent(),[2]}})})}var He=n(64583).Promise,qe=function(e,t,n,r){return new(n||(n=He))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},We=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function Ue(e){return"sc:uploadedLinks:".concat(e)}function Ke(e){return qe(this,void 0,void 0,function(){var t,n;return We(this,function(r){switch(r.label){case 0:return e?[4,(0,l.wv)(Ue(e))]:[2,[]];case 1:if(!(t=r.sent()))return[2,[]];try{return n=JSON.parse(t),Array.isArray(n)?[2,n.filter(function(e){return e&&"string"==typeof e.id&&"string"==typeof e.url}).map(function(e){return{id:String(e.id),name:"string"==typeof e.name?e.name:"",url:String(e.url),kind:"attachment"===e.kind?"attachment":"email",atIso:"string"==typeof e.atIso?e.atIso:""}})]:[2,[]]}catch(e){return[2,[]]}}})})}function $e(e,t){return qe(this,void 0,void 0,function(){return We(this,function(n){switch(n.label){case 0:return e?[4,(0,l.Kg)(Ue(e),JSON.stringify(t||[]))]:[2];case 1:return n.sent(),[2]}})})}var Ge=n(64583).Promise,Ve=function(){return Ve=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ve.apply(this,arguments)},Je=function(e,t,n,r){return new(n||(n=Ge))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},Xe=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Ze=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function Ye(e){return e?e.document?e.document:e.data?e.data:e.result?e.result:e:null}function Qe(e){return Je(this,void 0,void 0,function(){var t,n,r,o,a,i;return Xe(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),t=null===(a=null===(o=null===Office||void 0===Office?void 0:Office.context)||void 0===o?void 0:o.mailbox)||void 0===a?void 0:a.item,(null===(i=null==t?void 0:t.body)||void 0===i?void 0:i.getAsync)?[4,new Ge(function(e){t.body.getAsync(Office.CoercionType.Text,function(t){(null==t?void 0:t.status)===Office.AsyncResultStatus.Succeeded?e(String(t.value||"")):e("")})})]:[2,""];case 1:return n=c.sent(),(r=n.trim())?[2,r.length>e?r.slice(0,e):r]:[2,""];case 2:return c.sent(),[2,""];case 3:return[2]}})})}function et(e,t){var n=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return n&&t?"https://".concat(n,"/?/documents/view/").concat(encodeURIComponent(t)):""}function tt(e){if(!e)return"";try{return new Date(e).toLocaleString("cs-CZ")}catch(e){return""}}function nt(e){var t,n,o,a,i,c,s=this,d=e.token,f=e.settings,m=e.onChangeSettings,v=N(),g=v.email,p=v.error,b=r.useState({}),y=b[0],w=b[1],S=r.useState([]),k=S[0],x=S[1],I=r.useState(!1),T=I[0],_=I[1],z=r.useState(""),D=z[0],F=z[1],R=r.useState(""),P=R[0],L=R[1],M=r.useState(""),H=M[0],q=M[1],W=r.useState([]),K=W[0],$=W[1],G=r.useState(new Set),V=G[0],J=G[1],X=r.useState(!1),Z=X[0],Q=X[1],ne=r.useState(""),re=ne[0],oe=ne[1],ae=r.useState([]),ie=ae[0],ce=ae[1],se=r.useState(null),ue=se[0],de=se[1],fe=r.useState(!1),me=fe[0],ve=fe[1],he=r.useRef(null),be=r.useState(!1),we=be[0],ke=be[1],xe=r.useState(null),Te=xe[0],je=xe[1],_e=r.useState(null),ze=_e[0],De=_e[1],Fe=((null==g?void 0:g.itemId)||(null==g?void 0:g.id)||"").toString(),Re=((null==g?void 0:g.subject)||"").toString(),Pe=((null==g?void 0:g.fromName)||(null===(t=null==g?void 0:g.from)||void 0===t?void 0:t.name)||(null===(n=null==g?void 0:g.from)||void 0===n?void 0:n.displayName)||"").toString(),He=((null==g?void 0:g.fromEmail)||(null===(o=null==g?void 0:g.from)||void 0===o?void 0:o.email)||(null===(a=null==g?void 0:g.from)||void 0===a?void 0:a.emailAddress)||(null===(i=null==g?void 0:g.from)||void 0===i?void 0:i.address)||"").toString(),qe=r.useMemo(function(){return"all"===f.caseListScope?k:k.filter(function(e){return!((t=((null==e?void 0:e.status)||"").toLowerCase())&&(t.includes("closed")||t.includes("uzav")||t.includes("archiv")||t.includes("done")));var t})},[k,f.caseListScope]),We=r.useMemo(function(){return D?function(e,t,n){var r,o,a=e.find(function(e){return String(e.id)===String(n)}),i=((null==a?void 0:a.number)&&(null==a?void 0:a.name)?"".concat(a.number," Â· ").concat(a.name):"")||((null==a?void 0:a.caseNumber)&&(null==a?void 0:a.title)?"".concat(a.caseNumber," Â· ").concat(a.title):"")||((null==a?void 0:a.label)?String(a.label):"")||((null==a?void 0:a.title)?String(a.title):"")||n,c=(null==a?void 0:a.clientName)||(null==a?void 0:a.client_name)||(null==a?void 0:a.clientTitle)||(null===(r=null==a?void 0:a.client)||void 0===r?void 0:r.name)||(null==a?void 0:a.client_label)||(null==a?void 0:a.clientDisplay)||"",s=(null==a?void 0:a.clientId)||(null==a?void 0:a.client_id)||(null===(o=null==a?void 0:a.client)||void 0===o?void 0:o.id);return{caseLabel:i,clientLabel:(c?String(c):"")||s&&t[String(s)]||"Client"}}(qe,y,D):null},[qe,y,D]),Ue=r.useMemo(function(){var e,t=(null==ue?void 0:ue.documentId)?String(ue.documentId):"";if(t)return t;var n=(null===(e=ie.find(function(e){return"email"===e.kind}))||void 0===e?void 0:e.id)||"";return n?String(n):""},[ue,ie]),nt=r.useMemo(function(){return f.includeAttachments&&K.filter(function(e){return!e.isInline}).length>0},[f.includeAttachments,K]),rt=r.useCallback(function(e){F(e),L("suggested")},[]),ot=U({enabled:f.autoSuggestCase,emailItemId:Fe,conversationKey:(null==g?void 0:g.conversationKey)||"",subject:Re,bodySnippet:re,fromEmail:He,attachments:K,cases:qe,selectedCaseId:D,selectedSource:P,onAutoSelectCaseId:rt,topK:3}).suggestions;r.useEffect(function(){var e=!1;return Je(s,void 0,void 0,function(){var t,n;return Xe(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,l.wv)(u.d.workspaceHost)];case 1:return t=r.sent()||"",n=t.replace(/^https?:\/\//i,"").split("/")[0].trim(),e||q(n),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})}),function(){e=!0}},[]),r.useEffect(function(){var e=!0;return Je(s,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l;return Xe(this,function(u){switch(u.label){case 0:_(!0),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,Ge.all([Y(d,f.caseListScope),ee(d)])];case 2:if(t=u.sent(),n=t[0],r=t[1],!e)return[2];for(x(n),o={},a=0,i=r;a<i.length;a++)c=i[a],o[c.id]=c.name;return w(o),[3,5];case 3:return s=u.sent(),e?(l=s instanceof Error?s.message:"string"==typeof s?s:JSON.stringify(s),De("Cases load error: ".concat(l)),[3,5]):[2];case 4:return e&&_(!1),[7];case 5:return[2]}})}),function(){e=!1}},[d,f.caseListScope]),r.useEffect(function(){var e=!0;return Je(s,void 0,void 0,function(){var t;return Xe(this,function(n){switch(n.label){case 0:return Fe?[4,Qe(600)]:(e&&oe(""),[2]);case 1:return t=n.sent(),e&&oe(t||""),[2]}})}),function(){e=!1}},[Fe]),r.useEffect(function(){f.rememberLastCase&&D&&function(e){try{localStorage.setItem(Se(),e)}catch(e){}}(D)},[D,f.rememberLastCase]);var at=function(e){J(function(t){var n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},it=function(){return J(new Set(K.map(function(e){return e.id})))},ct=function(){return J(new Set)},st=function(e){return Je(s,void 0,void 0,function(){var t,n;return Xe(this,function(r){switch(r.label){case 0:return[4,Ke(Fe)];case 1:return t=r.sent(),n=Ze([e],t.filter(function(t){return t.id!==e.id}),!0).slice(0,5),ce(n),[4,$e(Fe,n)];case 2:return r.sent(),[2]}})})},lt=r.useState("idle"),ut=(lt[0],lt[1]),dt=r.useState([]),ft=dt[0],mt=dt[1],vt=r.useRef([]),gt=function(){vt.current.forEach(function(e){return window.clearTimeout(e)}),vt.current=[]},pt=function(e){return mt(function(t){return Ze(Ze([],t,!0),[e],!1)})},ht=function(e,t){var n=window.setTimeout(t,e);vt.current.push(n)};function bt(e,t){var n=[];(null==e?void 0:e.sent)&&(n.push({label:"ZaÅ™azeno do SingleCase",meta:tt(e.atIso)}),e.caseId&&n.push({label:"PÅ™Ã­pad: ".concat(e.caseId)}),e.documentId&&n.push({label:"Dokument uloÅ¾en",meta:"ID ".concat(e.documentId)}),"number"==typeof e.revisionNumber&&n.push({label:"Verze dokumentu",meta:"v".concat(e.revisionNumber)}),e.singlecaseRecordId&&n.push({label:"SingleCase zÃ¡znam",meta:"".concat(e.singlecaseRecordId)}));var r=t.find(function(e){return"email"===e.kind});r&&n.push({label:"Odkaz na email v SingleCase",meta:r.name});var o=t.filter(function(e){return"attachment"===e.kind});return o.length&&n.push({label:"NahranÃ© pÅ™Ã­lohy",meta:"".concat(o.length)}),n}r.useEffect(function(){var e=!1;return Je(s,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l,u,d,m,v,g,p=this;return Xe(this,function(h){switch(h.label){case 0:return h.trys.push([0,5,,6]),De(null),je(null),ve(!1),he.current=null,Fe?(t=function(e){try{return!!e&&"true"===localStorage.getItem(Ee(e))}catch(e){return!1}}(Fe),[4,Ke(Fe)]):(e||(ce([]),$([]),J(new Set),F(""),L(""),de(null),ut("idle"),gt(),mt([{id:"idle0",kind:"system",text:"OtevÅ™i nejdÅ™Ã­v email."}])),[2]);case 1:return[4,(b=h.sent().slice(0,10).map(function(e){return Je(p,void 0,void 0,function(){var t,n,r;return Xe(this,function(o){switch(o.label){case 0:return(null==e?void 0:e.id)?[4,(0,Oe.getDocumentMeta)(e.id)]:[2,null];case 1:return t=o.sent(),(n=Ye(t))?(r=(e.name||n.name||"").trim(),[2,Ve(Ve({},e),{name:r})]):[2,null]}})})}),Ge.all(b.map(function(e){return e.then(function(e){return{status:"fulfilled",value:e}},function(e){return{status:"rejected",reason:e}})})))];case 2:for(n=h.sent(),r=n.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}).filter(Boolean),o=new Set,a=[],i=0,c=r;i<c.length;i++)(s=c[i]).id&&(o.has(s.id)||(o.add(s.id),a.push(s)));return e?[2]:[4,$e(Fe,a)];case 3:return h.sent(),e?[2]:(ce(a),[4,Le(Fe)]);case 4:if(l=h.sent(),e)return[2];if(de(l),f.rememberLastCase?(u=function(){try{return localStorage.getItem(Se())||""}catch(e){return""}}(),F(u||""),L(u?"remembered":"")):(F(""),L("")),J(new Set),f.includeAttachments){Q(!0);try{d=function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return((null==n?void 0:n.attachments)||[]).map(function(e){return{id:String(e.id),name:String(e.name||""),size:Number(e.size||0),isInline:Boolean(e.isInline),contentType:e.contentType?String(e.contentType):void 0}})}catch(e){return[]}}().filter(function(e){return!e.isInline}).sort(function(e,t){return e.name.localeCompare(t.name)}),e||$(d)}finally{e||Q(!1)}}else $([]);return e?[2]:(gt(),mt([]),ut("idle"),pt({id:"e0",kind:"embed",node:"email"}),t?(ut("discarded"),ht(120,function(){pt({id:"d1",kind:"system",title:"Tento email se nebude uklÃ¡dat",text:"OznaÄil jsi ho jako Nechci uklÃ¡dat. Nebudeme ho znovu nabÃ­zet."}),pt({id:"d2",kind:"actions",row:"discardedUndo"})}),[2]):(null==l?void 0:l.sent)?(ut("sent"),m=bt(l,a),ht(120,function(){pt({id:"s1",kind:"system",title:"ZaÅ™azeno",text:"PÅ™ehled akcÃ­:"}),pt({id:"s2",kind:"timeline",items:m}),pt({id:"s3",kind:"actions",row:"sent"})}),[2]):(ut("new"),ht(140,function(){pt({id:"n1",kind:"system",title:"NavrÅ¾enÃ½ pÅ™Ã­pad",text:"Vyber pÅ™Ã­pad. Pak potvrÄ zaÅ™azenÃ­ nebo zvol Nechci uklÃ¡dat."})}),ht(260,function(){return pt({id:"n2",kind:"embed",node:"caseSelector"})}),ht(380,function(){return pt({id:"n3",kind:"actions",row:"choose"})}),[3,6]));case 5:return v=h.sent(),e?[2]:(g=v instanceof Error?v.message:String(v),De("Email switch failed: ".concat(g)),gt(),ut("idle"),mt([{id:"err0",kind:"system",title:"Chyba",text:g}]),[3,6]);case 6:return[2]}var b})}),function(){e=!0,gt()}},[Fe,d,f.includeAttachments,f.rememberLastCase,f.caseListScope]);var yt=function(){return Je(s,void 0,void 0,function(){var e,t,n,r,o,a,i,c,l,u,d,m,v,p,h,b,y,w,S,k,x,I,N,T,_,z,F,R,P,L,M,q,W,U,$,G,J,X,Z,Y,Q,ee,ne,oe,ae,se;return Xe(this,function(le){switch(le.label){case 0:if(we)return[2];if(De(null),je(null),(e="confirm"===he.current)&&(he.current=null,ve(!1)),!Fe)return De("Open an email first."),[2];if(!D)return De("Select a case."),[2];if(!f.preventDuplicates||e)return[3,9];le.label=1;case 1:return le.trys.push([1,8,,9]),X=Ne(),t=function(e,t,n){return(e[t]||[]).includes(n)}(X,D,Fe),n=Boolean(Ue),t||n?Ue?(o=Boolean,[4,(0,Oe.getDocumentMeta)(Ue)]):[3,3]:[3,7];case 2:return r=o.apply(void 0,[le.sent()]),[3,4];case 3:r=!1,le.label=4;case 4:return r?[3,6]:[4,Je(s,void 0,void 0,function(){return Xe(this,function(e){switch(e.label){case 0:return[4,$e(Fe,[])];case 1:return e.sent(),ce([]),de(null),je(null),Ce({}),[2]}})})];case 5:return le.sent(),[3,7];case 6:return ve(!0),[2];case 7:return[3,9];case 8:return le.sent(),[3,9];case 9:ke(!0),le.label=10;case 10:return le.trys.push([10,38,39,40]),[4,Qe(8e3)];case 11:if(a=le.sent(),i=(a||re||"").trim()||"[No body content available from Outlook]",c=[],!(f.includeAttachments&&V.size>0))return[3,15];if(l=K.filter(function(e){return V.has(e.id)}),l.reduce(function(e,t){return e+(t.size||0)},0)>12582912)return De("Selected attachments are too large. Please select fewer or smaller files."),[2];u=0,d=l,le.label=12;case 12:return u<d.length?(q=d[u],[4,(fe=q.id,new Ge(function(e){var t,n,r=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item;(null==r?void 0:r.getAttachmentContentAsync)?r.getAttachmentContentAsync(fe,function(t){if(t&&t.status===Office.AsyncResultStatus.Succeeded){var n=t.value||{},r=n.content,o=String(n.format||"").toLowerCase();e(r&&o?"base64"!==o?null:String(r):null)}else e(null)}):e(null)}))]):[3,15];case 13:if(!(m=le.sent()))return De('Cannot read attachment "'.concat(q.name,'". Unselect it and try again.')),[2];c.push({id:q.id,name:q.name,contentType:q.contentType,size:q.size,contentBase64:m}),le.label=14;case 14:return u++,[3,12];case 15:return v={caseId:D,outlookItemId:Fe,subject:Re,fromEmail:He,fromName:Pe},f.includeBodySnippet&&a&&(v.bodySnippet=a),f.includeAttachments&&c.length&&(v.attachments=c),[4,te(0,v)];case 16:if(p=le.sent(),h="From: ".concat(Pe," <").concat(He,">\r\n")+"To: SingleCase <noreply@singlecase>\r\n"+"Subject: ".concat(Re,"\r\n")+"Date: ".concat((new Date).toUTCString(),"\r\n")+"Message-ID: <".concat(Fe,"@outlook>\r\n")+"MIME-Version: 1.0\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: 8bit\r\n\r\n"+"".concat(i,"\r\n"),b=function(e){for(var t=(new TextEncoder).encode(e),n="",r=0;r<t.length;r+=1)n+=String.fromCharCode(t[r]);return btoa(n)}(h),y=Ue,e&&!y)throw new Error("Cannot upload a new version because no existing document was found.");return w=null!==(ee=null==ue?void 0:ue.revisionNumber)&&void 0!==ee?ee:1,S="",k=(Re||"").trim().replace(/[<>:"/\\|?*\x00-\x1F]/g," ").replace(/\s+/g," ").trim().slice(0,80)||"email",e&&y?[4,(0,Oe.uploadDocumentVersion)({documentId:y,fileName:"".concat(k,".eml"),mimeType:"text/plain",dataBase64:b})]:[3,25];case 17:if(x=le.sent(),I=function(e){var t,n,r,o,a,i,c,s;if(!e)return null;var l=e.data||e.result||e.document||e.version||e,u=null!==(s=null!==(c=null!==(i=null!==(o=null!==(n=null===(t=null==l?void 0:l.latest_version)||void 0===t?void 0:t.revision_number)&&void 0!==n?n:null===(r=null==l?void 0:l.latestVersion)||void 0===r?void 0:r.revisionNumber)&&void 0!==o?o:null===(a=null==l?void 0:l.latestVersion)||void 0===a?void 0:a.revision_number)&&void 0!==i?i:null==l?void 0:l.revision_number)&&void 0!==c?c:null==l?void 0:l.revisionNumber)&&void 0!==s?s:null==l?void 0:l.revision,d=Number(u);return Number.isFinite(d)&&d>0?d:null}(x),I)return[3,22];N=0,le.label=18;case 18:return N<3?[4,(0,Oe.getDocumentMeta)(y)]:[3,22];case 19:return T=le.sent(),_=Ye(T),I=function(e){var t,n=null===(t=null==e?void 0:e.latest_version)||void 0===t?void 0:t.revision_number,r=Number(n);return Number.isFinite(r)&&r>0?r:null}(_),I?[3,22]:[4,new Ge(function(e){return setTimeout(e,300)})];case 20:le.sent(),le.label=21;case 21:return N+=1,[3,18];case 22:if(!I)throw new Error("Version upload succeeded but revision could not be determined. docId=".concat(y));return w=I,S=y,(F=et(H,y))?[4,st({id:y,name:"".concat(k,"-v").concat(w,".eml"),url:F,kind:"email",atIso:(new Date).toISOString()})]:[3,24];case 23:le.sent(),le.label=24;case 24:return[3,28];case 25:return[4,(0,Oe.uploadDocumentToCase)({caseId:D,fileName:"".concat(k,".eml"),mimeType:"text/plain",dataBase64:b})];case 26:return z=le.sent(),U=null===(ne=z.documents)||void 0===ne?void 0:ne[0],y=(null==U?void 0:U.id)?String(U.id):y,w=null!==(ae=null===(oe=null==U?void 0:U.latest_version)||void 0===oe?void 0:oe.revision_number)&&void 0!==ae?ae:1,S=(null==U?void 0:U.id)?String(U.id):"",F=et(H,y),y&&F?[4,st({id:y,name:w>1?"".concat(k,"-v").concat(w,".eml"):"".concat(k,".eml"),url:F,kind:"email",atIso:(new Date).toISOString()})]:[3,28];case 27:le.sent(),le.label=28;case 28:if(R=[],P=0,!(f.includeAttachments&&c.length>0))return[3,36];L=0,M=c,le.label=29;case 29:if(!(L<M.length))return[3,36];q=M[L],le.label=30;case 30:return le.trys.push([30,34,,35]),[4,(0,Oe.uploadDocumentToCase)({caseId:D,fileName:q.name,mimeType:q.contentType||"application/octet-stream",dataBase64:q.contentBase64})];case 31:if(W=le.sent(),U=null===(se=W.documents)||void 0===se?void 0:se[0],!($=(null==U?void 0:U.id)?String(U.id):""))throw new Error("No document id returned");return(G=et(H,$))?[4,st({id:$,name:q.name,url:G,kind:"attachment",atIso:(new Date).toISOString()})]:[3,33];case 32:le.sent(),le.label=33;case 33:return P+=1,[3,35];case 34:return J=le.sent(),R.push({name:q.name,error:J instanceof Error?J.message:String(J)}),[3,35];case 35:return L++,[3,29];case 36:return f.preventDuplicates&&(function(e,t,n){var r=e[t]||[];r.includes(n)||(e[t]=ye(ye([],r,!0),[n],!1).slice(-200))}(X=Ne(),D,Fe),Ce(X)),function(e){var t=String(e.caseId||"").trim();if(t){var n=Date.now(),r=A(),o=B(e.conversationKey||"");o&&(r.threadToCase[o]={caseId:t,lastSeenAt:n});var a,i,c=B(e.senderEmail||"");if(c){r.senderToCase[c]||(r.senderToCase[c]={});var s=r.senderToCase[c][t]||{count:0,lastSeenAt:0};s.count+=1,s.lastSeenAt=n,r.senderToCase[c][t]=s;var l=(i=(a=B(c)).lastIndexOf("@"))<0?"":a.slice(i+1).trim();if(l){r.domainToCase[l]||(r.domainToCase[l]={});var u=r.domainToCase[l][t]||{count:0,lastSeenAt:0};u.count+=1,u.lastSeenAt=n,r.domainToCase[l][t]=u}}var d,f,m,v=r.recentCases.find(function(e){return e.caseId===t});v?(v.useCount+=1,v.lastUsedAt=n):r.recentCases.push({caseId:t,useCount:1,lastUsedAt:n}),r.threadToCase=(d=r.threadToCase,(f=Object.entries(d)).length<=400?d:(f.sort(function(e,t){return(t[1].lastSeenAt||0)-(e[1].lastSeenAt||0)}),Object.fromEntries(f.slice(0,400)))),j(r.senderToCase,300,30),j(r.domainToCase,200,30),r.recentCases=(m=r.recentCases,E([],m,!0).sort(function(e,t){return(t.lastUsedAt||0)-(e.lastUsedAt||0)}).slice(0,30)),function(e){try{localStorage.setItem(O(),JSON.stringify(e))}catch(e){}}(C(C({},r),{version:1}))}}({caseId:D,conversationKey:(null==g?void 0:g.conversationKey)||"",senderEmail:He||""}),je({ok:!0,id:p.singlecaseRecordId,emailDocumentId:S,uploadedCount:P,failedUploads:R}),Z={sent:!0,atIso:(new Date).toISOString(),caseId:D,singlecaseRecordId:p.singlecaseRecordId,documentId:y||void 0,revisionNumber:w},[4,Me(Fe,Z)];case 37:return le.sent(),de(Z),Ie(Fe),Y=bt(Z,Ze([],ie,!0)),gt(),mt(function(e){return e.filter(function(e){return"actions"!==e.kind})}),ut("sent"),pt({id:"done_".concat(Date.now()),kind:"system",title:"ZaÅ™azeno",text:"PÅ™ehled akcÃ­:"}),pt({id:"tl_".concat(Date.now()),kind:"timeline",items:Y}),pt({id:"sentAct_".concat(Date.now()),kind:"actions",row:"sent"}),[3,40];case 38:return Q=le.sent(),De(Q instanceof Error?Q.message:String(Q)),[3,40];case 39:return ke(!1),[7];case 40:return[2]}var fe})})},wt=function(){if(mt(function(e){return e.filter(function(e){return"actions"!==e.kind})}),nt)return ut("attachments"),pt({id:"a1_".concat(Date.now()),kind:"system",title:"PÅ™Ã­lohy",text:"Vyber pÅ™Ã­lohy nebo pÅ™eskoÄ."}),pt({id:"a2_".concat(Date.now()),kind:"embed",node:"attachments"}),void pt({id:"a3_".concat(Date.now()),kind:"actions",row:"attachments"});ut("ready"),pt({id:"r1_".concat(Date.now()),kind:"system",title:"PÅ™ipraveno",text:"OdeÅ¡lu email do SingleCase."}),pt({id:"r2_".concat(Date.now()),kind:"actions",row:"ready"})},St=function(){Fe&&(Be(Fe,!0),gt(),mt([{id:"e0",kind:"embed",node:"email"}]),ut("discarded"),ht(120,function(){pt({id:"d_".concat(Date.now()),kind:"system",title:"Tento email se nebude uklÃ¡dat",text:"OznaÄeno jako Nechci uklÃ¡dat. MÅ¯Å¾eÅ¡ to vrÃ¡tit zpÄ›t."}),pt({id:"du_".concat(Date.now()),kind:"actions",row:"discardedUndo"})}))},kt=function(){Fe&&(Be(Fe,!1),gt(),mt([{id:"e0",kind:"embed",node:"email"}]),ut("new"),ht(140,function(){return pt({id:"n1",kind:"system",title:"NavrÅ¾enÃ½ pÅ™Ã­pad",text:"Vyber pÅ™Ã­pad a potvrÄ."})}),ht(260,function(){return pt({id:"n2",kind:"embed",node:"caseSelector"})}),ht(380,function(){return pt({id:"n3",kind:"actions",row:"choose"})}))};return r.createElement(h,null,r.createElement("div",{className:"case-intake-panel-root"},r.createElement("div",{className:"case-intake-panel-body"},r.createElement("div",{className:"chat"},r.createElement("div",{className:"chat-header"},r.createElement("div",{className:"chat-header-title"},"ZaÅ™azenÃ­ emailu"),(null==ue?void 0:ue.sent)?r.createElement(Ae,{label:"ZaÅ™azeno",tone:"success",version:ue.revisionNumber,title:ue.caseId?"ZaÅ™azeno do pÅ™Ã­padu ".concat(ue.caseId):"Email byl zaÅ™azen do SingleCase"}):null),ft.map(function(e){if("system"===e.kind)return r.createElement("div",{key:e.id,className:"chat-bubble chat-in"},e.title?r.createElement("div",{className:"chat-title"},e.title):null,e.text?r.createElement("div",{className:"chat-text"},e.text):null);if("embed"===e.kind&&"email"===e.node)return r.createElement("div",{key:e.id,className:"chat-bubble chat-bubble-embed chat-in"},r.createElement(le,{emailError:p,emailItemId:Fe,fromName:Pe,fromEmail:He,subject:Re,isSwitchingEmail:!1}));if("embed"===e.kind&&"caseSelector"===e.node)return r.createElement("div",{key:e.id,className:"chat-bubble chat-bubble-embed chat-in"},r.createElement(ge,{title:"Case",scope:f.caseListScope,onScopeChange:function(e){m(function(t){return t.caseListScope===e?t:Ve(Ve({},t),{caseListScope:e})})},selectedCaseId:D,onSelectCaseId:function(e){F(e),L("manual")},suggestions:ot,cases:qe,isLoadingCases:T,clientNamesById:y}));if("embed"===e.kind&&"attachments"===e.node)return r.createElement("div",{key:e.id,className:"chat-bubble chat-bubble-embed chat-in"},r.createElement(pe,{enabled:f.includeAttachments,attachments:K,selectedAttachmentIds:V,isLoadingAttachments:Z,onToggleAttachment:at,onSelectAll:it,onClearAll:ct}));if("timeline"===e.kind)return r.createElement("div",{key:e.id,className:"chat-bubble chat-in"},r.createElement("div",{className:"timeline"},e.items.map(function(t,n){return r.createElement("div",{key:"".concat(e.id,"_").concat(n),className:"timeline-row"},r.createElement("div",{className:"timeline-dot"}),r.createElement("div",{className:"timeline-body"},r.createElement("div",{className:"timeline-label"},t.label),t.meta?r.createElement("div",{className:"timeline-meta"},t.meta):null))})));if("actions"===e.kind&&"choose"===e.row)return r.createElement("div",{key:e.id,className:"chat-actions chat-in"},r.createElement("button",{type:"button",className:"chat-btn chat-btn-primary",disabled:!D,onClick:wt},"Ano, zatÅ™Ã­dit"),r.createElement("button",{type:"button",className:"chat-btn chat-btn-danger",onClick:St},"Nechci uklÃ¡dat"));if("actions"===e.kind&&"attachments"===e.row)return r.createElement("div",{key:e.id,className:"chat-actions chat-actions-right chat-in"},r.createElement("button",{type:"button",className:"chat-btn",onClick:function(){J(new Set),mt(function(e){return e.filter(function(e){return"actions"!==e.kind})}),ut("ready"),pt({id:"r1_".concat(Date.now()),kind:"system",title:"PÅ™ipraveno",text:"OdeÅ¡lu email do SingleCase."}),pt({id:"r2_".concat(Date.now()),kind:"actions",row:"ready"})}},"PÅ™eskoÄit"),r.createElement("button",{type:"button",className:"chat-btn chat-btn-primary",onClick:function(){mt(function(e){return e.filter(function(e){return"actions"!==e.kind})}),ut("ready"),pt({id:"r1_".concat(Date.now()),kind:"system",title:"PÅ™ipraveno",text:"OdeÅ¡lu email a vybranÃ© pÅ™Ã­lohy do SingleCase."}),pt({id:"r2_".concat(Date.now()),kind:"actions",row:"ready"})}},"Continue"));if("actions"===e.kind&&"ready"===e.row)return r.createElement("div",{key:e.id,className:"chat-actions chat-actions-right chat-in"},r.createElement("button",{type:"button",className:"chat-btn chat-btn-primary",disabled:we||!Fe||!D,onClick:yt},we?"Sending...":"Send to SingleCase"));if("actions"===e.kind&&"discardedUndo"===e.row)return r.createElement("div",{key:e.id,className:"chat-actions chat-in"},r.createElement("button",{type:"button",className:"chat-btn",onClick:kt},"VrÃ¡tit zpÄ›t"));if("actions"===e.kind&&"sent"===e.row){var t=We?"".concat(We.caseLabel," (").concat(We.clientLabel,")"):(null==ue?void 0:ue.caseId)||"";return r.createElement("div",{key:e.id,className:"chat-actions chat-in"},t?r.createElement("div",{className:"chat-sent-note"},"ZaÅ™azeno do: ",t):null)}return null}),ze?r.createElement("div",{className:"chat-error chat-in"},ze):null,me?r.createElement("div",{className:"chat-bubble chat-in"},r.createElement("div",{className:"dup-prompt"},r.createElement("div",{className:"dup-text"},"Tento email uÅ¾ v pÅ™Ã­padu existuje. ChceÅ¡ ho nahrÃ¡t znovu jako novou verzi?"),r.createElement("div",{className:"dup-actions"},r.createElement("button",{type:"button",className:"dup-cancel",onClick:function(){return ve(!1)},disabled:we},"ZruÅ¡it"),r.createElement("button",{type:"button",className:"dup-confirm",disabled:we,onClick:function(){return Je(s,void 0,void 0,function(){return Xe(this,function(e){switch(e.label){case 0:return he.current="confirm",[4,yt()];case 1:return e.sent(),[2]}})})}},"NahrÃ¡t novou verzi")))):null,(null==Te?void 0:Te.ok)?r.createElement("div",{className:"chat-bubble chat-in"},r.createElement("div",{className:"chat-title"},"Hotovo"),r.createElement("div",{className:"chat-text"},"ZaÅ™azeno. ",Te.uploadedCount?"PÅ™Ã­lohy nahrÃ¡ny: ".concat(Te.uploadedCount,"."):"",(null===(c=Te.failedUploads)||void 0===c?void 0:c.length)?" NÄ›kterÃ© pÅ™Ã­lohy selhaly: ".concat(Te.failedUploads.map(function(e){return e.name}).join(", "),"."):"")):null)),r.createElement("div",{className:"case-intake-panel-footer"},ie.length>0?r.createElement("div",{className:"case-intake-panel-uploaded"},r.createElement("div",{className:"case-intake-panel-uploaded-title"},"NahrÃ¡no"),r.createElement("div",{className:"case-intake-panel-uploaded-list"},ie.slice(0,2).map(function(e){return r.createElement("div",{key:e.id,className:"case-intake-panel-uploaded-item"},r.createElement("div",{className:"case-intake-panel-uploaded-row"},r.createElement("a",{className:"case-intake-panel-uploaded-link",href:e.url,target:"_blank",rel:"noreferrer",title:e.name},e.name),r.createElement("div",{className:"case-intake-panel-uploaded-actions"},r.createElement("a",{href:e.url,target:"_blank",rel:"noreferrer",title:"View"},"â¿"))),r.createElement("span",{className:"case-intake-panel-uploaded-timestamp"},e.atIso?new Date(e.atIso).toLocaleString("cs-CZ"):""))}))):null)))}function rt(e){var t=e.toLowerCase().trim();if(!t)return"";var n=t.split(".");return n.length<=1||2===n.length?t:n.slice(-2).join(".")}function ot(e){var t=e.trim();if(!t)return"";var n=t.match(/<([^>]+)>/),r=n?n[1]:t,o=r.lastIndexOf("@");return-1===o?"":r.slice(o+1).toLowerCase().trim()}var at=n(45614),it=n(29255),ct=n(87294);const st={};function lt(){let e=null,t="",n="";const r=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const o=arguments[e];if("string"==typeof o&&""!==o){const a=o.indexOf(at.fj);if(-1===a)t+=o+" ";else{const i=o.substr(a,at.wn);a>0&&(t+=o.slice(0,a)),n+=i,r[e]=i}}}if(""===n)return t.slice(0,-1);const o=st[n];if(void 0!==o)return t+o;const a=[];for(let t=0;t<arguments.length;t++){const n=r[t];if(n){const t=at.k1[n];t&&(a.push(t[at.FS]),e=t[at.AX])}}const i=Object.assign.apply(Object,[{}].concat(a)),[c,s]=(0,ct.z)(i,e),l=(0,it.G)(s,e,r),u=l+" "+c;return st[n]=u,at.k1[l]=[i,e],t+u}const ut=r.createContext(void 0),dt={},ft=ut.Provider;var mt=n(53864);function vt(e,t,n=mt.A){const r=n();let o=null,a=null;return function(n){const{dir:i,renderer:c}=n,s="ltr"===i;return s?null===o&&(o=(0,ct.N)(e,i)):null===a&&(a=(0,ct.N)(e,i)),r(c,t),s?o:a}}var gt=n(49264),pt=n(26312),ht=n(56004);function bt(e,t){const n=vt(e,t,gt.A);return function(){const e=(0,ht.m)(),t=(0,pt.J)();return n({dir:e,renderer:t})}}const yt=bt({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{transform:scaleX(-1);}"]}),wt=bt({root:{B8gzw0y:"f1dd5bof"}},{m:[["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}]]}),St=(e,t,n,o)=>{const a="1em"===t?"20":t,i=r.forwardRef((e,i)=>{const c=wt(),s=((e,t)=>{const{title:n,primaryFill:o="currentColor",...a}=e,i={...a,title:void 0,fill:o},c=yt(),s=(()=>{const e=r.useContext(ut);return null!=e?e:dt})();return i.className=lt(c.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&c.rtl,i.className),n&&(i["aria-label"]=n),i["aria-label"]||i["aria-labelledby"]?i.role="img":i["aria-hidden"]=!0,i})(e,{flipInRtl:null==o?void 0:o.flipInRtl}),l={...s,className:lt(s.className,c.root),ref:i,width:t,height:t,viewBox:`0 0 ${a} ${a}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?r.createElement("svg",{...l,dangerouslySetInnerHTML:{__html:n}}):r.createElement("svg",l,...n.map(e=>r.createElement("path",{d:e,fill:l.fill})))});return i.displayName=e,i},kt=St("Open24Regular","24",["M6.25 4.5c-.97 0-1.75.78-1.75 1.75v11.5c0 .97.78 1.75 1.75 1.75h11.5c.97 0 1.75-.78 1.75-1.75v-4a.75.75 0 0 1 1.5 0v4c0 1.8-1.46 3.25-3.25 3.25H6.25A3.25 3.25 0 0 1 3 17.75V6.25C3 4.45 4.46 3 6.25 3h4a.75.75 0 0 1 0 1.5h-4ZM13 3.75c0-.41.34-.75.75-.75h6.5c.41 0 .75.34.75.75v6.5a.75.75 0 0 1-1.5 0V5.56l-5.22 5.22a.75.75 0 0 1-1.06-1.06l5.22-5.22h-4.69a.75.75 0 0 1-.75-.75Z"]),xt=St("Edit24Regular","24",["M20.95 3.05a3.58 3.58 0 0 0-5.06 0L3.94 15c-.4.4-.7.92-.82 1.48l-1.1 4.6a.75.75 0 0 0 .9.9l4.6-1.1A3.1 3.1 0 0 0 9 20.07L20.95 8.11a3.58 3.58 0 0 0 0-5.06Zm-4 1.06a2.08 2.08 0 1 1 2.94 2.94l-.89.89L16.06 5l.9-.9ZM15 6.06 17.94 9l-10 10a1.6 1.6 0 0 1-.76.43l-3.42.8.82-3.4c.06-.3.21-.56.42-.77l10-10Z"]);function It(e){var t=e.doc,n=e.workspaceHost,o=e.onOpenUrl,a=e.buildLiveEditUrl;return r.createElement("div",{className:"mwFiledDocMiniRow"},r.createElement("div",{className:"mwFiledDocMiniText",title:t.name},r.createElement("span",{className:"mwFiledDocMiniName"},t.name),t.uploadedBy?r.createElement("span",{className:"mwFiledDocMiniMeta",title:t.uploadedBy},"NahrÃ¡l: ",t.uploadedBy):null),r.createElement("div",{className:"mwFiledDocMiniActions"},r.createElement("button",{type:"button",className:"mwMiniIconBtn",title:"OtevÅ™Ã­t",onClick:function(){return o(t.url)}},r.createElement(kt,{className:"mwIconSvg"})),n&&t.id?r.createElement("button",{type:"button",className:"mwMiniIconBtnPrimary",title:"Upravit",onClick:function(){return o(a(n,String(t.id)))}},r.createElement(xt,{className:"mwIconSvgPrimary"})):null))}function Nt(e){var t=e.caseUrl,n=e.filedCaseName,o=e.sentPill,a=e.documentsToShow,i=e.workspaceHost,c=e.onOpenUrl,s=e.buildLiveEditUrl,l=e.fmtCs;return r.createElement("div",{className:"mwFiledSummaryCard"},r.createElement("div",{className:"mwFiledSummaryHeader"},r.createElement("div",{className:"mwFiledSummaryHeaderLeft"},r.createElement("span",{className:"mwFiledSummaryLabel"},"Case:"),r.createElement("div",{className:"mwFiledSummaryTitleWrap"},t?r.createElement("button",{type:"button",className:"mwFiledCaseLink",onClick:function(){return c(t)},title:"Open case"},n):r.createElement("span",{className:"mwFiledCaseName"},n)))),r.createElement("div",{className:"mwFiledSummaryMeta"},(null==o?void 0:o.atIso)?r.createElement("span",{className:"mwFiledSummaryMetaItem"},"Filed: ".concat(l(o.atIso))):null,r.createElement("span",{className:"mwFiledSummaryMetaItem"},"Documents: ".concat(a.length))),a.length>0?r.createElement("div",{className:"mwFiledDocsMini"},a.map(function(e){return r.createElement(It,{key:e.id,doc:e,workspaceHost:i,onOpenUrl:c,buildLiveEditUrl:s})})):null)}var Ct=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function Et(e){var t=e.attachmentsLite,n=e.attachmentIds,o=e.selectedAttachments,a=e.onSelectionChange,i=e.filingMode,c=e.onFilingModeChange,s=e.containerRef;return r.createElement("div",{ref:s,className:"mwAttachmentsStep"},r.createElement("div",{className:"mwAttachmentsStepTitle"},"Co chcete uloÅ¾it?"),r.createElement("div",{className:"mwAttachmentsStepButtons"},r.createElement("button",{type:"button",className:"mwFilingBtn ".concat("attachments"===i?"mwFilingBtnActive":""),onClick:function(){c("attachments"),a(n)}},"Pouze pÅ™Ã­lohy"),r.createElement("button",{type:"button",className:"mwFilingBtn ".concat("both"===i?"mwFilingBtnActive":""),onClick:function(){c("both"),a(n)}},"Email i pÅ™Ã­lohy")),r.createElement("div",{className:"mwAttachmentsStepList"},t.map(function(e){var t=String(e.id);return r.createElement("label",{key:t,className:"mwAttachmentsStepLabel"},r.createElement("input",{type:"checkbox",checked:o.includes(t),onChange:function(e){a(e.target.checked?Ct(Ct([],o,!0),[t],!1):o.filter(function(e){return e!==t}))}}),e.name)})))}function Bt(e){var t=e.text,n=e.isUnfiled,o=e.actions,a=e.tone,i=n?"mwChatBubble":"mwChatMuted";return"success"===(void 0===a?"default":a)&&n&&(i="mwChatBubbleSuccess"),r.createElement("div",{className:i},r.createElement("div",null,t||"Select an email and Iâ€™ll show you relevant suggestions."),o&&o.length>0&&r.createElement("div",{className:"mwQuickReplies"},o.map(function(e){return r.createElement("button",{key:e.id,type:"button",className:"mwQuickReplyBtn",onClick:e.onClick},e.label)})))}var Ot=n(92245),Tt=n(41114),At=n(64583).Promise;function jt(){return e=this,t=void 0,r=function(){var e,t,n,r,o,a,i,c,s,d,f,m,v,g,p,h,b,y,w,S,k,x,I;return function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}(this,function(N){switch(N.label){case 0:e=[];try{(null==(m=(0,Tt.xI)())?void 0:m.token)?e.push({success:!0,step:"sessionStorage token",message:"âœ“ Token found in sessionStorage",details:{hasToken:!0,tokenPrefix:m.token.slice(0,10),email:m.email,issuedAt:new Date(m.issuedAt).toISOString()}}):e.push({success:!1,step:"sessionStorage token",message:"âœ— No token in sessionStorage",details:{hasToken:!1}})}catch(t){e.push({success:!1,step:"sessionStorage token",message:"âœ— Error reading sessionStorage: ".concat(t instanceof Error?t.message:String(t))})}N.label=1;case 1:return N.trys.push([1,3,,4]),[4,(0,Tt.Ly)()];case 2:return(null==(t=N.sent())?void 0:t.token)?e.push({success:!0,step:"OfficeRuntime.storage token",message:"âœ“ Token found in OfficeRuntime.storage",details:{hasToken:!0,tokenPrefix:t.token.slice(0,10),email:t.email,issuedAt:new Date(t.issuedAt).toISOString()}}):e.push({success:!1,step:"OfficeRuntime.storage token",message:"âœ— No token in OfficeRuntime.storage",details:{hasToken:!1}}),[3,4];case 3:return n=N.sent(),e.push({success:!1,step:"OfficeRuntime.storage token",message:"âœ— Error reading OfficeRuntime.storage: ".concat(n instanceof Error?n.message:String(n))}),[3,4];case 4:return N.trys.push([4,6,,7]),[4,(0,l.wv)(u.d.workspaceHost)];case 5:return(p=N.sent())?e.push({success:!0,step:"workspaceHost",message:"âœ“ Workspace host found",details:{host:p}}):e.push({success:!1,step:"workspaceHost",message:"âœ— No workspace host configured",details:{host:null}}),[3,7];case 6:return r=N.sent(),e.push({success:!1,step:"workspaceHost",message:"âœ— Error reading workspace host: ".concat(r instanceof Error?r.message:String(r))}),[3,7];case 7:return N.trys.push([7,18,,19]),m=(0,Tt.xI)(),(o=null==m?void 0:m.token)?[3,9]:[4,(0,Tt.Ly)()];case 8:o=N.sent().token,N.label=9;case 9:return v=o,[4,(0,l.wv)(u.d.workspaceHost)];case 10:return p=N.sent(),a=(p||"").trim().replace(/^https?:\/\//i,"").split("/")[0],v?[3,11]:(e.push({success:!1,step:"GET /cases",message:"âœ— Skipped: no auth token"}),[3,17]);case 11:return a?[3,12]:(e.push({success:!1,step:"GET /cases",message:"âœ— Skipped: no workspace host"}),[3,17]);case 12:return i="/singlecase/".concat(encodeURIComponent(a),"/publicapi/v1/cases"),[4,fetch(i,{method:"GET",headers:{Authentication:v,"Content-Type":"application/json"}})];case 13:return(c=N.sent()).ok?[4,c.json()]:[3,15];case 14:return s=N.sent(),e.push({success:!0,step:"GET /cases",message:"âœ“ Successfully fetched cases",details:{status:c.status,caseCount:Array.isArray(s)?s.length:"unknown"}}),[3,17];case 15:return[4,c.text().catch(function(){return""})];case 16:d=N.sent(),e.push({success:!1,step:"GET /cases",message:"âœ— Failed with status ".concat(c.status),details:{status:c.status,statusText:c.statusText,responseSnippet:d.slice(0,200)}}),N.label=17;case 17:return[3,19];case 18:return f=N.sent(),e.push({success:!1,step:"GET /cases",message:"âœ— Request failed: ".concat(f instanceof Error?f.message:String(f))}),[3,19];case 19:return N.trys.push([19,28,,29]),m=(0,Tt.xI)(),(g=null==m?void 0:m.token)?[3,21]:[4,(0,Tt.Ly)()];case 20:g=N.sent().token,N.label=21;case 21:return v=g,[4,(0,l.wv)(u.d.workspaceHost)];case 22:return p=N.sent(),v?[3,23]:(e.push({success:!1,step:"POST /documents test",message:"âœ— Skipped: no auth token"}),[3,27]);case 23:return p?[3,24]:(e.push({success:!1,step:"POST /documents test",message:"âœ— Skipped: no workspace host"}),[3,27]);case 24:return(h=prompt("Enter a test case ID for upload diagnostic (or cancel to skip):"))?[3,25]:(e.push({success:!1,step:"POST /documents test",message:"âœ— Skipped: no case ID provided"}),[3,27]);case 25:return b="From: Test <test@example.com>\r\nTo: SingleCase <noreply@singlecase>\r\nSubject: Diagnostic Test Email\r\nDate: "+(new Date).toUTCString()+"\r\nMIME-Version: 1.0\r\nContent-Type: text/plain; charset=UTF-8\r\n\r\nThis is a diagnostic test email from the SingleCase Outlook add-in.\r\n",y=function(e){for(var t=(new TextEncoder).encode(e),n="",r=0;r<t.length;r+=1)n+=String.fromCharCode(t[r]);return btoa(n)}(b),[4,(0,Oe.uploadDocumentToCase)({caseId:h,fileName:"diagnostic-test.eml",mimeType:"message/rfc822",dataBase64:y})];case 26:w=N.sent(),S=null===(I=null===(x=null==w?void 0:w.documents)||void 0===x?void 0:x[0])||void 0===I?void 0:I.id,e.push({success:!0,step:"POST /documents test",message:"âœ“ Successfully uploaded test document",details:{documentId:S,caseId:h,response:w}}),N.label=27;case 27:return[3,29];case 28:return k=N.sent(),e.push({success:!1,step:"POST /documents test",message:"âœ— Upload failed: ".concat(k instanceof Error?k.message:String(k))}),[3,29];case 29:return[2,e]}})},new((n=void 0)||(n=At))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())});var e,t,n,r}var _t=n(64583).Promise,zt=function(){return zt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},zt.apply(this,arguments)},Dt=function(e,t,n,r){return new(n||(n=_t))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},Ft=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Rt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Pt="SC: Filed",Lt="SC: Unfiled",Mt="sc_conv_case:",Ht="sc_last_filed_case";function qt(e,t){return Dt(this,void 0,void 0,function(){var n,r,o;return Ft(this,function(a){switch(a.label){case 0:return n=String(e||"").trim(),r=String(t.caseId||"").trim(),o=String(t.emailDocId||"").trim(),n&&r&&o?[4,(0,l.Kg)("".concat("sc_conv_ctx:").concat(n),JSON.stringify({caseId:r,emailDocId:o}))]:[2];case 1:return a.sent(),[2]}})})}function Wt(e){return Dt(this,void 0,void 0,function(){var t,n;return Ft(this,function(r){switch(r.label){case 0:return t=String(e.caseId||"").trim(),n=String(e.emailDocId||"").trim(),t&&n?[4,(0,l.Kg)("sc_last_filed_ctx",JSON.stringify({caseId:t,emailDocId:n}))]:[2];case 1:return r.sent(),[2]}})})}function Ut(e){return Dt(this,void 0,void 0,function(){var t;return Ft(this,function(n){switch(n.label){case 0:return(t=String(e||"").trim())?[4,(0,l.Kg)(Ht,t)]:[2];case 1:return n.sent(),[2]}})})}function Kt(){return Dt(this,void 0,void 0,function(){var e;return Ft(this,function(t){switch(t.label){case 0:return[4,(0,l.wv)(Ht)];case 1:return e=t.sent(),[2,String(e||"").trim()]}})})}function $t(e,t){return Dt(this,void 0,void 0,function(){var n,r;return Ft(this,function(o){switch(o.label){case 0:return n=String(e||"").trim(),r=String(t||"").trim(),n&&r?[4,(0,l.Kg)("".concat(Mt).concat(n),r)]:[2];case 1:return o.sent(),[2]}})})}function Gt(e){return Dt(this,void 0,void 0,function(){var t,n;return Ft(this,function(r){switch(r.label){case 0:return(t=String(e||"").trim())?[4,(0,l.wv)("".concat(Mt).concat(t))]:[2,""];case 1:return n=r.sent(),[2,String(n||"").trim()]}})})}var Vt=(null===u.d||void 0===u.d?void 0:u.d.recipientHistory)||"recipientHistory";function Jt(e){return String(e||"").trim().toLowerCase()}function Xt(){return Dt(this,void 0,void 0,function(){var e,t;return Ft(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,l.wv)(Vt)];case 1:return(e=n.sent())?[2,(t=JSON.parse(String(e)))&&"object"==typeof t?t:{}]:[2,{}];case 2:return n.sent(),[2,{}];case 3:return[2]}})})}function Zt(){return Dt(this,void 0,void 0,function(){var e,t,n,r,o,a;return Ft(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.item,(null===(a=null==e?void 0:e.categories)||void 0===a?void 0:a.getAsync)?[4,new _t(function(t){e.categories.getAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(Array.isArray(e.value)?e.value:[]):t([])})})]:[2,[]];case 1:return t=i.sent(),n=t.map(un).filter(Boolean),console.log("[officeCats] raw",n),console.log("[officeCats] norm",n.map(ln)),[2,n.map(ln).filter(Boolean)];case 2:return i.sent(),[2,[]];case 3:return[2]}})})}function Yt(){return Dt(this,void 0,void 0,function(){var e,t,n,r;return Ft(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(e=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item)?"string"==typeof e.subject?[2,String(e.subject||"")]:(null===(r=null==e?void 0:e.subject)||void 0===r?void 0:r.getAsync)?[4,new _t(function(t){e.subject.getAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(String(e.value||"")):t("")})})]:[3,2]:[2,""];case 1:return[2,o.sent()||""];case 2:return[2,String((null==e?void 0:e.subject)||"")];case 3:return o.sent(),[2,""];case 4:return[2]}})})}function Qt(e){return Dt(this,void 0,void 0,function(){return Ft(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,l.Kg)(Vt,JSON.stringify(e))];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})}function en(e,t){return Dt(this,void 0,void 0,function(){var n,r,o,a,i,c,s,l,u;return Ft(this,function(d){switch(d.label){case 0:return(n=String(t||"").trim())?(r=(new Date).toISOString(),[4,Xt()]):[2];case 1:for(o=d.sent(),a=0,i=e;a<i.length;a++)c=i[a],(s=Jt(c))&&(l=o[s],u={email:s,caseId:n,count:((null==l?void 0:l.caseId)===n?Number((null==l?void 0:l.count)||0):0)+1,lastUsedIso:r},o[s]=u);return[4,Qt(o)];case 2:return d.sent(),[2]}})})}function tn(e){return Dt(this,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l,u,d,f,m;return Ft(this,function(v){switch(v.label){case 0:return v.trys.push([0,20,,21]),t=JSON.stringify({caseId:e.caseId,autoFileOnSend:e.autoFileOnSend,baseCaseId:String(e.baseCaseId||"").trim(),baseEmailDocId:String(e.baseEmailDocId||"").trim()}),n="sc_intent:".concat(e.itemKey),console.log("[saveComposeIntent] Saving intent",{key:n,caseId:e.caseId,autoFileOnSend:e.autoFileOnSend,baseCaseId:String(e.baseCaseId||"").trim(),baseEmailDocId:String(e.baseEmailDocId||"").trim()}),"undefined"!=typeof OfficeRuntime&&(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)?[4,OfficeRuntime.storage.setItem(n,t)]:[3,2];case 1:return v.sent(),console.log("[saveComposeIntent] Saved to OfficeRuntime.storage"),[3,5];case 2:return(null===(s=null===Office||void 0===Office?void 0:Office.context)||void 0===s?void 0:s.roamingSettings)?(Office.context.roamingSettings.set(n,t),[4,new _t(function(e,t){Office.context.roamingSettings.saveAsync(function(n){var r;n.status===Office.AsyncResultStatus.Succeeded?(console.log("[saveComposeIntent] Saved to roamingSettings"),e()):(console.error("[saveComposeIntent] roamingSettings.saveAsync failed:",n.error),t(new Error((null===(r=n.error)||void 0===r?void 0:r.message)||"saveAsync failed")))})})]):[3,4];case 3:return v.sent(),[3,5];case 4:localStorage.setItem(n,t),console.warn("[saveComposeIntent] Saved to localStorage (cross-context won't work)"),v.label=5;case 5:return v.trys.push([5,11,,12]),r="sc_intent:last_compose","undefined"!=typeof OfficeRuntime&&(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)?[4,OfficeRuntime.storage.setItem(r,t)]:[3,7];case 6:return v.sent(),console.log("[saveComposeIntent] Saved fallback to OfficeRuntime.storage"),[3,10];case 7:return(null===(l=null===Office||void 0===Office?void 0:Office.context)||void 0===l?void 0:l.roamingSettings)?(Office.context.roamingSettings.set(r,t),[4,new _t(function(e){Office.context.roamingSettings.saveAsync(function(){return e()})})]):[3,9];case 8:return v.sent(),console.log("[saveComposeIntent] Saved fallback to roamingSettings"),[3,10];case 9:localStorage.setItem(r,t),console.log("[saveComposeIntent] Saved fallback to localStorage"),v.label=10;case 10:return[3,12];case 11:return o=v.sent(),console.warn("[saveComposeIntent] Failed to save fallback key:",o),[3,12];case 12:return v.trys.push([12,18,,19]),(a=String((null===(f=null===(d=null===(u=null===Office||void 0===Office?void 0:Office.context)||void 0===u?void 0:u.mailbox)||void 0===d?void 0:d.item)||void 0===f?void 0:f.itemId)||"").trim())&&a!==e.itemKey?(i="sc_intent:".concat(a),"undefined"!=typeof OfficeRuntime&&(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)?[4,OfficeRuntime.storage.setItem(i,t)]:[3,14]):[3,17];case 13:return v.sent(),[3,17];case 14:return(null===(m=null===Office||void 0===Office?void 0:Office.context)||void 0===m?void 0:m.roamingSettings)?(Office.context.roamingSettings.set(i,t),[4,new _t(function(e){Office.context.roamingSettings.saveAsync(function(){return e()})})]):[3,16];case 15:return v.sent(),[3,17];case 16:localStorage.setItem(i,t),v.label=17;case 17:return[3,19];case 18:return v.sent(),[3,19];case 19:return[3,21];case 20:return c=v.sent(),console.error("[saveComposeIntent] Failed to save intent:",c),[3,21];case 21:return[2]}})})}function nn(e){return Dt(this,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l,u,d,f,m,v,g;return Ft(this,function(p){switch(p.label){case 0:return[4,Xt()];case 1:for(t=p.sent(),n={},r=0,o=e;r<o.length;r++)a=o[r],(i=Jt(a))&&(null==(c=t[i])?void 0:c.caseId)&&(s=Math.min(10,Math.max(1,Number(c.count||1))),n[c.caseId]=(n[c.caseId]||0)+s);for(l="",u=0,d=0,f=Object.entries(n);d<f.length;d++)m=f[d],v=m[0],(g=m[1])>u&&(u=g,l=v);return l?[2,{caseId:l,score:u}]:[2,null]}})})}function rn(e){var t;if(e){try{var n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.ui;if(n&&"function"==typeof n.openBrowserWindow)return void n.openBrowserWindow(e)}catch(e){}try{window.open(e,"_blank","noopener,noreferrer")}catch(e){}}}function on(e,t){var n=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return n&&t?"https://".concat(n,"/liveEdit/electronOnlineEditLatestVersion/").concat(encodeURIComponent(t)):""}function an(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return String((null==n?void 0:n.itemId)||"")}catch(e){return""}}function cn(){var e,t,n;try{var r=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return Boolean(null===(n=null==r?void 0:r.body)||void 0===n?void 0:n.setAsync)}catch(e){return!1}}function sn(){return Dt(this,void 0,void 0,function(){var e,t,n,r,o,a,i,c;return Ft(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),(e=null===(i=null===(a=null===Office||void 0===Office?void 0:Office.context)||void 0===a?void 0:a.mailbox)||void 0===i?void 0:i.item)?Boolean(null===(c=null==e?void 0:e.body)||void 0===c?void 0:c.setAsync)?(t=String(e.conversationId||e.conversationKey||"").trim())?[2,"draft:".concat(t)]:(n=String(e.dateTimeCreated||"").trim())?[2,"draft:".concat(n)]:[2,"draft:current"]:(r=String(e.itemId||"").trim())?[2,r]:"function"!=typeof e.getItemIdAsync?[3,2]:[4,new _t(function(t){e.getItemIdAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(String(e.value||"")):t("")})})]:[2,""];case 1:if(o=s.sent())return[2,o];s.label=2;case 2:return[2,""];case 3:return s.sent(),[2,""];case 4:return[2]}})})}function ln(e){return String(e||"").normalize("NFKC").replace(/[\u00A0\u2007\u202F]/g," ").replace(/\s+/g," ").trim().toLowerCase()}function un(e){var t,n,r,o;if(!e)return"";if("string"==typeof e)return e;var a=null!==(o=null!==(r=null!==(n=null!==(t=e.displayName)&&void 0!==t?t:e.name)&&void 0!==n?n:e.label)&&void 0!==r?r:e.value)&&void 0!==o?o:"";return String(a||"")}function dn(e,t){return Dt(this,void 0,void 0,function(){var n,r,o,a,i,c,s,l,u,d;return Ft(this,function(f){switch(f.label){case 0:n=function(e){return e.map(function(e){return ln(un(e))}).filter(Boolean)},r=function(n){return n.includes(e)||n.includes(t)},o=[],a=[],f.label=1;case 1:return f.trys.push([1,4,,5]),i=null===(u=null===(l=null===Office||void 0===Office?void 0:Office.context)||void 0===l?void 0:l.mailbox)||void 0===u?void 0:u.item,(null===(d=null==i?void 0:i.categories)||void 0===d?void 0:d.getAsync)?[4,new _t(function(e){i.categories.getAsync(function(t){(null==t?void 0:t.status)===Office.AsyncResultStatus.Succeeded?e(Array.isArray(t.value)?t.value:[]):e([])})})]:[3,3];case 2:c=f.sent(),o=n(c),f.label=3;case 3:return[3,5];case 4:return f.sent(),[3,5];case 5:return f.trys.push([5,7,,8]),[4,(0,Ot.getCurrentEmailCategoriesGraph)()];case 6:return s=f.sent(),a=n(Array.isArray(s)?s:[]),[3,8];case 7:return f.sent(),[3,8];case 8:return console.log("[cats] sourcePref (after reads)",{officeNorm:o,graphNorm:a,hasOfficeSignal:r(o),hasGraphSignal:r(a)}),r(o)?[2,o]:r(a)?[2,a]:[2,Array.from(new Set(Rt(Rt([],o||[],!0),a||[],!0)))]}})})}function fn(e,t,n){return Dt(this,void 0,void 0,function(){var r;return Ft(this,function(o){switch(o.label){case 0:return[4,dn(e,t)];case 1:return(r=o.sent()).includes(t)?(n(!0),[2]):(r.includes(e),n(!1),[2])}})})}function mn(e){return Dt(this,void 0,void 0,function(){var t,n,r,o,a,i;return Ft(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),t=null===(a=null===(o=null===Office||void 0===Office?void 0:Office.context)||void 0===o?void 0:o.mailbox)||void 0===a?void 0:a.item,(null===(i=null==t?void 0:t.body)||void 0===i?void 0:i.getAsync)?[4,new _t(function(e){t.body.getAsync(Office.CoercionType.Text,function(t){(null==t?void 0:t.status)===Office.AsyncResultStatus.Succeeded?e(String(t.value||"")):e("")})})]:[2,""];case 1:return n=c.sent(),(r=String(n||"").trim())?[2,r.length>e?r.slice(0,e):r]:[2,""];case 2:return c.sent(),[2,""];case 3:return[2]}})})}function vn(){return Dt(this,void 0,void 0,function(){var e,t,n,r,o,a,i,c;return Ft(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),(e=null===(c=null===(i=null===Office||void 0===Office?void 0:Office.context)||void 0===i?void 0:i.mailbox)||void 0===c?void 0:c.item)?[4,(t=function(e){return new _t(function(t){try{if(!(null==e?void 0:e.getAsync))return t([]);e.getAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(Array.isArray(e.value)?e.value:[]):t([])})}catch(e){t([])}})})(e.to)]:[2,[]];case 1:return n=s.sent(),[4,t(e.cc)];case 2:return r=s.sent(),[4,t(e.bcc)];case 3:return o=s.sent(),a=Rt(Rt(Rt([],n,!0),r,!0),o,!0).map(function(e){return Jt((null==e?void 0:e.emailAddress)||(null==e?void 0:e.address)||"")}).filter(Boolean),[2,Array.from(new Set(a))];case 4:return s.sent(),[2,[]];case 5:return[2]}})})}function gn(e){return e.toLowerCase().trim().replace(/-/g,".")}function pn(e,t){return Dt(this,void 0,void 0,function(){var n,r,o;return Ft(this,function(a){return n=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.item,[2,new _t(function(r,o){try{if(!(null==n?void 0:n.getAttachmentContentAsync))return o(new Error("Attachment API not available"));n.getAttachmentContentAsync(e,function(a){var i;if(!a||a.status!==Office.AsyncResultStatus.Succeeded)return o(null==a?void 0:a.error);var c=a.value||{},s=Array.isArray(null==n?void 0:n.attachments)?String((null===(i=n.attachments.find(function(t){return String(null==t?void 0:t.id)===String(e)}))||void 0===i?void 0:i.name)||""):"",l=String(c.name||t||s||"attachment");r({base64:String(c.content||""),name:l,mime:String(c.contentType||"application/octet-stream")})})}catch(e){o(e)}})]})})}function hn(e){return Dt(this,void 0,void 0,function(){return Ft(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Me(e,null)];case 1:case 2:return t.sent(),[3,3];case 3:return t.trys.push([3,5,,6]),[4,$e(e,[])];case 4:case 5:return t.sent(),[3,6];case 6:return[2]}})})}function bn(e,t){return Dt(this,void 0,void 0,function(){var n,r,o,a,i,c,s,l;return Ft(this,function(u){switch(u.label){case 0:return(n=String((null==e?void 0:e.documentId)||"").trim())?[4,(0,Oe.getDocumentMeta)(n)]:[3,2];case 1:return l=u.sent(),[2,Boolean(null==l?void 0:l.id)];case 2:return[4,Ke(t).catch(function(){return[]})];case 3:if(r=u.sent(),0===(o=Array.isArray(r)?r:[]).length)return[2,!1];a=0,i=o.slice(0,5),u.label=4;case 4:return a<i.length?(c=i[a],(s=String((null==c?void 0:c.id)||"").trim())?[4,(0,Oe.getDocumentMeta)(s).catch(function(){return null})]:[3,6]):[3,7];case 5:if(null==(l=u.sent())?void 0:l.id)return[2,!0];u.label=6;case 6:return a++,[3,4];case 7:return[2,!1]}})})}function yn(e,t){var n=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return n&&t?"https://".concat(n,"/?/documents/view/").concat(encodeURIComponent(t)):""}function wn(e){if(!e)return"";try{return new Date(e).toLocaleString("cs-CZ")}catch(e){return""}}function Sn(e){return e?e.document?e.document:e.data?e.data:e.result?e.result:e:null}function kn(e,t,n){return n?String(e||t||"").trim():String(t||"").trim()}function xn(e){var t=this,o=(e.email,e.token),a=e.settings,i=e.onChangeSettings,c=r.useMemo(function(){return(e=(new Date).getHours())>=5&&e<12?"Good morning":e>=12&&e<18?"Good afternoon":"Good evening";var e},[]),s=r.useMemo(function(){return function(){try{var e=Office.context.mailbox.userProfile;if(null==e?void 0:e.displayName)return e.displayName;var t=null==e?void 0:e.emailAddress;return t?t.split("@")[0].replace(/[._-]+/g," ").replace(/\s+/g," ").trim().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "):"user"}catch(e){return"user"}}()},[]),d=r.useMemo(function(){return ln(Pt)},[]),f=r.useMemo(function(){return ln(Lt)},[]),m=r.useState(function(){return an()||""}),v=m[0],g=m[1],p=r.useMemo(function(){return cn()},[v]),h=r.useState(""),b=h[0],y=h[1],w=r.useState("prompt"),S=w[0],k=w[1],x=r.useState("case"),I=x[0],N=x[1],C=r.useState({itemId:"",kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),E=C[0],B=C[1],O=r.useRef(new Set),T=r.useRef(null),A=r.useRef(null),j=r.useRef(null),_=r.useState({}),z=_[0],q=_[1],K=r.useState([]),$=K[0],G=K[1],V=r.useState(!1),J=V[0],X=V[1],Z=r.useState(""),Q=Z[0],ne=Z[1],re=r.useState(""),oe=re[0],ae=re[1],ie=r.useState(!1),ce=ie[0],se=ie[1],le=r.useState([]),ue=le[0],de=le[1],fe=r.useState(!1),me=fe[0],ve=(fe[1],r.useState(!1)),pe=ve[0],he=ve[1],be=r.useState(!1),ye=be[0],we=be[1],Se=r.useState(!1),ke=Se[0],xe=Se[1],Ne=r.useState(null),Ce=Ne[0],Ee=Ne[1],Be=r.useState(""),Te=Be[0],Ae=Be[1],je=r.useState(""),_e=je[0],ze=je[1],De=r.useState([]),Fe=De[0],Re=De[1],Pe=r.useState([]),He=Pe[0],qe=Pe[1],We=r.useState(!1),Ue=We[0],Ge=We[1],Ve=r.useState("both"),Je=Ve[0],Xe=Ve[1],Ze=r.useState([]),Ye=Ze[0],Qe=Ze[1],et=r.useState(!1),tt=et[0],nt=et[1],at=r.useState(!1),it=at[0],ct=at[1],st=r.useState(""),lt=st[0],ut=st[1],dt=r.useState(""),ft=dt[0],mt=dt[1],vt=r.useState(!1),gt=vt[0],pt=vt[1],ht=r.useState(null),bt=ht[0],yt=ht[1],wt=r.useState(""),St=wt[0],kt=wt[1],xt=r.useState(!1),It=xt[0],Ct=xt[1],Tt=r.useState(""),At=Tt[0],Mt=Tt[1],Ht=r.useState(!1),Vt=(Ht[0],Ht[1]);r.useCallback(function(){return Dt(t,void 0,void 0,function(){var e,t,n;return Ft(this,function(r){switch(r.label){case 0:Vt(!0),console.log("=== Starting SingleCase Diagnostics ==="),r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,jt()];case 2:return e=r.sent(),t=function(e){for(var t="=== SingleCase Diagnostics ===\n\n",n=0,r=e;n<r.length;n++){var o=r[n];t+="".concat(o.message,"\n"),o.details&&(t+="  Details: ".concat(JSON.stringify(o.details,null,2),"\n")),t+="\n"}var a=e.filter(function(e){return e.success}).length,i=e.length;return t+"\n=== Summary: ".concat(a,"/").concat(i," checks passed ===\n")}(e),console.log(t),alert(t),[3,5];case 3:return n=r.sent(),console.error("Diagnostics failed:",n),alert("Diagnostics failed: ".concat(n instanceof Error?n.message:String(n))),[3,5];case 4:return Vt(!1),[7];case 5:return[2]}})})},[]),r.useEffect(function(){var e=!0;return Dt(t,void 0,void 0,function(){var t;return Ft(this,function(n){switch(n.label){case 0:return[4,Yt()];case 1:return t=n.sent(),e&&Mt(t||""),[2]}})}),function(){e=!1}},[v]),r.useEffect(function(){var e=!0;return Dt(t,void 0,void 0,function(){var t;return Ft(this,function(n){switch(n.label){case 0:return cn()||Ue?[2]:[4,new _t(function(e){return setTimeout(e,500)})];case 1:return n.sent(),e?[4,dn(d,f)]:[2];case 2:return t=n.sent(),e?t.includes(f)?(se(!0),[2]):(t.includes(d),se(!1),[2]):[2]}})}),function(){e=!1}},[v,d,f,Ue]),r.useEffect(function(){p||"sent"===S&&(Ue||fn(d,f,se))},[S,p,v,d,f,Ue]);var Jt=r.useMemo(function(){return function(){var e,t,n,r,o,a;try{var i=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item,c=(null===(n=null==i?void 0:i.from)||void 0===n?void 0:n.emailAddress)||(null===(r=null==i?void 0:i.from)||void 0===r?void 0:r.address)||(null===(o=null==i?void 0:i.sender)||void 0===o?void 0:o.emailAddress)||(null===(a=null==i?void 0:i.sender)||void 0===a?void 0:a.address)||"";return String(c||"")}catch(e){return""}}()},[v,b]),Xt=r.useMemo(function(){return function(){var e,t,n,r,o,a;try{var i=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item,c=(null===(n=null==i?void 0:i.from)||void 0===n?void 0:n.displayName)||(null===(r=null==i?void 0:i.from)||void 0===r?void 0:r.name)||(null===(o=null==i?void 0:i.sender)||void 0===o?void 0:o.displayName)||(null===(a=null==i?void 0:i.sender)||void 0===a?void 0:a.name)||"";return String(c||"")}catch(e){return""}}()},[v,b]),Qt=r.useMemo(function(){return function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return String((null==n?void 0:n.conversationId)||(null==n?void 0:n.conversationKey)||"")}catch(e){return""}}()},[v,b]),un=r.useMemo(function(){return function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return(Array.isArray(null==n?void 0:n.attachments)?n.attachments:[]).filter(function(e){return!(null==e?void 0:e.isInline)}).map(function(e){return{id:String(e.id),name:String(e.name||""),size:Number(e.size||0),isInline:Boolean(e.isInline)}})}catch(e){return[]}}()},[v,b]),xn=r.useMemo(function(){return(un||[]).map(function(e){return String(e.id)}).filter(Boolean)},[un]);r.useEffect(function(){p&&Xe("both")},[p,v]);var In=r.useMemo(function(){return kn(b,v,p)},[b,v,p]),Nn=r.useState(""),Cn=Nn[0],En=Nn[1],Bn=r.useState(!1),On=Bn[0],Tn=Bn[1],An=r.useMemo(function(){return(null==Ce?void 0:Ce.caseId)?String(Ce.caseId):""},[null==Ce?void 0:Ce.caseId]),jn=r.useState(!1),_n=jn[0],zn=jn[1],Dn=r.useMemo(function(){return"sent"===S||!("prompt"!==S||"filed"!==E.kind||!(null==Ce?void 0:Ce.caseId))},[S,E.kind,null==Ce?void 0:Ce.caseId]),Fn=r.useMemo(function(){return"all"===a.caseListScope?$:$.filter(function(e){return!((t=((null==e?void 0:e.status)||"").toLowerCase())&&(t.includes("closed")||t.includes("uzav")||t.includes("archiv")||t.includes("done")));var t})},[$,a.caseListScope]),Rn=r.useState([]),Pn=Rn[0],Ln=Rn[1],Mn=r.useState("idle"),Hn=Mn[0],qn=Mn[1],Wn=r.useState([]),Un=Wn[0],Kn=Wn[1],$n=r.useState(""),Gn=$n[0],Vn=$n[1],Jn=r.useState(!0),Xn=Jn[0],Zn=Jn[1],Yn=r.useState(""),Qn=Yn[0],er=Yn[1],tr=r.useState(""),nr=tr[0],rr=tr[1],or=r.useState(""),ar=or[0],ir=or[1],cr=r.useState(""),sr=cr[0],lr=cr[1],ur=r.useState(!1),dr=ur[0],fr=ur[1],mr=r.useState(!1),vr=mr[0],gr=mr[1],pr=r.useState(""),hr=pr[0],br=pr[1],yr=r.useState(""),wr=yr[0],Sr=yr[1],kr=r.useState(""),xr=kr[0],Ir=kr[1],Nr=r.useMemo(function(){return p?(null==Pn?void 0:Pn[0])||"":Jt},[p,Jt,Pn]);function Cr(e){return Dt(this,void 0,void 0,function(){var t,n,r,o;return Ft(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,(0,l.Ox)("sc_intent:".concat(e))];case 1:case 2:return a.sent(),[3,3];case 3:return a.trys.push([3,6,,7]),(t=String((null===(o=null===(r=null===(n=null===Office||void 0===Office?void 0:Office.context)||void 0===n?void 0:n.mailbox)||void 0===r?void 0:r.item)||void 0===o?void 0:o.itemId)||"").trim())&&t!==e?[4,(0,l.Ox)("sc_intent:".concat(t))]:[3,5];case 4:a.sent(),a.label=5;case 5:return[3,7];case 6:return a.sent(),[3,7];case 7:return[2]}})})}r.useEffect(function(){var e=!1;return Dt(t,void 0,void 0,function(){var t,n;return Ft(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,l.wv)(u.d.workspaceHost)];case 1:return t=r.sent()||"",n=t.replace(/^https?:\/\//i,"").split("/")[0].trim(),e||Ae(n),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})}),function(){e=!0}},[]),r.useEffect(function(){var e=!0;return Dt(t,void 0,void 0,function(){var t;return Ft(this,function(n){switch(n.label){case 0:return p||v?[4,mn(600)]:(e&&En(""),[2]);case 1:return t=n.sent(),e&&En(t||""),[2]}})}),function(){e=!1}},[v,p]),r.useEffect(function(){var e=!1;return Dt(t,void 0,void 0,function(){var t;return Ft(this,function(n){switch(n.label){case 0:if(!In)return e||(Re([]),qe([])),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Ke(In)];case 2:return t=n.sent(),e||Re(Array.isArray(t)?t:[]),[3,4];case 3:return n.sent(),e||Re([]),[3,4];case 4:return[2]}})}),function(){e=!0}},[In,S]),r.useEffect(function(){var e=!1;return Dt(t,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l,u,d=this;return Ft(this,function(f){switch(f.label){case 0:return In?0===(t=Array.isArray(Fe)?Fe:[]).length?(e||qe([]),[2]):(n=String((null==Ce?void 0:Ce.caseId)||"").trim(),[4,(m=t.slice(0,10).map(function(e){return Dt(d,void 0,void 0,function(){var t,r,o,a,i;return Ft(this,function(c){switch(c.label){case 0:if(!(t=String((null==e?void 0:e.id)||"").trim()))return[2,null];r=null,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,(0,Oe.getDocumentMeta)(t)];case 2:return o=c.sent(),r=Sn(o),[3,4];case 3:return c.sent(),r=null,[3,4];case 4:return r?(a=String(r.case_id||r.caseId||"").trim(),n&&a&&a!==n?[2,null]:(i=String(e.name||r.name||"").trim(),[2,zt(zt({},e),{name:i||e.name,caseId:a||e.caseId})])):[2,e]}})})}),_t.all(m.map(function(e){return e.then(function(e){return{status:"fulfilled",value:e}},function(e){return{status:"rejected",reason:e}})})))]):[2];case 1:for(r=f.sent(),o=r.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}).filter(Boolean),a=new Set,i=[],c=0,s=o;c<s.length;c++)l=s[c],(u=String(l.id||""))&&(a.has(u)||(a.add(u),i.push(l)));return e||qe(i),[2]}var m})}),function(){e=!0}},[In,Fe,null==Ce?void 0:Ce.caseId]),r.useEffect(function(){"pickCase"===S&&"attachments"===I&&(Qe(xn),requestAnimationFrame(function(){var e;null===(e=A.current)||void 0===e||e.scrollIntoView({block:"start",behavior:"smooth"})}))},[S,I,xn]),r.useEffect(function(){var e;null===(e=j.current)||void 0===e||e.scrollIntoView({block:"end",behavior:"auto"})},[S,I,E.itemId,E.kind,E.text,Q,tt,He.length,null==Ce?void 0:Ce.sent]),r.useEffect(function(){if(console.log("[useEffect:saveIntent] Triggered",{composeMode:p,storeKey:In,selectedCaseId:Q,autoFileOnSend:Xn}),p)if(In)if(Q&&Xn){var e=On&&Boolean(ft)&&Boolean(lt)&&String(Q)===String(lt);tn({itemKey:In,caseId:Q,autoFileOnSend:Xn,baseCaseId:e?lt:"",baseEmailDocId:e?ft:""})}else Cr(In);else console.log("[useEffect:saveIntent] Skipping - no storeKey");else console.log("[useEffect:saveIntent] Skipping - not compose mode")},[p,In,Q,Xn,On,lt,ft]),r.useEffect(function(){if("pickCase"===S||Dn||p){var e=!0;return Dt(t,void 0,void 0,function(){var t,n,r,i,c,s,l;return Ft(this,function(u){switch(u.label){case 0:X(!0),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,_t.all([Y(o,a.caseListScope),ee(o)])];case 2:if(t=u.sent(),n=t[0],r=t[1],!e)return[2];for(G(n),i={},c=0,s=r;c<s.length;c++)l=s[c],i[String(l.id)]=l.name;return q(i),[3,5];case 3:return u.sent(),e?(G([]),q({}),[3,5]):[2];case 4:return e&&X(!1),[7];case 5:return[2]}})}),function(){e=!1}}},[S,Dn,p,o,a.caseListScope]);var Er=U({enabled:"pickCase"===S&&a.autoSuggestCase,emailItemId:v,conversationKey:Qt,subject:At,bodySnippet:Cn,fromEmail:Nr,attachments:un,cases:Fn,selectedCaseId:Q,selectedSource:oe,onAutoSelectCaseId:function(e){ne(e),ae("suggested")},topK:3}).suggestions;r.useEffect(function(){Gn&&"manual"!==oe&&"remembered"!==oe&&(nr||Q!==Gn&&(ne(Gn),ae("suggested")))},[Gn,oe,Q,nr]),r.useEffect(function(){var e=!0,n=null,r=function(){return Dt(t,void 0,void 0,function(){var t;return Ft(this,function(n){switch(n.label){case 0:return e?cn()?[4,vn()]:(Ln([]),[2]):[2];case 1:return t=n.sent(),e?(Ln(t),[2]):[2]}})})};return Dt(t,void 0,void 0,function(){return Ft(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),"function"!=typeof(null===Office||void 0===Office?void 0:Office.onReady)?[3,2]:[4,Office.onReady()];case 1:e.sent(),e.label=2;case 2:try{Office.context.mailbox.addHandlerAsync(Office.EventType.RecipientsChanged,function(){r()})}catch(e){}return n=window.setInterval(function(){r()},350),r(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})}),function(){e=!1,n&&window.clearInterval(n);try{Office.context.mailbox.removeHandlerAsync(Office.EventType.RecipientsChanged,r)}catch(e){}}},[v]);var Br=r.useRef(null);r.useEffect(function(){if(p){var e=Pn||[];if(0!==e.length&&Te){var t=function(e,t){if(!t||0===e.length)return[];for(var n=t.toLowerCase().replace(/^https?:\/\//,"").replace(/\/$/,""),r=[],o=0,a=e;o<a.length;o++){var i=a[o],c=i.toLowerCase().trim();if(c&&c.includes("@")){var s=c.split("@"),l=s[0],u=s[1];if(u&&l&&u===n){var d=l.trim();d&&(r.push(d),console.log("[extractSubmailCaseKeys] Found submail case key:",d,"from:",i))}}}return r}(e,Te);if(0!==t.length){if(Array.from(new Set(t)).length>1)return rr(""),ir(""),lr(""),void("suggested"===oe&&Q===nr&&(ne(""),ae("")));var n=function(e,t){if(!e||!t||0===t.length)return null;var n=gn(e),r=t.filter(function(e){var t=String((null==e?void 0:e.name)||(null==e?void 0:e.title)||"").toLowerCase(),r=t.match(/\(([^)]+)\)\s*$/);return!(!r||gn(r[1])!==n)||t.replace(/-/g,".").includes(n)});if(0===r.length)return console.log("[resolveSubmailCaseKey] No case found for key:",e),null;if(r.length>1)return console.warn("[resolveSubmailCaseKey] Multiple cases match key:",e,r.length),null;var o=r[0],a=String((null==o?void 0:o.id)||""),i=String((null==o?void 0:o.name)||(null==o?void 0:o.title)||"");return console.log("[resolveSubmailCaseKey] Resolved case:",{caseKey:e,caseId:a,caseName:i}),{caseId:a,caseName:i,caseKey:e}}(t[0],$);n?(rr(n.caseId),ir(n.caseKey),lr(n.caseName),"manual"!==oe&&(ne(n.caseId),ae("suggested"),_n||Zn(!0))):nr&&(rr(""),ir(""),lr(""),"suggested"===oe&&Q===nr&&(ne(""),ae("")))}else nr&&(rr(""),ir(""),lr(""),"suggested"===oe&&Q===nr&&(ne(""),ae("")))}else nr&&(rr(""),ir(""),lr(""),"suggested"===oe&&Q===nr&&(ne(""),ae("")))}else nr&&(rr(""),ir(""),lr(""))},[p,Pn,Te,$,oe,_n,nr,Q]),r.useEffect(function(){var e,t,n;if(p){var r=Pn||[];if(0!==r.length){var o=(null===(n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile)||void 0===n?void 0:n.emailAddress)||"";if(!o)return console.warn("[internal-guard] Could not determine sender email"),void he(!1);var a=function(e,t,n){if(void 0===n&&(n=[]),0===t.length)return!1;var r=new Set,o=ot(e);if(o){var a=rt(o);a&&r.add(a)}for(var i=0,c=n;i<c.length;i++){var s=rt(c[i].toLowerCase().trim());s&&r.add(s)}if(0===r.size)return!1;for(var l=0,u=t;l<u.length;l++){var d=ot(u[l]);if(!d)return!1;var f=rt(d);if(!f)return!1;if(!r.has(f))return!1}return!0}(o,r);console.log("[internal-guard] Detection result:",{senderEmail:o,recipientCount:r.length,recipients:r,isInternal:a,overrideActive:ye}),he(a)}else pe&&(he(!1),console.log("[internal-guard] No recipients, clearing internal detection"))}else pe&&he(!1)},[p,Pn,pe,ye]),r.useEffect(function(){we(!1),xe(!1),console.log("[internal-guard] Reset overrides for new email item:",b)},[b]),r.useEffect(function(){!p&&v?!dr&&o&&Dt(t,void 0,void 0,function(){var e,t,r,o,a,i,c,s,l,u,d,f,m,v,g,p,h,b,y,w,S,k,x,I,N,C,E,B;return Ft(this,function(O){switch(O.label){case 0:return O.trys.push([0,18,,19]),console.log("[checkIfFiled] Starting filed status check (using conversationId + subject)"),e=null===(S=null===(w=null===Office||void 0===Office?void 0:Office.context)||void 0===w?void 0:w.mailbox)||void 0===S?void 0:S.item,t=String((null==e?void 0:e.conversationId)||"").trim(),r=String((null==e?void 0:e.subject)||"").trim(),t?r?(o={host:null===(I=null===(x=null===(k=null===Office||void 0===Office?void 0:Office.context)||void 0===k?void 0:k.mailbox)||void 0===x?void 0:x.diagnostics)||void 0===I?void 0:I.hostName,hostVersion:null===(E=null===(C=null===(N=null===Office||void 0===Office?void 0:Office.context)||void 0===N?void 0:N.mailbox)||void 0===C?void 0:C.diagnostics)||void 0===E?void 0:E.hostVersion,platform:null===(B=null===Office||void 0===Office?void 0:Office.context)||void 0===B?void 0:B.platform},console.log("[checkIfFiled] Platform info:",o),console.log("[checkIfFiled] Email identifiers:",{conversationId:t.substring(0,30)+"...",subject:r,timestamp:(new Date).toISOString()}),console.log("[checkIfFiled] Checking local cache for conversationId"),[4,n.e(243).then(n.bind(n,1243))]):(console.log("[checkIfFiled] No subject available, cannot check filed status"),fr(!0),gr(!1),[2]):(console.log("[checkIfFiled] No conversationId available, cannot check filed status"),fr(!0),gr(!1),[2]);case 1:return a=O.sent(),i=a.getFiledEmailFromCache,c=a.findFiledEmailBySubject,s=a.cacheFiledEmail,[4,_t.resolve().then(n.bind(n,11584))];case 2:return l=O.sent(),u=l.normalizeSubject,d=l.checkFiledStatusByConversationAndSubject,console.log("[checkIfFiled] Attempting conversationId lookup..."),[4,i(t)];case 3:return f=O.sent(),console.log("[checkIfFiled] ConversationId lookup result:",f?"FOUND":"NOT FOUND"),f?[3,5]:(console.log("[checkIfFiled] ConversationId lookup failed, trying subject lookup"),[4,c(r,t)]);case 4:f=O.sent(),console.log("[checkIfFiled] Subject lookup result:",f?"FOUND":"NOT FOUND"),O.label=5;case 5:if(m=null,f&&(v=u(f.subject),g=u(r),v===g?(console.log("[checkIfFiled] Found in cache",{documentId:f.documentId,caseId:f.caseId,caseName:f.caseName,caseKey:f.caseKey}),m={documentId:f.documentId,caseId:f.caseId,caseName:f.caseName,caseKey:f.caseKey,subject:f.subject}):console.log("[checkIfFiled] Cache entry found but subject mismatch",{cached:v,current:g})),m)return[3,12];console.log("[checkIfFiled] Not found in cache, querying SingleCase API..."),O.label=6;case 6:return O.trys.push([6,11,,12]),[4,d(t,r)];case 7:return(p=O.sent())?(console.log("[checkIfFiled] âœ… Found on SingleCase platform!",{documentId:p.documentId,caseId:p.caseId,caseName:p.caseName,caseKey:p.caseKey}),[4,s(t,p.caseId,p.documentId,p.subject||r,p.caseName,p.caseKey)]):[3,9];case 8:return O.sent(),m={documentId:p.documentId,caseId:p.caseId,caseName:p.caseName,caseKey:p.caseKey,subject:p.subject||r},[3,10];case 9:return console.log("[checkIfFiled] âŒ Not found on SingleCase platform (definitive)"),fr(!0),gr(!1),[2];case 10:return[3,12];case 11:return h=O.sent(),console.warn("[checkIfFiled] API query failed, assuming not filed:",h),fr(!0),gr(!1),[2];case 12:if(!m)return console.log("[checkIfFiled] Unexpected: filedInfo is null after all checks"),fr(!0),gr(!1),[2];gr(!0),br(m.caseId),Sr(m.caseKey&&m.caseName?"".concat(m.caseKey," Â· ").concat(m.caseName):m.caseName||m.caseKey||"Unknown case"),Ir(m.documentId),O.label=13;case 13:return O.trys.push([13,16,,17]),console.log("[checkIfFiled] Applying filed category via Office.js"),[4,_t.resolve().then(n.bind(n,92245))];case 14:return[4,(0,O.sent().applyFiledCategoryToCurrentEmailOfficeJs)()];case 15:return O.sent(),console.log("[checkIfFiled] Category applied successfully"),[3,17];case 16:return b=O.sent(),console.warn("[checkIfFiled] Failed to apply category:",b),[3,17];case 17:return fr(!0),[3,19];case 18:return y=O.sent(),console.error("[checkIfFiled] Failed to check filed status:",y),fr(!0),gr(!1),[3,19];case 19:return[2]}})}):dr&&(fr(!1),gr(!1),br(""),Sr(""),Ir(""))},[p,v,dr,o]),r.useEffect(function(){vr&&wr&&!p&&v&&(console.log("[useEffect:alreadyFiled] Updating UI for filed email",{caseLabel:wr,documentId:xr}),k("prompt"),N("case"),Kn([{id:"view_in_singlecase",label:"View in SingleCase",intent:"view_in_singlecase"}]),B({itemId:v,kind:"filed",text:"âœ… JiÅ¾ zaÅ™azen do: ".concat(wr)}))},[vr,wr,xr,p,v]),r.useEffect(function(){var e=!1;return Dt(t,void 0,void 0,function(){var t,n,r;return Ft(this,function(o){switch(o.label){case 0:return cn()?nr||0===(t=Pn||[]).length?(Vn(""),[2]):(n="".concat(v,":").concat(t.slice().sort().join("|")),Qn&&Qn===n?(Vn(""),[2]):[4,nn(t)]):(Vn(""),er(""),[2]);case 1:return r=o.sent(),e||Vn((null==r?void 0:r.caseId)||""),[2]}})}),function(){e=!0}},[v,Pn,Qn,nr]),r.useEffect(function(){if(p){var e=!1;return Dt(t,void 0,void 0,function(){var t,n,r,o,a,i,c,s;return Ft(this,function(l){switch(l.label){case 0:return"manual"===oe||nr?[2]:(t=Array.isArray(Pn)?Pn:[],n=t.length>0,r=String(At||"").trim().length>0,o=String(Cn||"").trim().length>0,n||r||o?(a="",i="",Qt?[4,Gt(Qt)]:[3,2]):[2]);case 1:if(a=l.sent(),i=a?"thread":"",e)return[2];l.label=2;case 2:return a||!n?[3,4]:[4,Kt()];case 3:if(a=l.sent(),i=a?"last":"",e)return[2];l.label=4;case 4:return a?(ne(a),ae("remembered"),_n||Zn(!0),qn("compose_ready"),c=($||[]).find(function(e){return String(null==e?void 0:e.id)===String(a)}),s=String((null==c?void 0:c.name)||(null==c?void 0:c.title)||(null==c?void 0:c.label)||"").trim()||"Case ".concat(a),"thread"===i&&B({itemId:v,kind:"unfiled",text:"The case was recognised from a previous email. Case: ".concat(s,".")}),[2]):[2]}})}),function(){e=!0}}},[p,Qt,oe,v,$,Pn,At,Cn]);var Or=r.useMemo(function(){if(!Gn)return"";var e=($||[]).find(function(e){return String(null==e?void 0:e.id)===String(Gn)});return String((null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.label)||"").trim()||"Case ".concat(Gn)},[$,Gn]);r.useEffect(function(){if(!p)return qn("idle"),void Kn([]);if(!Q){if(0===(Array.isArray(Pn)?Pn:[]).length)return qn("compose_wait_recipients"),Kn([]),void B({itemId:v,kind:"unfiled",text:"Add a recipient (To or Cc) and I will suggest a case and the next steps for filing."});if(nr){Q||(ne(nr),ae("suggested"),In&&tn({itemKey:In,caseId:nr,autoFileOnSend:!0})),qn("compose_ready");var e=Xn?"Email se zaÅ™adÃ­ pÅ™i odeslÃ¡nÃ­.":"Email se nezaÅ™adÃ­ pÅ™i odeslÃ¡nÃ­.";return B({itemId:v,kind:"filed",text:"Spis detekovÃ¡n z BCC: ".concat(ar," Â· ").concat(sr,". ").concat(e)}),void Kn([{id:"s1",label:"Select a different case",intent:"pick_another_case"},{id:"s2",label:Xn?"Auto file on send: Enabled":"Auto file on send: Disabled",intent:"toggle_auto_file"}])}if(Gn)return Q||(ne(Gn),ae("suggested"),In&&tn({itemKey:In,caseId:Gn,autoFileOnSend:!0})),qn("compose_offer_frequent"),e=Xn?"Email se zaÅ™adÃ­ pÅ™i odeslÃ¡nÃ­.":"Email se nezaÅ™adÃ­ pÅ™i odeslÃ¡nÃ­.",B({itemId:v,kind:"unfiled",text:"Podle historie to obvykle patÅ™Ã­ do spisu: ".concat(Or,". ").concat(e)}),void Kn([{id:"a2",label:"Select a different case",intent:"pick_another_case"},{id:"a3",label:Xn?"Auto file on send: Enabled":"Auto file on send: Disabled",intent:"toggle_auto_file"}]);qn("compose_choose_case"),Kn([{id:"b1",label:"Select a different case",intent:"pick_another_case"},{id:"b2",label:Xn?"Disable auto file on send":"Enable auto file on send",intent:"toggle_auto_file"}]),B({itemId:v,kind:"unfiled",text:"Select a case for this draft email."})}},[p,Q,v,Pn,Gn,Or,Xn]),r.useEffect(function(){if(p&&"compose_ready"===Hn){if(pe&&!ye&&!ke)return console.log("[internal-guard] Showing internal email warning instead of suggestions"),k("prompt"),N("case"),Kn([{id:"ig1",label:"File anyway",intent:"internal_guard_file_anyway"},{id:"ig2",label:"Don't file",intent:"internal_guard_dont_file"}]),void B({itemId:v,kind:"unfiled",text:"I've detected an internal email. This conversation won't be filed."});if(ke)return console.log("[internal-guard] Email marked as do-not-file, showing confirmation"),k("prompt"),N("case"),Kn([]),void B({itemId:v,kind:"unfiled",text:"This email will not be filed."});if(Q){var e=($||[]).find(function(e){return String(null==e?void 0:e.id)===String(Q)}),t=String((null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.label)||"").trim()||"Case ".concat(Q);k("prompt"),N("case"),Kn([{id:"c1",label:"Select a different case",intent:"pick_another_case"},{id:"c2",label:Xn?"Auto file on send: Enabled":"Auto file on send: Disabled",intent:"toggle_auto_file"}]),B({itemId:v,kind:"unfiled",text:"Iâ€™ve matched this email to ".concat(t," based on previous interactions.")})}}},[p,Hn,Q,$,v,Xn,pe,ye,ke]);var Tr=r.useCallback(function(e){return Dt(t,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l;return Ft(this,function(u){switch(u.label){case 0:return u.trys.push([0,15,,16]),function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return"message"===String((null==n?void 0:n.itemType)||"").toLowerCase()}catch(e){return!1}}()&&e?cn()?(Ee(null),Re([]),qe([]),N("case"),Qe([]),Tn(!1),k("prompt"),B({itemId:e,kind:"unfiled",text:"Vyberte spis a potom pouÅ¾ijte ZaÅ™adit teÄ."}),[2]):vr&&wr?(console.log("[evaluateItem] Email already filed",{caseId:hr,caseLabel:wr}),k("prompt"),N("case"),Kn([{id:"af1",label:"View in SingleCase",intent:"view_in_singlecase"}]),B({itemId:e,kind:"filed",text:"âœ… Already filed in: ".concat(wr)}),[2]):O.current.has(e)?(k("prompt"),ne(""),ae(""),Ee(null),N("case"),Qe([]),Tn(!1),B({itemId:e,kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),[2]):[4,Le(e)]:(k("prompt"),ne(""),ae(""),Ee(null),N("case"),se(!1),Qe([]),Tn(!1),B({itemId:"",kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),[2]);case 1:return t=u.sent(),Ee(t||null),n=ln(Pt),r=ln(Lt),[4,dn(n,r)];case 2:return o=u.sent(),a=o.includes(n),i=o.includes(r),c=a||Boolean(null==t?void 0:t.sent),i?(k("prompt"),N("case"),Tn(!1),B({itemId:e,kind:"unfiled",text:"This email is not filed. Do you want to file it?"}),[2]):c?[4,bn(t||null,e)]:[3,14];case 3:return u.sent()?[3,5]:[4,hn(e)];case 4:return u.sent(),Ee(null),Re([]),qe([]),k("prompt"),N("case"),Tn(!1),B({itemId:e,kind:"deleted",text:"Iâ€™ve noticed that this email or its attachments were deleted from SingleCase. Do you want to re-file it?"}),[2];case 5:return u.trys.push([5,8,,9]),s=String((null==t?void 0:t.caseId)||"").trim(),l=String((null==t?void 0:t.documentId)||"").trim(),s&&l?[4,Wt({caseId:s,emailDocId:l})]:[3,7];case 6:u.sent(),u.label=7;case 7:return[3,9];case 8:return u.sent(),[3,9];case 9:return u.trys.push([9,12,,13]),(null==t?void 0:t.caseId)?[4,Ut(String(t.caseId))]:[3,11];case 10:u.sent(),u.label=11;case 11:return[3,13];case 12:return u.sent(),[3,13];case 13:return k("sent"),N("case"),Tn(!1),B({itemId:e,kind:"filed",text:"Tento email je jiÅ¾ zaÅ™azen."}),[2];case 14:return k("prompt"),N("case"),Tn(!1),B({itemId:e,kind:"unfiled",text:"This email is not filed. Do you want to file it?"}),[3,16];case 15:return u.sent(),k("prompt"),N("case"),Tn(!1),B({itemId:"",kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),[3,16];case 16:return[2]}})})},[]);r.useEffect(function(){var e=!0,n=null,r=function(){return Dt(t,void 0,void 0,function(){var t,n,r,o,a,i,c,s,l,u;return Ft(this,function(d){switch(d.label){case 0:return e?[4,sn()]:[2];case 1:return t=d.sent(),n=an(),r=cn(),[4,Yt().catch(function(){return""})];case 2:return d.sent(),String((null===(u=null===(l=null===(s=null===Office||void 0===Office?void 0:Office.context)||void 0===s?void 0:s.mailbox)||void 0===l?void 0:l.item)||void 0===u?void 0:u.conversationId)||""),o=n||"",a=t,i=String(o||"")!==String(v||"")||String(a||"")!==String(b||""),console.log("[sync] activeChanged",{activeChanged:i,nextActiveId:o,nextActiveKey:a}),t&&i?(console.log("[sync] APPLY switch",{nextActiveId:o,nextActiveKey:a,modeNow:r,nextStoreKey:kn(a,o,r)}),ct(!0),Ee(null),Re([]),qe([]),ze(""),ut(""),mt(""),g(o),y(a),ne(""),ae(""),N("case"),Qe([]),Tn(!1),c=kn(a,o,r),[4,Tr(c)]):[3,4];case 3:return d.sent(),ct(!1),[2];case 4:return t&&t!==b&&y(t),[2]}})})},o=function(){r()},a=function(){r()};return Dt(t,void 0,void 0,function(){return Ft(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),"function"!=typeof(null===Office||void 0===Office?void 0:Office.onReady)?[3,2]:[4,Office.onReady()];case 1:e.sent(),e.label=2;case 2:try{Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,o)}catch(e){}return window.addEventListener("focus",a),document.addEventListener("visibilitychange",a),n=window.setInterval(function(){r()},450),[4,r()];case 3:case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){e=!1;try{window.removeEventListener("focus",a),document.removeEventListener("visibilitychange",a)}catch(e){}n&&window.clearInterval(n);try{try{Office.context.mailbox.removeHandlerAsync(Office.EventType.ItemChanged,{handler:o})}catch(e){Office.context.mailbox.removeHandlerAsync(Office.EventType.ItemChanged,o)}}catch(e){}}},[v,b,Tr]);var Ar=r.useMemo(function(){return An&&($||[]).find(function(e){return String(null==e?void 0:e.id)===An})||null},[$,An]),jr=r.useMemo(function(){var e=Ar;return String((null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.label)||"").trim()||(An?"Case ".concat(An):"")},[Ar,An]),_r=r.useMemo(function(){if(!An)return"";var e,t,n=function(e,t){if(!t)return"";var n=t.url||t.webUrl||t.web_url||t.href||t.link;if(n&&"string"==typeof n){if(/^https?:\/\//i.test(n))return n;var r=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return r?"https://".concat(r).concat(n.startsWith("/")?n:"/".concat(n)):""}return""}(Te,Ar);return n||(e=An,(t=(Te||"").trim().replace(/^https?:\/\//i,"").split("/")[0])&&e?"https://".concat(t).concat("/?/cases/view/").concat(encodeURIComponent(e)):"")},[An,Ar,Te]),zr=r.useMemo(function(){var e=[];if(null==Ce?void 0:Ce.documentId){var t=String(Ce.documentId),n=Array.isArray(He)?He.find(function(e){return String(null==e?void 0:e.id)===t}):null;(null==n?void 0:n.url)&&e.push(n)}if(Array.isArray(He))for(var r=0,o=He;r<o.length;r++){var a=o[r];(null==a?void 0:a.id)&&(null==a?void 0:a.url)&&e.push(a)}var i=new Set;return e.filter(function(e){return!i.has(e.id)&&(i.add(e.id),!0)}).slice(0,25)},[Ce,He]),Dr=function(){pt(!1),yt(null),kt(""),Ct(!1)},Fr=r.useCallback(function(){console.log("[internal-guard] User clicked 'File anyway', overriding guard"),we(!0),xe(!1)},[]),Rr=r.useCallback(function(){console.log("[internal-guard] User clicked 'Don't file', marking email as do-not-file"),xe(!0),we(!1),ne(""),ae("")},[]),Pr=r.useCallback(function(e){if(console.log("[handleQuickAction] enter",e),"toggle_auto_file"===e)return zn(!0),void Zn(function(e){var t=!e;return p&&Q&&In&&(t?tn({itemKey:In,caseId:Q,autoFileOnSend:!0}):Cr(In)),Kn(function(e){return(e||[]).map(function(e){return"toggle_auto_file"===e.intent?zt(zt({},e),{label:t?"Auto-file on send: On":"Auto-file on send: Off"}):e})}),t});if("internal_guard_file_anyway"!==e)if("internal_guard_dont_file"!==e){if("cancel_compose"===e)return ne(""),ae("manual"),In&&Cr(In),k("pickCase"),N("case"),qn("compose_choose_case"),Kn([]),void B({itemId:v,kind:"unfiled",text:"Select a case for this draft email."});if("accept_frequent_case"===e){if(!Gn)return;return ne(Gn),ae("suggested"),p?(k("prompt"),N("case"),Kn([]),qn("compose_ready"),In&&tn({itemKey:In,caseId:Gn,autoFileOnSend:Xn}),void B({itemId:v,kind:"unfiled",text:"OK. KliknÄ›te ZaÅ™adit teÄ. Potom mÅ¯Å¾ete email normÃ¡lnÄ› odeslat. Spis: ".concat(Or,".")})):(qn("idle"),k("pickCase"),void N(un.length>0?"attachments":"case"))}if("pick_another_case"===e){var n="suggested"===oe||"remembered"===oe;return console.log("[pick_another_case] ðŸ”µ Button clicked",{wasAutoSelected:n,selectedSource:oe,visibleCasesCount:Fn.length}),p&&(ne(""),ae("manual"),n?Dt(t,void 0,void 0,function(){var e,t,n,r,o;return Ft(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,Yt()];case 1:return e=a.sent(),[4,mn(600)];case 2:return t=a.sent(),n=e.trim()||t.trim(),console.log("[pick_another_case] ðŸ“¥ Fetched fresh content:",{subjectLength:e.length,bodyLength:t.length,hasContent:!!n}),n?(console.log("[pick_another_case] âœ… Triggering content analysis"),r=function(e){for(var t,n=null!==(t=e.topK)&&void 0!==t?t:5,r=String(e.subject||""),o=P(r),a=R(r),i=String(e.bodySnippet||"").slice(0,1500),c=P(i),s=R(i),l={},u={},d=function(e,t,n){e&&(u[e]=(u[e]||0)+t,n&&(l[e]||(l[e]=[]),l[e].includes(n)||l[e].push(n)))},f=0,m=e.cases;f<m.length;f++){var v=m[f],g=String((null==v?void 0:v.id)||""),p=R(D(v));if(g&&p){var h=a.includes(p),b=s.includes(p);(h||b)&&d(g,95,"Case reference found in email content")}}for(var y=0,w=e.cases;y<w.length;y++)if(v=w[y],g=String((null==v?void 0:v.id)||"")){var S=F(v),k=P(S);if(k){var x=L(S);if(o&&(k===o||k.includes(o)||o.includes(k)))d(g,98,"Subject matches case name");else{if(x.length>0&&r){var I=M(x,r);I.hits>=2&&d(g,60+30*H(I.total>0?I.hits/I.total:0,0,1),"Case name matches subject keywords")}if(i&&x.length>0){var N=k.length>=4&&c.includes(k);if(x.length<=2)N&&d(g,45,"Case name found in email body");else{var C=M(x,i);C.hits>=2?d(g,35+25*H(C.total>0?C.hits/C.total:0,0,1),"Case name found in email body"):N&&d(g,40,"Case name found in email body")}}}}}var E=Object.entries(u).map(function(e){var t=e[0];return{caseId:t,score:e[1],reasons:l[t]||[]}}).sort(function(e,t){return t.score-e.score}),B=E.map(function(e){return e.score});return{suggestions:E.map(function(e,t){return{caseId:e.caseId,score:e.score,confidencePct:W(B,t),reasons:e.reasons}}).filter(function(e){return e.confidencePct>=10}).slice(0,n)}}({subject:e,bodySnippet:t,cases:Fn,topK:5}),console.log("[pick_another_case] ðŸ“Š Analysis complete:",{foundCount:r.suggestions.length,suggestions:r.suggestions.map(function(e){return{caseId:e.caseId,pct:e.confidencePct,score:e.score,reasons:e.reasons}})}),de(r.suggestions),0===r.suggestions.length?(console.log("[pick_another_case] âŒ No suggestions found"),B({itemId:v,kind:"unfiled",text:"Å½Ã¡dnÃ© nÃ¡vrhy podle obsahu. Vyberte spis ruÄnÄ›."})):(console.log("[pick_another_case] âœ… Set",r.suggestions.length,"suggestions in state"),B({itemId:v,kind:"unfiled",text:"Vyberte spis podle obsahu emailu."})),[3,4]):(console.log("[pick_another_case] â­ï¸ Skipping analysis: no content"),de([]),B({itemId:v,kind:"unfiled",text:"Vyberte spis."}),[2]);case 3:return o=a.sent(),console.error("[pick_another_case] âŒ Analysis failed:",o),de([]),B({itemId:v,kind:"unfiled",text:"Vyberte spis."}),[3,4];case 4:return[2]}})}):(console.log("[pick_another_case] â­ï¸ Skipping analysis: not auto-selected"),de([]),B({itemId:v,kind:"unfiled",text:"Vyberte spis."}))),k("pickCase"),N("case"),qn("compose_choose_case"),void Kn([])}if("skip_attachments"===e)return Xe("both"),Qe([]),qn("compose_ready"),Kn([]),void B({itemId:v,kind:"unfiled",text:"DobÅ™e. KliknÄ›te ZaÅ™adit teÄ. ZaÅ™adÃ­m jen email."});if("select_attachments"===e)return Xe("both"),Qe(xn),qn("compose_ready"),Kn([]),void B({itemId:v,kind:"unfiled",text:"DobÅ™e. KliknÄ›te ZaÅ™adit teÄ. ZaÅ™adÃ­m email i pÅ™Ã­lohy."});if("view_in_singlecase"!==e);else if(xr&&Te){var r="https://".concat(Te,"/documents/").concat(xr);console.log("[handleQuickAction] Opening SingleCase document:",r),window.open(r,"_blank")}else hr&&Te&&(r="https://".concat(Te,"/cases/").concat(hr),console.log("[handleQuickAction] Opening SingleCase case:",r),window.open(r,"_blank"))}else Rr();else Fr()},[v,xn,un.length,Pn,Gn,p,Or,Or,Gn,Q,In,Xn,xr,hr,Te]),Lr=r.useCallback(function(e){return Dt(t,void 0,void 0,function(){var t,n,r,i,c,l,u,d,f,m,g,h,b,y,w,S,x,N,C,E,O,A,j,_,z,D,F,R,P,L,M,H,q,W,U,K,$,G,V,J;return Ft(this,function(X){switch(X.label){case 0:if(tt)return[2];if(!(t=String((null==e?void 0:e.caseId)||Q||"").trim()))return[2];if(ke)return console.log("[doSubmit] Email marked as do-not-file, skipping filing"),ze("Email nebude zaÅ™azen (oznaÄen jako internÃ­)."),[2];if(pe&&!ye)return console.log("[doSubmit] Internal email detected without override, skipping filing"),ze("InternÃ­ email nebude zaÅ™azen. KliknÄ›te 'File anyway' pro pÅ™epsÃ¡nÃ­."),[2];if(vr&&!p)return console.log("[doSubmit] Email already filed, preventing double filing"),ze("Email jiÅ¾ byl zaÅ™azen do SingleCase."),[2];if("attachments"===I&&un.length>0&&0===Ye.length)return[2];if(!In)return ze("Chyba: nelze urÄit klÃ­Ä emailu."),[2];nt(!0),k("sending"),ze(""),X.label=1;case 1:return X.trys.push([1,40,41,42]),[4,mn(8e3)];case 2:return n=X.sent(),r=(n||Cn||"").trim()||"[No body content available from Outlook]",i=(At||"email").trim().replace(/[<>:"/\\|?*\x00-\x1F]/g," ").replace(/\s+/g," ").trim().slice(0,80)||"email",c="From: ".concat(Xt," <").concat(Jt,">\r\n")+"To: SingleCase <noreply@singlecase>\r\n"+"Subject: ".concat(At,"\r\n")+"Date: ".concat((new Date).toUTCString(),"\r\n")+"Message-ID: <".concat(v,"@outlook>\r\n")+"MIME-Version: 1.0\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: 8bit\r\n\r\n"+"".concat(r,"\r\n"),l=function(e){for(var t=(new TextEncoder).encode(e),n="",r=0;r<t.length;r+=1)n+=String.fromCharCode(t[r]);return btoa(n)}(c),u=String((null==Ce?void 0:Ce.caseId)||lt||""),d=String((null==Ce?void 0:Ce.documentId)||ft||""),console.log("[doSubmit] new version check",{isUploadingNewVersion:On,existingEmailDocId:d,originalCaseId:u,caseId:t,replyBaseCaseId:lt,replyBaseEmailDocId:ft,sentPillCaseId:null==Ce?void 0:Ce.caseId,sentPillDocId:null==Ce?void 0:Ce.documentId}),f=On&&Boolean(d)&&Boolean(u)&&t===u,m=null==Ce?void 0:Ce.singlecaseRecordId,f?[3,4]:(g={caseId:t,outlookItemId:v&&!String(v).startsWith("draft:")?v:void 0,subject:At,fromEmail:Jt,fromName:Xt},a.includeBodySnippet&&n&&(g.bodySnippet=n),[4,te(0,g)]);case 3:h=X.sent(),m=null==h?void 0:h.singlecaseRecordId,X.label=4;case 4:return b="",y=null!==(K=null==Ce?void 0:Ce.revisionNumber)&&void 0!==K?K:1,console.log("[doSubmit] About to upload email document",{caseId:t,filingMode:Je,uploadAsNewVersion:f,workspaceHost:Te,hasToken:!!o}),"both"!==Je?[3,18]:f?(console.log("[doSubmit] Uploading new version of existing document",{existingEmailDocId:d}),[4,(0,Oe.uploadDocumentVersion)({documentId:d,fileName:"".concat(i,".eml"),mimeType:"message/rfc822",dataBase64:l})]):[3,14];case 5:if(w=X.sent(),S=function(e){var t,n,r,o,a,i,c,s;if(!e)return null;var l=e.data||e.result||e.document||e.version||e,u=null!==(s=null!==(c=null!==(i=null!==(o=null!==(n=null===(t=null==l?void 0:l.latest_version)||void 0===t?void 0:t.revision_number)&&void 0!==n?n:null===(r=null==l?void 0:l.latestVersion)||void 0===r?void 0:r.revisionNumber)&&void 0!==o?o:null===(a=null==l?void 0:l.latestVersion)||void 0===a?void 0:a.revision_number)&&void 0!==i?i:null==l?void 0:l.revision_number)&&void 0!==c?c:null==l?void 0:l.revisionNumber)&&void 0!==s?s:null==l?void 0:l.revision,d=Number(u);return Number.isFinite(d)&&d>0?d:null}(w),S)return[3,10];x=0,X.label=6;case 6:return x<3?[4,(0,Oe.getDocumentMeta)(d)]:[3,10];case 7:return N=X.sent(),C=Sn(N),S=function(e){var t,n=null===(t=null==e?void 0:e.latest_version)||void 0===t?void 0:t.revision_number,r=Number(n);return Number.isFinite(r)&&r>0?r:null}(C),S?[3,10]:[4,new _t(function(e){return setTimeout(e,300)})];case 8:X.sent(),X.label=9;case 9:return x+=1,[3,6];case 10:if(!S)throw new Error("Version upload succeeded but revision could not be determined. docId=".concat(d));return y=S,(j=yn(Te,b=d))?(E={id:b,name:"".concat(i,"-v").concat(y,".eml"),url:j,kind:"email",atIso:(new Date).toISOString(),uploadedBy:s,caseId:t},[4,Ke(In)]):[3,13];case 11:return z=X.sent(),D=Rt([E],z.filter(function(e){return String(null==e?void 0:e.id)!==String(E.id)}),!0).slice(0,25),[4,$e(In,D)];case 12:X.sent(),Re(D),qe(D),X.label=13;case 13:return[3,18];case 14:return console.log("[doSubmit] Creating new email document",{caseId:t,fileName:"".concat(i,".eml"),mimeType:"message/rfc822"}),[4,(0,Oe.uploadDocumentToCase)({caseId:t,fileName:"".concat(i,".eml"),mimeType:"message/rfc822",dataBase64:l})];case 15:return O=X.sent(),console.log("[doSubmit] Email document created",{response:O}),A=(null===($=null==O?void 0:O.documents)||void 0===$?void 0:$[0])||null,b=(null==A?void 0:A.id)?String(A.id):"",y=null!==(V=null===(G=null==A?void 0:A.latest_version)||void 0===G?void 0:G.revision_number)&&void 0!==V?V:1,console.log("[doSubmit] Extracted document ID",{emailDocId:b,emailRevisionNumber:y}),j=b?yn(Te,b):"",b&&j?(_={id:b,name:y>1?"".concat(i,"-v").concat(y,".eml"):"".concat(i,".eml"),url:j,kind:"email",atIso:(new Date).toISOString(),uploadedBy:s,caseId:t},[4,Ke(In)]):[3,18];case 16:return z=X.sent(),D=Rt([_],z.filter(function(e){return String(null==e?void 0:e.id)!==String(_.id)}),!0).slice(0,25),[4,$e(In,D)];case 17:X.sent(),Re(D),qe(D),X.label=18;case 18:if("attachments"!==Je&&"both"!==Je)return[3,22];F=function(e){var n,r,o,a,i,c,l,u,d;return Ft(this,function(f){switch(f.label){case 0:return n=un.find(function(t){return String(t.id)===String(e)}),[4,pn(e,null==n?void 0:n.name)];case 1:return r=f.sent(),[4,(0,Oe.uploadDocumentToCase)({caseId:t,fileName:r.name,mimeType:r.mime,dataBase64:r.base64})];case 2:return o=f.sent(),a=(null===(J=null==o?void 0:o.documents)||void 0===J?void 0:J[0])||null,(i=(null==a?void 0:a.id)?String(a.id):"")&&(c=yn(Te,i))?(l={id:i,name:r.name,url:c,kind:"attachment",atIso:(new Date).toISOString(),uploadedBy:s,caseId:t},[4,Ke(In)]):[2,"continue"];case 3:return u=f.sent(),d=Rt([l],u.filter(function(e){return String(null==e?void 0:e.id)!==String(l.id)}),!0).slice(0,25),[4,$e(In,d)];case 4:return f.sent(),Re(d),qe(d),[2]}})},R=0,P=Ye,X.label=19;case 19:return R<P.length?(L=P[R],[5,F(L)]):[3,22];case 20:X.sent(),X.label=21;case 21:return R++,[3,19];case 22:return M={sent:!0,atIso:(new Date).toISOString(),caseId:t,singlecaseRecordId:m,documentId:b||(f?d:void 0),revisionNumber:y,filedBy:s},[4,Me(In,M)];case 23:X.sent(),Ee(M),Ie(In),X.label=24;case 24:return X.trys.push([24,27,,28]),Qt?[4,$t(Qt,t)]:[3,26];case 25:X.sent(),X.label=26;case 26:return[3,28];case 27:return X.sent(),[3,28];case 28:return X.trys.push([28,31,,32]),Qt&&b?[4,qt(Qt,{caseId:t,emailDocId:b})]:[3,30];case 29:X.sent(),X.label=30;case 30:return[3,32];case 31:return X.sent(),[3,32];case 32:return X.trys.push([32,35,,36]),(H=p?Pn:[]).length>0?[4,en(H,t)]:[3,34];case 33:X.sent(),X.label=34;case 34:return[3,36];case 35:return X.sent(),[3,36];case 36:return X.trys.push([36,38,,39]),[4,(0,Ot.applyFiledCategoryToCurrentEmailOfficeJs)()];case 37:return X.sent(),[3,39];case 38:return q=X.sent(),console.warn("Office category apply failed:",q),[3,39];case 39:return se(!1),B(p?{itemId:In,kind:"filed",text:"ZaÅ™azeno do SingleCase. TeÄ mÅ¯Å¾ete email normÃ¡lnÄ› odeslat v Outlooku."}:{itemId:In,kind:"filed",text:"Tento email je jiÅ¾ zaÅ™azen."}),k("sent"),Tn(!1),[3,42];case 40:return W=X.sent(),console.error("[doSubmit] Upload failed",W),console.error("[doSubmit] Error details:",{name:W instanceof Error?W.name:"unknown",message:W instanceof Error?W.message:String(W),stack:W instanceof Error?W.stack:void 0}),U=W instanceof Error?W.message:String(W),ze("Chyba pÅ™i uklÃ¡dÃ¡nÃ­: ".concat(U)),k(p?"prompt":"pickCase"),setTimeout(function(){var e;try{null===(e=T.current)||void 0===e||e.scrollTo({top:0,behavior:"smooth"})}catch(e){}},50),[3,42];case 41:return nt(!1),[7];case 42:return[2]}})})},[tt,Q,I,un.length,Ye,At,Jt,Xt,o,a.includeBodySnippet,Cn,Te,Je,On,lt,ft,null==Ce?void 0:Ce.caseId,null==Ce?void 0:Ce.documentId,null==Ce?void 0:Ce.singlecaseRecordId,null==Ce?void 0:Ce.revisionNumber,s,p,vr,Pn,In,v]);return r.useEffect(function(){return Br.current=function(){return Lr()},function(){Br.current=null}},[Lr]),r.createElement("div",{className:"mwPage"},r.createElement("div",{className:"mwHero"},r.createElement("h1",{className:"mwGreeting"},c,", ",s),r.createElement("p",{className:"mwQuestion"},"What can I do for you?")),_e?r.createElement("div",{className:"mwChatBubble",style:{marginBottom:12}},_e):null,it?r.createElement("div",{className:"mwFiledSummaryCard"},r.createElement("div",{className:"mwChatBubble"},r.createElement("span",{className:"mwThinking"},"NaÄÃ­tÃ¡m email",r.createElement("span",{className:"mwDot mwDotBounce1"}),r.createElement("span",{className:"mwDot mwDotBounce2"}),r.createElement("span",{className:"mwDot mwDotBounce3"})))):Dn?r.createElement(Nt,{caseUrl:_r,filedCaseName:jr,sentPill:Ce,documentsToShow:zr,workspaceHost:Te,onOpenUrl:rn,buildLiveEditUrl:on,fmtCs:wn}):null,r.createElement("div",{className:"mwChatCard"},r.createElement("div",{className:"mwChatBody",ref:T},it?r.createElement("div",{className:"mwChatBubble"},r.createElement("span",{className:"mwThinking"},"NaÄÃ­tÃ¡m",r.createElement("span",{className:"mwDot mwDotBounce1"}),r.createElement("span",{className:"mwDot mwDotBounce2"}),r.createElement("span",{className:"mwDot mwDotBounce3"}))):null,"prompt"===S?r.createElement(Bt,{text:E.text,isUnfiled:"unfiled"===E.kind||"deleted"===E.kind,tone:p&&Q&&Xn?"success":"default",actions:(Un||[]).map(function(e){return{id:e.id,label:e.label,onClick:function(){console.log("[UI] clicked",e.intent,{viewMode:S,chatStep:Hn}),Pr(e.intent)}}})}):null,"pickCase"===S?r.createElement("div",null,r.createElement(ge,{title:"Case",scope:a.caseListScope,onScopeChange:function(e){i(function(t){return t.caseListScope===e?t:zt(zt({},t),{caseListScope:e})})},selectedCaseId:Q,onSelectCaseId:function(e){if(ne(e),ae("manual"),ut(""),mt(""),Tn(!1),p){var t=($||[]).find(function(t){return String(null==t?void 0:t.id)===String(e)}),n=String((null==t?void 0:t.name)||(null==t?void 0:t.title)||(null==t?void 0:t.label)||"").trim()||"Case ".concat(e);return k("prompt"),N("case"),Kn([]),qn("compose_ready"),In&&tn({itemKey:In,caseId:e,autoFileOnSend:Xn}),void B({itemId:In||v,kind:"unfiled",text:"OK. KliknÄ›te ZaÅ™adit teÄ. Potom mÅ¯Å¾ete email normÃ¡lnÄ› odeslat. Spis: ".concat(n,".")})}un.length>0&&N("attachments")},suggestions:Er,cases:Fn,isLoadingCases:J,clientNamesById:z,contentSuggestions:ue,isLoadingContentSuggestions:me}),"attachments"===I&&un.length>0?r.createElement(Et,{attachmentsLite:un,attachmentIds:xn,selectedAttachments:Ye,onSelectionChange:Qe,filingMode:Je,onFilingModeChange:Xe,containerRef:A}):null):null,"sending"===S?r.createElement("div",{className:"mwChatBubble"},r.createElement("span",{className:"mwThinking"},"Sending",r.createElement("span",{className:"mwDot mwDotBounce1"}),r.createElement("span",{className:"mwDot mwDotBounce2"}),r.createElement("span",{className:"mwDot mwDotBounce3"}))):null,"sent"===S?r.createElement(r.Fragment,null,r.createElement("div",{className:"mwChatBubble"},"Done"),r.createElement("div",{ref:j})):null,r.createElement("div",{ref:j})),"prompt"!==S||"unfiled"!==E.kind&&"deleted"!==E.kind||p?null:r.createElement("div",{className:"mwActionsBar"},r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){O.current.add(E.itemId),Dt(t,void 0,void 0,function(){var e;return Ft(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,Ot.applyUnfiledCategoryToCurrentEmailOfficeJs)()];case 1:return t.sent(),se(!0),[3,3];case 2:return e=t.sent(),console.warn("applyUnfiledCategory failed:",e),[3,3];case 3:return[2]}})}),B({itemId:E.itemId,kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."})}},"No"),r.createElement("button",{className:"mwPrimaryBtn",type:"button",onClick:function(){k("pickCase"),N("case"),ne(""),ae(""),Qe([]),Tn(!1)}},"Yes, file it")),"pickCase"!==S||p?null:r.createElement("div",{className:"mwActionsBar"},"attachments"===I?r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){N("case"),Qe([])}},"Back"):r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){if(ze(""),On)return Tn(!1),k("sent"),N("case"),void B({itemId:In,kind:"filed",text:"Tento email je jiÅ¾ zaÅ™azen."});k("prompt"),N("case"),ne(""),ae(""),Qe([]),B({itemId:In,kind:"unfiled",text:"This email is not filed. Do you want to file it?"})}},"Close"),"case"===I?r.createElement("button",{className:"mwPrimaryBtn ".concat(Q?"":"mwPrimaryBtnDisabled"),type:"button",disabled:!Q,onClick:function(){un.length>0?N("attachments"):Lr()}},"Continue"):r.createElement("button",{className:"mwPrimaryBtn ".concat(!Q||tt||un.length>0&&0===Ye.length?"mwPrimaryBtnDisabled":""),type:"button",disabled:!Q||tt||it||un.length>0&&0===Ye.length,onClick:function(){Lr()}},"Continue")),"sent"!==S||p?null:r.createElement("div",{className:"mwActionsBar"},r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){console.log("[toggleCategory] ðŸ”µ Button clicked!",{forceUnfiledLabel:ce,viewMode:S,composeMode:p,activeItemId:v}),Dt(t,void 0,void 0,function(){var e,t,n,r,o,a,i,c,s,l,u,m,v,g=this;return Ft(this,function(p){switch(p.label){case 0:e=function(e){return new _t(function(t){return setTimeout(t,e)})},t=function(e){return Dt(g,void 0,void 0,function(){return Ft(this,function(t){return[2,new _t(function(t,n){var r,o;try{var a=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.item,i=null==a?void 0:a.categories;if(!(null==i?void 0:i.removeAsync))return console.log("[toggleCategory] âš ï¸ removeAsync not available"),t();console.log("[toggleCategory] Removing categories:",e),i.removeAsync(e,function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Failed?(console.error("[toggleCategory] âŒ removeAsync failed:",null==e?void 0:e.error),n(null==e?void 0:e.error)):(console.log("[toggleCategory] âœ… removeAsync succeeded"),t())})}catch(e){console.error("[toggleCategory] âŒ removeAsync exception:",e),n(e)}})]})})},p.label=1;case 1:return p.trys.push([1,21,26,27]),Ge(!0),console.log("[toggleCategory] ðŸ“Š Starting toggle process",{forceUnfiledLabel:ce,filed:Pt,unfiled:Lt}),[4,Zt()];case 2:return n=p.sent(),r=n.includes(f),o=n.includes(d),a=!(!r||o)||!(o&&!r)&&Boolean(ce),i=!a,console.log("[toggleCategory] beforeOffice",{beforeOffice:n,hasUnfiledBefore:r,hasFiledBefore:o,currentIsUnfiled:a,targetIsUnfiled:i}),se(i),[4,t([Pt,Lt])];case 3:return p.sent(),[4,e(150)];case 4:return p.sent(),console.log("[toggleCategory] ðŸŽ¯ Applying target category:",i?"UNFILED":"FILED"),i?[4,(0,Ot.applyUnfiledCategoryToCurrentEmailOfficeJs)()]:[3,6];case 5:return p.sent(),console.log("[toggleCategory] âœ… Applied UNFILED category"),[3,8];case 6:return[4,(0,Ot.applyFiledCategoryToCurrentEmailOfficeJs)()];case 7:p.sent(),console.log("[toggleCategory] âœ… Applied FILED category"),p.label=8;case 8:c=0,p.label=9;case 9:return c<12?[4,e(250)]:[3,20];case 10:return p.sent(),[4,Zt()];case 11:return s=p.sent(),l=s.includes(f),u=s.includes(d),console.log("[toggleCategory] verify",{i:c,afterOffice:s,hasUnfiled:l,hasFiled:u}),l&&u?[4,t([Pt,Lt])]:[3,18];case 12:return p.sent(),[4,e(150)];case 13:return p.sent(),i?[4,(0,Ot.applyUnfiledCategoryToCurrentEmailOfficeJs)()]:[3,15];case 14:return p.sent(),[3,17];case 15:return[4,(0,Ot.applyFiledCategoryToCurrentEmailOfficeJs)()];case 16:p.sent(),p.label=17;case 17:return[3,19];case 18:if(i&&l&&!u)return se(!0),[2];if(!i&&u&&!l)return se(!1),[2];p.label=19;case 19:return c+=1,[3,9];case 20:return console.warn("[toggleCategory] âš ï¸ Could not observe category change after retries, keeping optimistic UI"),[3,27];case 21:m=p.sent(),console.error("[toggleCategory] âŒ FAILED:",m),console.error("[toggleCategory] Error details:",{message:m instanceof Error?m.message:String(m),stack:m instanceof Error?m.stack:void 0}),p.label=22;case 22:return p.trys.push([22,24,,25]),console.log("[toggleCategory] ðŸ”„ Attempting to revert state from Outlook"),[4,fn(d,f,se)];case 23:return p.sent(),console.log("[toggleCategory] âœ… State reverted successfully"),[3,25];case 24:return v=p.sent(),console.error("[toggleCategory] âŒ Could not revert state:",v),[3,25];case 25:return[3,27];case 26:return Ge(!1),console.log("[toggleCategory] ðŸ Toggle process completed"),[7];case 27:return[2]}})})}},ce?"Mark as Filed":"Mark as Unfiled"))),gt?r.createElement("div",{className:"mwRenameOverlay",onClick:function(){It||(pt(!1),yt(null))}},r.createElement("div",{className:"mwRenameDialog",onClick:function(e){return e.stopPropagation()}},r.createElement("div",{className:"mwRenameTitle"},"PÅ™ejmenovat dokument"),r.createElement("input",{value:St,onChange:function(e){return kt(e.target.value)},className:"mwRenameInput",autoFocus:!0}),r.createElement("div",{className:"mwRenameActions"},r.createElement("button",{type:"button",className:"mwGhostBtn",disabled:It,onClick:function(){return Dr()}},"ZruÅ¡it"),r.createElement("button",{type:"button",className:"mwPrimaryBtn",disabled:It||!String(St||"").trim(),onClick:function(){Dt(t,void 0,void 0,function(){var e,t,n,r,o;return Ft(this,function(a){switch(a.label){case 0:if(!bt)return[2];if(!(e=String(St||"").trim()))return[2];if(e===bt.name)return Dr(),[2];Ct(!0),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,Ke(In)];case 2:return t=a.sent(),n=Array.isArray(t)?t:[],r=n.map(function(t){return String(t.id)===String(bt.id)?zt(zt({},t),{name:e}):t}),[4,$e(In,r)];case 3:return a.sent(),Re(r),qe(r),Dr(),[3,5];case 4:return o=a.sent(),console.error(o),Ct(!1),[3,5];case 5:return[2]}})})}},It?"UklÃ¡dÃ¡m":"UloÅ¾it")))):null)}const In=r.createContext(void 0);In.Provider;const Nn=(...e)=>{const t={};for(const n of e){const e=Array.isArray(n)?n:Object.keys(n);for(const n of e)t[n]=1}return t},Cn=Nn(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),En=Nn(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","popover","ref","role","style","tabIndex","title","translate","spellCheck","name"]),Bn=Nn(["itemID","itemProp","itemRef","itemScope","itemType"]),On=Nn(En,Cn,Bn),Tn=Nn(On,["form"]),An=Nn(On,["height","loop","muted","preload","src","width"]),jn=Nn(An,["poster"]),_n=Nn(On,["start"]),zn=Nn(On,["value"]),Dn=Nn(On,["download","href","hrefLang","media","referrerPolicy","rel","target","type"]),Fn=Nn(On,["dateTime"]),Rn=Nn(On,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","popoverTarget","popoverTargetAction","type","value"]),Pn={label:Tn,audio:An,video:jn,ol:_n,li:zn,a:Dn,button:Rn,input:Nn(Rn,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:Nn(Rn,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:Nn(Rn,["form","multiple","required"]),option:Nn(On,["selected","value"]),table:Nn(On,["cellPadding","cellSpacing"]),tr:On,th:Nn(On,["colSpan","rowSpan","scope"]),td:Nn(On,["colSpan","headers","rowSpan","scope"]),colGroup:Nn(On,["span"]),col:Nn(On,["span"]),fieldset:Nn(On,["disabled","form"]),form:Nn(On,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:Nn(On,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:Nn(On,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:Fn,dialog:Nn(On,["open","onCancel","onClose"])};function Ln(e,t,n){const r=e&&Pn[e]||On;return r.as=1,function(e,t,n){const r=Array.isArray(t),o={},a=Object.keys(e);for(const i of a)!(!r&&t[i]||r&&t.indexOf(i)>=0||0===i.indexOf("data-")||0===i.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(i))||(o[i]=e[i]);return o}(t,r,n)}const Mn=Symbol.for("fui.slotRenderFunction"),Hn=Symbol.for("fui.slotElementType"),qn=Symbol.for("fui.slotClassNameProp");function Wn(e,t){const{defaultProps:n,elementType:o}=t,a=function(e){return"string"==typeof e||"number"==typeof e||Kn(e)||r.isValidElement(e)?{children:e}:e}(e),i={...n,...a,[Hn]:o,[qn]:(null==a?void 0:a.className)||(null==n?void 0:n.className)};return a&&"function"==typeof a.children&&(i[Mn]=a.children,i.children=null==n?void 0:n.children),i}function Un(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return Wn(e,t)}const Kn=e=>"object"==typeof e&&null!==e&&Symbol.iterator in e;function $n(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const Gn=$n()?r.useLayoutEffect:r.useEffect,Vn=e=>{const t=r.useRef(()=>{throw new Error("Cannot call an event handler while rendering")});return Gn(()=>{t.current=e},[e]),r.useCallback((...e)=>(0,t.current)(...e),[t])},Jn=r.createContext(void 0),Xn=Jn.Provider;function Zn(){var e;return null!==(e=r.useContext(Jn))&&void 0!==e?e:{}}const Yn=(e,t)=>{e=function(e,t){return function(e,t,n){if(!e)return t;t={...t};const{generatedControlId:r,hintId:o,labelFor:a,labelId:i,required:c,validationMessageId:s,validationState:l}=e;var u,d,f,m,v,g,p,h,b,y,w,S,k;return r&&(null!==(d=(u=t).id)&&void 0!==d||(u.id=r)),!i||(null==n?void 0:n.supportsLabelFor)&&a===t.id||null!==(v=(f=t)[m="aria-labelledby"])&&void 0!==v||(f[m]=i),(s||o)&&(t["aria-describedby"]=[s,o,null==t?void 0:t["aria-describedby"]].filter(Boolean).join(" ")),"error"===l&&(null!==(p=(g=t)["aria-invalid"])&&void 0!==p||(g["aria-invalid"]=!0)),c&&((null==n?void 0:n.supportsRequired)?null!==(w=(y=t).required)&&void 0!==w||(y.required=!0):null!==(k=(S=t)["aria-required"])&&void 0!==k||(S["aria-required"]=!0)),(null==n?void 0:n.supportsSize)&&(null!==(b=(h=t).size)&&void 0!==b||(h.size=e.size)),t}(r.useContext(In),e,t)}(e,{supportsLabelFor:!0,supportsRequired:!0,supportsSize:!0});const n=Zn();var o;const{size:a="medium",appearance:i=(null!==(o=n.inputDefaultAppearance)&&void 0!==o?o:"outline"),onChange:c}=e,[s,l]=(e=>{const[t,n]=r.useState(()=>void 0===e.defaultState?e.initialState:"function"==typeof e.defaultState?e.defaultState():e.defaultState),o=r.useRef(e.state);r.useEffect(()=>{o.current=e.state},[e.state]);const a=r.useCallback(e=>{(function(e){return"function"==typeof e})(e)&&e(o.current)},[]);return(e=>{const[t]=r.useState(()=>void 0!==e);return t})(e.state)?[e.state,a]:[t,n]})({state:e.value,defaultState:e.defaultValue,initialState:""}),u=(({primarySlotTagName:e,props:t,excludedPropNames:n})=>({root:{style:t.style,className:t.className},primary:Ln(e,t,[...n||[],"style","className"])}))({props:e,primarySlotTagName:"input",excludedPropNames:["size","onChange","value","defaultValue"]}),d={size:a,appearance:i,components:{root:"span",input:"input",contentBefore:"span",contentAfter:"span"},input:Wn(e.input,{defaultProps:{type:"text",ref:t,...u.primary},elementType:"input"}),contentAfter:Un(e.contentAfter,{elementType:"span"}),contentBefore:Un(e.contentBefore,{elementType:"span"}),root:Wn(e.root,{defaultProps:u.root,elementType:"span"})};return d.input.value=s,d.input.onChange=Vn(e=>{const t=e.target.value;null==c||c(e,{value:t}),l(t)}),d};function Qn(e){return Boolean(null==e?void 0:e.hasOwnProperty(Hn))}function er(e,t){return function(n,r,o,a,i){return Qn(r)?t(function(e,t){return{...t,[Hn]:e}}(n,r),null,o,a,i):Qn(n)?t(n,r,o,a,i):e(n,r,o,a,i)}}function tr(e){const{as:t,[qn]:n,[Hn]:r,[Mn]:o,...a}=e,i=a,c="string"==typeof r&&null!=t?t:r;return"string"!=typeof c&&t&&(i.as=t),{elementType:c,props:i,renderFunction:o}}n(44363);var nr=n(74848);const rr=n.t(nr,2),or=er(rr.jsx,(e,t,n)=>{const{elementType:o,renderFunction:a,props:i}=tr(e),c={...i,...t};return a?rr.jsx(r.Fragment,{children:a(o,c)},n):rr.jsx(o,c,n)}),ar=er(rr.jsxs,(e,t,n)=>{const{elementType:o,renderFunction:a,props:i}=tr(e),c={...i,...t};return a?rr.jsx(r.Fragment,{children:a(o,{...c,children:rr.jsxs(r.Fragment,{children:c.children},void 0)})},n):rr.jsxs(o,c,n)});function ir(e,t,n){const r=function(e,t,n,r=mt.A){const o=r();return function(r){const{dir:a,renderer:i}=r,c="ltr"===a?e:t||e;return o(i,Array.isArray(n)?{r:n}:n),c}}(e,t,n,gt.A);return function(){const e=(0,ht.m)(),t=(0,pt.J)();return r({dir:e,renderer:t})}}const cr=ir("r1oeeo9n","r9sxh5",{r:[".r1oeeo9n{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r1oeeo9n::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-left-radius:var(--borderRadiusMedium);border-bottom-right-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r1oeeo9n:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r1oeeo9n:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r1oeeo9n:focus-within{outline:2px solid transparent;}",".r9sxh5{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r9sxh5::after{box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-right-radius:var(--borderRadiusMedium);border-bottom-left-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r9sxh5:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r9sxh5:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r9sxh5:focus-within{outline:2px solid transparent;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]}),sr=bt({small:{sshi5w:"f1pha7fy",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},medium:{},large:{sshi5w:"f1w5jphr",Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},outline:{},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1l4zc64",gg5e9n:["f1m52nbi","f1ub3y4t"],Drbcw7:"f8vnjqi",udz0bu:["fz1etlk","f1hc16gm"],Be8ivqh:"f1klwx88",ofdepl:["f1hc16gm","fz1etlk"]},underline:{De3pzq:"f1c21dwh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],wvpqe5:["f1deefiw","f1n71otn"],Eqx8gd:["f1n6gb5g","f15yvnhg"],B1piin3:["f15yvnhg","f1n6gb5g"]},underlineInteractive:{oetu4i:"f1l4zc64",Be8ivqh:"f1klwx88",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f2ale1x"},filled:{g2u3we:"fghlq4f",h3c5rm:["f1gn591s","fjscplz"],B9xav0g:"fb073pr",zhjwy3:["fjscplz","f1gn591s"]},filledInteractive:{q7v0qe:"ftmjh5b",kmh5ft:["f17blpuu","fsrcdbj"],nagaa4:"f1tpwn32",B1yhkcb:["fsrcdbj","f17blpuu"]},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},"filled-darker":{De3pzq:"f16xq7d1"},"filled-lighter":{De3pzq:"fxugw4r"},"filled-darker-shadow":{De3pzq:"f16xq7d1",E5pizo:"fyed02w"},"filled-lighter-shadow":{De3pzq:"fxugw4r",E5pizo:"fyed02w"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"],Bsft5z2:"fhr9occ",Bduesf4:"f99w1ws"},smallWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},smallWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},mediumWithContentBefore:{uwmqm3:["f1ng84yb","f11gcy0p"]},mediumWithContentAfter:{z189sj:["f11gcy0p","f1ng84yb"]},largeWithContentBefore:{uwmqm3:["f1uw59to","fw5db7e"]},largeWithContentAfter:{z189sj:["fw5db7e","f1uw59to"]}},{d:[".f1pha7fy{min-height:24px;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1w5jphr{min-height:40px;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".fokr779{border-radius:0;}",{p:-1}],".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",[".f2ale1x::after{border-radius:0;}",{p:-1}],".fghlq4f{border-top-color:var(--colorTransparentStroke);}",".f1gn591s{border-right-color:var(--colorTransparentStroke);}",".fjscplz{border-left-color:var(--colorTransparentStroke);}",".fb073pr{border-bottom-color:var(--colorTransparentStroke);}",".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".fyed02w{box-shadow:var(--shadow2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fhr9occ::after{content:unset;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}"],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".ftmjh5b:hover,.ftmjh5b:focus-within{border-top-color:var(--colorTransparentStrokeInteractive);}",".f17blpuu:hover,.f17blpuu:focus-within{border-right-color:var(--colorTransparentStrokeInteractive);}",".fsrcdbj:hover,.fsrcdbj:focus-within{border-left-color:var(--colorTransparentStrokeInteractive);}",".f1tpwn32:hover,.f1tpwn32:focus-within{border-bottom-color:var(--colorTransparentStrokeInteractive);}"],a:[".f8vnjqi:active,.f8vnjqi:focus-within{border-top-color:var(--colorNeutralStroke1Pressed);}",".fz1etlk:active,.fz1etlk:focus-within{border-right-color:var(--colorNeutralStroke1Pressed);}",".f1hc16gm:active,.f1hc16gm:focus-within{border-left-color:var(--colorNeutralStroke1Pressed);}",".f1klwx88:active,.f1klwx88:focus-within{border-bottom-color:var(--colorNeutralStrokeAccessiblePressed);}"],m:[["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],w:[".f99w1ws:focus-within{outline-style:none;}"]}),lr=ir("r12stul0",null,[".r12stul0{align-self:stretch;box-sizing:border-box;flex-grow:1;min-width:0;border-style:none;padding:0 var(--spacingHorizontalM);color:var(--colorNeutralForeground1);background-color:transparent;outline-style:none;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;}",".r12stul0::-webkit-input-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::-moz-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::placeholder{color:var(--colorNeutralForeground4);opacity:1;}"]),ur=bt({small:{uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},medium:{},large:{uwmqm3:["fnphzt9","flt1dlf"],z189sj:["flt1dlf","fnphzt9"]},smallWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},smallWithContentAfter:{z189sj:["ffczdla","fgiv446"]},mediumWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},mediumWithContentAfter:{z189sj:["ffczdla","fgiv446"]},largeWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},largeWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},disabled:{sj55zd:"f1s2aq7o",De3pzq:"f1c21dwh",Bceei9c:"fdrzuqr",yvdlaj:"fahhnxm"}},{d:[".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".fnphzt9{padding-left:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".flt1dlf{padding-right:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".fgiv446{padding-left:var(--spacingHorizontalXXS);}",".ffczdla{padding-right:var(--spacingHorizontalXXS);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fdrzuqr{cursor:not-allowed;}",".fahhnxm::-webkit-input-placeholder{color:var(--colorNeutralForegroundDisabled);}",".fahhnxm::-moz-placeholder{color:var(--colorNeutralForegroundDisabled);}"]}),dr=ir("r1572tok",null,[".r1572tok{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;}",".r1572tok>svg{font-size:20px;}"]),fr=bt({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),mr=r.createContext(void 0),vr=()=>{},gr=mr.Provider,pr=e=>{var t,n;return null!==(n=null===(t=r.useContext(mr))||void 0===t?void 0:t[e])&&void 0!==n?n:vr},hr=r.forwardRef((e,t)=>{const n=Yn(e,t);return(e=>{const{size:t,appearance:n}=e,r=e.input.disabled,o="true"==`${e.input["aria-invalid"]}`,a=n.startsWith("filled"),i=sr(),c=ur(),s=fr();e.root.className=lt("fui-Input",cr(),i[t],e.contentBefore&&i[`${t}WithContentBefore`],e.contentAfter&&i[`${t}WithContentAfter`],i[n],!r&&"outline"===n&&i.outlineInteractive,!r&&"underline"===n&&i.underlineInteractive,!r&&a&&i.filledInteractive,a&&i.filled,!r&&o&&i.invalid,r&&i.disabled,e.root.className),e.input.className=lt("fui-Input__input",lr(),c[t],e.contentBefore&&c[`${t}WithContentBefore`],e.contentAfter&&c[`${t}WithContentAfter`],r&&c.disabled,e.input.className);const l=[dr(),r&&s.disabled,s[t]];e.contentBefore&&(e.contentBefore.className=lt("fui-Input__contentBefore",...l,e.contentBefore.className)),e.contentAfter&&(e.contentAfter.className=lt("fui-Input__contentAfter",...l,e.contentAfter.className))})(n),pr("useInputStyles_unstable")(n),(e=>ar(e.root,{children:[e.contentBefore&&or(e.contentBefore,{}),or(e.input,{}),e.contentAfter&&or(e.contentAfter,{})]}))(n)});hr.displayName="Input";const br="Enter",yr=" ";function wr(e,t){const{disabled:n,disabledFocusable:r=!1,"aria-disabled":o,onClick:a,onKeyDown:i,onKeyUp:c,...s}=null!=t?t:{},l="string"==typeof o?"true"===o:o,u=n||r||l,d=Vn(e=>{u?(e.preventDefault(),e.stopPropagation()):null==a||a(e)}),f=Vn(e=>{if(null==i||i(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===br||t===yr))return e.preventDefault(),void e.stopPropagation();t!==yr?t===br&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()}),m=Vn(e=>{if(null==c||c(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===br||t===yr))return e.preventDefault(),void e.stopPropagation();t===yr&&(e.preventDefault(),e.currentTarget.click())});if("button"===e||void 0===e)return{...s,disabled:n&&!r,"aria-disabled":!!r||l,onClick:r?void 0:d,onKeyUp:r?void 0:c,onKeyDown:r?void 0:i};{const t=!!s.href;let o=t?void 0:"button";!o&&u&&(o="link");const a={role:o,tabIndex:r||!t&&!n?0:void 0,...s,onClick:d,onKeyUp:m,onKeyDown:f,"aria-disabled":u};return"a"===e&&u&&(a.href=void 0),a}}const Sr=(e,t,n)=>{var r;return Ln(null!==(r=t.as)&&void 0!==r?r:e,t,n)},kr=r.createContext(void 0),xr={},Ir=(kr.Provider,(e,t)=>{const{size:n}=null!==(o=r.useContext(kr))&&void 0!==o?o:xr;var o;const{appearance:a="secondary",as:i="button",disabled:c=!1,disabledFocusable:s=!1,icon:l,iconPosition:u="before",shape:d="rounded",size:f=(null!=n?n:"medium")}=e,m=Un(l,{elementType:"span"});return{appearance:a,disabled:c,disabledFocusable:s,iconPosition:u,shape:d,size:f,iconOnly:Boolean((null==m?void 0:m.children)&&!e.children),components:{root:"button",icon:"span"},root:Wn(Sr(i,wr(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"===i?"button":void 0}}),icon:m}}),Nr=ir("r1f29ykk",null,{r:[".r1f29ykk{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1f29ykk:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1f29ykk:hover:active,.r1f29ykk:active:focus-visible{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1f29ykk[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1f29ykk{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1f29ykk:focus{border-color:ButtonText;}.r1f29ykk:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1f29ykk:hover:active,.r1f29ykk:active:focus-visible{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1f29ykk[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),Cr=ir("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]),Er=bt({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",Bpjbzib:"fkoldzo"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",Bpjbzib:"f1ksv2xa",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"f1d6mv4x",By8wz76:"f1nz3ub2",Bcq6wej:"fag2qd2",Jcjdmf:["fmvhcg7","f14bpyus"],sc4o1m:"f1o3dhpw",Bosien3:["f14bpyus","fmvhcg7"],B7iucu3:"fqc85l4",B8gzw0y:"f1h3a8gf",Bbkh6qg:"fkiggi6",F230oe:"f8gmj8i",Bdw8ktp:["f1ap8nzx","fjag8bx"],Bj1xduy:"f1igan7k",Bhh2cfd:["fjag8bx","f1ap8nzx"],Bahaeuw:"f1v3eptx",Bv2bamp:"f1ysmecq",vxuvv6:"faulsx",Bli9q98:["f79t15f","f8qmx7k"],Bx2tt8t:"fbtzoaq",yad0b3:["f8qmx7k","f79t15f"],j2fop7:"fd4bjan"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",Bpjbzib:"f1q1yqic",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"fwga7ee",Bqou3pl:"f1nhwcv0",Bsnehw8:"f1gm6xmp",wsxvnf:"f1xxsver",Bahaeuw:"f1v3eptx",Buhizc3:"fivsta0",j2fop7:"fd4bjan",Bqabnb4:"f3m6zum"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bpjbzib:"fkoldzo",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"f1l983o9",Bqou3pl:"f1nhwcv0",Bsnehw8:"f1gm6xmp",Bbkh6qg:"fxoo9op",Bahaeuw:"f1v3eptx",Bv2bamp:"f1i0gk12",j2fop7:"fd4bjan"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fkoldzo:hover:active,.fkoldzo:active:focus-visible{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".f1ksv2xa:hover:active,.f1ksv2xa:active:focus-visible{background-color:var(--colorBrandBackgroundPressed);}",".fhvnf4x:hover:active,.fhvnf4x:active:focus-visible{border-top-color:transparent;}",".fb6swo4:hover:active,.fb6swo4:active:focus-visible{border-right-color:transparent;}",".f232fm2:hover:active,.f232fm2:active:focus-visible{border-left-color:transparent;}",".f1klyf7k:hover:active,.f1klyf7k:active:focus-visible{border-bottom-color:transparent;}",".f1d6mv4x:hover:active,.f1d6mv4x:active:focus-visible{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".f1q1yqic:hover:active,.f1q1yqic:active:focus-visible{background-color:var(--colorSubtleBackgroundPressed);}",".fwga7ee:hover:active,.fwga7ee:active:focus-visible{color:var(--colorNeutralForeground2Pressed);}",".f1nhwcv0:hover:active .fui-Icon-filled,.f1nhwcv0:active:focus-visible .fui-Icon-filled{display:inline;}",".f1gm6xmp:hover:active .fui-Icon-regular,.f1gm6xmp:active:focus-visible .fui-Icon-regular{display:none;}",".f1xxsver:hover:active .fui-Button__icon,.f1xxsver:active:focus-visible .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1l983o9:hover:active,.f1l983o9:active:focus-visible{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1nz3ub2{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fag2qd2{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14bpyus{border-left-color:HighlightText;}.fmvhcg7{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o3dhpw{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fqc85l4{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1h3a8gf{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkiggi6:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f8gmj8i:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ap8nzx:hover{border-right-color:Highlight;}.fjag8bx:hover{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1igan7k:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1v3eptx:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ysmecq:hover:active,.f1ysmecq:active:focus-visible{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.faulsx:hover:active,.faulsx:active:focus-visible{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f79t15f:hover:active,.f79t15f:active:focus-visible{border-right-color:Highlight;}.f8qmx7k:hover:active,.f8qmx7k:active:focus-visible{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbtzoaq:hover:active,.fbtzoaq:active:focus-visible{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fd4bjan:hover:active,.fd4bjan:active:focus-visible{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fivsta0:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3m6zum:hover:active .fui-Button__icon,.f3m6zum:active:focus-visible .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fxoo9op:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1i0gk12:hover:active,.f1i0gk12:active:focus-visible{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),Br=bt({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",Bpjbzib:"f1jct5ie",im15vp:"f13txml0",Hjvxdg:["f1ncddno","f1axfvow"],Gpfmf1:"f1z04ada",ustxxc:["f1axfvow","f1ncddno"],Brsut9c:"f1uhomfy",Bses4qk:"fy9mucy",Bqou3pl:"f1g9va8i",Bsnehw8:"fwgvudy",wsxvnf:"fom6jww"},highContrast:{By8wz76:"f14ptb23",Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"],B7iucu3:"f1cyfu5x",Grqk0h:"f127ot8j",h3ptyc:"f19etb0b",Buw724y:["f4f984j","fw441p0"],Buk7464:"f3d22hf",Hwei09:["fw441p0","f4f984j"],Bbkh6qg:"fj8k9ua",F230oe:"fifrq0d",Bdw8ktp:["f196mwp7","fnekfq"],Bj1xduy:"f1l6uprw",Bhh2cfd:["fnekfq","f196mwp7"],Bahaeuw:"fa9u7a5",Buhizc3:"f1m71e0y",Bv2bamp:"fw24f3",vxuvv6:"f1nznrny",Bli9q98:["fq8nxuu","f1ao3jkc"],Bx2tt8t:"ftoixeo",yad0b3:["f1ao3jkc","fq8nxuu"],j2fop7:"fpmuzpx",Bqabnb4:"f168odog"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",Bpjbzib:"f9r0db0"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bpjbzib:"f9r0db0",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bpjbzib:"f9r0db0",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1jct5ie:hover:active,.f1jct5ie:active:focus-visible{background-color:var(--colorNeutralBackgroundDisabled);}",".f13txml0:hover:active,.f13txml0:active:focus-visible{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ncddno:hover:active,.f1ncddno:active:focus-visible{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1axfvow:hover:active,.f1axfvow:active:focus-visible{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1z04ada:hover:active,.f1z04ada:active:focus-visible{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1uhomfy:hover:active,.f1uhomfy:active:focus-visible{color:var(--colorNeutralForegroundDisabled);}",".fy9mucy:hover:active,.fy9mucy:active:focus-visible{cursor:not-allowed;}",".f1g9va8i:hover:active .fui-Icon-filled,.f1g9va8i:active:focus-visible .fui-Icon-filled{display:none;}",".fwgvudy:hover:active .fui-Icon-regular,.fwgvudy:active:focus-visible .fui-Icon-regular{display:inline;}",".fom6jww:hover:active .fui-Button__icon,.fom6jww:active:focus-visible .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f9r0db0:hover:active,.f9r0db0:active:focus-visible{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".fhvnf4x:hover:active,.fhvnf4x:active:focus-visible{border-top-color:transparent;}",".fb6swo4:hover:active,.fb6swo4:active:focus-visible{border-right-color:transparent;}",".f232fm2:hover:active,.f232fm2:active:focus-visible{border-left-color:transparent;}",".f1klyf7k:hover:active,.f1klyf7k:active:focus-visible{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f14ptb23{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cyfu5x{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f127ot8j .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f19etb0b:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4f984j:focus{border-right-color:GrayText;}.fw441p0:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3d22hf:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fj8k9ua:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fifrq0d:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f196mwp7:hover{border-right-color:GrayText;}.fnekfq:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1l6uprw:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fa9u7a5:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1m71e0y:hover .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fw24f3:hover:active,.fw24f3:active:focus-visible{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1nznrny:hover:active,.f1nznrny:active:focus-visible{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ao3jkc:hover:active,.f1ao3jkc:active:focus-visible{border-left-color:GrayText;}.fq8nxuu:hover:active,.fq8nxuu:active:focus-visible{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ftoixeo:hover:active,.ftoixeo:active:focus-visible{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fpmuzpx:hover:active,.fpmuzpx:active:focus-visible{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f168odog:hover:active .fui-Button__icon,.f168odog:active:focus-visible .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),Or=bt({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Bqsb82s:["fixhny3","f18mfu3r"],jg1oma:"feygou5"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f18mfu3r[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fixhny3[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.feygou5[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),Tr=bt({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),Ar=bt({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]}),jr=r.forwardRef((e,t)=>{const n=Ir(e,t);return(e=>{const t=Nr(),n=Cr(),r=Er(),o=Br(),a=Or(),i=Tr(),c=Ar(),{appearance:s,disabled:l,disabledFocusable:u,icon:d,iconOnly:f,iconPosition:m,shape:v,size:g}=e;e.root.className=lt("fui-Button",t,s&&r[s],r[g],d&&"small"===g&&r.smallWithIcon,d&&"large"===g&&r.largeWithIcon,r[v],(l||u)&&o.base,(l||u)&&o.highContrast,s&&(l||u)&&o[s],"primary"===s&&a.primary,a[g],a[v],f&&i[g],e.root.className),e.icon&&(e.icon.className=lt("fui-Button__icon",n,!!e.root.children&&c[m],c[g],e.icon.className))})(n),pr("useButtonStyles_unstable")(n),(e=>{const{iconOnly:t,iconPosition:n}=e;return ar(e.root,{children:["after"!==n&&e.icon&&or(e.icon,{}),!t&&e.root.children,"after"===n&&e.icon&&or(e.icon,{})]})})(n)});jr.displayName="Button";var _r=n(64583).Promise,zr=function(e,t,n,r){return new(n||(n=_r))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},Dr=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Fr=(0,i.n)({page:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",padding:"18px",background:"rgb(63, 74, 86)",boxSizing:"border-box",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif'},shell:{width:"100%",maxWidth:"720px",marginLeft:"auto",marginRight:"auto",borderRadius:"16px",border:"1px solid rgba(0,0,0,0.10)",background:"white",boxShadow:"0 12px 30px rgba(0,0,0,0.12)",padding:"22px",boxSizing:"border-box"},brandRow:{display:"flex",justifyContent:"center",marginBottom:"14px"},logo:{height:"40px",width:"auto",display:"block"},title:{margin:0,textAlign:"center",fontSize:"30px",lineHeight:1.12,letterSpacing:"-0.02em",fontWeight:800,color:"rgba(17,24,39,0.95)"},subtitle:{margin:"10px 0 0 0",textAlign:"center",fontSize:"13.5px",lineHeight:1.45,opacity:.72},formBlock:{marginTop:"18px",maxWidth:"640px",marginLeft:"auto",marginRight:"auto"},fieldLabel:{fontSize:"12.5px",fontWeight:800,opacity:.85,marginBottom:"8px"},inputWrap:{borderRadius:"14px",border:"1px solid rgba(0,0,0,0.14)",background:"white",padding:"8px",boxShadow:"0 1px 0 rgba(0,0,0,0.02)"},input:{width:"100%","& input::placeholder":{color:"rgba(0,0,0,0.35)"}},continueBtn:{marginTop:"12px",width:"100%",minHeight:"42px",borderRadius:"14px",fontWeight:800},errorBox:{marginTop:"12px",borderRadius:"12px",padding:"10px 12px",border:"1px solid rgba(180, 0, 0, 0.25)",background:"rgba(220, 0, 0, 0.05)",color:"rgba(120, 0, 0, 0.95)",fontSize:"12.5px",lineHeight:1.35},signedInTitle:{marginTop:"18px",textAlign:"center",fontSize:"13px",fontWeight:900,opacity:.9},connectedList:{marginTop:"12px",display:"flex",flexDirection:"column",gap:"10px",maxWidth:"640px",marginLeft:"auto",marginRight:"auto"},connectedCard:{borderRadius:"16px",border:"1px solid rgba(0,0,0,0.10)",background:"white",padding:"12px 14px",display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 1px 0 rgba(0,0,0,0.02)",transition:"background 120ms ease",":hover":{background:"rgba(0,0,0,0.015)"}},iconImg:{width:"40px",height:"40px",borderRadius:"14px",border:"1px solid rgba(0,0,0,0.10)",background:"white",padding:"8px",boxSizing:"border-box",flex:"0 0 auto"},cardMain:{flex:"1 1 auto",minWidth:0},hostLine:{fontSize:"14px",fontWeight:900,color:"rgba(17,24,39,0.95)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},nameLine:{marginTop:"3px",fontSize:"12.5px",opacity:.72,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},openBtn:{flex:"0 0 auto",minHeight:"36px",padding:"0 16px",borderRadius:"999px",fontWeight:800,fontSize:"13px",background:"rgba(37, 99, 235, 0.08)",color:"rgba(37, 99, 235, 0.95)",border:"1px solid rgba(37, 99, 235, 0.25)",boxShadow:"0 1px 0 rgba(0,0,0,0.02)"}}),Rr="sc:connectedWorkspaces";function Pr(e){var t=this,n=e.email,o=e.onSelect,a=Fr(),i=r.useState(""),c=i[0],s=i[1],u=r.useState(null),d=u[0],f=u[1],m=r.useState(!1),v=m[0],g=m[1],p=r.useState([]),h=p[0],b=p[1];r.useEffect(function(){zr(t,void 0,void 0,function(){var e,t;return Dr(this,function(n){switch(n.label){case 0:return[4,(0,l.wv)(Rr)];case 1:if(!(e=n.sent()))return[2];try{t=JSON.parse(e),Array.isArray(t)&&t.length>0&&b(t)}catch(e){}return[2]}})})},[]);var y=r.useCallback(function(e){return zr(t,void 0,void 0,function(){var t,n,r,a;return Dr(this,function(i){switch(i.label){case 0:if(f(null),t=function(e){var t=(e||"").trim();return t?t.replace(/^https?:\/\//i,"").split(/[\/?#]/)[0].trim().toLowerCase():""}(e),!t)return[2];g(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),n=function(e){return{workspaceId:e,name:e,host:e}}(t),o(n),r=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([n],h.filter(function(e){return e.workspaceId!==n.workspaceId}),!0).slice(0,10),b(r),[4,(0,l.Kg)(Rr,JSON.stringify(r))];case 2:return i.sent(),[3,5];case 3:return a=i.sent(),f(a instanceof Error?a.message:String(a)),[3,5];case 4:return g(!1),[7];case 5:return[2]}})})},[h,o]),w=function(){y(c.trim())};return r.createElement("div",{className:a.page},r.createElement("div",{className:a.shell},r.createElement("div",{className:a.brandRow},r.createElement("img",{src:"assets/SingleCaseFullLogo.svg",alt:"SingleCase",className:a.logo})),r.createElement("h1",{className:a.title},"Select your workspace"),r.createElement("p",{className:a.subtitle},"Signed in as ",n,". Enter your SingleCase workspace host."),r.createElement("div",{className:a.formBlock},r.createElement("div",{className:a.fieldLabel},"Workspace host"),r.createElement("div",{className:a.inputWrap},r.createElement(hr,{value:c,onChange:function(e,t){return s(t.value)},placeholder:"valfor-demo.singlecase.ch",appearance:"outline",className:a.input,onKeyDown:function(e){"Enter"===e.key&&!v&&c.trim().length>0&&w()}})),r.createElement(jr,{appearance:"primary",onClick:w,disabled:v||0===c.trim().length,className:a.continueBtn},v?"Checking...":"Continue"),d?r.createElement("div",{className:a.errorBox},d):null),h.length>0?r.createElement(r.Fragment,null,r.createElement("div",{className:a.signedInTitle},"Recent workspaces"),r.createElement("div",{className:a.connectedList},h.slice(0,2).map(function(e){return r.createElement("div",{key:e.workspaceId,className:a.connectedCard},r.createElement("img",{src:"assets/icon.svg",alt:"",className:a.iconImg}),r.createElement("div",{className:a.cardMain},r.createElement("div",{className:a.hostLine},e.host),r.createElement("div",{className:a.nameLine},e.name)),r.createElement(jr,{appearance:"secondary",onClick:function(){return o(e)},className:a.openBtn},"Open"))}))):null))}var Lr=n(64583).Promise,Mr=function(e,t,n,r){return new(n||(n=Lr))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},Hr=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function qr(e){return String(e).padStart(2,"0")}function Wr(e){return"".concat(e.getFullYear(),"-").concat(qr(e.getMonth()+1),"-").concat(qr(e.getDate()))}function Ur(e){var t=Math.max(0,Number(e||0));return{h:Math.floor(t/3600),m:Math.floor(t%3600/60)}}function Kr(e,t){return 3600*(Number.isFinite(e)?Math.max(0,Math.floor(e)):0)+60*(Number.isFinite(t)?Math.max(0,Math.floor(t)):0)}function $r(){var e=new Date;return{from:Wr(new Date(e.getFullYear(),e.getMonth(),1)),to:Wr(e)}}function Gr(e){var t,n,o,a=this,i=e.token,c=e.onBack,s=N(),l=s.email,u=s.error,d=((null==l?void 0:l.itemId)||(null==l?void 0:l.id)||"").toString(),f=((null==l?void 0:l.subject)||"").toString(),m=((null==l?void 0:l.conversationKey)||"").toString(),v=((null==l?void 0:l.fromEmail)||(null===(t=null==l?void 0:l.from)||void 0===t?void 0:t.email)||(null===(n=null==l?void 0:l.from)||void 0===n?void 0:n.emailAddress)||(null===(o=null==l?void 0:l.from)||void 0===o?void 0:o.address)||"").toString(),g=r.useState([]),p=g[0],b=g[1],y=r.useState({}),w=y[0],S=y[1],k=r.useState([]),x=k[0],I=k[1],C=r.useState("my"),E=C[0],B=C[1],O=r.useState(!1),T=O[0],A=O[1],j=r.useState(""),z=j[0],D=j[1],F=r.useState(""),R=F[0],P=F[1],L=r.useState(!1),M=L[0],H=L[1],q=r.useState([]),W=q[0],K=q[1],$=r.useState(null),G=$[0],V=$[1],J=r.useState(!1),X=J[0],Z=J[1],Q=r.useState(null),te=Q[0],ne=Q[1];r.useEffect(function(){var e=!0;return Mr(a,void 0,void 0,function(){var t,n,r,o,a,c,s,l,u;return Hr(this,function(d){switch(d.label){case 0:A(!0),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,Lr.all([Y(i,E),ee(i),re(i)])];case 2:if(t=d.sent(),n=t[0],r=t[1],o=t[2],!e)return[2];for(b(n),I(o),a={},c=0,s=r;c<s.length;c++)l=s[c],a[l.id]=l.name;return S(a),[3,5];case 3:return u=d.sent(),e?(V(u instanceof Error?u.message:String(u)),[3,5]):[2];case 4:return e&&A(!1),[7];case 5:return[2]}})}),function(){e=!1}},[i,E]);var oe=r.useMemo(function(){return"all"===E?p:p.filter(function(e){return!((t=((null==e?void 0:e.status)||"").toLowerCase())&&(t.includes("closed")||t.includes("uzav")||t.includes("archiv")||t.includes("done")));var t})},[p,E]);r.useEffect(function(){var e=!0;return Mr(a,void 0,void 0,function(){var t,n,r,o;return Hr(this,function(a){switch(a.label){case 0:if(!d)return[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Le(d)];case 2:return t=a.sent(),n=(null==t?void 0:t.caseId)?String(t.caseId):"",r=!n&&m?_(m):"",(o=n||r)&&e?(D(o),P(n?"attached":"thread"),[3,4]):[2];case 3:return a.sent(),[3,4];case 4:return[2]}})}),function(){e=!1}},[d,m]);var ae=r.useCallback(function(e){"attached"!==R&&"thread"!==R&&(D(e),P("suggested"))},[R]),le=U({enabled:!0,emailItemId:d,conversationKey:m,subject:f,bodySnippet:"",fromEmail:v,attachments:[],cases:oe,selectedCaseId:z,selectedSource:"suggested"===R?"suggested":"manual"===R?"manual":"",onAutoSelectCaseId:ae,topK:3}).suggestions;r.useEffect(function(){z&&(oe.some(function(e){return String(e.id)===String(z)})||"all"!==E&&B("all"))},[z,oe,E]),r.useEffect(function(){var e=!0;return z?(Mr(a,void 0,void 0,function(){var t,n,r,o,a;return Hr(this,function(c){switch(c.label){case 0:H(!0),V(null),c.label=1;case 1:return c.trys.push([1,3,4,5]),t=$r(),n=t.from,r=t.to,[4,ie(i,{projectId:z,from:n,to:r})];case 2:return o=c.sent(),e?(K(o),[3,5]):[2];case 3:return a=c.sent(),e?(V(a instanceof Error?a.message:String(a)),K([]),[3,5]):[2];case 4:return e&&H(!1),[7];case 5:return[2]}})}),function(){e=!1}):(K([]),function(){})},[i,z]);var ue=r.useMemo(function(){return{total:W.reduce(function(e,t){return e+Number(t.total_time||0)},0),billed:W.reduce(function(e,t){return e+Number(t.total_billed_time||0)},0)}},[W]),de=function(e){ne(e.id?String(e.id):null),Z(!0)},fe=Ur(ue.total),me=Ur(ue.billed);return r.createElement(h,null,r.createElement("div",{className:"ts-root"},r.createElement("div",{className:"ts-body"},r.createElement("div",{className:"ts-topbar"},r.createElement("button",{type:"button",className:"ts-back",onClick:c},"â€¹ Back"),r.createElement("div",{className:"ts-title"},"Timesheets"),r.createElement("div",{className:"ts-spacer"})),u?r.createElement("div",{className:"ts-error"},String(u)):null,r.createElement("div",{className:"ts-section"},r.createElement(ge,{title:"Case",scope:E,onScopeChange:function(e){return B(e)},selectedCaseId:z,onSelectCaseId:function(e){D(e),P("manual")},suggestions:le,cases:oe,isLoadingCases:T,clientNamesById:w}),"attached"===R?r.createElement("div",{className:"ts-muted",style:{marginTop:6}},"Case preselected from attached email"):null,"thread"===R?r.createElement("div",{className:"ts-muted",style:{marginTop:6}},"Case preselected from this email thread"):null),r.createElement("div",{className:"ts-summary"},r.createElement("div",{className:"ts-summary-left"},r.createElement("div",{className:"ts-summary-title"},"Vykazy"),r.createElement("div",{className:"ts-summary-sub"},"Total ",fe.h,"h ",qr(fe.m),"m Billed ",me.h,"h ",qr(me.m),"m"))),G?r.createElement("div",{className:"ts-error"},G):null,M?r.createElement("div",{className:"ts-muted"},"Loadingâ€¦"):null,r.createElement("div",{className:"ts-list"},W.map(function(e,t){var n=(e.date||"").slice(0,10),o=Ur(Number(e.total_time||0)),a=Ur(Number(e.total_billed_time||0)),i=(e.note||"").trim();return r.createElement("div",{key:e.id||"".concat(n,"-").concat(t),className:"ts-row",onClick:function(){return de(e)},role:"button",tabIndex:0,onKeyDown:function(t){"Enter"!==t.key&&" "!==t.key||de(e)}},r.createElement("div",{className:"ts-row-left"},r.createElement("div",{className:"ts-row-date"},n),r.createElement("div",{className:"ts-row-note"},i||"No note")),r.createElement("div",{className:"ts-row-right"},r.createElement("div",{className:"ts-row-time"},o.h,"h ",qr(o.m),"m"),Number(e.total_billed_time||0)!==Number(e.total_time||0)?r.createElement("div",{className:"ts-row-billed"},"Billed ",a.h,"h ",qr(a.m),"m"):null))}))),r.createElement("div",{className:"ts-footer"},r.createElement("button",{type:"button",className:"ts-primary",onClick:function(){ne(null),Z(!0)},disabled:!z},"Add timesheet")),X?r.createElement(Vr,{token:i,caseId:z,users:x,editingId:te,onClose:function(){Z(!1),ne(null)},onSave:function(e){return Mr(a,void 0,void 0,function(){var t,n,r,o;return Hr(this,function(a){switch(a.label){case 0:return z?te?[4,se(i,te,e)]:[3,2]:[2];case 1:return a.sent(),[3,4];case 2:return[4,ce(i,e)];case 3:a.sent(),a.label=4;case 4:return t=$r(),n=t.from,r=t.to,[4,ie(i,{projectId:z,from:n,to:r})];case 5:return o=a.sent(),K(o),Z(!1),ne(null),[2]}})})}}):null))}function Vr(e){var t=this,n=(e.token,e.caseId),o=e.users,a=e.editingId,i=e.onClose,c=e.onSave,s=r.useState(function(){return Wr(new Date)}),l=s[0],u=s[1],d=r.useState(0),f=d[0],m=d[1],v=r.useState(0),g=v[0],p=v[1],h=r.useState(!1),b=h[0],y=h[1],w=r.useState(0),S=w[0],k=w[1],x=r.useState(0),I=x[0],N=x[1],C=r.useState(""),E=C[0],B=C[1],O=r.useState(""),T=O[0],A=O[1];r.useEffect(function(){1===o.length&&A(o[0].id)},[o]);var j=r.useState(!1),_=j[0],z=j[1],D=r.useState(null),F=D[0],R=D[1];return r.createElement("div",{className:"ts-modal-overlay",role:"dialog","aria-modal":"true"},r.createElement("div",{className:"ts-modal"},r.createElement("div",{className:"ts-modal-header"},r.createElement("div",{className:"ts-modal-title"},a?"Edit timesheet":"Create timesheet"),r.createElement("button",{type:"button",className:"ts-x",onClick:i},"Ã—")),r.createElement("div",{className:"ts-modal-grid"},r.createElement("div",null,r.createElement("div",{className:"ts-label"},"User"),r.createElement("select",{className:"ts-select",value:T,onChange:function(e){return A(e.target.value)}},r.createElement("option",{value:""},"Select user"),o.map(function(e){return r.createElement("option",{key:e.id,value:e.id},function(e){var t="".concat((e.firstName||"").trim()," ").concat((e.lastName||"").trim()).trim();return t&&e.username?"".concat(t," (").concat(e.username,")"):t||e.username||"User ".concat(e.id)}(e))}))),r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Date"),r.createElement("input",{className:"ts-input",type:"date",value:l,onChange:function(e){return u(e.target.value)}})),r.createElement("div",{className:"ts-time-row"},r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Hours"),r.createElement("input",{className:"ts-input",type:"number",value:f,onChange:function(e){return m(Number(e.target.value))}})),r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Minutes"),r.createElement("input",{className:"ts-input",type:"number",value:g,onChange:function(e){return p(Number(e.target.value))}}))),r.createElement("label",{className:"ts-check"},r.createElement("input",{type:"checkbox",checked:b,onChange:function(e){return y(e.target.checked)}}),"Billable time is different"),b?r.createElement("div",{className:"ts-time-row"},r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Billed hours"),r.createElement("input",{className:"ts-input",type:"number",value:S,onChange:function(e){return k(Number(e.target.value))}})),r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Billed minutes"),r.createElement("input",{className:"ts-input",type:"number",value:I,onChange:function(e){return N(Number(e.target.value))}}))):null,r.createElement("div",{className:"ts-note"},r.createElement("div",{className:"ts-label"},"Details"),r.createElement("textarea",{className:"ts-textarea",value:E,onChange:function(e){return B(e.target.value)},placeholder:"Note"})),F?r.createElement("div",{className:"ts-error"},F):null),r.createElement("div",{className:"ts-modal-actions"},r.createElement("button",{type:"button",className:"ts-secondary",onClick:i,disabled:_},"Cancel"),r.createElement("button",{type:"button",className:"ts-primary",onClick:function(){return Mr(t,void 0,void 0,function(){var e,t,r,o;return Hr(this,function(a){switch(a.label){case 0:if(R(null),!n)return R("Select a case first."),[2];if(!T)return R("User is required."),[2];if(!l)return R("Date is required."),[2];if(g<0||g>59||I<0||I>59)return R("Minutes must be 0 to 59."),[2];if((e=Kr(f,g))<=0)return R("Time must be greater than 0."),[2];if((t=b?Kr(S,I):e)<0)return R("Billed time must be valid."),[2];r={user_id:Number(T),project_id:Number(n),date:"".concat(l," 00:00:00"),total_time:e,total_billed_time:t,sheet_activity_id:1,note:E||""},z(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,c(r)];case 2:return a.sent(),[3,5];case 3:return o=a.sent(),R(o instanceof Error?o.message:String(o)),[3,5];case 4:return z(!1),[7];case 5:return[2]}})})},disabled:_},_?"Savingâ€¦":"Save"))))}var Jr=function(){return Jr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Jr.apply(this,arguments)};function Xr(e){var t=e.isOpen,n=e.settings,o=e.onClose,a=e.onChange,i=e.onReset;if(r.useEffect(function(){if(t){var e=function(e){"Escape"===e.key&&o()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}},[t,o]),!t)return null;var c={display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},s={fontSize:12,opacity:.85,lineHeight:"1.3"},l={fontSize:12,opacity:.65,marginTop:4,lineHeight:"1.35"},u={width:18,height:18},d={borderRadius:12,border:"1px solid rgba(0,0,0,0.08)",padding:12};return r.createElement("div",{onClick:o,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.25)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:9999}},r.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{width:"100%",maxWidth:420,borderRadius:14,border:"1px solid rgba(0,0,0,0.10)",background:"rgba(255,255,255,0.98)",boxShadow:"0 10px 30px rgba(0,0,0,0.18)",padding:14}},r.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12}},r.createElement("div",{style:{fontWeight:600}},"Settings"),r.createElement("button",{onClick:o,style:{border:"none",background:"transparent",cursor:"pointer",fontSize:16,lineHeight:1,padding:6,opacity:.75},"aria-label":"Close",type:"button"},"Ã—")),r.createElement("div",{style:{marginTop:12,display:"flex",flexDirection:"column",gap:12}},r.createElement("div",{style:Jr(Jr({},d),{background:"rgba(17,24,39,0.02)"})},r.createElement("div",{style:c},r.createElement("div",null,r.createElement("div",{style:s},"Default case group"),r.createElement("div",{style:l},"Select which case group should be shown by default when opening the add-in.")),r.createElement("select",{style:{height:32,borderRadius:10,border:"1px solid rgba(0,0,0,0.12)",padding:"0 10px",background:"rgba(255,255,255,0.9)"},value:n.caseListScope,onChange:function(e){return a(Jr(Jr({},n),{caseListScope:e.target.value}))}},r.createElement("option",{value:"favourites"},"Favourites"),r.createElement("option",{value:"all"},"All")))),r.createElement("div",{style:d},r.createElement("div",{style:c},r.createElement("div",null,r.createElement("div",{style:s},"Auto suggest case from subject"),r.createElement("div",{style:l},"Preselect a case based on the email subject.")),r.createElement("input",{style:u,type:"checkbox",checked:n.autoSuggestCase,onChange:function(e){return a(Jr(Jr({},n),{autoSuggestCase:e.target.checked}))}})),r.createElement("div",{style:Jr({marginTop:10},c)},r.createElement("div",null,r.createElement("div",{style:s},"Remember last selected case"),r.createElement("div",{style:l},"Start with your last case when opening new emails.")),r.createElement("input",{style:u,type:"checkbox",checked:n.rememberLastCase,onChange:function(e){return a(Jr(Jr({},n),{rememberLastCase:e.target.checked}))}}))),r.createElement("div",{style:d},r.createElement("div",{style:c},r.createElement("div",null,r.createElement("div",{style:s},"Prevent duplicates"),r.createElement("div",{style:l},"Block sending if the same email was already attached to the same case.")),r.createElement("input",{style:u,type:"checkbox",checked:n.preventDuplicates,onChange:function(e){return a(Jr(Jr({},n),{preventDuplicates:e.target.checked}))}})),r.createElement("div",{style:Jr({marginTop:10},c)},r.createElement("div",null,r.createElement("div",{style:s},"Include body snippet"),r.createElement("div",{style:l},"Send a short plain text excerpt.")),r.createElement("input",{style:u,type:"checkbox",checked:n.includeBodySnippet,onChange:function(e){return a(Jr(Jr({},n),{includeBodySnippet:e.target.checked}))}})),r.createElement("div",{style:Jr({marginTop:10},c)},r.createElement("div",null,r.createElement("div",{style:s},"Include attachments"),r.createElement("div",{style:l},"Allow selecting attachments to send to SingleCase.")),r.createElement("input",{style:u,type:"checkbox",checked:n.includeAttachments,onChange:function(e){return a(Jr(Jr({},n),{includeAttachments:e.target.checked}))}}))),r.createElement("div",{style:{display:"flex",justifyContent:"space-between",gap:10}},e.onSignOut?r.createElement("button",{onClick:e.onSignOut,style:{height:34,borderRadius:10,border:"1px solid rgba(220,38,38,0.25)",padding:"0 12px",background:"rgba(220,38,38,0.06)",color:"rgb(153,27,27)",cursor:"pointer",fontWeight:600},type:"button"},"Sign out"):r.createElement("div",null),r.createElement("div",{style:{display:"flex",gap:10}},r.createElement("button",{onClick:i,style:{height:34,borderRadius:10,border:"1px solid rgba(0,0,0,0.12)",padding:"0 12px",background:"transparent",cursor:"pointer"},type:"button"},"Reset"),r.createElement("button",{onClick:o,style:{height:34,borderRadius:10,border:"none",padding:"0 12px",background:"#111827",color:"white",cursor:"pointer"},type:"button"},"Done"))))))}var Zr=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Yr=(0,i.n)({page:{display:"flex",flexDirection:"column",height:"100%",minHeight:0},header:{marginBottom:"10px"},title:{margin:0,fontSize:"18px",fontWeight:800,color:"rgba(17,24,39,0.92)"},subtitle:{margin:"4px 0 0 0",fontSize:"13px",color:"rgba(17,24,39,0.62)",lineHeight:1.35},actionsDock:{position:"fixed",left:0,right:0,bottom:"120px",padding:"10px 12px 12px",zIndex:20,backgroundColor:"rgba(255,255,255,0.92)",borderTop:"1px solid rgba(0,0,0,0.06)",backdropFilter:"blur(8px)"},chat:{flex:1,minHeight:0,overflowY:"auto",padding:"6px 0 120px 0",display:"flex",flexDirection:"column",gap:"10px"},bubble:{maxWidth:"92%",borderRadius:"16px",padding:"10px 12px",border:"1px solid rgba(0,0,0,0.08)",boxShadow:"0 10px 24px rgba(0,0,0,0.06)",fontSize:"13px",lineHeight:1.4,color:"rgba(17,24,39,0.92)",whiteSpace:"pre-wrap",wordBreak:"break-word"},bubbleAssistant:{alignSelf:"flex-start",backgroundColor:"rgba(255,255,255,0.92)"},bubbleUser:{alignSelf:"flex-end",backgroundColor:"rgba(0,32,74,0.06)"},pillsWrap:{paddingTop:"10px",display:"flex",flexWrap:"wrap",gap:"8px"},pill:{height:"34px",padding:"0 12px",borderRadius:"999px",border:"1px solid rgba(0,0,0,0.12)",backgroundColor:"rgba(255,255,255,0.92)",cursor:"pointer",fontSize:"12px",fontWeight:800,color:"rgba(17,24,39,0.86)",boxShadow:"0 10px 24px rgba(0,0,0,0.06)",transitionProperty:"transform, background-color, border-color",transitionDuration:"120ms",transitionTimingFunction:"ease",":hover":{backgroundColor:"rgba(255,255,255,1)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)",backgroundColor:"rgba(255,255,255,0.94)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.16), 0 10px 24px rgba(0,0,0,0.06)"}},footerHint:{marginTop:"10px",fontSize:"12px",color:"rgba(17,24,39,0.55)",lineHeight:1.35}});function Qr(){return"".concat(Date.now(),"_").concat(Math.random().toString(16).slice(2))}function eo(e){switch(e){case"add_timesheet":return"OK. This will create a timesheet entry.\n\nNext step: choose case, date, and duration (prototype only).";case"add_task":return"OK. This will create a task.\n\nNext step: pick case, assignee, due date (prototype only).";case"create_note":return"OK. This will create a note linked to the current case or email.\n\nNext step: enter the note text (prototype only).";case"summarise_email":return"OK. This will summarise the currently selected email.\n\nNext step: generate a short summary and key actions (prototype only).";default:return"OK."}}function to(e){var t=Yr(),n=r.useState([]),o=n[0],a=n[1],i=r.useRef(null);r.useEffect(function(){var e;0!==o.length&&(null===(e=i.current)||void 0===e||e.scrollIntoView({block:"end",behavior:"smooth"}))},[o.length]);var c=function(t){var n,r=function(e){switch(e){case"add_timesheet":return"Add timesheet";case"add_task":return"Add task";case"create_note":return"Create note";case"summarise_email":return"Summarise email";default:return"Action"}}(t);a(function(e){return Zr(Zr([],e,!0),[{id:Qr(),role:"user",text:r},{id:Qr(),role:"assistant",text:eo(t)}],!1)}),"add_timesheet"===t&&(null===(n=e.onOpenTab)||void 0===n||n.call(e,"timesheets"))};return r.createElement("div",{className:t.page},r.createElement("div",{className:t.header},r.createElement("p",{className:t.title},"Quick Actions")),r.createElement("div",{className:t.chat,role:"log","aria-label":"Quick actions chat"},o.length>0?o.map(function(e){return r.createElement("div",{key:e.id,className:[t.bubble,"assistant"===e.role?t.bubbleAssistant:t.bubbleUser].join(" ")},e.text)}):null,r.createElement("div",{ref:i})),r.createElement("div",{className:t.actionsDock},r.createElement("div",{className:t.pillsWrap,"aria-label":"Quick action options"},r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("add_timesheet")}},"Add timesheet"),r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("add_task")}},"Add task"),r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("create_note")}},"Create note"),r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("summarise_email")}},"Summarise email"))))}var no=n(64583).Promise,ro=function(e,t,n,r){return new(n||(n=no))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},oo=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},ao={autoSuggestCase:!0,caseListScope:"my",preventDuplicates:!0,includeBodySnippet:!1,rememberLastCase:!0,includeAttachments:!0},io=(0,i.n)({root:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"rgb(255, 255, 255)"},content:{flex:1,padding:"12px",paddingBottom:"".concat(86,"px"),minHeight:0},topRow:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px",minHeight:"48px"},logoCenterWrap:{position:"absolute",left:"50%",transform:"translateX(-50%)"},topLeft:{display:"flex",alignItems:"center",gap:"10px",minWidth:0},logoCenter:{position:"absolute",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},backBtn:{height:"40px",padding:"0 16px",borderRadius:"999px",border:"1px solid rgba(0,0,0,0.12)",backgroundColor:"rgba(255,255,255,0.92)",cursor:"pointer",fontSize:"14px",fontWeight:700,color:"rgba(17,24,39,0.92)",boxShadow:"0 10px 26px rgba(0,0,0,0.06)",transitionProperty:"transform, background-color, border-color",transitionDuration:"120ms",transitionTimingFunction:"ease",":hover":{backgroundColor:"rgba(255,255,255,1)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)",backgroundColor:"rgba(255,255,255,0.94)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.18), 0 10px 26px rgba(0,0,0,0.06)"}},brandLogo:{height:"38px",width:"auto",objectFit:"contain",userSelect:"none"},settingsBtn:{width:"44px",height:"44px",borderRadius:"14px",border:"1px solid rgba(0,0,0,0.10)",backgroundColor:"rgba(255,255,255,0.92)",display:"inline-flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 10px 26px rgba(0,0,0,0.06)",transitionProperty:"transform, background-color, border-color",transitionDuration:"120ms",transitionTimingFunction:"ease",padding:0,color:"#111827",":hover":{backgroundColor:"rgba(255,255,255,1)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)",backgroundColor:"rgba(255,255,255,0.94)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.18), 0 10px 26px rgba(0,0,0,0.06)"}},settingsIcon:{fontSize:"18px",lineHeight:1,opacity:.9,userSelect:"none"},bottomNavWrap:{position:"fixed",left:0,right:0,bottom:0,padding:"10px 12px 12px",zIndex:50,pointerEvents:"none"},bottomNav:{pointerEvents:"auto",maxWidth:"720px",marginLeft:"auto",marginRight:"auto",backgroundColor:"rgba(255,255,255,0.92)",border:"1px solid rgba(0,0,0,0.08)",borderRadius:"18px",boxShadow:"0 14px 34px rgba(0,0,0,0.12)",height:"".concat(74,"px"),display:"grid",gridTemplateColumns:"repeat(4, 1fr)",alignItems:"center",padding:"6px",gap:"6px"},navItem:{height:"100%",borderRadius:"14px",border:"1px solid transparent",background:"transparent",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px",padding:0,color:"rgba(17,24,39,0.65)",transitionProperty:"background-color, border-color, transform",transitionDuration:"120ms",transitionTimingFunction:"ease",":hover":{backgroundColor:"rgba(0,0,0,0.04)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.14)"}},navItemActive:{backgroundColor:"rgba(0,32,74,0.06)",color:"rgba(17,24,39,0.92)"},navIcon:{fontSize:"18px",lineHeight:1,userSelect:"none"},navLabel:{fontSize:"12px",fontWeight:700,lineHeight:1}});function co(e){var t=io(),n=[{id:"quick",icon:"âš¡",label:"Quick Actions"}];return r.createElement("div",{className:t.bottomNavWrap},r.createElement("div",{className:t.bottomNav,style:{gridTemplateColumns:"repeat(".concat(n.length,", 1fr)")}},n.map(function(n){var o=n.id===e.active;return r.createElement("button",{key:n.id,type:"button",className:[t.navItem,o?t.navItemActive:""].filter(Boolean).join(" "),onClick:function(){return e.onSelect(n.id)},"aria-current":o?"page":void 0},r.createElement("span",{className:t.navIcon,"aria-hidden":"true"},n.icon),r.createElement("span",{className:t.navLabel},n.label))})))}var so=function(e){var t=io(),n=r.useState(!1),o=n[0],a=n[1],i=r.useState(function(){return(0,Tt.xI)()}),c=i[0],s=i[1],d=r.useState(null),f=d[0],m=d[1],v=r.useState(!1),p=v[0],h=v[1],b=r.useState(function(){return function(e){try{var t=localStorage.getItem("sc_case_intake_settings:".concat(we()));if(!t)return e;var n=JSON.parse(t);return be(be({},e),n)}catch(t){return e}}(ao)}),y=b[0],w=b[1],S=r.useState(!1),k=S[0],x=S[1],I=r.useState("cases"),N=I[0],C=I[1],E=r.useState("home"),B=E[0],O=E[1],T=r.useRef(null);r.useEffect(function(){(0,Tt.i_)(),s((0,Tt.xI)())},[]),r.useEffect(function(){ro(void 0,void 0,void 0,function(){var e;return oo(this,function(t){switch(t.label){case 0:return e="b8115f370a53b1e35e83d93a18fe4ba820aafb3decf3139b29c149a6c464a2435495ebb11224b62f",[4,(0,l.Kg)(u.d.publicToken,e)];case 1:return t.sent(),(0,Tt.TV)(e,(0,Tt.xI)().email||"unknown@singlecase.local"),s((0,Tt.xI)()),[2]}})})},[]),r.useEffect(function(){ro(void 0,void 0,void 0,function(){var e,t;return oo(this,function(n){switch(n.label){case 0:return c.token?o?(m(null),O("home"),h(!0),[2]):[4,(0,l.wv)(u.d.workspaceId)]:(m(null),a(!1),O("home"),h(!0),[2]);case 1:return e=n.sent(),t=e&&e.length>0?e:null,m(t),O("home"),h(!0),[2]}})})},[c.token,o]);var A=function(){var e;try{null===(e=T.current)||void 0===e||e.close()}catch(e){}finally{T.current=null}},j=function(){return ro(void 0,void 0,void 0,function(){return oo(this,function(e){switch(e.label){case 0:return(0,Tt.q0)(),[4,(0,l.Kg)(u.d.onboardingDone,"false")];case 1:return e.sent(),[4,(0,l.Kg)(u.d.workspaceId,"")];case 2:return e.sent(),[4,(0,l.Kg)(u.d.workspaceName,"")];case 3:return e.sent(),[4,(0,l.Kg)(u.d.workspaceHost,"")];case 4:return e.sent(),[4,(0,l.Kg)(u.d.agreementAccepted,"false")];case 5:return e.sent(),s((0,Tt.xI)()),m(null),O("home"),h(!0),[2]}})})},_=Boolean(c.token)&&Boolean(f),z=_&&"app"===B;return p?r.createElement("div",{className:t.root},c.token?r.createElement(r.Fragment,null,r.createElement(Xr,{isOpen:k,settings:y,onClose:function(){return x(!1)},onChange:function(e){return w(e)},onReset:function(){return w(ao)},onSignOut:j}),r.createElement("div",{className:t.content},_?r.createElement("div",{className:t.topRow},r.createElement("div",{className:t.topLeft},z?r.createElement("button",{type:"button",className:t.backBtn,onClick:function(){return O("home")}},"â€¹ Back"):r.createElement("div",null)),r.createElement("div",{className:t.logoCenter},r.createElement("img",{src:"".concat(window.location.origin,"/assets/sc.png"),alt:"SingleCase",className:t.brandLogo})),r.createElement("button",{type:"button",className:t.settingsBtn,onClick:function(){return x(!0)},"aria-label":"NastavenÃ­",title:"NastavenÃ­"},r.createElement("span",{className:t.settingsIcon,"aria-hidden":"true"},"âš™"))):null,f?"home"===B?r.createElement(xn,{email:c.email,token:c.token,settings:y,onChangeSettings:w,onSignOut:j,onOpenTab:function(e){O("app"),C(e)}}):"timesheets"===N?r.createElement(Gr,{token:c.token,onBack:function(){return O("home")}}):"quick"===N?r.createElement(to,{onOpenTab:function(e){O("app"),C(e)}}):r.createElement(nt,{token:c.token,onBack:function(){return O("home")},onSignOut:j,settings:y,onChangeSettings:w}):r.createElement(Pr,{email:c.email,onSelect:function(e){return ro(void 0,void 0,void 0,function(){var t;return oo(this,function(n){switch(n.label){case 0:return[4,(0,l.Kg)(u.d.workspaceId,e.workspaceId)];case 1:return n.sent(),[4,(0,l.Kg)(u.d.workspaceName,e.name)];case 2:return n.sent(),[4,(0,l.Kg)(u.d.workspaceHost,e.host)];case 3:return n.sent(),m(e.workspaceId),a(!1),[4,(0,l.wv)(u.d.onboardingDone)];case 4:return t="true"===n.sent(),O(t?"app":"home"),[2]}})})}})),_?r.createElement(co,{active:N,onSelect:function(e){O("app"),C(e)}}):null):r.createElement(g,{title:e.title,onOpenLoginDialog:function(e){return ro(void 0,void 0,void 0,function(){var t,n,r,o,i,c,d;return oo(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),(null===(d=null===(c=null===Office||void 0===Office?void 0:Office.context)||void 0===c?void 0:c.ui)||void 0===d?void 0:d.displayDialogAsync)?[4,(0,l.wv)(u.d.publicToken)]:(console.warn("Office UI dialog API not ready yet."),[2]);case 1:return t=f.sent(),(n=(t||"").trim())?((r=new URLSearchParams).set("workspaceHost",e.workspaceHost),r.set("token",n),o="".concat(window.location.origin,"/dialog.html?").concat(r.toString()),Office.context.ui.displayDialogAsync(o,{height:70,width:45,displayInIframe:!1},function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var t=e.value;T.current=t,t.addEventHandler(Office.EventType.DialogMessageReceived,function(e){return ro(void 0,void 0,void 0,function(){var t;return oo(this,function(n){switch(n.label){case 0:if(!e||"string"!=typeof e.message)return[2];try{t=JSON.parse(e.message)}catch(e){return[2]}return"auth_cancel"===(null==t?void 0:t.type)?(A(),[2]):"auth_complete"!==(null==t?void 0:t.type)?[3,2]:[4,(r={token:String(t.token||""),email:String(t.email||""),agreed:Boolean(t.agreed),workspace:t.workspace?{workspaceId:String(t.workspace.workspaceId||""),name:String(t.workspace.name||""),host:String(t.workspace.host||"")}:void 0},ro(void 0,void 0,void 0,function(){var e;return oo(this,function(t){switch(t.label){case 0:return r.agreed?(x(!1),(0,Tt.TV)(r.token,r.email),[4,(0,l.Kg)(u.d.agreementAccepted,"true")]):[2];case 1:return t.sent(),(null===(e=r.workspace)||void 0===e?void 0:e.workspaceId)?[4,(0,l.Kg)(u.d.workspaceId,r.workspace.workspaceId)]:[3,6];case 2:return t.sent(),[4,(0,l.Kg)(u.d.workspaceName,r.workspace.name||"")];case 3:return t.sent(),[4,(0,l.Kg)(u.d.workspaceHost,r.workspace.host||"")];case 4:return t.sent(),m(r.workspace.workspaceId),a(!1),[4,(0,l.Kg)(u.d.onboardingDone,"false")];case 5:return t.sent(),O("home"),[3,11];case 6:return[4,(0,l.Kg)(u.d.onboardingDone,"false")];case 7:return t.sent(),[4,(0,l.Kg)(u.d.workspaceId,"")];case 8:return t.sent(),[4,(0,l.Kg)(u.d.workspaceName,"")];case 9:return t.sent(),[4,(0,l.Kg)(u.d.workspaceHost,"")];case 10:t.sent(),a(!0),m(null),O("home"),t.label=11;case 11:return s((0,Tt.xI)()),[2]}})}))];case 1:n.sent(),A(),n.label=2;case 2:return[2]}var r})})}),t.addEventHandler(Office.EventType.DialogEventReceived,function(){A()})}else console.error("displayDialogAsync failed",e.error)}),[3,3]):(console.error("Missing sc:publicToken in storage."),[2]);case 2:return i=f.sent(),console.error("Open dialog crashed",i),[3,3];case 3:return[2]}})})},onAuthCompleted:function(){}})):r.createElement("div",{className:t.root})};const lo=r.createContext(void 0),uo={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},fo=lo.Provider;function mo(){var e;return null!==(e=r.useContext(lo))&&void 0!==e?e:uo}const vo=r.createContext(void 0),go=vo.Provider,po=r.createContext(void 0).Provider,ho=r.createContext(void 0).Provider;function bo(e,t){var n;const r=e;var o;return Boolean((null==r||null===(n=r.ownerDocument)||void 0===n?void 0:n.defaultView)&&r instanceof r.ownerDocument.defaultView[null!==(o=null==t?void 0:t.constructorName)&&void 0!==o?o:"HTMLElement"])}var yo="undefined"!=typeof WeakRef,wo=class{constructor(e){yo&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let n;return this._weakRef?(n=null==(e=this._weakRef)?void 0:e.deref(),n||delete this._weakRef):(n=this._instance,(null==(t=null==n?void 0:n.isDisposed)?void 0:t.call(n))&&delete this._instance),n}},So="keyborg:focusin",ko=!1,xo=0,Io=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout(()=>{delete this._isMouseOrTouchUsedTimer},1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++xo,this._win=e;const n=e.document;if(t){const e=t.triggerKeys,n=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==n?void 0:n.length)&&(this._dismissKeys=new Set(n))}n.addEventListener(So,this._onFocusIn,!0),n.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),n.addEventListener("touchstart",this._onMouseOrTouch,!0),n.addEventListener("touchend",this._onMouseOrTouch,!0),n.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;ko||(ko=function(e){const t=e.HTMLElement,n=t.prototype.focus;let r=!1;return t.prototype.focus=function(){r=!0},e.document.createElement("button").focus(),t.prototype.focus=n,r}(t));const n=t.HTMLElement.prototype.focus;if(n.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=s;const r=new Set,o=e=>{const t=e.target;if(!t)return;const n=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(n)},a=e=>{const t=e.target;if(!t)return;let n=e.composedPath()[0];const c=new Set;for(;n;)n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(c.add(n),n=n.host):n=n.parentNode;for(const e of r){const t=e.deref();t&&c.has(t)||(r.delete(e),t&&(t.removeEventListener("focusin",a,!0),t.removeEventListener("focusout",o,!0)))}i(t,e.relatedTarget||void 0)},i=(e,t,n)=>{var i;const s=e.shadowRoot;if(s){for(const e of r)if(e.deref()===s)return;return s.addEventListener("focusin",a,!0),s.addEventListener("focusout",o,!0),void r.add(new wo(s))}const l={relatedTarget:t,originalEvent:n},u=new CustomEvent(So,{cancelable:!0,bubbles:!0,composed:!0,detail:l});u.details=l,(ko||c.lastFocusedProgrammatically)&&(l.isFocusedProgrammatically=e===(null==(i=c.lastFocusedProgrammatically)?void 0:i.deref()),c.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},c=t.__keyborgData={focusInHandler:a,focusOutHandler:o,shadowTargets:r};function s(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new wo(this)),n.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let l=t.document.activeElement;for(;l&&l.shadowRoot;)i(l),l=l.shadowRoot.activeElement;s.__keyborgNativeFocus=n}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,n=t.HTMLElement.prototype,r=n.focus.__keyborgNativeFocus,o=t.__keyborgData;if(o){t.document.removeEventListener("focusin",o.focusInHandler,!0),t.document.removeEventListener("focusout",o.focusOutHandler,!0);for(const e of o.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",o.focusInHandler,!0),t.removeEventListener("focusout",o.focusOutHandler,!0))}o.shadowTargets.clear(),delete t.__keyborgData}r&&(n.focus=r)}(e);const t=e.document;t.removeEventListener(So,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const n=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(n)for(const e of Object.keys(n))No.update(n[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const n=null==(t=this._win)?void 0:t.document.activeElement,r=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable);return r&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout(()=>{this._dismissTimer=void 0;const n=e.document.activeElement;t&&n&&t===n&&(this.isNavigatingWithKeyboard=!1)},500)}}},No=class e{constructor(e,t){this._cb=[],this._id="k"+ ++xo,this._win=e;const n=e.__keyborg;n?(this._core=n.core,n.refs[this._id]=this):(this._core=new Io(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,n){return new e(t,n)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach(e=>e(t))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const Co="data-fui-focus-visible";function Eo(e,t){if(Bo(e))return()=>{};const n={current:void 0},r=(o=t,No.create(o,void 0));var o;function a(e){r.isNavigatingWithKeyboard()&&bo(e)&&(n.current=e,e.setAttribute(Co,""))}function i(){n.current&&(n.current.removeAttribute(Co),n.current=void 0)}r.subscribe(e=>{e?a(t.document.activeElement):i()});const c=e=>{i(),a(e.composedPath()[0])},s=t=>{(!t.relatedTarget||bo(t.relatedTarget)&&!e.contains(t.relatedTarget))&&i()};return e.addEventListener(So,c),e.addEventListener("focusout",s),e.focusVisible=!0,e.contains(t.document.activeElement)&&a(t.document.activeElement),()=>{var t;i(),e.removeEventListener(So,c),e.removeEventListener("focusout",s),e.focusVisible=void 0,t=r,No.dispose(t)}}function Bo(e){return!!e&&(!!e.focusVisible||Bo(null==e?void 0:e.parentElement))}function Oo(e={}){const t=mo(),n=r.useRef(null);var o;const a=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return r.useEffect(()=>{if((null==a?void 0:a.defaultView)&&n.current)return Eo(n.current,a.defaultView)},[n,a]),n}function To(...e){const t=r.useCallback(n=>{t.current=n;for(const t of e)"function"==typeof t?t(n):t&&(t.current=n)},[...e]);return t}const Ao={current:0},jo=r.createContext(void 0);const _o=r.createContext(void 0);function zo(e="fui-",t){const n=null!==(c=r.useContext(jo))&&void 0!==c?c:Ao,a=r.useContext(_o)||"",i=o.useId;var c;if(i){const n=i(),o=r.useMemo(()=>n.replace(/:/g,""),[n]);return t||`${a}${e}${o}`}return r.useMemo(()=>t||`${a}${e}${++n.current}`,[a,e,t,n])}_o.Provider;const Do="fui-FluentProvider",Fo=vt({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),Ro=o.useInsertionEffect?o.useInsertionEffect:Gn,Po={},Lo={},Mo=(e,t)=>{const n=mo(),o=r.useContext(vo),a=Zn(),i=r.useContext(mr)||Po,{applyStylesToPortals:c=!0,customStyleHooks_unstable:s,dir:l=n.dir,targetDocument:u=n.targetDocument,theme:d,overrides_unstable:f={}}=e,m=Ho(o,d),v=Ho(a,f),g=Ho(i,s),p=(0,pt.J)();var h;const{styleTagId:b,rule:y}=(e=>{const{targetDocument:t,theme:n,rendererAttributes:o}=e,a=r.useRef(void 0),i=zo(Do),c=o,s=r.useMemo(()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce((e,n)=>`${e}--${n}: ${t[n]}; `,"")} }`:`${e} {}`}(`.${i}`,n),[n,i]);return function(e,t){r.useState(()=>{if(!e)return;const n=e.getElementById(t);n&&e.head.append(n)})}(t,i),Ro(()=>{const e=null==t?void 0:t.getElementById(i);return e?a.current=e:(a.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const n=e.createElement("style");return Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),e.head.appendChild(n),n})(t,{...c,id:i}),a.current&&((e,t)=>{const n=e.sheet;n&&(n.cssRules.length>0&&n.deleteRule(0),n.insertRule(t,0))})(a.current,s)),()=>{var e;null===(e=a.current)||void 0===e||e.remove()}},[i,t,s,c]),{styleTagId:i,rule:s}})({theme:m,targetDocument:u,rendererAttributes:null!==(h=p.styleElementAttributes)&&void 0!==h?h:Lo});return{applyStylesToPortals:c,customStyleHooks_unstable:g,dir:l,targetDocument:u,theme:m,overrides_unstable:v,themeClassName:b,components:{root:"div"},root:Wn(Sr("div",{...e,dir:l,ref:To(t,Oo({targetDocument:u}))}),{elementType:"div"}),serverStyleProps:{cssRule:y,attributes:{...p.styleElementAttributes,id:b}}}};function Ho(e,t){return e&&t?{...e,...t}:e||t}const qo=r.forwardRef((e,t)=>{const n=Mo(e,t);(e=>{const t=(0,pt.J)(),n=Fo({dir:e.dir,renderer:t});e.root.className=lt(Do,e.themeClassName,n.root,e.root.className)})(n);const o=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:n,dir:o,root:a,targetDocument:i,theme:c,themeClassName:s,overrides_unstable:l}=e,u=r.useMemo(()=>({dir:o,targetDocument:i}),[o,i]),[d]=r.useState(()=>({})),f=r.useMemo(()=>({textDirection:o}),[o]);return{customStyleHooks_unstable:n,overrides_unstable:l,provider:u,textDirection:o,iconDirection:f,tooltip:d,theme:c,themeClassName:t?a.className:s}}(n);return((e,t)=>or(fo,{value:t.provider,children:or(go,{value:t.theme,children:or(po,{value:t.themeClassName,children:or(gr,{value:t.customStyleHooks_unstable,children:or(ho,{value:t.tooltip,children:or(ht.e,{dir:t.textDirection,children:or(ft,{value:t.iconDirection,children:or(Xn,{value:t.overrides_unstable,children:ar(e.root,{children:[$n()?null:or("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(n,o)});qo.displayName="FluentProvider";const Wo="#242424",Uo="#424242",Ko="#616161",$o="#bdbdbd",Go="#e0e0e0",Vo="#e6e6e6",Jo="#ebebeb",Xo="#f0f0f0",Zo="#f5f5f5",Yo="#fafafa",Qo="rgba(255, 255, 255, 0.4)",ea="rgba(255, 255, 255, 0.5)",ta="rgba(0, 0, 0, 0.05)",na="rgba(0, 0, 0, 0.1)",ra="#ffffff",oa={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},aa={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},ia={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:aa,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},ca={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:oa,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},sa={cranberry:oa,green:aa,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},la={success:"green",warning:"orange",danger:"cranberry"},ua=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:ia[t].tint60,[`colorPalette${n}Background2`]:ia[t].tint40,[`colorPalette${n}Background3`]:ia[t].primary,[`colorPalette${n}Foreground1`]:ia[t].shade10,[`colorPalette${n}Foreground2`]:ia[t].shade30,[`colorPalette${n}Foreground3`]:ia[t].primary,[`colorPalette${n}BorderActive`]:ia[t].primary,[`colorPalette${n}Border1`]:ia[t].tint40,[`colorPalette${n}Border2`]:ia[t].primary};return Object.assign(e,r)},{});ua.colorPaletteYellowForeground1=ia.yellow.shade30,ua.colorPaletteRedForegroundInverted=ia.red.tint20,ua.colorPaletteGreenForegroundInverted=ia.green.tint20,ua.colorPaletteYellowForegroundInverted=ia.yellow.tint40;const da=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:ca[t].tint40,[`colorPalette${n}Foreground2`]:ca[t].shade30,[`colorPalette${n}BorderActive`]:ca[t].primary};return Object.assign(e,r)},{}),fa={...ua,...da},ma=Object.entries(la).reduce((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${r}Background1`]:sa[n].tint60,[`colorStatus${r}Background2`]:sa[n].tint40,[`colorStatus${r}Background3`]:sa[n].primary,[`colorStatus${r}Foreground1`]:sa[n].shade10,[`colorStatus${r}Foreground2`]:sa[n].shade30,[`colorStatus${r}Foreground3`]:sa[n].primary,[`colorStatus${r}ForegroundInverted`]:sa[n].tint30,[`colorStatus${r}BorderActive`]:sa[n].primary,[`colorStatus${r}Border1`]:sa[n].tint40,[`colorStatus${r}Border2`]:sa[n].primary};return Object.assign(e,o)},{});ma.colorStatusDangerBackground3Hover=sa[la.danger].shade10,ma.colorStatusDangerBackground3Pressed=sa[la.danger].shade20,ma.colorStatusWarningForeground1=sa[la.warning].shade20,ma.colorStatusWarningForeground3=sa[la.warning].shade20,ma.colorStatusWarningBorder2=sa[la.warning].shade20;const va={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},ga={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},pa={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},ha={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},ba={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},ya={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function wa(e,t,n=""){return{[`shadow2${n}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${n}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${n}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${n}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${n}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${n}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const Sa={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},ka={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},xa="10px",Ia="12px",Na="16px",Ca="20px",Ea="24px",Ba="32px",Oa={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:xa,spacingHorizontalM:Ia,spacingHorizontalL:Na,spacingHorizontalXL:Ca,spacingHorizontalXXL:Ea,spacingHorizontalXXXL:Ba},Ta={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:xa,spacingVerticalM:Ia,spacingVerticalL:Na,spacingVerticalXL:Ca,spacingVerticalXXL:Ea,spacingVerticalXXXL:Ba},Aa=(()=>{const e=(e=>({colorNeutralForeground1:Wo,colorNeutralForeground1Hover:Wo,colorNeutralForeground1Pressed:Wo,colorNeutralForeground1Selected:Wo,colorNeutralForeground2:Uo,colorNeutralForeground2Hover:Wo,colorNeutralForeground2Pressed:Wo,colorNeutralForeground2Selected:Wo,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:Ko,colorNeutralForeground3Hover:Uo,colorNeutralForeground3Pressed:Uo,colorNeutralForeground3Selected:Uo,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:$o,colorNeutralForegroundInvertedDisabled:Qo,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:Uo,colorNeutralForeground2LinkHover:Wo,colorNeutralForeground2LinkPressed:Wo,colorNeutralForeground2LinkSelected:Wo,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:Wo,colorNeutralForegroundStaticInverted:ra,colorNeutralForegroundInverted:ra,colorNeutralForegroundInvertedHover:ra,colorNeutralForegroundInvertedPressed:ra,colorNeutralForegroundInvertedSelected:ra,colorNeutralForegroundInverted2:ra,colorNeutralForegroundOnBrand:ra,colorNeutralForegroundInvertedLink:ra,colorNeutralForegroundInvertedLinkHover:ra,colorNeutralForegroundInvertedLinkPressed:ra,colorNeutralForegroundInvertedLinkSelected:ra,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:ra,colorNeutralBackground1Hover:Zo,colorNeutralBackground1Pressed:Go,colorNeutralBackground1Selected:Jo,colorNeutralBackground2:Yo,colorNeutralBackground2Hover:Xo,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:Vo,colorNeutralBackground3:Zo,colorNeutralBackground3Hover:Jo,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:Go,colorNeutralBackground4:Xo,colorNeutralBackground4Hover:Yo,colorNeutralBackground4Pressed:Zo,colorNeutralBackground4Selected:ra,colorNeutralBackground5:Jo,colorNeutralBackground5Hover:Zo,colorNeutralBackground5Pressed:Xo,colorNeutralBackground5Selected:Yo,colorNeutralBackground6:Vo,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:ea,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:Zo,colorSubtleBackgroundPressed:Go,colorSubtleBackgroundSelected:Jo,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:ea,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:na,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:Xo,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:Vo,colorNeutralStencil2:Yo,colorNeutralStencil1Alpha:na,colorNeutralStencil2Alpha:ta,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:ra,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:Yo,colorNeutralCardBackgroundHover:ra,colorNeutralCardBackgroundPressed:Zo,colorNeutralCardBackgroundSelected:Jo,colorNeutralCardBackgroundDisabled:Xo,colorNeutralStrokeAccessible:Ko,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:$o,colorNeutralStroke2:Go,colorNeutralStroke3:Xo,colorNeutralStrokeSubtle:Go,colorNeutralStrokeOnBrand:ra,colorNeutralStrokeOnBrand2:ra,colorNeutralStrokeOnBrand2Hover:ra,colorNeutralStrokeOnBrand2Pressed:ra,colorNeutralStrokeOnBrand2Selected:ra,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:Go,colorNeutralStrokeInvertedDisabled:Qo,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:ta,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:ra,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...va,...ga,...pa,...ba,...ha,...ya,...Oa,...Ta,...Sa,...ka,...e,...fa,...ma,...wa(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...wa(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})();var ja=n(64583).Promise,_a=function(e,t,n,r){return new(n||(n=ja))(function(o,a){function i(e){try{s(r.next(e))}catch(e){a(e)}}function c(e){try{s(r.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((r=r.apply(e,t||[])).next())})},za=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Da="sc:filedEmailsCache";function Fa(){return _a(this,void 0,void 0,function(){var e,t,n,r,o,a,i,c,s,u,d;return za(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,(0,l.wv)(Da)];case 1:return(e=f.sent())?(t=JSON.parse(String(e)),n=Object.entries(t),console.log("ðŸ“¦ Cache contains ".concat(n.length," entries:")),console.log("â”€".repeat(80)),r=n.map(function(e){var t=e[0],n=e[1];return{Key:t.substring(0,40)+(t.length>40?"...":""),Type:t.startsWith("subj:")?"Subject":"ConversationId",CaseId:n.caseId,DocumentId:n.documentId,Subject:n.subject,FiledAt:new Date(n.filedAt).toISOString()}}),console.table(r),console.log("\nðŸ“Š Statistics:"),o=n.filter(function(e){return!e[0].startsWith("subj:")}).length,a=n.filter(function(e){return e[0].startsWith("subj:")}).length,console.log("  - ConversationId entries: ".concat(o)),console.log("  - Subject entries: ".concat(a)),console.log("  - Total: ".concat(n.length)),console.log("\nðŸ’¡ Most recent entry:"),(i=n.sort(function(e,t){return t[1].filedAt-e[1].filedAt})).length>0&&(c=i[0],s=c[0],u=c[1],console.log("  - Key: ".concat(s)),console.log("  - Subject: ".concat(u.subject)),console.log("  - Filed: ".concat(new Date(u.filedAt).toISOString()))),console.log("\nðŸ“ Raw cache data:"),console.log(JSON.stringify(t,null,2)),[3,3]):(console.log("ðŸ“¦ Cache is EMPTY"),[2]);case 2:return d=f.sent(),console.error("âŒ Failed to read cache:",d),[3,3];case 3:return[2]}})})}function Ra(){var e,t,n,r,o,a,i,c,s,l;try{var u={host:null===(n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.diagnostics)||void 0===n?void 0:n.hostName,hostVersion:null===(a=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.diagnostics)||void 0===a?void 0:a.hostVersion,platform:null===(i=null===Office||void 0===Office?void 0:Office.context)||void 0===i?void 0:i.platform,officeVersion:null===(s=null===(c=null===Office||void 0===Office?void 0:Office.context)||void 0===c?void 0:c.diagnostics)||void 0===s?void 0:s.version,hasOfficeRuntime:"undefined"!=typeof OfficeRuntime,hasRoamingSettings:!!(null===(l=null===Office||void 0===Office?void 0:Office.context)||void 0===l?void 0:l.roamingSettings)};console.log("ðŸ–¥ï¸  Platform Information:"),console.log("â”€".repeat(80)),console.table(u)}catch(e){console.error("âŒ Failed to get platform info:",e)}}function Pa(){return _a(this,void 0,void 0,function(){var e,t;return za(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,l.S8)()];case 1:return(e=n.sent())?(console.log("ðŸ“„ Debug Log (persistent):"),console.log("â”€".repeat(80)),console.log(e),console.log("â”€".repeat(80)),console.log("Total size: ".concat(e.length," characters")),[3,3]):(console.log("ðŸ“„ Debug log is EMPTY"),[2]);case 2:return t=n.sent(),console.error("âŒ Failed to read debug log:",t),[3,3];case 3:return[2]}})})}function La(){return _a(this,void 0,void 0,function(){var e;return za(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,l.L1)()];case 1:return t.sent(),console.log("âœ… Debug log cleared"),[3,3];case 2:return e=t.sent(),console.error("âŒ Failed to clear debug log:",e),[3,3];case 3:return[2]}})})}function Ma(e){return _a(this,void 0,void 0,function(){var t,n,r,o,a,i;return za(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,(0,l.wv)(Da)];case 1:return(t=c.sent())?(n=JSON.parse(String(t)),r="subj:".concat(e.trim().toLowerCase()),console.log('ðŸ” Searching for subject: "'.concat(e,'"')),console.log('ðŸ”‘ Looking for key: "'.concat(r,'"')),(o=n[r])?(console.log("âœ… Found entry:"),console.table({CaseId:o.caseId,DocumentId:o.documentId,Subject:o.subject,FiledAt:new Date(o.filedAt).toISOString()})):(console.log("âŒ No entry found for this subject"),(a=Object.keys(n).filter(function(e){return e.startsWith("subj:")})).length>0&&(console.log("\nðŸ“ Available subject keys:"),a.forEach(function(e){var t=e.substring(5);console.log('  - "'.concat(t,'"'))}))),[3,3]):(console.log("ðŸ“¦ Cache is empty"),[2]);case 2:return i=c.sent(),console.error("âŒ Failed to search cache:",i),[3,3];case 3:return[2]}})})}var Ha=document.getElementById("container"),qa=Ha?(0,a.H)(Ha):void 0;Office.onReady(function(){"undefined"!=typeof window&&(window.scDebug={showCache:Fa,showPlatform:Ra,showDebugLog:Pa,clearDebugLog:La,searchBySubject:Ma,help:function(){console.log("ðŸ› ï¸  SingleCase Debug Commands:"),console.log("â”€".repeat(80)),console.log("scDebug.showCache()           - Show all cached filed emails"),console.log("scDebug.showPlatform()        - Show platform information"),console.log("scDebug.showDebugLog()        - Show persistent debug log"),console.log("scDebug.clearDebugLog()       - Clear debug log"),console.log("scDebug.searchBySubject('...')- Search cache by email subject"),console.log("scDebug.help()                - Show this help"),console.log("â”€".repeat(80))}},console.log("âœ… Debug commands installed! Type scDebug.help() for available commands")),null==qa||qa.render(r.createElement(qo,{theme:Aa},r.createElement(so,{title:"Contoso Task Pane Add-in"})))})},35137:function(e,t,n){function r(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}n.d(t,{A:function(){return r}})},39046:function(){},41114:function(e,t,n){n.d(t,{Ly:function(){return b},TV:function(){return y},i_:function(){return w},q0:function(){return S},xI:function(){return h}});var r=n(64583).Promise,o=function(e,t,n,o){return new(n||(n=r))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((o=o.apply(e,t||[])).next())})},a=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},i="singlecase_token",c="singlecase_user_email",s="singlecase_auth_issued_at",l="sc_token",u="sc_user_email",d="sc_auth_issued_at",f=288e5;function m(e){var t=(e||"").trim().toLowerCase();return t.length>0?t:"unknown@singlecase.local"}function v(e){return o(this,void 0,void 0,function(){var t,n,r;return a(this,function(o){switch(o.label){case 0:if("undefined"==typeof OfficeRuntime||!(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeRuntime.storage.getItem(e)];case 2:return"string"==typeof(n=o.sent())?[2,n]:[3,4];case 3:return t=o.sent(),console.warn("[rtGet] OfficeRuntime.storage.getItem failed:",t),[3,4];case 4:if(null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.roamingSettings)try{if("string"==typeof(n=Office.context.roamingSettings.get(e)))return[2,n]}catch(e){console.warn("[rtGet] roamingSettings.get failed:",e)}return[2,null]}})})}function g(e,t){return o(this,void 0,void 0,function(){var n,o,i;return a(this,function(a){switch(a.label){case 0:if("undefined"==typeof OfficeRuntime||!(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage))return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,OfficeRuntime.storage.setItem(e,t)];case 2:return a.sent(),console.log("[rtSet] Saved to OfficeRuntime.storage:",e),[2];case 3:return n=a.sent(),console.warn("[rtSet] OfficeRuntime.storage.setItem failed:",n),[3,4];case 4:if(!(null===(i=null===Office||void 0===Office?void 0:Office.context)||void 0===i?void 0:i.roamingSettings))return[3,8];a.label=5;case 5:return a.trys.push([5,7,,8]),Office.context.roamingSettings.set(e,t),[4,new r(function(t,n){Office.context.roamingSettings.saveAsync(function(r){var o;r.status===Office.AsyncResultStatus.Succeeded?(console.log("[rtSet] Saved to roamingSettings:",e),t()):(console.error("[rtSet] roamingSettings.saveAsync failed:",r.error),n(new Error((null===(o=r.error)||void 0===o?void 0:o.message)||"saveAsync failed")))})})];case 6:return a.sent(),[3,8];case 7:return o=a.sent(),console.error("[rtSet] roamingSettings failed:",o),[3,8];case 8:return[2]}})})}function p(e){return o(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,OfficeRuntime.storage.removeItem(e)];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})}function h(){var e=sessionStorage.getItem(i),t=sessionStorage.getItem(c),n=sessionStorage.getItem(s);return{token:e,email:m(t),issuedAt:n?Number(n):0}}function b(){return o(this,void 0,void 0,function(){var e,t,n,o;return a(this,function(a){switch(a.label){case 0:return[4,r.all([v(l),v(u),v(d)])];case 1:return e=a.sent(),t=e[0],n=e[1],o=e[2],[2,{token:t,email:m(n),issuedAt:o?Number(o):0}]}})})}function y(e,t){return o(this,void 0,void 0,function(){var n,o;return a(this,function(a){switch(a.label){case 0:return n=m(t),o=Date.now(),sessionStorage.setItem(i,e),sessionStorage.setItem(c,n),sessionStorage.setItem(s,String(o)),[4,r.all([g(l,e),g(u,n),g(d,String(o))])];case 1:return a.sent(),[2]}})})}function w(){var e=h(),t=e.token,n=e.issuedAt;if(t){var r=Date.now()-(n||0);(!n||r>f)&&S()}}function S(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return sessionStorage.removeItem(i),sessionStorage.removeItem(c),sessionStorage.removeItem(s),[4,r.all([p(l),p(u),p(d)])];case 1:return e.sent(),[2]}})})}},44363:function(e,t,n){n(22799)},44541:function(e,t,n){n.d(t,{n:function(){return lt}});var r=n(53864),o=n(35137);function a(e){return e.reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e[r]=n,e},{})}function i(e){return"number"==typeof e}function c(e,t){return-1!==e.indexOf(t)}function s(e,t,n,r){return t+(o=n,0===parseFloat(o)?o:"-"===o[0]?o.slice(1):"-"+o)+r;var o}function l(e){return e.replace(/ +/g," ").split(" ").map(function(e){return e.trim()}).filter(Boolean).reduce(function(e,t){var n=e.list,r=e.state,o=(t.match(/\(/g)||[]).length,a=(t.match(/\)/g)||[]).length;return r.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),r.parensDepth+=o-a,{list:n,state:r}},{list:[],state:{parensDepth:0}}).list}function u(e){var t=l(e);if(t.length<=3||t.length>4)return e;var n=t[0],r=t[1],o=t[2];return[n,t[3],o,r].join(" ")}var d={padding:function(e){var t=e.value;return i(t)?t:u(t)},textShadow:function(e){return function(e){for(var t=[],n=0,r=0,o=!1;r<e.length;)o||","!==e[r]?"("===e[r]?(o=!0,r++):")"===e[r]?(o=!1,r++):r++:(t.push(e.substring(n,r).trim()),n=++r);return n!=r&&t.push(e.substring(n,r+1)),t}(e.value).map(function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,function(e,t,n,r){return"0"===r?e:t+(""===n?"-":"")+r})}).join(",")},borderColor:function(e){return u(e.value)},borderRadius:function(e){var t=e.value;if(i(t))return t;if(c(t,"/")){var n=t.split("/"),r=n[0],o=n[1];return d.borderRadius({value:r.trim()})+" / "+d.borderRadius({value:o.trim()})}var a=l(t);switch(a.length){case 2:return a.reverse().join(" ");case 4:var s=a[0],u=a[1],f=a[2];return[u,s,a[3],f].join(" ");default:return t}},background:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgImgDirectionRegex,a=e.bgPosDirectionRegex;if(i(t))return t;var c=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(c,d.backgroundPosition({value:c,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:a})),d.backgroundImage({value:t,valuesToConvert:n,bgImgDirectionRegex:o})},backgroundImage:function(e){var t=e.value,n=e.valuesToConvert,r=e.bgImgDirectionRegex;return c(t,"url(")||c(t,"linear-gradient(")?t.replace(r,function(e,t,r){return e.replace(r,n[r])}):t},backgroundPosition:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return t.replace(r?/^((-|\d|\.)+%)/:null,function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var n=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(n)+"%"}return e}(t)}).replace(o,function(e){return n[e]})},backgroundPositionX:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return i(t)?t:d.backgroundPosition({value:t,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:o})},transition:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){var t=e.split(" ");return t[0]=n[t[0]]||t[0],t.join(" ")}).join(", ")},transitionProperty:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){return n[e]||e}).join(", ")},transform:function(e){var t=e.value,n="[^\\u0020-\\u007e]",r="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",o="((?:-?(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|-?(?:[_a-z]|"+n+"|"+r+")(?:[_a-z0-9-]|"+n+"|"+r+")*)?)|(?:inherit|auto))",a=new RegExp("(translateX\\s*\\(\\s*)"+o+"(\\s*\\))","gi"),i=new RegExp("(translate\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,1}\\s*\\))","gi"),c=new RegExp("(translate3d\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,2}\\s*\\))","gi"),l=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+o+"(\\s*\\))","gi");return t.replace(a,s).replace(i,s).replace(c,s).replace(l,s)}};d.objectPosition=d.backgroundPosition,d.margin=d.padding,d.borderWidth=d.padding,d.boxShadow=d.textShadow,d.webkitBoxShadow=d.boxShadow,d.mozBoxShadow=d.boxShadow,d.WebkitBoxShadow=d.boxShadow,d.MozBoxShadow=d.boxShadow,d.borderStyle=d.borderColor,d.webkitTransform=d.transform,d.mozTransform=d.transform,d.WebkitTransform=d.transform,d.MozTransform=d.transform,d.transformOrigin=d.backgroundPosition,d.webkitTransformOrigin=d.transformOrigin,d.mozTransformOrigin=d.transformOrigin,d.WebkitTransformOrigin=d.transformOrigin,d.MozTransformOrigin=d.transformOrigin,d.webkitTransition=d.transition,d.mozTransition=d.transition,d.WebkitTransition=d.transition,d.MozTransition=d.transition,d.webkitTransitionProperty=d.transitionProperty,d.mozTransitionProperty=d.transitionProperty,d.WebkitTransitionProperty=d.transitionProperty,d.MozTransitionProperty=d.transitionProperty,d["text-shadow"]=d.textShadow,d["border-color"]=d.borderColor,d["border-radius"]=d.borderRadius,d["background-image"]=d.backgroundImage,d["background-position"]=d.backgroundPosition,d["background-position-x"]=d.backgroundPositionX,d["object-position"]=d.objectPosition,d["border-width"]=d.padding,d["box-shadow"]=d.textShadow,d["-webkit-box-shadow"]=d.textShadow,d["-moz-box-shadow"]=d.textShadow,d["border-style"]=d.borderColor,d["-webkit-transform"]=d.transform,d["-moz-transform"]=d.transform,d["transform-origin"]=d.transformOrigin,d["-webkit-transform-origin"]=d.transformOrigin,d["-moz-transform-origin"]=d.transformOrigin,d["-webkit-transition"]=d.transition,d["-moz-transition"]=d.transition,d["transition-property"]=d.transitionProperty,d["-webkit-transition-property"]=d.transitionProperty,d["-moz-transition-property"]=d.transitionProperty;var f=a([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),m=["content"],v=a([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),g=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),p=new RegExp("(left)|(right)");function h(e){return Object.keys(e).reduce(function(t,n){var r=e[n];if("string"==typeof r&&(r=r.trim()),c(m,n))return t[n]=r,t;var o=b(n,r),a=o.key,i=o.value;return t[a]=i,t},Array.isArray(e)?[]:{})}function b(e,t){var n,r=/\/\*\s?@noflip\s?\*\//.test(t),o=r?e:f[n=e]||n,a=r?t:function(e,t){if(!function(e){return!("boolean"==typeof e||function(e){return null==e}(e))}(t))return t;if((n=t)&&"object"==typeof n)return h(t);var n,r,o=i(t),a=function(e){return"function"==typeof e}(t),c=o||a?t:t.replace(/ !important.*?$/,""),s=!o&&c.length!==t.length,l=d[e];return r=l?l({value:c,valuesToConvert:v,propertiesToConvert:f,isRtl:!0,bgImgDirectionRegex:g,bgPosDirectionRegex:p}):v[c]||c,s?r+" !important":r}(o,t);return{key:o,value:a}}var y=n(45614);const w=/[A-Z]/g,S=/^ms-/,k={};function x(e){return"-"+e.toLowerCase()}function I(e){if(Object.prototype.hasOwnProperty.call(k,e))return k[e];if("--"===e.substr(0,2))return e;const t=e.replace(w,x);return k[e]=S.test(t)?"-"+t:t}function N(e){return"&"===e.charAt(0)?e.slice(1):e}var C="-moz-",E="-webkit-",B="comm",O="rule",T="decl",A="@import",j="@namespace",_="@keyframes",z="@layer",D=Math.abs,F=String.fromCharCode,R=Object.assign;function P(e){return e.trim()}function L(e,t){return(e=t.exec(e))?e[0]:e}function M(e,t,n){return e.replace(t,n)}function H(e,t,n){return e.indexOf(t,n)}function q(e,t){return 0|e.charCodeAt(t)}function W(e,t,n){return e.slice(t,n)}function U(e){return e.length}function K(e){return e.length}function $(e,t){return t.push(e),e}function G(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function V(e,t,n,r){switch(e.type){case z:if(e.children.length)break;case A:case j:case T:return e.return=e.return||e.value;case B:return"";case _:return e.return=e.value+"{"+G(e.children,r)+"}";case O:if(!U(e.value=e.props.join(",")))return""}return U(n=G(e.children,r))?e.return=e.value+"{"+n+"}":""}var J=1,X=1,Z=0,Y=0,Q=0,ee="";function te(e,t,n,r,o,a,i,c){return{value:e,root:t,parent:n,type:r,props:o,children:a,line:J,column:X,length:i,return:"",siblings:c}}function ne(e,t){return R(te("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function re(){return Q=Y>0?q(ee,--Y):0,X--,10===Q&&(X=1,J--),Q}function oe(){return Q=Y<Z?q(ee,Y++):0,X++,10===Q&&(X=1,J++),Q}function ae(){return q(ee,Y)}function ie(){return Y}function ce(e,t){return W(ee,e,t)}function se(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function le(e){return J=X=1,Z=U(ee=e),Y=0,[]}function ue(e){return ee="",e}function de(e){return P(ce(Y-1,ve(91===e?e+2:40===e?e+1:e)))}function fe(e){for(;(Q=ae())&&Q<33;)oe();return se(e)>2||se(Q)>3?"":" "}function me(e,t){for(;--t&&oe()&&!(Q<48||Q>102||Q>57&&Q<65||Q>70&&Q<97););return ce(e,ie()+(t<6&&32==ae()&&32==oe()))}function ve(e){for(;oe();)switch(Q){case e:return Y;case 34:case 39:34!==e&&39!==e&&ve(Q);break;case 40:41===e&&ve(e);break;case 92:oe()}return Y}function ge(e,t){for(;oe()&&e+Q!==57&&(e+Q!==84||47!==ae()););return"/*"+ce(t,Y-1)+"*"+F(47===e?e:oe())}function pe(e){for(;!se(ae());)oe();return ce(e,Y)}function he(e){return ue(be("",null,null,null,[""],e=le(e),0,[0],e))}function be(e,t,n,r,o,a,i,c,s){for(var l=0,u=0,d=i,f=0,m=0,v=0,g=1,p=1,h=1,b=0,y="",w=o,S=a,k=r,x=y;p;)switch(v=b,b=oe()){case 40:if(108!=v&&58==q(x,d-1)){-1!=H(x+=M(de(b),"&","&\f"),"&\f",D(l?c[l-1]:0))&&(h=-1);break}case 34:case 39:case 91:x+=de(b);break;case 9:case 10:case 13:case 32:x+=fe(v);break;case 92:x+=me(ie()-1,7);continue;case 47:switch(ae()){case 42:case 47:$(we(ge(oe(),ie()),t,n,s),s),5!=se(v||1)&&5!=se(ae()||1)||!U(x)||" "===W(x,-1,void 0)||(x+=" ");break;default:x+="/"}break;case 123*g:c[l++]=U(x)*h;case 125*g:case 59:case 0:switch(b){case 0:case 125:p=0;case 59+u:-1==h&&(x=M(x,/\f/g,"")),m>0&&(U(x)-d||0===g&&47===v)&&$(m>32?Se(x+";",r,n,d-1,s):Se(M(x," ","")+";",r,n,d-2,s),s);break;case 59:x+=";";default:if($(k=ye(x,t,n,l,u,o,c,y,w=[],S=[],d,a),a),123===b)if(0===u)be(x,t,k,k,w,a,d,c,S);else{switch(f){case 99:if(110===q(x,3))break;case 108:if(97===q(x,2))break;default:u=0;case 100:case 109:case 115:}u?be(e,k,k,r&&$(ye(e,k,k,0,0,o,c,y,o,w=[],d,S),S),o,S,d,c,r?w:S):be(x,k,k,k,[""],S,0,c,S)}}l=u=m=0,g=h=1,y=x="",d=i;break;case 58:d=1+U(x),m=v;default:if(g<1)if(123==b)--g;else if(125==b&&0==g++&&125==re())continue;switch(x+=F(b),b*g){case 38:h=u>0?1:(x+="\f",-1);break;case 44:c[l++]=(U(x)-1)*h,h=1;break;case 64:45===ae()&&(x+=de(oe())),f=ae(),u=d=U(y=x+=pe(ie())),b++;break;case 45:45===v&&2==U(x)&&(g=0)}}return a}function ye(e,t,n,r,o,a,i,c,s,l,u,d){for(var f=o-1,m=0===o?a:[""],v=K(m),g=0,p=0,h=0;g<r;++g)for(var b=0,y=W(e,f+1,f=D(p=i[g])),w=e;b<v;++b)(w=P(p>0?m[b]+" "+y:M(y,/&\f/g,m[b])))&&(s[h++]=w);return te(e,t,n,0===o?O:c,s,l,u,d)}function we(e,t,n,r){return te(e,t,n,B,F(Q),W(e,2,-2),0,r)}function Se(e,t,n,r,o){return te(e,t,n,T,W(e,0,r),W(e,r+1,-1),r,o)}function ke(e){var t=K(e);return function(n,r,o,a){for(var i="",c=0;c<t;c++)i+=e[c](n,r,o,a)||"";return i}}function xe(e){return function(t){t.root||(t=t.return)&&e(t)}}const Ie=e=>{if(e.type===O){if("string"==typeof e.props)return;e.props=e.props.map(e=>-1===e.indexOf(":global(")?e:function(e){return ue(function(e){for(;oe();)switch(se(Q)){case 0:$(pe(Y-1),e);break;case 2:$(de(Q),e);break;default:$(F(Q),e)}return e}(le(e)))}(e).reduce((e,t,n,r)=>{if(""===t)return e;if(":"===t&&"global"===r[n+1]){const t=r[n+2].slice(1,-1)+" ";return e.unshift(t),r[n+1]="",r[n+2]="",e}return e.push(t),e},[]).join(""))}};function Ne(e,t,n){switch(function(e,t){return 45^q(e,0)?(((t<<2^q(e,0))<<2^q(e,1))<<2^q(e,2))<<2^q(e,3):0}(e,t)){case 5103:return E+"print-"+e+e;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return E+e+e;case 4215:if(102===q(e,9))return E+e+e;if(116===q(e,t+1))return E+e+e;break;case 4789:return C+e+e;case 5349:case 4246:case 6968:return E+e+C+e+e;case 6187:if(!L(e,/grab/))return M(M(M(e,/(zoom-|grab)/,E+"$1"),/(image-set)/,E+"$1"),e,"")+e;case 5495:case 3959:return M(e,/(image-set\([^]*)/,E+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return M(e,/(.+)-inline(.+)/,E+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(U(e)-1-t>6)switch(q(e,t+1)){case 102:if(108===q(e,t+3))return M(e,/(.+:)(.+)-([^]+)/,"$1"+E+"$2-$3$1"+C+(108==q(e,t+3)?"$3":"$2-$3"))+e;case 115:return~H(e,"stretch")?Ne(M(e,"stretch","fill-available"),t)+e:e}}return e}function Ce(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case T:return void(e.return=Ne(e.value,e.length));case O:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(L(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return G([ne(e,{props:[M(t,/:(read-\w+)/,":"+C+"$1")]})],r);case"::placeholder":return G([ne(e,{props:[M(t,/:(plac\w+)/,":"+E+"input-$1")]}),ne(e,{props:[M(t,/:(plac\w+)/,":"+C+"$1")]})],r)}return""})}}const Ee=e=>{(function(e){switch(e.type){case"@container":case"@media":case"@supports":case z:return!0}return!1})(e)&&Array.isArray(e.children)&&e.children.sort((e,t)=>e.props[0]>t.props[0]?1:-1)};const Be=/,( *[^ &])/g;function Oe(e,t,n){let r=t;return n.length>0&&(r=n.reduceRight((e,t)=>{return`${n=t,"&"+N(n.replace(Be,",&$1"))} { ${e} }`;var n},t)),`${e}{${r}}`}function Te(e,t){const{className:n,selectors:r,property:o,rtlClassName:a,rtlProperty:i,rtlValue:c,value:s}=e,{container:l,layer:u,media:d,supports:f}=t;let m=Oe(`.${n}`,Array.isArray(s)?`${s.map(e=>`${I(o)}: ${e}`).join(";")};`:`${I(o)}: ${s};`,r);return i&&a&&(m+=Oe(`.${a}`,Array.isArray(c)?`${c.map(e=>`${I(i)}: ${e}`).join(";")};`:`${I(i)}: ${c};`,r)),d&&(m=`@media ${d} { ${m} }`),u&&(m=`@layer ${u} { ${m} }`),f&&(m=`@supports ${f} { ${m} }`),l&&(m=`@container ${l} { ${m} }`),function(e){const t=[];return G(he(e),ke([Ie,Ee,Ce,V,xe(e=>t.push(e))])),t}(m)}function Ae(e){let t="";for(const n in e){const r=e[n];if("string"!=typeof r&&"number"!=typeof r){if(Array.isArray(r))for(const e of r)t+=I(n)+":"+e+";"}else t+=I(n)+":"+r+";"}return t}function je(e){let t="";for(const n in e)t+=`${n}{${Ae(e[n])}}`;return t}function _e(e,t){const n=[];return G(he(`@keyframes ${e} {${t}}`),ke([V,Ce,xe(e=>n.push(e))])),n}const ze={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]};function De(e,t){return 0===e.length?t:`${e} and ${t}`}function Fe(e){return"@media"===e.substr(0,6)}function Re(e){return"@layer"===e.substr(0,6)}const Pe=/^(:|\[|>|&)/;function Le(e){return Pe.test(e)}function Me(e){return"@supports"===e.substr(0,9)}function He(e){return"@container"===e.substring(0,10)}function qe(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}const We={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function Ue(e,t){if(t.media)return"m";if(t.layer||t.supports)return"t";if(t.container)return"c";if(e.length>0){const t=e[0].trim();if(58===t.charCodeAt(0))return We[t.slice(4,8)]||We[t.slice(3,5)]||"d"}return"d"}function Ke(e,t){return e?t+e:e}function $e(e){return Ke(e.container,"c")+Ke(e.media,"m")+Ke(e.layer,"l")+Ke(e.supports,"s")}function Ge(e,t,n){const r=e+$e(n)+t,a=(0,o.A)(r),i=a.charCodeAt(0);return i>=48&&i<=57?String.fromCharCode(i+17)+a.slice(1):a}function Ve({property:e,selector:t,salt:n,value:r},a){return y.aN+(0,o.A)(n+t+$e(a)+e+r.trim())}function Je(e){return e===y.Ut}function Xe(e){return e.replace(/>\s+/g,">")}function Ze(e,t){}function Ye(e,t){}function Qe(e){return ze[e]}function et(e){var t;return null!==(t=null==e?void 0:e[0])&&void 0!==t?t:0}function tt(e,t,n,r){e[t]=r?[n,r]:n}function nt(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function rt(e,t,n,r,o,a){var i;const c=[];0!==a&&c.push(["p",a]),"m"===t&&o&&c.push(["m",o]),null!==(i=e[t])&&void 0!==i||(e[t]=[]),n&&e[t].push(nt(n,c)),r&&e[t].push(nt(r,c))}function ot(e,t="",n=[],r={container:"",layer:"",media:"",supports:""},a={},i={},c){for(const s in e){if(y.qw.hasOwnProperty(s)){Ye(0,e[s]);continue}const l=e[s];if(null!=l){if(Je(l)){tt(a,Ge(Xe(n.join("")),s,r),0,void 0);continue}if("string"==typeof l||"number"==typeof l){const e=Xe(n.join("")),o=Qe(s);if(o){const e=o[1],c=Object.fromEntries(e.map(e=>[e,y.Ut]));ot(c,t,n,r,a,i)}const u=Ge(e,s,r),d=Ve({value:l.toString(),salt:t,selector:e,property:s},r),f=c&&{key:s,value:c}||b(s,l),m=f.key!==s||f.value!==l,v=m?Ve({value:f.value.toString(),property:f.key,salt:t,selector:e},r):void 0,g=m?{rtlClassName:v,rtlProperty:f.key,rtlValue:f.value}:void 0,p=Ue(n,r),[h,w]=Te(Object.assign({className:d,selectors:n,property:s,value:l},g),r);tt(a,u,d,v),rt(i,p,h,w,r.media,et(o))}else if("animationName"===s){const e=Array.isArray(l)?l:[l],c=[],s=[];for(const t of e){const e=je(t),n=je(h(t)),a=y.aN+(0,o.A)(e);let l;const u=_e(a,e);let d=[];e===n?l=a:(l=y.aN+(0,o.A)(n),d=_e(l,n));for(let e=0;e<u.length;e++)rt(i,"k",u[e],d[e],r.media,0);c.push(a),s.push(l)}ot({animationName:c.join(", ")},t,n,r,a,i,s.join(", "))}else if(Array.isArray(l)){if(0===l.length)continue;const e=Xe(n.join("")),o=Qe(s);if(o){const e=o[1],c=Object.fromEntries(e.map(e=>[e,y.Ut]));ot(c,t,n,r,a,i)}const c=Ge(e,s,r),u=Ve({value:l.map(e=>(null!=e?e:"").toString()).join(";"),salt:t,selector:e,property:s},r),d=l.map(e=>b(s,e));if(d.some(e=>e.key!==d[0].key))continue;const f=d[0].key!==s||d.some((e,t)=>e.value!==l[t]),m=f?Ve({value:d.map(e=>{var t;return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").toString()}).join(";"),salt:t,property:d[0].key,selector:e},r):void 0,v=f?{rtlClassName:m,rtlProperty:d[0].key,rtlValue:d.map(e=>e.value)}:void 0,g=Ue(n,r),[p,h]=Te(Object.assign({className:u,selectors:n,property:s,value:l},v),r);tt(a,c,u,m),rt(i,g,p,h,r.media,et(o))}else if(qe(l))if(Le(s))ot(l,t,n.concat(N(s)),r,a,i);else if(Fe(s)){const e=De(r.media,s.slice(6).trim());ot(l,t,n,Object.assign({},r,{media:e}),a,i)}else if(Re(s)){const e=(r.layer?`${r.layer}.`:"")+s.slice(6).trim();ot(l,t,n,Object.assign({},r,{layer:e}),a,i)}else if(Me(s)){const e=De(r.supports,s.slice(9).trim());ot(l,t,n,Object.assign({},r,{supports:e}),a,i)}else if(He(s)){const e=s.slice(10).trim();ot(l,t,n,Object.assign({},r,{container:e}),a,i)}else Ze()}}return[a,i]}var at=n(87294);var it=n(49264),ct=n(26312),st=n(56004);function lt(e){const t=function(e,t=r.A){const n=t();let o=null,a=null,i=null,c=null;return function(t){const{dir:r,renderer:s}=t;null===o&&([o,a]=function(e,t=""){const n={},r={};for(const o in e){const a=e[o],[i,c]=ot(a,t);n[o]=i,Object.keys(c).forEach(e=>{r[e]=(r[e]||[]).concat(c[e])})}return[n,r]}(e,s.classNameHashSalt));const l="ltr"===r;return l?null===i&&(i=(0,at.N)(o,r)):null===c&&(c=(0,at.N)(o,r)),n(s,a),l?i:c}}(e,it.A);return function(){const e=(0,st.m)(),n=(0,ct.J)();return t({dir:e,renderer:n})}}},45614:function(e,t,n){n.d(t,{AX:function(){return v},EJ:function(){return s},FS:function(){return m},Ut:function(){return p},aN:function(){return l},ed:function(){return c},ez:function(){return u},fj:function(){return d},k1:function(){return i},qw:function(){return g},wn:function(){return f}});const r="undefined"==typeof window?n.g:window,o="@griffel/";function a(e,t){return r[Symbol.for(o+e)]||(r[Symbol.for(o+e)]=t),r[Symbol.for(o+e)]}const i=a("DEFINITION_LOOKUP_TABLE",{}),c="data-make-styles-bucket",s="data-priority",l="f",u=7,d="___",f=d.length+u,m=0,v=1,g={all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1},p="DO_NOT_USE_DIRECTLY: @griffel/reset-value"},49264:function(e,t,n){n.d(t,{A:function(){return i}});var r=n(96540),o=n.t(r,2);const a=o.useInsertionEffect?o.useInsertionEffect:void 0,i=()=>{const e={};return function(t,n){a&&"undefined"!=typeof window&&window.document&&window.document.createElement?a(()=>{t.insertCSSRules(n)},[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}}},50134:function(e,t,n){n.d(t,{Kg:function(){return v},L1:function(){return l},Ox:function(){return g},S8:function(){return s},wv:function(){return m}});var r=n(64583).Promise,o=function(e,t,n,o){return new(n||(n=r))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((o=o.apply(e,t||[])).next())})},a=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},i=!1,c="sc:debugLog";function s(){return o(this,void 0,void 0,function(){return a(this,function(e){try{return d()?[2,String(Office.context.roamingSettings.get(c)||"")]:"undefined"!=typeof localStorage?[2,localStorage.getItem(c)||""]:[2,""]}catch(e){return[2,""]}})})}function l(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),d()?(Office.context.roamingSettings.remove(c),[4,f()]):[3,2];case 1:return e.sent(),[3,3];case 2:"undefined"!=typeof localStorage&&localStorage.removeItem(c),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})})}function u(){try{return"undefined"!=typeof OfficeRuntime&&!!(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)}catch(e){return!1}}function d(){var e;try{return!!(null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.roamingSettings)}catch(e){return!1}}function f(){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return e=Date.now(),i&&console.log("[saveRoamingSettings] Starting saveAsync..."),[4,new r(function(t,n){try{Office.context.roamingSettings.saveAsync(function(r){var o,a,c,s=Date.now()-e;if((null==r?void 0:r.status)===Office.AsyncResultStatus.Succeeded)i&&console.log("[saveRoamingSettings] âœ… Succeeded in ".concat(s,"ms")),t();else{var l=(null===(o=null==r?void 0:r.error)||void 0===o?void 0:o.message)||"roamingSettings.saveAsync failed";console.error("[saveRoamingSettings] âŒ Failed in ".concat(s,"ms:"),l,{status:null==r?void 0:r.status,errorCode:null===(a=null==r?void 0:r.error)||void 0===a?void 0:a.code,errorName:null===(c=null==r?void 0:r.error)||void 0===c?void 0:c.name}),n(new Error(l))}})}catch(t){var r=Date.now()-e;console.error("[saveRoamingSettings] âŒ Exception in ".concat(r,"ms:"),t),n(t)}})];case 1:return t.sent(),[4,new r(function(e){return setTimeout(e,100)})];case 2:return t.sent(),[2]}})})}function m(e){return o(this,arguments,void 0,function(e,t){var n,o,c,s,l,f,m;return void 0===t&&(t=!1),a(this,function(a){switch(a.label){case 0:if(!(n=String(e||"").trim()))return[2,null];o=u()?"OfficeRuntime.storage":d()?"roamingSettings":"localStorage",(c=i&&!n.includes("recipientHistory")&&!n.includes("recentCases"))&&console.log("[getStored] Using storage backend:",o,"for key:",n,t?"(force fresh)":""),a.label=1;case 1:return a.trys.push([1,7,,8]),u()?[4,OfficeRuntime.storage.getItem(n)]:[3,3];case 2:return s=a.sent(),c&&console.log("[getStored] Got from OfficeRuntime.storage:",n,s?"found (".concat(s.length," chars)"):"not found"),[2,"string"==typeof s?s:null];case 3:return d()?t&&i?(console.log("[getStored] Waiting 500ms for roamingSettings sync..."),[4,new r(function(e){return setTimeout(e,500)})]):[3,5]:[3,6];case 4:a.sent(),a.label=5;case 5:return l=Office.context.roamingSettings.get(n),c&&console.log("[getStored] Got from roamingSettings:",n,l?"found (".concat(String(l).length," chars)"):"not found"),[2,"string"==typeof l?l:null];case 6:return f=localStorage.getItem(n),c&&console.warn("[getStored] No Office storage, using localStorage:",n,f?"found (".concat(f.length," chars)"):"not found"),[2,f];case 7:return m=a.sent(),console.warn("[getStored] Failed, falling back to localStorage:",m),[2,localStorage.getItem(n)];case 8:return[2]}})})}function v(e,t){return o(this,arguments,void 0,function(e,t,n){var o,c,s,l,m,g,p;return void 0===n&&(n=0),a(this,function(a){switch(a.label){case 0:if(!(o=String(e||"").trim()))return[2];c=String(null!=t?t:""),s=2,l=u()?"OfficeRuntime.storage":d()?"roamingSettings":"localStorage",i&&console.log("[setStored] Using storage backend:",l,"for key:",o,"(".concat(c.length," chars)"),n>0?"[retry ".concat(n,"]"):""),a.label=1;case 1:return a.trys.push([1,10,,11]),u()?(i&&console.log("[setStored] Writing to OfficeRuntime.storage..."),[4,OfficeRuntime.storage.setItem(o,c)]):[3,3];case 2:return a.sent(),i&&console.log("[setStored] âœ… Write to OfficeRuntime.storage completed"),[2];case 3:if(!d())return[3,9];i&&console.log("[setStored] Writing to roamingSettings..."),Office.context.roamingSettings.set(o,c),i&&console.log("[setStored] Calling saveAsync..."),a.label=4;case 4:return a.trys.push([4,6,,9]),[4,f()];case 5:return a.sent(),i&&console.log("[setStored] âœ… saveAsync completed"),[2];case 6:return m=a.sent(),console.error("[setStored] saveAsync failed:",m),n<s?(g=200*(n+1),i&&console.log("[setStored] Retrying in ".concat(g,"ms...")),[4,new r(function(e){return setTimeout(e,g)})]):[3,8];case 7:return a.sent(),[2,v(e,t,n+1)];case 8:throw m;case 9:return i&&console.warn("[setStored] No Office storage, using localStorage for key:",o),localStorage.setItem(o,c),[3,11];case 10:return p=a.sent(),console.warn("[setStored] âŒ Failed after retries, falling back to localStorage:",p),localStorage.setItem(o,c),[3,11];case 11:return[2]}})})}function g(e){return o(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:if(!(t=String(e||"").trim()))return[2];n.label=1;case 1:return n.trys.push([1,6,,7]),u()?[4,OfficeRuntime.storage.removeItem(t)]:[3,3];case 2:return n.sent(),[2];case 3:return d()?(Office.context.roamingSettings.remove(t),[4,f()]):[3,5];case 4:return n.sent(),[2];case 5:return localStorage.removeItem(t),[3,7];case 6:return n.sent(),localStorage.removeItem(t),[3,7];case 7:return[2]}})})}},50466:function(e,t,n){n.d(t,{d:function(){return r}});var r={onboardingDone:"sc:onboardingDone",workspaceId:"sc:workspaceId",workspaceName:"sc:workspaceName",workspaceHost:"sc:workspaceHost",agreementAccepted:"sc:agreementAccepted",publicToken:"sc:publicToken",recipientHistory:"recipientHistory",outlookFolderCache:"sc:outlookFolderCache"}},53864:function(e,t,n){n.d(t,{A:function(){return r}});const r=()=>{const e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}}},56004:function(e,t,n){n.d(t,{e:function(){return a},m:function(){return i}});var r=n(96540);const o=r.createContext("ltr"),a=({children:e,dir:t})=>r.createElement(o.Provider,{value:t},e);function i(){return r.useContext(o)}},74848:function(e,t,n){e.exports=n(21020)},87294:function(e,t,n){n.d(t,{N:function(){return i},z:function(){return a}});var r=n(45614),o=n(29255);function a(e,t){let n="",r="";for(const o in e){const a=e[o];if(0===a){r+=o+" ";continue}const i=Array.isArray(a),c="rtl"===t?(i?a[1]:a)+" ":(i?a[0]:a)+" ";n+=c,r+=c}return[n.slice(0,-1),r.slice(0,-1)]}function i(e,t){const n={};for(const i in e){const[c,s]=a(e[i],t);if(""===s){n[i]="";continue}const l=(0,o.G)(s,t),u=l+(""===c?"":" "+c);r.k1[l]=[e[i],t],n[i]=u}return n}},92245:function(e,t,n){n.r(t),n.d(t,{applyCategoryToMessageById:function(){return x},applyFiledCategoryToCurrentEmail:function(){return y},applyFiledCategoryToCurrentEmailOfficeJs:function(){return d},applyUnfiledCategoryToCurrentEmailOfficeJs:function(){return f},findInternetMessageIdInSentItems:function(){return I},getCurrentEmailCategoriesGraph:function(){return b},getFiledCategoryName:function(){return w},getInternetMessageIdViaGraph:function(){return k},getUnfiledCategoryName:function(){return S}});var r=n(64583).Promise,o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},a=function(e,t,n,o){return new(n||(n=r))(function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}s((o=o.apply(e,t||[])).next())})},i=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},c="https://graph.microsoft.com/v1.0",s="SC: Filed",l="SC: Unfiled",u="preset4";function d(){return a(this,void 0,void 0,function(){var e,t,n;return i(this,function(o){switch(o.label){case 0:if(!(e=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item))throw new Error("No current Outlook item.");return[4,new r(function(e){var t,n;try{var r=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.masterCategories;if(!(null==r?void 0:r.addAsync))return e();r.addAsync([{displayName:s,color:Office.MailboxEnums.CategoryColor.Preset4}],function(){return e()})}catch(t){e()}})];case 1:return o.sent(),[4,new r(function(t){try{var n=null==e?void 0:e.categories;if(!(null==n?void 0:n.removeAsync))return t();n.removeAsync([l],function(){return t()})}catch(e){t()}})];case 2:return o.sent(),[4,new r(function(t,n){try{var r=null==e?void 0:e.categories;if(!(null==r?void 0:r.addAsync))return n(new Error("Categories API unavailable."));r.addAsync([s],function(e){var r;if((null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded)return t();n(new Error((null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.message)||"categories.addAsync failed"))})}catch(e){n(e)}})];case 3:return o.sent(),[2]}})})}function f(){return a(this,void 0,void 0,function(){var e,t,n;return i(this,function(o){switch(o.label){case 0:if(!(e=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item))throw new Error("No current Outlook item.");return[4,new r(function(e){var t,n;try{var r=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.masterCategories;if(!(null==r?void 0:r.addAsync))return e();r.addAsync([{displayName:l,color:Office.MailboxEnums.CategoryColor.Preset7}],function(){return e()})}catch(t){e()}})];case 1:return o.sent(),[4,new r(function(t){try{var n=null==e?void 0:e.categories;if(!(null==n?void 0:n.removeAsync))return t();n.removeAsync([s],function(){return t()})}catch(e){t()}})];case 2:return o.sent(),[4,new r(function(t,n){try{var r=null==e?void 0:e.categories;if(!(null==r?void 0:r.addAsync))return n(new Error("Categories API unavailable."));r.addAsync([l],function(e){var r;if((null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded)return t();n(new Error((null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.message)||"categories.addAsync failed"))})}catch(e){n(e)}})];case 3:return o.sent(),[2]}})})}function m(){var e,t,n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item,r=String((null==n?void 0:n.itemId)||"");if(!r)return"";try{return Office.context.mailbox.convertToRestId(r,Office.MailboxEnums.RestVersion.v2_0)}catch(e){return""}}function v(e,t,n){return a(this,void 0,void 0,function(){return i(this,function(r){return[2,fetch("".concat(c).concat(t),o(o({},n),{headers:o({Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},(null==n?void 0:n.headers)||{})}))]})})}function g(e){return a(this,void 0,void 0,function(){var t;return i(this,function(n){switch(n.label){case 0:return[4,e.text().catch(function(){return""})];case 1:if(!(t=n.sent()))return[2,null];try{return[2,JSON.parse(t)]}catch(e){return[2,null]}}})})}function p(e,t,n){return a(this,void 0,void 0,function(){var r,o,a,c,s;return i(this,function(i){switch(i.label){case 0:return[4,v(e,"/me/outlook/masterCategories?$filter=displayName eq '".concat(t.replace(/'/g,"''"),"'"))];case 1:return(r=i.sent()).ok?[4,g(r)]:[3,3];case 2:if(o=i.sent(),Array.isArray(null==o?void 0:o.value)&&o.value.length>0)return[2];i.label=3;case 3:return[4,v(e,"/me/outlook/masterCategories",{method:"POST",body:JSON.stringify({displayName:t,color:n})})];case 4:return(a=i.sent()).ok||409===a.status?[2]:[4,g(a)];case 5:throw c=i.sent(),new Error((null===(s=null==c?void 0:c.error)||void 0===s?void 0:s.message)||"Failed to create category (".concat(a.status,")"))}})})}function h(){return a(this,void 0,void 0,function(){var e,t,n;return i(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),"undefined"!=typeof OfficeRuntime&&(null===(n=null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.auth)||void 0===n?void 0:n.getAccessToken)?[4,OfficeRuntime.auth.getAccessToken({allowSignInPrompt:!0,forMSGraphAccess:!0})]:[3,2];case 1:return e=r.sent(),[2,String(e||"")];case 2:return[3,4];case 3:return t=r.sent(),console.warn("[graphMail] OfficeRuntime.auth.getAccessToken failed:",t),[3,4];case 4:return[2,""]}})})}function b(){return a(this,void 0,void 0,function(){var e,t,n,r,o,a;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),(e=m())?[4,h()]:[2,[]];case 1:return(t=i.sent())?[4,v(t,"/me/messages/".concat(encodeURIComponent(e),"?$select=categories"))]:[2,[]];case 2:return(n=i.sent()).ok?[3,4]:[4,g(n)];case 3:return r=i.sent(),console.warn("[graphMail] getCurrentEmailCategoriesGraph not ok",n.status,r),[2,[]];case 4:return[4,g(n)];case 5:return o=i.sent(),[2,(Array.isArray(null==o?void 0:o.categories)?o.categories:[]).map(function(e){return String(e||"")}).filter(Boolean)];case 6:return a=i.sent(),console.warn("[graphMail] getCurrentEmailCategoriesGraph failed:",a),[2,[]];case 7:return[2]}})})}function y(e){return a(this,void 0,void 0,function(){var t,n,r,o;return i(this,function(a){switch(a.label){case 0:if(!(t=m()))throw new Error("Cannot resolve REST id.");return[4,p(e,s,u)];case 1:return a.sent(),[4,v(e,"/me/messages/".concat(encodeURIComponent(t)),{method:"PATCH",body:JSON.stringify({categories:[s]})})];case 2:return(n=a.sent()).ok?[3,4]:[4,g(n)];case 3:throw r=a.sent(),new Error((null===(o=null==r?void 0:r.error)||void 0===o?void 0:o.message)||"Failed to apply category (".concat(n.status,")"));case 4:return[2]}})})}function w(){return s}function S(){return l}function k(e){return a(this,void 0,void 0,function(){var t,n,r,o,a,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),console.log("[getInternetMessageIdViaGraph] Fetching for message:",e.substring(0,50)+"..."),[4,h()];case 1:return t=i.sent(),n="/me/messages/".concat(encodeURIComponent(e),"?$select=internetMessageId"),[4,v(t,n,{method:"GET"})];case 2:return(r=i.sent()).ok?[4,r.json()]:(console.warn("[getInternetMessageIdViaGraph] Failed:",r.status),[2,null]);case 3:return o=i.sent(),(a=null==o?void 0:o.internetMessageId)?(console.log("[getInternetMessageIdViaGraph] Found:",a),[2,String(a)]):(console.log("[getInternetMessageIdViaGraph] No internetMessageId in response"),[2,null]);case 4:return c=i.sent(),console.error("[getInternetMessageIdViaGraph] Error:",c),[2,null];case 5:return[2]}})})}function x(e){return a(this,void 0,void 0,function(){var t,n,r,o,a,c;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,6,,7]),console.log("[applyCategoryToMessageById] Applying category to:",e.substring(0,50)+"..."),[4,h()];case 1:return[4,p(t=i.sent(),s,u)];case 2:return i.sent(),[4,v(t,"/me/messages/".concat(encodeURIComponent(e)),{method:"PATCH",body:JSON.stringify({categories:[s]})})];case 3:return(n=i.sent()).ok?[3,5]:[4,g(n)];case 4:throw r=i.sent(),console.warn("[applyCategoryToMessageById] Failed:",(null===(a=null==r?void 0:r.error)||void 0===a?void 0:a.message)||n.status),new Error((null===(c=null==r?void 0:r.error)||void 0===c?void 0:c.message)||"Failed to apply category (".concat(n.status,")"));case 5:return console.log("[applyCategoryToMessageById] Category applied successfully"),[3,7];case 6:throw o=i.sent(),console.error("[applyCategoryToMessageById] Error:",o),o;case 7:return[2]}})})}function I(e,t,n){return a(this,void 0,void 0,function(){var r,o,a,c,s,l,u,d,f;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),console.log("[findInternetMessageIdInSentItems] Searching",{conversationId:e.substring(0,30)+"...",subject:t,sentAfter:n}),[4,h()];case 1:return r=i.sent(),o=t.replace(/'/g,"''"),a="subject eq '".concat(o,"' and sentDateTime ge ").concat(n),c="/me/mailFolders/SentItems/messages?$filter=".concat(encodeURIComponent(a),"&$select=internetMessageId,subject,sentDateTime&$top=5"),[4,v(r,c,{method:"GET"})];case 2:return(s=i.sent()).ok?[4,s.json()]:(console.warn("[findInternetMessageIdInSentItems] Failed:",s.status),[2,null]);case 3:return l=i.sent(),u=(null==l?void 0:l.value)||[],console.log("[findInternetMessageIdInSentItems] Found",u.length,"messages in window"),u.length>0&&u[0].internetMessageId?(d=String(u[0].internetMessageId),console.log("[findInternetMessageIdInSentItems] Match:",d),[2,d]):(console.log("[findInternetMessageIdInSentItems] No match found"),[2,null]);case 4:return f=i.sent(),console.error("[findInternetMessageIdInSentItems] Error:",f),[2,null];case 5:return[2]}})})}}},function(e){var t=function(t){return e(e.s=t)};t(33088),t(39046)}]);
//# sourceMappingURL=taskpane.js.map