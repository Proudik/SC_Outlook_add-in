/*! For license information please see taskpane.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[926],{5338:function(e,t,n){var r=n(40961);t.H=r.createRoot,r.hydrateRoot},21020:function(e,t,n){var r=n(96540),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,c=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var r,i={},l=null,u=null;for(r in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:l,ref:u,props:i,_owner:c.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},22799:function(e,t){if("function"==typeof Symbol&&Symbol.for){var n=Symbol.for;n("react.element"),n("react.portal"),n("react.fragment"),n("react.strict_mode"),n("react.profiler"),n("react.provider"),n("react.context"),n("react.forward_ref"),n("react.suspense"),n("react.suspense_list"),n("react.memo"),n("react.lazy"),n("react.block"),n("react.server.block"),n("react.fundamental"),n("react.debug_trace_mode"),n("react.legacy_hidden")}},26312:function(e,t,n){function r(e){return Array.isArray(e)?e:[e]}n.d(t,{J:function(){return m}});var o=n(45614);const i=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,n)=>(e[t]=n,e),{});function a(e,t,n,r,a={}){var c,s;const l="m"===e,u=null!==(c=a.m)&&void 0!==c?c:"0",d=null!==(s=a.p)&&void 0!==s?s:0,f=function(e,t,n){return("m"===e?e+t:e)+n}(e,u,d);if(!r.stylesheets[f]){const c=t&&t.createElement("style"),s=function(e,t,n,r){const i=[];if(r[o.ed]=t,r[o.EJ]=String(n),e)for(const t in r)e.setAttribute(t,r[t]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):i.push(t)},element:e,bucketName:t,cssRules(){return(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):i}}}(c,e,d,Object.assign({},r.styleElementAttributes,l&&{media:u}));r.stylesheets[f]=s,(null==t?void 0:t.head)&&c&&t.head.insertBefore(c,function(e,t,n,r,a={}){var c,s;const l=i[n],u=null!==(c=a.m)&&void 0!==c?c:"",d=null!==(s=a.p)&&void 0!==s?s:0;let f=e=>l-i[e.getAttribute(o.ed)],m=e.head.querySelectorAll(`[${o.ed}]`);if("m"===n){const t=e.head.querySelectorAll(`[${o.ed}="${n}"]`);t.length&&(m=t,f=e=>r.compareMediaQueries(u,e.media))}const v=e=>function(e,t,n){var r,i;return t+(null!==(r=n.m)&&void 0!==r?r:"")===e.getAttribute(o.ed)+(null!==(i=e.media)&&void 0!==i?i:"")}(e,n,a)?d-Number(e.getAttribute("data-priority")):f(e),g=m.length;let p=g-1;for(;p>=0;){const e=m.item(p);if(v(e)>0)return e.nextSibling;p--}return g>0?m.item(0):t?t.nextSibling:null}(t,n,e,r,a))}return r.stylesheets[f]}function c(e,t){try{e.insertRule(t)}catch(e){}}let s=0;const l=(e,t)=>e<t?-1:e>t?1:0;function u(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:n,unstable_filterCSSRule:o,insertionPoint:i,styleElementAttributes:u,compareMediaQueries:d=l}=t,f={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(u),compareMediaQueries:d,id:"d"+s++,insertCSSRules(t){for(const n in t){const s=t[n];for(let t=0,l=s.length;t<l;t++){const[l,u]=r(s[t]),d=a(n,e,i||null,f,u);f.insertionCache[l]||(f.insertionCache[l]=n,o?o(l)&&c(d,l):c(d,l))}}}};return f}var d=n(96540);const f=d.createContext(u());function m(){return d.useContext(f)}},29255:function(e,t,n){n.d(t,{G:function(){return i}});var r=n(35137),o=n(45614);function i(e,t,n=[]){return o.fj+function(e){const t=e.length;if(t===o.ez)return e;for(let n=t;n<o.ez;n++)e+="0";return e}((0,r.A)(e+t))}},34680:function(e,t,n){var r=n(96540),o=n.t(r,2),i=n(5338),a=n(44541);var c=(0,a.n)({root:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"8px",width:"100%"},logo:{width:"100%",maxWidth:"420px",height:"auto",objectFit:"contain"},logoSmall:{maxWidth:"260px"},message:{fontSize:"var(--fontSizeBase500)",fontWeight:"var(--fontWeightSemibold)",margin:0}}),s=function(e){var t=e.logo,n=e.title,o=e.message,i=e.size,a=void 0===i?"default":i,s=c();return r.createElement("div",{className:s.root},r.createElement("img",{src:t,alt:n,className:"".concat(s.logo," ").concat("small"===a?s.logoSmall:"")}),o?r.createElement("h1",{className:s.message},o):null)},l=n(50134),u={onboardingDone:"sc:onboardingDone",workspaceId:"sc:workspaceId",workspaceName:"sc:workspaceName",workspaceHost:"sc:workspaceHost",agreementAccepted:"sc:agreementAccepted",publicToken:"sc:publicToken",recipientHistory:"recipientHistory",outlookFolderCache:"sc:outlookFolderCache"},d=n(64583).Promise,f=function(e,t,n,r){return new(n||(n=d))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},m=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},v=(0,a.n)({root:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"rgb(240, 240, 240)"},content:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"24px 16px 0",boxSizing:"border-box"},headerWrap:{marginTop:"36px",display:"flex",justifyContent:"center",width:"100%"},scaleImage:{width:"100%",maxWidth:"320px",margin:"64px auto 24px",opacity:.6,display:"block",pointerEvents:"none",userSelect:"none"},actionsWrap:{position:"sticky",bottom:"20px",width:"100%",display:"flex",justifyContent:"center"},actionsInner:{width:"100%",maxWidth:"420px",padding:"0 16px",display:"flex",flexDirection:"column",gap:"14px"},formWrap:{width:"100%",display:"flex",flexDirection:"column",gap:"10px"},label:{fontSize:"12px",opacity:.8},input:{height:"40px",borderRadius:"12px",border:"1px solid rgba(0,0,0,0.12)",padding:"0 12px",outline:"none",background:"rgba(255,255,255,0.9)",boxSizing:"border-box",width:"100%"},error:{borderRadius:"10px",padding:"10px 12px",border:"1px solid rgba(180, 0, 0, 0.25)",background:"rgba(220, 0, 0, 0.06)",color:"rgba(120, 0, 0, 0.95)",fontSize:"13px",lineHeight:1.35},primaryBtn:{height:"44px",borderRadius:"12px",border:"none",padding:"0 16px",background:"#00204A",color:"white",cursor:"pointer",fontWeight:600,width:"100%"},secondaryBtn:{height:"44px",borderRadius:"12px",border:"1px solid rgba(0,0,0,0.12)",padding:"0 16px",background:"transparent",cursor:"pointer",fontWeight:500,width:"100%"},legalRow:{marginTop:"8px",fontSize:"12px",lineHeight:"1.35",opacity:.75,textAlign:"center"},legalLink:{border:"none",background:"transparent",padding:0,cursor:"pointer",textDecoration:"underline",fontSize:"12px",fontWeight:700,color:"#00204A"}});function g(e){var t=this,n=e.title,o=e.onOpenLoginDialog,i=v(),a=r.useState(""),c=a[0],d=a[1],g=r.useState(null),p=g[0],h=g[1];r.useEffect(function(){f(t,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return[4,(0,l.wv)(u.workspaceHost)];case 1:return(e=t.sent())&&d(e),[2]}})})},[]);var b=function(e){var t=(e||"").trim();if(!t)return"";var n=t;return(n=(n=(n=(n=n.replace(/^https?:\/\//i,"")).split("/")[0]).split("?")[0]).split("#")[0])&&!n.includes(".")&&(n="".concat(n,".singlecase.com")),n.toLowerCase()}(c),y=b.length>0,w=function(e){var t,n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.ui;(null==n?void 0:n.openBrowserWindow)?n.openBrowserWindow(e):window.open(e,"_blank","noopener,noreferrer")};return r.createElement("div",{className:i.root},r.createElement("div",{className:i.content},r.createElement("div",{className:i.headerWrap},r.createElement(s,{logo:"assets/SingleCaseFullLogo.svg",title:n,size:"small"})),r.createElement("img",{src:"assets/Scale.webp",alt:"",className:i.scaleImage})),r.createElement("div",{className:i.actionsWrap},r.createElement("div",{className:i.actionsInner},r.createElement("div",{className:i.formWrap},r.createElement("div",null,r.createElement("div",{className:i.label},"Workspace URL"),r.createElement("input",{className:i.input,value:c,onChange:function(e){return d(e.target.value)},placeholder:"acme.singlecase.com or acme",autoComplete:"off",spellCheck:!1})),p?r.createElement("div",{className:i.error},p):null),r.createElement("button",{className:i.primaryBtn,onClick:function(){return f(t,void 0,void 0,function(){var e,t;return m(this,function(n){switch(n.label){case 0:return h(null),b?[4,(0,l.wv)(u.publicToken)]:(h("Please enter a workspace URL."),[2]);case 1:return e=n.sent(),(t=(e||"").trim())?[4,(0,l.Kg)(u.workspaceHost,b)]:(h("Missing public token in local storage."),[2]);case 2:return n.sent(),o({workspaceHost:b,token:t}),[2]}})})},disabled:!y,type:"button"},"Continue"),r.createElement("button",{className:i.secondaryBtn,onClick:function(){var e,t=b?"https://".concat(b):"https://singlecase.com",n=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.ui;(null==n?void 0:n.openBrowserWindow)?n.openBrowserWindow(t):window.open(t,"_blank","noopener,noreferrer")},type:"button"},"Open workspace"),r.createElement("div",{className:i.legalRow},r.createElement("button",{type:"button",className:i.legalLink,onClick:function(){return w("https://singlecase.com/terms")}},"Terms")," ","and"," ",r.createElement("button",{type:"button",className:i.legalLink,onClick:function(){return w("https://singlecase.com/privacy")}},"Privacy Policy")))))}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var h=function(){return h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},h.apply(this,arguments)};function b(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile;return String((null==n?void 0:n.emailAddress)||"").toLowerCase().trim()||"default"}catch(e){return"default"}}function y(){return"sc_case_intake_settings:".concat(b())}function w(){return"sc_ever_filed_v1:".concat(b())}function S(e){if(e){var t=function(){try{var e=localStorage.getItem(w()),t=e?JSON.parse(e):{};return t&&"object"===p(t)?t:{}}catch(e){return{}}}();t[e]=Date.now(),function(e){try{localStorage.setItem(w(),JSON.stringify(e))}catch(e){}}(t)}}function k(e){try{localStorage.setItem(y(),JSON.stringify(e))}catch(e){}}var x=n(64583).Promise;function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}var C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},C.apply(this,arguments)},N=function(e,t,n,r){return new(n||(n=x))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},E=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},B=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},O="sc:sentPills";function T(e){if(!e||"object"!==I(e))return null;var t=e,n="string"==typeof t.filedBy?t.filedBy:void 0,r=Boolean(t.sent),o="string"==typeof t.atIso?t.atIso:void 0,i="string"==typeof t.caseId?t.caseId:void 0,a="string"==typeof t.singlecaseRecordId?t.singlecaseRecordId:void 0,c="string"==typeof t.documentId?t.documentId:"number"==typeof t.documentId?String(t.documentId):void 0,s="number"==typeof t.revisionNumber?t.revisionNumber:"string"==typeof t.revisionNumber?Number(t.revisionNumber):void 0,l=Number.isFinite(s)?s:void 0;return C(C(C(C(C(C({sent:r},o?{atIso:o}:{}),i?{caseId:i}:{}),a?{singlecaseRecordId:a}:{}),c?{documentId:c}:{}),void 0!==l?{revisionNumber:l}:{}),n?{filedBy:n}:{})}function _(){return N(this,void 0,void 0,function(){var e;return E(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,l.wv)(O)];case 1:return(e=t.sent())?[2,JSON.parse(e)]:[3,3];case 2:return t.sent(),[3,3];case 3:return[2,{}]}})})}function A(e){return N(this,void 0,void 0,function(){var t,n,r;return E(this,function(o){switch(o.label){case 0:if(!e)return[2,null];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,_()];case 2:return t=o.sent(),(n=t[e])?(n._savedAt,[2,T(B(n,["_savedAt"]))]):[3,4];case 3:return o.sent(),[3,4];case 4:return o.trys.push([4,6,,7]),[4,(0,l.wv)("".concat("sc:sent:").concat(e))];case 5:return(r=o.sent())&&""!==r.trim()?[2,T(JSON.parse(r))]:[3,7];case 6:return o.sent(),[3,7];case 7:return[2,null]}})})}function j(e,t){return N(this,void 0,void 0,function(){var n,r,o,i,a;return E(this,function(c){switch(c.label){case 0:return e?(n=null!==(a=T(t))&&void 0!==a?a:{sent:Boolean(t.sent)},[4,_()]):[2];case 1:return(r=c.sent())[e]=C(C({},n),{_savedAt:Date.now()}),(o=Object.entries(r)).length>10&&(o.sort(function(e,t){return(t[1]._savedAt||0)-(e[1]._savedAt||0)}),i={},o.slice(0,10).forEach(function(e){var t=e[0],n=e[1];i[t]=n}),r=i),[4,(0,l.Kg)(O,JSON.stringify(r))];case 2:return c.sent(),[2]}})})}function z(e){var t=function(e){return String((null==e?void 0:e.case_id_visible)||(null==e?void 0:e.caseIdVisible)||"")}(e),n=function(e){return String((null==e?void 0:e.title)||(null==e?void 0:e.name)||"")}(e);return t?"".concat(t," Â· ").concat(n):n}function F(e){var t,n,r,o,i,a,c,s,l,u="string"==typeof(null==e?void 0:e.client)&&e.client.trim()||"string"==typeof(null==e?void 0:e.client_name)&&e.client_name.trim()||"string"==typeof(null==e?void 0:e.clientName)&&e.clientName.trim()||"string"==typeof(null==e?void 0:e.client_title)&&e.client_title.trim(),d="string"==typeof(null===(t=null==e?void 0:e.client)||void 0===t?void 0:t.name)&&e.client.name.trim()||"string"==typeof(null===(n=null==e?void 0:e.client)||void 0===n?void 0:n.title)&&e.client.title.trim(),f=u||d,m=null!==(s=null!==(a=null!==(o=null!==(r=null==e?void 0:e.client_id)&&void 0!==r?r:null==e?void 0:e.clientId)&&void 0!==o?o:null===(i=null==e?void 0:e.client)||void 0===i?void 0:i.id)&&void 0!==a?a:null===(c=null==e?void 0:e.client)||void 0===c?void 0:c.client_id)&&void 0!==s?s:null===(l=null==e?void 0:e.client)||void 0===l?void 0:l.clientId,v=null!=m?String(m):"";return f?{key:"name:".concat(f),label:f,id:v||void 0}:v?{key:"id:".concat(v),label:"Client ".concat(v),id:v}:{key:"other",label:"Other"}}function R(e,t){return e.key.startsWith("name:")?e.label:e.id&&(null==t?void 0:t[e.id])?t[e.id]:e.label}function D(e){return e>=90?"case-selector-confidence-pill case-selector-confidence-pill--high":e>=80?"case-selector-confidence-pill case-selector-confidence-pill--mid":e>=70?"case-selector-confidence-pill case-selector-confidence-pill--low":"case-selector-confidence-pill case-selector-confidence-pill--none"}function P(e){return["case-selector-chip",e?"case-selector-chip--active":""].filter(Boolean).join(" ")}function L(e){return String(e||"").toLowerCase().trim()}function M(e){var t=e.title,n=void 0===t?"Case":t,o=e.scope,i=e.onScopeChange,a=e.selectedCaseId,c=e.onSelectCaseId,s=e.cases,l=e.isLoadingCases,u=e.clientNamesById,d=e.suggestions,f=e.contentSuggestions,m=e.isLoadingContentSuggestions,v=r.useState(""),g=v[0],p=v[1],h=r.useRef(null),b=r.useMemo(function(){return function(e,t){for(var n=new Map,r=0,o=e;r<o.length;r++){var i=o[r],a=F(i),c=n.get(a.key);c?c.items.push(i):n.set(a.key,{key:a.key,label:a.label,id:a.id,items:[i]})}for(var s=Array.from(n.keys()).sort(function(e,t){return"other"===e?1:"other"===t?-1:e.localeCompare(t,"cs")}),l=[],u=function(e){var r=n.get(e);if(!r)return"continue";var o=R({key:r.key,label:r.label,id:r.id},t),i=r.items.map(function(e){var t=e,n=String(t.id||""),i=z(t);return{kind:"case",clientLabel:o,clientId:r.id,caseId:n,label:i}}).sort(function(e,t){return"case"!==e.kind||"case"!==t.kind?0:e.label.localeCompare(t.label,"cs",{sensitivity:"base"})});if(0===i.length)return"continue";l.push({kind:"client",clientLabel:o,count:i.length}),l.push.apply(l,i)},d=0,f=s;d<f.length;d++)u(f[d]);return l}(s,u)},[s,u]),y=r.useMemo(function(){return b.filter(function(e){return"case"===e.kind})},[b]),w=r.useMemo(function(){var e=(d||[]).slice(0,10);return e.length?e.map(function(e){var t=y.find(function(t){return t.caseId===e.caseId});return t?{caseId:e.caseId,confidencePct:"number"==typeof e.confidencePct?e.confidencePct:0,reasons:e.reasons||[],label:t.label,clientLabel:t.clientLabel}:null}).filter(Boolean):[]},[d,y]),S=r.useMemo(function(){var e=(f||[]).slice(0,10);return e.length?e.map(function(e){var t=y.find(function(t){return t.caseId===e.caseId});return t?{caseId:e.caseId,confidencePct:"number"==typeof e.confidencePct?e.confidencePct:0,reasons:e.reasons||[],label:t.label,clientLabel:t.clientLabel}:null}).filter(Boolean):[]},[f,y]),k=w.length?w[0]:null,x=r.useMemo(function(){var e=w[1];return e?e.caseId===(null==k?void 0:k.caseId)||(e.confidencePct||0)<1?null:e:null},[w,null==k?void 0:k.caseId]),I=r.useMemo(function(){var e=new Set;return(null==k?void 0:k.caseId)&&e.add(k.caseId),(null==x?void 0:x.caseId)&&e.add(x.caseId),e},[null==k?void 0:k.caseId,null==x?void 0:x.caseId]),C=r.useMemo(function(){return k?w.slice(1).filter(function(e){return!I.has(e.caseId)}).filter(function(e){return e.confidencePct>=60}):[]},[w,k,I]),N=r.useMemo(function(){return y.filter(function(e){return!I.has(e.caseId)})},[y,I]),E=C.length>0?C:N,B=r.useMemo(function(){var e=L(g);return e?E.filter(function(t){var n=L(String(t.label||"")),r=L(String(t.clientLabel||""));return n.includes(e)||r.includes(e)}).slice(0,20):[]},[E,g]),O=r.useMemo(function(){if(!a)return null;var e=s.find(function(e){return String((null==e?void 0:e.id)||"")===a});if(!e)return null;var t=R(F(e),u);return{caseId:a,label:z(e),clientLabel:t}},[s,a,u]),T=r.useMemo(function(){return y.slice(0,5)},[y]),_=function(e){c(e),p("")};r.useEffect(function(){p("")},[a,o]),r.useEffect(function(){f&&f.length>0&&console.log("[CaseSelector] ðŸ“„ Content suggestions received:",{count:f.length,mapped:S.length,suggestions:f.map(function(e){return{caseId:e.caseId,pct:e.confidencePct}})})},[null==f?void 0:f.length]);var A=y.length>0;r.useEffect(function(){A&&h.current&&h.current.focus()},[A]);var j=function(e,t){var n,o=a===e.caseId;return r.createElement("button",{type:"button",className:["case-selector-suggested-btn","secondary"===t?"case-selector-suggested-btn--secondary":"",o?"case-selector-suggested-btn--selected":""].filter(Boolean).join(" "),onClick:function(){return _(e.caseId)}},r.createElement("div",{className:"case-selector-suggested-topline"},r.createElement("div",{className:"case-selector-suggested-primary"},o&&r.createElement("span",{className:"case-selector-checkmark"},"âœ“ "),e.label),r.createElement("div",{className:D(e.confidencePct)},e.confidencePct,"%")),r.createElement("div",{className:"case-selector-suggested-secondary"},e.clientLabel),(null===(n=e.reasons)||void 0===n?void 0:n.length)?r.createElement("div",{className:"case-selector-suggested-reason"},e.reasons[0]):null,o&&r.createElement("div",{className:"case-selector-selected-badge"},"Selected"))};return r.createElement("div",{className:"case-selector-wrap"},r.createElement("div",{className:"case-selector-top-row"},r.createElement("div",{className:"case-selector-title"},n),r.createElement("div",{className:"case-selector-chips"},r.createElement("button",{className:P("favourites"===o),onClick:function(){return i("favourites")},type:"button"},"Favourites"),r.createElement("button",{className:P("all"===o),onClick:function(){return i("all")},type:"button"},"All"))),l?r.createElement("div",{className:"case-selector-loading"},"Loadingâ€¦"):A?"favourites"===o?r.createElement("div",{className:"case-selector-favourites-list"},T.map(function(e){var t=a===e.caseId;return r.createElement("button",{key:"fav-".concat(e.caseId),type:"button",className:["case-selector-other-item",t?"case-selector-other-item--selected":""].filter(Boolean).join(" "),onClick:function(){return _(e.caseId)}},r.createElement("div",{className:"case-selector-other-left"},r.createElement("div",{className:"case-selector-other-primary"},t&&r.createElement("span",{className:"case-selector-checkmark"},"âœ“ "),e.label),r.createElement("div",{className:"case-selector-other-secondary"},e.clientLabel)),t&&r.createElement("div",{className:"case-selector-selected-badge"},"Selected"))})):r.createElement("div",{className:"case-selector-suggested-card"},O&&r.createElement("div",{className:"case-selector-selected-section"},r.createElement("div",{className:"case-selector-selected-card"},r.createElement("div",{className:"case-selector-selected-card-content"},r.createElement("div",{className:"case-selector-checkmark-icon"},"âœ“"),r.createElement("div",{className:"case-selector-selected-info"},r.createElement("div",{className:"case-selector-selected-primary"},O.label),r.createElement("div",{className:"case-selector-selected-secondary"},O.clientLabel))),r.createElement("div",{className:"case-selector-selected-badge-large"},"SELECTED"))),m?r.createElement("div",{className:"case-selector-loading",style:{marginBottom:12}},"HledÃ¡m odpovÃ­dajÃ­cÃ­ spisyâ€¦"):null,!m&&S.length>0?r.createElement("div",{style:{marginBottom:16}},r.createElement("div",{style:{fontSize:12,fontWeight:600,color:"#616161",marginBottom:8}},"ðŸ“„ NÃ¡vrhy podle obsahu emailu"),S.slice(0,3).map(function(e,t){return r.createElement("div",{key:"content-".concat(e.caseId),style:{marginBottom:4}},j(e,0===t?"primary":"secondary"))})):null,S.length>0&&k?r.createElement("div",{style:{fontSize:12,fontWeight:600,color:"#616161",marginBottom:8}},"ðŸ•’ NÃ¡vrhy podle historie"):null,k&&k.caseId!==a?r.createElement(r.Fragment,null,j(k,"primary"),x&&x.caseId!==a?j(x,"secondary"):null):m||0!==S.length||a?null:r.createElement("div",{className:"case-selector-empty",style:{marginBottom:8}},"I couldnâ€™t find a good match yet. Try searching for a case below."),r.createElement("div",{className:"case-selector-other-list"},r.createElement("input",{ref:h,className:"case-selector-input case-selector-input--search",value:g,onChange:function(e){return p(e.target.value)},onKeyDown:function(e){"Escape"===e.key?(p(""),e.currentTarget.blur()):"Enter"===e.key&&B.length>0&&_(B[0].caseId)},placeholder:"Search other cases or clients"}),g.trim().length>0&&r.createElement(r.Fragment,null,B.map(function(e){var t=String(e.caseId||""),n=String(e.label||""),o=String(e.clientLabel||""),i="number"==typeof e.confidencePct?e.confidencePct:0,c=a===t;return r.createElement("button",{key:"o-".concat(t),type:"button",className:["case-selector-other-item",c?"case-selector-other-item--selected":""].filter(Boolean).join(" "),onClick:function(){return _(t)}},r.createElement("div",{className:"case-selector-other-left"},r.createElement("div",{className:"case-selector-other-primary"},c&&r.createElement("span",{className:"case-selector-checkmark"},"âœ“ "),n),r.createElement("div",{className:"case-selector-other-secondary"},o)),i>0?r.createElement("div",{className:D(i)},i,"%"):c?r.createElement("div",{className:"case-selector-selected-badge"},"Selected"):r.createElement("div",{className:"case-selector-other-spacer"}))}),0===B.length&&r.createElement("div",{className:"case-selector-empty"},"No matches found.")))):r.createElement("div",{className:"case-selector-empty"},"No cases available."))}var H=n(64583).Promise,q=function(e,t,n,r){return new(n||(n=H))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},W=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function U(){return q(this,void 0,void 0,function(){var e,t;return W(this,function(n){switch(n.label){case 0:return[4,(0,l.wv)(u.workspaceHost)];case 1:if(e=n.sent(),!(t=function(e){var t=(e||"").trim().toLowerCase();return t?t.replace(/^https?:\/\//i,"").split("/")[0]:""}(e||"")))throw new Error("Workspace host is missing. Please enter a workspace URL first.");return[2,"/singlecase/".concat(encodeURIComponent(t),"/publicapi/v1")]}})})}function K(e,t,n,r,o){return q(this,void 0,void 0,function(){var i,a,c,s,l;return W(this,function(u){switch(u.label){case 0:if(!n)throw new Error("SingleCase token is missing");return[4,U()];case 1:if(!(i=u.sent()))throw new Error("SingleCase base url is missing");return a="".concat(i).concat(t).concat(function(e){void 0===e&&(e={});for(var t=new URLSearchParams,n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],i=o[0],a=o[1];null!=a&&""!==a&&(Array.isArray(a)?t.set(i,a.join(",")):t.set(i,String(a)))}var c=t.toString();return c?"?".concat(c):""}(o)),[4,fetch(a,{method:e,headers:{Authentication:n,"Content-Type":"application/json"},body:void 0!==r?JSON.stringify(r):void 0})];case 2:return c=u.sent(),s=c.headers.get("content-type")||"",[4,c.text()];case 3:if(l=u.sent(),!c.ok)throw new Error("SingleCase ".concat(c.status,": ").concat(l||c.statusText));if(!s.includes("application/json")){if(!l)return[2,void 0];throw new Error("SingleCase returned non JSON (".concat(s||"no content-type","). First bytes: ").concat(l.slice(0,200)))}return[2,JSON.parse(l)]}})})}function $(e,t,n){return q(this,void 0,void 0,function(){return W(this,function(r){return[2,K("GET",e,t,void 0,n)]})})}function G(e){var t,n,r,o=null!=e.client_id?String(e.client_id):null!=e.clientId?String(e.clientId):null!=(null===(t=e.client)||void 0===t?void 0:t.id)?String(e.client.id):void 0,i=e.case_id_visible?String(e.case_id_visible):"",a=e.name?String(e.name):"",c=i?"".concat(i," Â· ").concat(a||"Case ".concat(e.id)):a||"Case ".concat(e.id);return{id:String(e.id),title:c,clientId:o,client:(null===(n=e.client)||void 0===n?void 0:n.name)||e.client_name||void 0,status:(null===(r=e.status)||void 0===r?void 0:r.name)||e.status||void 0}}function J(e){return q(this,arguments,void 0,function(e,t){var n,r,o;return void 0===t&&(t="my"),W(this,function(t){switch(t.label){case 0:return[4,$("/cases",e)];case 1:return n=t.sent(),[2,(Array.isArray(n)?n:null!==(o=null!==(r=n.items)&&void 0!==r?r:n.data)&&void 0!==o?o:[]).map(G)]}})})}function V(e){return{id:String(e.id),name:String(e.name||"")}}function X(e){return q(this,void 0,void 0,function(){var t,n,r;return W(this,function(o){switch(o.label){case 0:return[4,$("/clients",e)];case 1:return t=o.sent(),[2,(Array.isArray(t)?t:null!==(r=null!==(n=t.items)&&void 0!==n?n:t.data)&&void 0!==r?r:[]).map(V).filter(function(e){return e.id&&e.name})]}})})}function Y(e,t){return q(this,void 0,void 0,function(){return W(this,function(e){switch(e.label){case 0:return[4,new H(function(e){return setTimeout(e,500)})];case 1:return e.sent(),[2,{ok:!0,singlecaseRecordId:"mail_".concat(Date.now()),payload:t}]}})})}function Q(e){return{id:String(e.id),firstName:String(e.first_name||""),lastName:String(e.last_name||""),username:String(e.username||"")}}function Z(e){return q(this,void 0,void 0,function(){var t,n,r;return W(this,function(o){switch(o.label){case 0:return[4,K("GET","/users",e)];case 1:return t=o.sent(),[2,(Array.isArray(t)?t:null!==(r=null!==(n=t.items)&&void 0!==n?n:t.data)&&void 0!==r?r:[]).map(Q)]}})})}function ee(e){return{"filter[user_id]":e.userId,"filter[project_id]":e.projectId,"filter[from]":e.from,"filter[to]":e.to}}function te(e){return e?{id:null!=e.id?String(e.id):null!=e.timer_id?String(e.timer_id):null!=e.timerId?String(e.timerId):void 0,user_id:null!=e.user_id?String(e.user_id):String(e.userId||""),project_id:null!=e.project_id?String(e.project_id):String(e.projectId||""),date:String(e.date||""),total_time:Number(e.total_time||0),total_billed_time:Number(e.total_billed_time||0),sheet_activity_id:null!=e.sheet_activity_id?String(e.sheet_activity_id):null!=e.sheetActivityId?String(e.sheetActivityId):void 0,note:null!=e.note?String(e.note):""}:e}function ne(e,t){return q(this,void 0,void 0,function(){var n,r,o;return W(this,function(i){switch(i.label){case 0:return[4,K("GET","/timers",e,void 0,ee(t))];case 1:return n=i.sent(),[2,(Array.isArray(n)?n:null!==(o=null!==(r=n.items)&&void 0!==r?r:n.data)&&void 0!==o?o:[]).map(te)]}})})}function re(e,t){return q(this,void 0,void 0,function(){return W(this,function(n){return[2,K("POST","/timers",e,t)]})})}function oe(e,t,n){return q(this,void 0,void 0,function(){return W(this,function(r){return[2,K("PUT","/timers/".concat(encodeURIComponent(t)),e,n)]})})}var ie=function(){return ie=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ie.apply(this,arguments)};var ae={version:1,threadToCase:{},senderToCase:{},domainToCase:{},recentCases:[]};function ce(){try{var e=localStorage.getItem("sc_case_suggest:".concat(function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile;return String((null==n?void 0:n.emailAddress)||"").toLowerCase().trim()||"default"}catch(e){return"default"}}()));if(!e)return ae;var t=JSON.parse(e);return t&&1===t.version?ie(ie(ie({},ae),t),{threadToCase:t.threadToCase||{},senderToCase:t.senderToCase||{},domainToCase:t.domainToCase||{},recentCases:Array.isArray(t.recentCases)?t.recentCases:[]}):ae}catch(e){return ae}}function se(e){var t,n=String(e||"").trim().toLowerCase();return n&&(null===(t=ce().threadToCase[n])||void 0===t?void 0:t.caseId)||""}function le(e){return String(e||"").trim().toLowerCase()}function ue(e){return String((null==e?void 0:e.case_id_visible)||(null==e?void 0:e.caseIdVisible)||(null==e?void 0:e.caseIdVisibleText)||(null==e?void 0:e.visibleId)||"").trim()}function de(e){return String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||(null==e?void 0:e.case_name)||(null==e?void 0:e.caseName)||(null==e?void 0:e.case_name_visible)||(null==e?void 0:e.caseNameVisible)||"").trim()}function fe(e){return le(function(e){try{return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}catch(t){return e}}(e)).replace(/[^a-z0-9\s.:-]/g," ").replace(/\s+/g," ").trim()}function me(e){return fe(e).replace(/-/g," ").replace(/\s+/g," ").trim()}function ve(e){return me(e).split(" ").map(function(e){return e.trim()}).filter(function(e){return e.length>=3})}function ge(e,t){if(!e.length)return{hits:0,total:0};for(var n=" ".concat(me(t)," "),r=0,o=0,i=e;o<i.length;o++){var a=i[o];n.includes(" ".concat(a," "))&&(r+=1)}return{hits:r,total:e.length}}function pe(e,t,n){return Math.max(t,Math.min(n,e))}function he(e){return Math.log(1+Math.max(0,e))}function be(e,t){var n,r,o,i=null!==(n=e[t])&&void 0!==n?n:0,a=null!==(r=e[0])&&void 0!==r?r:0,c=null!==(o=e[1])&&void 0!==o?o:0,s=pe(i/120,0,1),l=0===t?c:a,u=pe(Math.max(0,i-l)/60,0,1);return pe(Math.round(100*(.65*s+.35*u)),0,100)}function ye(e){var t=e.enabled,n=e.emailItemId,o=e.conversationKey,i=e.subject,a=e.bodySnippet,c=e.fromEmail,s=e.attachments,l=e.cases,u=e.selectedCaseId,d=e.selectedSource,f=e.onAutoSelectCaseId,m=e.topK,v=r.useState([]),g=v[0],p=v[1],h=r.useState(""),b=h[0],y=h[1],w=r.useRef();r.useEffect(function(){w.current=f},[f]);var S=r.useMemo(function(){return(s||[]).filter(function(e){return!(null==e?void 0:e.isInline)}).map(function(e){return String((null==e?void 0:e.name)||"")}).join("|")},[s]),k=r.useMemo(function(){return(l||[]).map(function(e){var t;return String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:"")}).join("|")},[l]),x=r.useRef({emailItemId:"",caseId:""});return r.useEffect(function(){if(!t||!n||!(null==l?void 0:l.length))return p([]),void y("");var e=(s||[]).filter(function(e){return!e.isInline}).map(function(e){return e.name}),r=function(e){var t,n,r,o,i=null!==(t=e.topK)&&void 0!==t?t:2,a=String(e.conversationKey||"").trim(),c=String(e.subject||""),s=me(c),l=String(e.bodySnippet||""),u=me(l),d=(e.attachmentNames||[]).map(function(e){return fe(e)}),f=le(e.fromEmail||""),m=(r=(n=le(f)).lastIndexOf("@"))>=0?n.slice(r+1):"",v={threadToCase:(o=ce()).threadToCase,senderToCase:o.senderToCase,domainToCase:o.domainToCase,recentCases:o.recentCases},g=v.senderToCase,p=v.domainToCase,h=v.recentCases,b={},y={},w=function(e,t,n){e&&(y[e]=(y[e]||0)+t,n&&(b[e]||(b[e]=[]),b[e].includes(n)||b[e].push(n)))};if(a){var S=se(a);S&&w(S,100,"Same email thread previously attached to this case.")}for(var k=fe(c),x=fe(l),I=function(e){var t=e,n=String((null==t?void 0:t.id)||""),r=fe(ue(t));if(!n||!r)return"continue";var o=k.includes(r),i=x.includes(r),a=d.some(function(e){return e.includes(r)});(o||i||a)&&w(n,95,"Case reference found in the email.")},C=0,N=e.cases;C<N.length;C++)I(N[C]);for(var E=0,B=e.cases;E<B.length;E++){var O=B[E];if(M=String((null==O?void 0:O.id)||"")){var T=de(O),_=me(T);if(_){var A=ve(T);if(s&&(_===s||_.includes(s)||s.includes(_)))w(M,98,"Email subject matches the case name.");else{if(A.length>0&&c){var j=ge(A,c);if(j.hits>=2){var z=60+30*pe(j.total>0?j.hits/j.total:0,0,1);w(M,z,"Case name matches the email subject.")}}if(l&&A.length>0){var F=_.length>=4&&u.includes(_);if(A.length<=2)F&&w(M,45,"Case name mentioned in the email body.");else{var R=ge(A,l);R.hits>=2?(z=35+25*pe(R.total>0?R.hits/R.total:0,0,1),w(M,z,"Case name mentioned in the email body.")):F&&w(M,40,"Case name mentioned in the email body.")}}}}}}if(f&&g[f])for(var D=0,P=Object.entries(g[f]);D<P.length;D++){var L=P[D],M=L[0];(z=30*he(L[1].count||0))>0&&w(M,z,"You often attach emails from this sender to this case.")}if(m&&p[m])for(var H=0,q=Object.entries(p[m]);H<q.length;H++){var W=q[H];M=W[0],(z=20*he(W[1].count||0))>0&&w(M,z,"This domain often maps to this case.")}for(var U=Date.now(),K=0,$=h||[];K<$.length;K++){var G=$[K];(z=12*pe(1-(U-(G.lastUsedAt||0))/864e5/14,0,1))>0&&w(G.caseId,z,"Recently used.")}var J=Object.entries(y).map(function(e){var t=e[0];return{caseId:t,score:e[1],reasons:b[t]||[]}}).sort(function(e,t){return t.score-e.score}),V=J.map(function(e){return e.score});J.length>0?console.log("[suggestCasesLocal] ðŸ” Top scores (before filtering):",J.slice(0,5).map(function(e){return{caseId:e.caseId,score:e.score.toFixed(1),reasons:e.reasons}})):(console.log("[suggestCasesLocal] âš ï¸ No cases scored any points!"),console.log("[suggestCasesLocal] Input:",{subjectLoose:s,bodyLoose:u.substring(0,100),casesCount:e.cases.length}));var X=J.map(function(e,t){return{caseId:e.caseId,score:e.score,confidencePct:be(V,t),reasons:e.reasons}}).filter(function(e){return e.confidencePct>=10}).slice(0,i),Y=X[0];return{suggestions:X,autoSelectCaseId:Y&&Y.confidencePct>=70?Y.caseId:""}}({conversationKey:o||"",subject:i,bodySnippet:a,attachmentNames:e,fromEmail:c,cases:l,topK:null!=m?m:2});console.log("[SC suggest] cases:",l.length),console.log("[SC suggest] subject:",i),console.log("[SC suggest] bodySnippet:",a),console.log("[SC suggest] suggestions:",r.suggestions.map(function(e){return{caseId:e.caseId,pct:e.confidencePct,score:e.score}}));var f=(l||[]).some(function(e){var t=String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||(null==e?void 0:e.case_name_visible)||(null==e?void 0:e.caseNameVisible)||"").toLowerCase();return t.includes("internal")&&t.includes("know")&&t.includes("how")});if(!(console.log("[SC suggest] has Internal Know How in cases[]:",f),console.log("[SC suggest] case titles sample:",(l||[]).slice(0,15).map(function(e){var t;return{id:String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""),title:String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||"")}})),console.log("[SC suggest] case titles sample:",(l||[]).slice(0,15).map(function(e){var t;return{id:String(null!==(t=null==e?void 0:e.id)&&void 0!==t?t:""),title:String((null==e?void 0:e.title)||(null==e?void 0:e.name)||(null==e?void 0:e.label)||(null==e?void 0:e.caseTitle)||"")}})),p(function(e){var t=(e||[]).map(function(e){var t;return"".concat(String((null==e?void 0:e.caseId)||""),":").concat(String(null!==(t=null==e?void 0:e.score)&&void 0!==t?t:""))}).join("|"),n=(r.suggestions||[]).map(function(e){var t;return"".concat(String((null==e?void 0:e.caseId)||""),":").concat(String(null!==(t=null==e?void 0:e.score)&&void 0!==t?t:""))}).join("|");return t===n?e:r.suggestions}),y(function(e){return e===r.autoSelectCaseId?e:r.autoSelectCaseId}),"manual"===d||u&&"remembered"!==d&&"suggested"!==d&&""!==d&&void 0!==d)){var v=String(r.autoSelectCaseId||"");v&&String(u||"")!==v&&(x.current.emailItemId===String(n)&&x.current.caseId===v||(x.current={emailItemId:String(n),caseId:v}))}},[t,n,o,i,c,a,S,k,u,d,m]),{suggestions:g,autoSelectCaseId:b}}function we(e){var t=e.toLowerCase().trim();if(!t)return"";var n=t.split(".");return n.length<=1||2===n.length?t:n.slice(-2).join(".")}function Se(e){var t=e.trim();if(!t)return"";var n=t.match(/<([^>]+)>/),r=n?n[1]:t,o=r.lastIndexOf("@");return-1===o?"":r.slice(o+1).toLowerCase().trim()}function ke(e,t,n){if(void 0===n&&(n=[]),0===t.length)return!1;var r=new Set,o=Se(e);if(o){var i=we(o);i&&r.add(i)}for(var a=0,c=n;a<c.length;a++){var s=we(c[a].toLowerCase().trim());s&&r.add(s)}if(0===r.size)return!1;for(var l=0,u=t;l<u.length;l++){var d=Se(u[l]);if(!d)return!1;var f=we(d);if(!f)return!1;if(!r.has(f))return!1}return!0}var xe=n(64583).Promise,Ie=function(e,t,n,r){return new(n||(n=xe))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Ce=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Ne="singlecase_token",Ee="singlecase_user_email",Be="singlecase_auth_issued_at",Oe="sc_token",Te="sc_user_email",_e="sc_auth_issued_at";function Ae(e){var t=(e||"").trim().toLowerCase();return t.length>0?t:"unknown@singlecase.local"}function je(e){return Ie(this,void 0,void 0,function(){var t,n,r;return Ce(this,function(o){switch(o.label){case 0:if("undefined"==typeof OfficeRuntime||!(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeRuntime.storage.getItem(e)];case 2:return"string"==typeof(n=o.sent())?[2,n]:[3,4];case 3:return t=o.sent(),console.warn("[rtGet] OfficeRuntime.storage.getItem failed:",t),[3,4];case 4:if(null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.roamingSettings)try{if("string"==typeof(n=Office.context.roamingSettings.get(e)))return[2,n]}catch(e){console.warn("[rtGet] roamingSettings.get failed:",e)}return[2,null]}})})}function ze(e,t){return Ie(this,void 0,void 0,function(){var n,r,o;return Ce(this,function(i){switch(i.label){case 0:if("undefined"==typeof OfficeRuntime||!(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeRuntime.storage.setItem(e,t)];case 2:return i.sent(),console.log("[rtSet] Saved to OfficeRuntime.storage:",e),[2];case 3:return n=i.sent(),console.warn("[rtSet] OfficeRuntime.storage.setItem failed:",n),[3,4];case 4:if(!(null===(o=null===Office||void 0===Office?void 0:Office.context)||void 0===o?void 0:o.roamingSettings))return[3,8];i.label=5;case 5:return i.trys.push([5,7,,8]),Office.context.roamingSettings.set(e,t),[4,new xe(function(t,n){Office.context.roamingSettings.saveAsync(function(r){var o;r.status===Office.AsyncResultStatus.Succeeded?(console.log("[rtSet] Saved to roamingSettings:",e),t()):(console.error("[rtSet] roamingSettings.saveAsync failed:",r.error),n(new Error((null===(o=r.error)||void 0===o?void 0:o.message)||"saveAsync failed")))})})];case 6:return i.sent(),[3,8];case 7:return r=i.sent(),console.error("[rtSet] roamingSettings failed:",r),[3,8];case 8:return[2]}})})}function Fe(e){return Ie(this,void 0,void 0,function(){return Ce(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,OfficeRuntime.storage.removeItem(e)];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})}function Re(){var e=sessionStorage.getItem(Ne),t=sessionStorage.getItem(Ee),n=sessionStorage.getItem(Be);return{token:e,email:Ae(t),issuedAt:n?Number(n):0}}function De(){return Ie(this,void 0,void 0,function(){var e,t,n,r;return Ce(this,function(o){switch(o.label){case 0:return[4,xe.all([je(Oe),je(Te),je(_e)])];case 1:return e=o.sent(),t=e[0],n=e[1],r=e[2],[2,{token:t,email:Ae(n),issuedAt:r?Number(r):0}]}})})}function Pe(e,t){return Ie(this,void 0,void 0,function(){var n,r;return Ce(this,function(o){switch(o.label){case 0:return n=Ae(t),r=Date.now(),sessionStorage.setItem(Ne,e),sessionStorage.setItem(Ee,n),sessionStorage.setItem(Be,String(r)),[4,xe.all([ze(Oe,e),ze(Te,n),ze(_e,String(r))])];case 1:return o.sent(),[2]}})})}function Le(){return Ie(this,void 0,void 0,function(){return Ce(this,function(e){switch(e.label){case 0:return sessionStorage.removeItem(Ne),sessionStorage.removeItem(Ee),sessionStorage.removeItem(Be),[4,xe.all([Fe(Oe),Fe(Te),Fe(_e)])];case 1:return e.sent(),[2]}})})}var Me=n(64583).Promise,He=function(){return He=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},He.apply(this,arguments)},qe=function(e,t,n,r){return new(n||(n=Me))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},We=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function Ue(){return qe(this,void 0,void 0,function(){var e,t,n;return We(this,function(r){switch(r.label){case 0:return console.log("[resolveApiBaseUrl] Reading workspaceHost from storage key:",u.workspaceHost),[4,(0,l.wv)(u.workspaceHost)];case 1:if(e=r.sent(),console.log("[resolveApiBaseUrl] Raw stored host:",e),t=function(e){var t=(e||"").trim().toLowerCase();return t?t.replace(/^https?:\/\//i,"").split("/")[0]:""}(e||""),console.log("[resolveApiBaseUrl] Normalized host:",t),!t)throw console.error("[resolveApiBaseUrl] Workspace host is missing"),new Error("Workspace host is missing.");return n="/singlecase/".concat(encodeURIComponent(t),"/publicapi/v1"),console.log("[resolveApiBaseUrl] Resolved base URL:",n),[2,n]}})})}function Ke(){return qe(this,void 0,void 0,function(){var e,t;return We(this,function(n){switch(n.label){case 0:return(null==(e=Re())?void 0:e.token)?(console.log("[getToken] Using sessionStorage token"),[2,e.token]):(console.log("[getToken] sessionStorage token not available, trying OfficeRuntime.storage"),[4,De()]);case 1:if(null==(t=n.sent())?void 0:t.token)return console.log("[getToken] Using OfficeRuntime.storage token"),[2,t.token];throw console.error("[getToken] No token found in either sessionStorage or OfficeRuntime.storage"),new Error("Missing auth token.")}})})}function $e(e,t){return qe(this,void 0,void 0,function(){var n,r;return We(this,function(o){switch(o.label){case 0:return[4,e.text().catch(function(){return""})];case 1:if(n=o.sent(),!e.ok){if(423===e.status)throw new Error("Dokument je momentÃ¡lnÄ› uzamÄen. NÄ›kdo jej prÃ¡vÄ› upravuje. PoÄkejte prosÃ­m, neÅ¾ se dokument odemkne, a zkuste to znovu.");throw new Error("".concat(t," (").concat(e.status,"): ").concat(n||e.statusText))}if(!(r=e.headers.get("content-type")||"").includes("application/json"))throw new Error("".concat(t,": expected JSON but got ").concat(r||"no content-type","."));return[2,JSON.parse(n)]}})})}function Ge(e){return qe(this,void 0,void 0,function(){var t,n,r,o,i;return We(this,function(a){switch(a.label){case 0:return[4,Ke()];case 1:return t=a.sent(),[4,Ue()];case 2:return n=a.sent(),r="".concat(n,"/documents/").concat(encodeURIComponent(String(e))),[4,fetch(r,{method:"GET",headers:{Authentication:t,"Content-Type":"application/json","Accept-Encoding":"identity"}})];case 3:return 404===(o=a.sent()).status?[2,null]:[4,$e(o,"Get document failed")];case 4:return i=a.sent(),[2,{id:String(i.id||e),name:String(i.name||""),case_id:String(i.case_id||"")}]}})})}function Je(e){return qe(this,void 0,void 0,function(){var t,n,r,o,i,a,c,s,l,u,d,f,m,v,g,p;return We(this,function(h){switch(h.label){case 0:return t=e.documentId,n=e.fileName,r=e.mimeType,o=e.dataBase64,i=e.directoryId,[4,Ke()];case 1:return a=h.sent(),[4,Ue()];case 2:c=h.sent(),s=encodeURIComponent(String(t)),l={name:n,mime_type:r,data_base64:o},i&&(l.dir_id=i),u=JSON.stringify(l),d=[{url:"".concat(c,"/documents/").concat(s,"/version"),method:"POST"},{url:"".concat(c,"/documents/").concat(s,"/versions"),method:"POST"},{url:"".concat(c,"/documents/").concat(s,"/versions"),method:"PUT"},{url:"".concat(c,"/documents/").concat(s,"/version"),method:"PUT"},{url:"".concat(c,"/documents/").concat(s,"/versions"),method:"PATCH"},{url:"".concat(c,"/documents/").concat(s,"/version"),method:"PATCH"}],f=null,m=0,v=d,h.label=3;case 3:return m<v.length?(g=v[m],[4,fetch(g.url,{method:g.method,headers:{"Content-Type":"application/json",Authentication:a,"Accept-Encoding":"identity"},body:u})]):[3,7];case 4:return 404===(p=h.sent()).status||405===p.status?(f=new Error("Endpoint not available: ".concat(g.method," ").concat(g.url," (").concat(p.status,")")),[3,6]):[4,$e(p,"Upload version failed")];case 5:return[2,h.sent()];case 6:return m++,[3,3];case 7:throw f instanceof Error?f:new Error("Upload version failed: no supported endpoint found")}})})}function Ve(e){return qe(this,void 0,void 0,function(){var t,n,r,o,i,a,c,s,l,u,d,f,m,v,g,p,h,b;return We(this,function(y){switch(y.label){case 0:t=e.caseId,n=e.fileName,r=e.mimeType,o=e.dataBase64,i=e.directoryId,a=e.metadata,console.log("[uploadDocumentToCase] Starting upload",{caseId:t,fileName:n,mimeType:r,dataLength:o.length}),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Ke()];case 2:return c=y.sent(),console.log("[uploadDocumentToCase] Token retrieved",{hasToken:!!c,tokenPrefix:c.slice(0,10)}),[3,4];case 3:throw s=y.sent(),console.error("[uploadDocumentToCase] Failed to get token:",s),s;case 4:return y.trys.push([4,6,,7]),[4,Ue()];case 5:return l=y.sent(),console.log("[uploadDocumentToCase] Base URL resolved:",l),[3,7];case 6:throw u=y.sent(),console.error("[uploadDocumentToCase] Failed to resolve base URL:",u),u;case 7:d="".concat(l,"/documents"),console.log("[uploadDocumentToCase] Full URL:",d),f={case_id:t,documents:[He(He({name:n,mime_type:r,data_base64:o},i?{dir_id:i}:{}),a?{metadata:a}:{})]},console.log("[uploadDocumentToCase] Payload structure:",{case_id:f.case_id,documentCount:f.documents.length,firstDoc:{name:f.documents[0].name,mime_type:f.documents[0].mime_type,data_base64_length:f.documents[0].data_base64.length}}),y.label=8;case 8:return y.trys.push([8,10,,11]),[4,fetch(d,{method:"POST",headers:{"Content-Type":"application/json",Authentication:c,"Accept-Encoding":"identity"},body:JSON.stringify(f)})];case 9:return m=y.sent(),console.log("[uploadDocumentToCase] Fetch completed",{status:m.status,statusText:m.statusText,ok:m.ok}),[3,11];case 10:throw v=y.sent(),console.error("[uploadDocumentToCase] Fetch failed:",v),new Error("Network request failed: ".concat(v instanceof Error?v.message:String(v)));case 11:return m.ok?[3,13]:[4,m.text().catch(function(){return""})];case 12:g=y.sent(),p=g.slice(0,300),console.error("[uploadDocumentToCase] Upload failed",{status:m.status,statusText:m.statusText,url:d,responseSnippet:p}),y.label=13;case 13:return[4,$e(m,"Upload failed")];case 14:return h=y.sent(),console.log("[uploadDocumentToCase] Upload successful",{documentIds:null===(b=h.documents)||void 0===b?void 0:b.map(function(e){return e.id})}),[2,h]}})})}var Xe=n(64583).Promise,Ye=function(e,t,n,r){return new(n||(n=Xe))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Qe=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function Ze(e){return"sc:uploadedLinks:".concat(e)}function et(e){return Ye(this,void 0,void 0,function(){var t,n;return Qe(this,function(r){switch(r.label){case 0:return e?[4,(0,l.wv)(Ze(e))]:[2,[]];case 1:if(!(t=r.sent()))return[2,[]];try{return n=JSON.parse(t),Array.isArray(n)?[2,n.filter(function(e){return e&&"string"==typeof e.id&&"string"==typeof e.url}).map(function(e){return{id:String(e.id),name:"string"==typeof e.name?e.name:"",url:String(e.url),kind:"attachment"===e.kind?"attachment":"email",atIso:"string"==typeof e.atIso?e.atIso:""}})]:[2,[]]}catch(e){return[2,[]]}}})})}function tt(e,t){return Ye(this,void 0,void 0,function(){return Qe(this,function(n){switch(n.label){case 0:return e?[4,(0,l.Kg)(Ze(e),JSON.stringify(t||[]))]:[2];case 1:return n.sent(),[2]}})})}var nt=n(45614),rt=n(29255),ot=n(87294);const it={};function at(){let e=null,t="",n="";const r=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const o=arguments[e];if("string"==typeof o&&""!==o){const i=o.indexOf(nt.fj);if(-1===i)t+=o+" ";else{const a=o.substr(i,nt.wn);i>0&&(t+=o.slice(0,i)),n+=a,r[e]=a}}}if(""===n)return t.slice(0,-1);const o=it[n];if(void 0!==o)return t+o;const i=[];for(let t=0;t<arguments.length;t++){const n=r[t];if(n){const t=nt.k1[n];t&&(i.push(t[nt.FS]),e=t[nt.AX])}}const a=Object.assign.apply(Object,[{}].concat(i)),[c,s]=(0,ot.z)(a,e),l=(0,rt.G)(s,e,r),u=l+" "+c;return it[n]=u,nt.k1[l]=[a,e],t+u}const ct=r.createContext(void 0),st={},lt=ct.Provider;var ut=n(53864);function dt(e,t,n=ut.A){const r=n();let o=null,i=null;return function(n){const{dir:a,renderer:c}=n,s="ltr"===a;return s?null===o&&(o=(0,ot.N)(e,a)):null===i&&(i=(0,ot.N)(e,a)),r(c,t),s?o:i}}var ft=n(49264),mt=n(26312),vt=n(56004);function gt(e,t){const n=dt(e,t,ft.A);return function(){const e=(0,vt.m)(),t=(0,mt.J)();return n({dir:e,renderer:t})}}const pt=gt({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{transform:scaleX(-1);}"]}),ht=gt({root:{B8gzw0y:"f1dd5bof"}},{m:[["@media (forced-colors: active){.f1dd5bof{forced-color-adjust:auto;}}",{m:"(forced-colors: active)"}]]}),bt=(e,t,n,o)=>{const i="1em"===t?"20":t,a=r.forwardRef((e,a)=>{const c=ht(),s=((e,t)=>{const{title:n,primaryFill:o="currentColor",...i}=e,a={...i,title:void 0,fill:o},c=pt(),s=(()=>{const e=r.useContext(ct);return null!=e?e:st})();return a.className=at(c.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&c.rtl,a.className),n&&(a["aria-label"]=n),a["aria-label"]||a["aria-labelledby"]?a.role="img":a["aria-hidden"]=!0,a})(e,{flipInRtl:null==o?void 0:o.flipInRtl}),l={...s,className:at(s.className,c.root),ref:a,width:t,height:t,viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?r.createElement("svg",{...l,dangerouslySetInnerHTML:{__html:n}}):r.createElement("svg",l,...n.map(e=>r.createElement("path",{d:e,fill:l.fill})))});return a.displayName=e,a},yt=bt("Open24Regular","24",["M6.25 4.5c-.97 0-1.75.78-1.75 1.75v11.5c0 .97.78 1.75 1.75 1.75h11.5c.97 0 1.75-.78 1.75-1.75v-4a.75.75 0 0 1 1.5 0v4c0 1.8-1.46 3.25-3.25 3.25H6.25A3.25 3.25 0 0 1 3 17.75V6.25C3 4.45 4.46 3 6.25 3h4a.75.75 0 0 1 0 1.5h-4ZM13 3.75c0-.41.34-.75.75-.75h6.5c.41 0 .75.34.75.75v6.5a.75.75 0 0 1-1.5 0V5.56l-5.22 5.22a.75.75 0 0 1-1.06-1.06l5.22-5.22h-4.69a.75.75 0 0 1-.75-.75Z"]),wt=bt("Edit24Regular","24",["M20.95 3.05a3.58 3.58 0 0 0-5.06 0L3.94 15c-.4.4-.7.92-.82 1.48l-1.1 4.6a.75.75 0 0 0 .9.9l4.6-1.1A3.1 3.1 0 0 0 9 20.07L20.95 8.11a3.58 3.58 0 0 0 0-5.06Zm-4 1.06a2.08 2.08 0 1 1 2.94 2.94l-.89.89L16.06 5l.9-.9ZM15 6.06 17.94 9l-10 10a1.6 1.6 0 0 1-.76.43l-3.42.8.82-3.4c.06-.3.21-.56.42-.77l10-10Z"]);function St(e){var t=e.doc,n=e.workspaceHost,o=e.onOpenUrl,i=e.buildLiveEditUrl;return r.createElement("div",{className:"mwFiledDocMiniRow"},r.createElement("div",{className:"mwFiledDocMiniText",title:t.name},r.createElement("span",{className:"mwFiledDocMiniName"},t.name),t.uploadedBy?r.createElement("span",{className:"mwFiledDocMiniMeta",title:t.uploadedBy},"NahrÃ¡l: ",t.uploadedBy):null),r.createElement("div",{className:"mwFiledDocMiniActions"},r.createElement("button",{type:"button",className:"mwMiniIconBtn",title:"Open",onClick:function(){return o(t.url)}},r.createElement(yt,{className:"mwIconSvg"})),n&&t.id?r.createElement("button",{type:"button",className:"mwMiniIconBtnPrimary",title:"Edit",onClick:function(){return o(i(n,String(t.id)))}},r.createElement(wt,{className:"mwIconSvgPrimary"})):null))}function kt(e){var t=e.caseUrl,n=e.filedCaseName,o=e.sentPill,i=e.documentsToShow,a=e.workspaceHost,c=e.onOpenUrl,s=e.buildLiveEditUrl,l=e.fmtCs;return r.createElement("div",{className:"mwFiledSummaryCard"},r.createElement("div",{className:"mwFiledSummaryHeader"},r.createElement("div",{className:"mwFiledSummaryHeaderLeft"},r.createElement("span",{className:"mwFiledSummaryLabel"},"Case:"),r.createElement("div",{className:"mwFiledSummaryTitleWrap"},t?r.createElement("button",{type:"button",className:"mwFiledCaseLink",onClick:function(){return c(t)},title:"Open case"},n):r.createElement("span",{className:"mwFiledCaseName"},n)))),r.createElement("div",{className:"mwFiledSummaryMeta"},(null==o?void 0:o.atIso)?r.createElement("span",{className:"mwFiledSummaryMetaItem"},"Filed: ".concat(l(o.atIso))):null,r.createElement("span",{className:"mwFiledSummaryMetaItem"},"Documents: ".concat(i.length))),i.length>0?r.createElement("div",{className:"mwFiledDocsMini"},i.map(function(e){return r.createElement(St,{key:e.id,doc:e,workspaceHost:a,onOpenUrl:c,buildLiveEditUrl:s})})):null)}var xt=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function It(e){var t=e.attachmentsLite,n=e.attachmentIds,o=e.selectedAttachments,i=e.onSelectionChange,a=e.filingMode,c=e.onFilingModeChange,s=e.containerRef;return r.createElement("div",{ref:s,className:"mwAttachmentsStep"},r.createElement("div",{className:"mwAttachmentsStepTitle"},"Co chcete uloÅ¾it?"),r.createElement("div",{className:"mwAttachmentsStepButtons"},r.createElement("button",{type:"button",className:"mwFilingBtn ".concat("attachments"===a?"mwFilingBtnActive":""),onClick:function(){c("attachments"),i(n)}},"Pouze pÅ™Ã­lohy"),r.createElement("button",{type:"button",className:"mwFilingBtn ".concat("both"===a?"mwFilingBtnActive":""),onClick:function(){c("both"),i(n)}},"Email i pÅ™Ã­lohy")),r.createElement("div",{className:"mwAttachmentsStepList"},t.map(function(e){var t=String(e.id);return r.createElement("label",{key:t,className:"mwAttachmentsStepLabel"},r.createElement("input",{type:"checkbox",checked:o.includes(t),onChange:function(e){i(e.target.checked?xt(xt([],o,!0),[t],!1):o.filter(function(e){return e!==t}))}}),e.name)})))}function Ct(e){var t=e.text,n=e.isUnfiled,o=e.actions,i=e.tone,a=n?"mwChatBubble":"mwChatMuted";return"success"===(void 0===i?"default":i)&&n&&(a="mwChatBubbleSuccess"),r.createElement("div",{className:a},r.createElement("div",null,t||"Select an email and Iâ€™ll show you relevant suggestions."),o&&o.length>0&&r.createElement("div",{className:"mwQuickReplies"},o.map(function(e){return r.createElement("button",{key:e.id,type:"button",className:"mwQuickReplyBtn",onClick:e.onClick},e.label)})))}var Nt=n(92245),Et=n(64583).Promise,Bt=function(){return Bt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Bt.apply(this,arguments)},Ot=function(e,t,n,r){return new(n||(n=Et))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Tt=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},_t=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},At="SC: Filed",jt="SC: Unfiled",zt="sc_conv_case:",Ft="sc_conv_ctx:";function Rt(e,t){return Ot(this,void 0,void 0,function(){var n,r,o;return Tt(this,function(i){switch(i.label){case 0:return n=String(e||"").trim(),r=String(t.caseId||"").trim(),o=String(t.emailDocId||"").trim(),n&&r&&o?[4,(0,l.Kg)("".concat(Ft).concat(n),JSON.stringify({caseId:r,emailDocId:o}))]:[2];case 1:return i.sent(),[2]}})})}function Dt(e){return Ot(this,void 0,void 0,function(){var t,n;return Tt(this,function(r){switch(r.label){case 0:return t=String(e.caseId||"").trim(),n=String(e.emailDocId||"").trim(),t&&n?[4,(0,l.Kg)("sc_last_filed_ctx",JSON.stringify({caseId:t,emailDocId:n}))]:[2];case 1:return r.sent(),[2]}})})}function Pt(e){return Ot(this,void 0,void 0,function(){var t;return Tt(this,function(n){switch(n.label){case 0:return(t=String(e||"").trim())?[4,(0,l.Kg)("sc_last_filed_case",t)]:[2];case 1:return n.sent(),[2]}})})}function Lt(e,t){return Ot(this,void 0,void 0,function(){var n,r;return Tt(this,function(o){switch(o.label){case 0:return n=String(e||"").trim(),r=String(t||"").trim(),n&&r?[4,(0,l.Kg)("".concat(zt).concat(n),r)]:[2];case 1:return o.sent(),[2]}})})}function Mt(e){return Ot(this,void 0,void 0,function(){var t,n;return Tt(this,function(r){switch(r.label){case 0:return(t=String(e||"").trim())?[4,(0,l.wv)("".concat(zt).concat(t))]:[2,""];case 1:return n=r.sent(),[2,String(n||"").trim()]}})})}var Ht=(null==u?void 0:u.recipientHistory)||"recipientHistory";function qt(e){return String(e||"").trim().toLowerCase()}function Wt(){return Ot(this,void 0,void 0,function(){var e,t;return Tt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,l.wv)(Ht)];case 1:return(e=n.sent())?[2,(t=JSON.parse(String(e)))&&"object"==typeof t?t:{}]:[2,{}];case 2:return n.sent(),[2,{}];case 3:return[2]}})})}function Ut(){return Ot(this,void 0,void 0,function(){var e,t,n,r,o,i;return Tt(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.item,(null===(i=null==e?void 0:e.categories)||void 0===i?void 0:i.getAsync)?[4,new Et(function(t){e.categories.getAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(Array.isArray(e.value)?e.value:[]):t([])})})]:[2,[]];case 1:return t=a.sent(),n=t.map(nn).filter(Boolean),console.log("[officeCats] raw",n),console.log("[officeCats] norm",n.map(tn)),[2,n.map(tn).filter(Boolean)];case 2:return a.sent(),[2,[]];case 3:return[2]}})})}function Kt(){return Ot(this,void 0,void 0,function(){var e,t,n,r;return Tt(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(e=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item)?"string"==typeof e.subject?[2,String(e.subject||"")]:(null===(r=null==e?void 0:e.subject)||void 0===r?void 0:r.getAsync)?[4,new Et(function(t){e.subject.getAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(String(e.value||"")):t("")})})]:[3,2]:[2,""];case 1:return[2,o.sent()||""];case 2:return[2,String((null==e?void 0:e.subject)||"")];case 3:return o.sent(),[2,""];case 4:return[2]}})})}function $t(e){return Ot(this,void 0,void 0,function(){return Tt(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,l.Kg)(Ht,JSON.stringify(e))];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}})})}function Gt(e,t){return Ot(this,void 0,void 0,function(){var n,r,o,i,a,c,s,l,u;return Tt(this,function(d){switch(d.label){case 0:return(n=String(t||"").trim())?(r=(new Date).toISOString(),[4,Wt()]):[2];case 1:for(o=d.sent(),i=0,a=e;i<a.length;i++)c=a[i],(s=qt(c))&&(l=o[s],u={email:s,caseId:n,count:((null==l?void 0:l.caseId)===n?Number((null==l?void 0:l.count)||0):0)+1,lastUsedIso:r},o[s]=u);return[4,$t(o)];case 2:return d.sent(),[2]}})})}function Jt(e){return Ot(this,void 0,void 0,function(){var t,n,r,o,i,a,c,s,l,u,d,f,m;return Tt(this,function(v){switch(v.label){case 0:return v.trys.push([0,20,,21]),t=JSON.stringify({caseId:e.caseId,autoFileOnSend:e.autoFileOnSend,baseCaseId:String(e.baseCaseId||"").trim(),baseEmailDocId:String(e.baseEmailDocId||"").trim()}),n="sc_intent:".concat(e.itemKey),console.log("[saveComposeIntent] Saving intent",{key:n,caseId:e.caseId,autoFileOnSend:e.autoFileOnSend,baseCaseId:String(e.baseCaseId||"").trim(),baseEmailDocId:String(e.baseEmailDocId||"").trim()}),"undefined"!=typeof OfficeRuntime&&(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)?[4,OfficeRuntime.storage.setItem(n,t)]:[3,2];case 1:return v.sent(),console.log("[saveComposeIntent] Saved to OfficeRuntime.storage"),[3,5];case 2:return(null===(s=null===Office||void 0===Office?void 0:Office.context)||void 0===s?void 0:s.roamingSettings)?(Office.context.roamingSettings.set(n,t),[4,new Et(function(e,t){Office.context.roamingSettings.saveAsync(function(n){var r;n.status===Office.AsyncResultStatus.Succeeded?(console.log("[saveComposeIntent] Saved to roamingSettings"),e()):(console.error("[saveComposeIntent] roamingSettings.saveAsync failed:",n.error),t(new Error((null===(r=n.error)||void 0===r?void 0:r.message)||"saveAsync failed")))})})]):[3,4];case 3:return v.sent(),[3,5];case 4:localStorage.setItem(n,t),console.warn("[saveComposeIntent] Saved to localStorage (cross-context won't work)"),v.label=5;case 5:return v.trys.push([5,11,,12]),r="sc_intent:last_compose","undefined"!=typeof OfficeRuntime&&(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)?[4,OfficeRuntime.storage.setItem(r,t)]:[3,7];case 6:return v.sent(),console.log("[saveComposeIntent] Saved fallback to OfficeRuntime.storage"),[3,10];case 7:return(null===(l=null===Office||void 0===Office?void 0:Office.context)||void 0===l?void 0:l.roamingSettings)?(Office.context.roamingSettings.set(r,t),[4,new Et(function(e){Office.context.roamingSettings.saveAsync(function(){return e()})})]):[3,9];case 8:return v.sent(),console.log("[saveComposeIntent] Saved fallback to roamingSettings"),[3,10];case 9:localStorage.setItem(r,t),console.log("[saveComposeIntent] Saved fallback to localStorage"),v.label=10;case 10:return[3,12];case 11:return o=v.sent(),console.warn("[saveComposeIntent] Failed to save fallback key:",o),[3,12];case 12:return v.trys.push([12,18,,19]),(i=String((null===(f=null===(d=null===(u=null===Office||void 0===Office?void 0:Office.context)||void 0===u?void 0:u.mailbox)||void 0===d?void 0:d.item)||void 0===f?void 0:f.itemId)||"").trim())&&i!==e.itemKey?(a="sc_intent:".concat(i),"undefined"!=typeof OfficeRuntime&&(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)?[4,OfficeRuntime.storage.setItem(a,t)]:[3,14]):[3,17];case 13:return v.sent(),[3,17];case 14:return(null===(m=null===Office||void 0===Office?void 0:Office.context)||void 0===m?void 0:m.roamingSettings)?(Office.context.roamingSettings.set(a,t),[4,new Et(function(e){Office.context.roamingSettings.saveAsync(function(){return e()})})]):[3,16];case 15:return v.sent(),[3,17];case 16:localStorage.setItem(a,t),v.label=17;case 17:return[3,19];case 18:return v.sent(),[3,19];case 19:return[3,21];case 20:return c=v.sent(),console.error("[saveComposeIntent] Failed to save intent:",c),[3,21];case 21:return[2]}})})}function Vt(e){return Ot(this,void 0,void 0,function(){var t,n,r,o,i,a,c,s,l,u,d,f,m,v,g;return Tt(this,function(p){switch(p.label){case 0:return[4,Wt()];case 1:for(t=p.sent(),n={},r=0,o=e;r<o.length;r++)i=o[r],(a=qt(i))&&(null==(c=t[a])?void 0:c.caseId)&&(s=Math.min(10,Math.max(1,Number(c.count||1))),n[c.caseId]=(n[c.caseId]||0)+s);for(l="",u=0,d=0,f=Object.entries(n);d<f.length;d++)m=f[d],v=m[0],(g=m[1])>u&&(u=g,l=v);return l?[2,{caseId:l,score:u}]:[2,null]}})})}function Xt(e){var t;if(e){try{var n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.ui;if(n&&"function"==typeof n.openBrowserWindow)return void n.openBrowserWindow(e)}catch(e){}try{window.open(e,"_blank","noopener,noreferrer")}catch(e){}}}function Yt(e,t){var n=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return n&&t?"https://".concat(n,"/liveEdit/electronOnlineEditLatestVersion/").concat(encodeURIComponent(t)):""}function Qt(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return String((null==n?void 0:n.itemId)||"")}catch(e){return""}}function Zt(){var e,t,n;try{var r=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return Boolean(null===(n=null==r?void 0:r.body)||void 0===n?void 0:n.setAsync)}catch(e){return!1}}function en(){return Ot(this,void 0,void 0,function(){var e,t,n,r,o,i,a,c;return Tt(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),(e=null===(a=null===(i=null===Office||void 0===Office?void 0:Office.context)||void 0===i?void 0:i.mailbox)||void 0===a?void 0:a.item)?Boolean(null===(c=null==e?void 0:e.body)||void 0===c?void 0:c.setAsync)?(t=String(e.conversationId||e.conversationKey||"").trim())?[2,"draft:".concat(t)]:(n=String(e.dateTimeCreated||"").trim())?[2,"draft:".concat(n)]:[2,"draft:current"]:(r=String(e.itemId||"").trim())?[2,r]:"function"!=typeof e.getItemIdAsync?[3,2]:[4,new Et(function(t){e.getItemIdAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(String(e.value||"")):t("")})})]:[2,""];case 1:if(o=s.sent())return[2,o];s.label=2;case 2:return[2,""];case 3:return s.sent(),[2,""];case 4:return[2]}})})}function tn(e){return String(e||"").normalize("NFKC").replace(/[\u00A0\u2007\u202F]/g," ").replace(/\s+/g," ").trim().toLowerCase()}function nn(e){var t,n,r,o;if(!e)return"";if("string"==typeof e)return e;var i=null!==(o=null!==(r=null!==(n=null!==(t=e.displayName)&&void 0!==t?t:e.name)&&void 0!==n?n:e.label)&&void 0!==r?r:e.value)&&void 0!==o?o:"";return String(i||"")}function rn(e,t){return Ot(this,void 0,void 0,function(){var n,r,o,i,a,c,s,l,u,d;return Tt(this,function(f){switch(f.label){case 0:n=function(e){return e.map(function(e){return tn(nn(e))}).filter(Boolean)},r=function(n){return n.includes(e)||n.includes(t)},o=[],i=[],f.label=1;case 1:return f.trys.push([1,4,,5]),a=null===(u=null===(l=null===Office||void 0===Office?void 0:Office.context)||void 0===l?void 0:l.mailbox)||void 0===u?void 0:u.item,(null===(d=null==a?void 0:a.categories)||void 0===d?void 0:d.getAsync)?[4,new Et(function(e){a.categories.getAsync(function(t){(null==t?void 0:t.status)===Office.AsyncResultStatus.Succeeded?e(Array.isArray(t.value)?t.value:[]):e([])})})]:[3,3];case 2:c=f.sent(),o=n(c),f.label=3;case 3:return[3,5];case 4:return f.sent(),[3,5];case 5:return f.trys.push([5,7,,8]),[4,(0,Nt.getCurrentEmailCategoriesGraph)()];case 6:return s=f.sent(),i=n(Array.isArray(s)?s:[]),[3,8];case 7:return f.sent(),[3,8];case 8:return console.log("[cats] sourcePref (after reads)",{officeNorm:o,graphNorm:i,hasOfficeSignal:r(o),hasGraphSignal:r(i)}),r(o)?[2,o]:r(i)?[2,i]:[2,Array.from(new Set(_t(_t([],o||[],!0),i||[],!0)))]}})})}function on(e,t,n){return Ot(this,void 0,void 0,function(){var r;return Tt(this,function(o){switch(o.label){case 0:return[4,rn(e,t)];case 1:return(r=o.sent()).includes(t)?(n(!0),[2]):(r.includes(e),n(!1),[2])}})})}function an(e){return Ot(this,void 0,void 0,function(){var t,n,r,o,i,a;return Tt(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),t=null===(i=null===(o=null===Office||void 0===Office?void 0:Office.context)||void 0===o?void 0:o.mailbox)||void 0===i?void 0:i.item,(null===(a=null==t?void 0:t.body)||void 0===a?void 0:a.getAsync)?[4,new Et(function(e){t.body.getAsync(Office.CoercionType.Text,function(t){(null==t?void 0:t.status)===Office.AsyncResultStatus.Succeeded?e(String(t.value||"")):e("")})})]:[2,""];case 1:return n=c.sent(),(r=String(n||"").trim())?[2,r.length>e?r.slice(0,e):r]:[2,""];case 2:return c.sent(),[2,""];case 3:return[2]}})})}function cn(){var e,t,n,r,o,i;try{var a=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item,c=(null===(n=null==a?void 0:a.from)||void 0===n?void 0:n.emailAddress)||(null===(r=null==a?void 0:a.from)||void 0===r?void 0:r.address)||(null===(o=null==a?void 0:a.sender)||void 0===o?void 0:o.emailAddress)||(null===(i=null==a?void 0:a.sender)||void 0===i?void 0:i.address)||"";return String(c||"")}catch(e){return""}}function sn(){return Ot(this,void 0,void 0,function(){var e,t,n,r,o,i,a,c;return Tt(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,5]),(e=null===(c=null===(a=null===Office||void 0===Office?void 0:Office.context)||void 0===a?void 0:a.mailbox)||void 0===c?void 0:c.item)?[4,(t=function(e){return new Et(function(t){try{if(!(null==e?void 0:e.getAsync))return t([]);e.getAsync(function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded?t(Array.isArray(e.value)?e.value:[]):t([])})}catch(e){t([])}})})(e.to)]:[2,[]];case 1:return n=s.sent(),[4,t(e.cc)];case 2:return r=s.sent(),[4,t(e.bcc)];case 3:return o=s.sent(),i=_t(_t(_t([],n,!0),r,!0),o,!0).map(function(e){return qt((null==e?void 0:e.emailAddress)||(null==e?void 0:e.address)||"")}).filter(Boolean),[2,Array.from(new Set(i))];case 4:return s.sent(),[2,[]];case 5:return[2]}})})}function ln(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;if(!n)return[];var r=Array.isArray(n.to)?n.to:[],o=Array.isArray(n.cc)?n.cc:[],i=_t(_t([],r,!0),o,!0).map(function(e){return qt((null==e?void 0:e.emailAddress)||(null==e?void 0:e.address)||"")}).filter(Boolean);return Array.from(new Set(i))}catch(e){return[]}}function un(e){return e.toLowerCase().trim().replace(/-/g,".")}function dn(e,t){return Ot(this,void 0,void 0,function(){var n,r,o;return Tt(this,function(i){return n=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.item,[2,new Et(function(r,o){try{if(!(null==n?void 0:n.getAttachmentContentAsync))return o(new Error("Attachment API not available"));n.getAttachmentContentAsync(e,function(i){var a;if(!i||i.status!==Office.AsyncResultStatus.Succeeded)return o(null==i?void 0:i.error);var c=i.value||{},s=Array.isArray(null==n?void 0:n.attachments)?String((null===(a=n.attachments.find(function(t){return String(null==t?void 0:t.id)===String(e)}))||void 0===a?void 0:a.name)||""):"",l=String(c.name||t||s||"attachment");r({base64:String(c.content||""),name:l,mime:String(c.contentType||"application/octet-stream")})})}catch(e){o(e)}})]})})}function fn(e){return Ot(this,void 0,void 0,function(){return Tt(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,j(e,null)];case 1:case 2:return t.sent(),[3,3];case 3:return t.trys.push([3,5,,6]),[4,tt(e,[])];case 4:case 5:return t.sent(),[3,6];case 6:return[2]}})})}function mn(e,t){return Ot(this,void 0,void 0,function(){var n,r,o,i,a,c,s,l;return Tt(this,function(u){switch(u.label){case 0:if(!(n=String((null==e?void 0:e.documentId)||"").trim()))return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,Ge(n)];case 2:return[2,null!==(l=u.sent())];case 3:return u.sent(),[2,null];case 4:return[4,et(t).catch(function(){return[]})];case 5:if(r=u.sent(),0===(o=Array.isArray(r)?r:[]).length)return[2,null];i=0,a=o.slice(0,5),u.label=6;case 6:if(!(i<a.length))return[3,11];if(c=a[i],!(s=String((null==c?void 0:c.id)||"").trim()))return[3,10];u.label=7;case 7:return u.trys.push([7,9,,10]),[4,Ge(s)];case 8:return(null==(l=u.sent())?void 0:l.id)?[2,!0]:[3,10];case 9:return u.sent(),[2,null];case 10:return i++,[3,6];case 11:return[2,!1]}})})}function vn(e,t){var n=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return n&&t?"https://".concat(n,"/?/documents/view/").concat(encodeURIComponent(t)):""}function gn(e){if(!e)return"";try{return new Date(e).toLocaleString("cs-CZ")}catch(e){return""}}function pn(e){return e?e.document?e.document:e.data?e.data:e.result?e.result:e:null}function hn(e,t,n){return n?String(e||t||"").trim():String(t||"").trim()}function bn(e){var t=this,o=(e.email,e.token),i=e.settings,a=(e.onChangeSettings,r.useMemo(function(){return(e=(new Date).getHours())>=5&&e<12?"Good morning":e>=12&&e<18?"Good afternoon":"Good evening";var e},[])),c=r.useMemo(function(){return function(){try{var e=Office.context.mailbox.userProfile;if(null==e?void 0:e.displayName)return e.displayName;var t=null==e?void 0:e.emailAddress;return t?t.split("@")[0].replace(/[._-]+/g," ").replace(/\s+/g," ").trim().split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "):"user"}catch(e){return"user"}}()},[]),s=r.useMemo(function(){return tn(At)},[]),d=r.useMemo(function(){return tn(jt)},[]),f=r.useState(function(){return Qt()||""}),m=f[0],v=f[1],g=r.useMemo(function(){return Zt()},[m]),p=r.useState(""),h=p[0],b=p[1],y=r.useState("prompt"),w=y[0],k=y[1],x=r.useState("case"),I=x[0],C=x[1],N=r.useState({itemId:"",kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),E=N[0],B=N[1],O=r.useRef(new Set),T=r.useRef(null),_=r.useRef(null),z=r.useRef(null),F=r.useState({}),R=F[0],D=F[1],P=r.useState([]),L=P[0],H=P[1],q=r.useState(!1),W=q[0],U=q[1],K=r.useState(""),$=K[0],G=K[1],V=r.useState(""),Q=V[0],Z=V[1],ee=r.useState(!1),te=ee[0],ne=ee[1],re=r.useState([]),oe=re[0],ie=re[1],ae=r.useState(!1)[0],ce=r.useState(!1),se=ce[0],le=ce[1],he=r.useState(!1),we=he[0],Se=he[1],xe=r.useState(!1),Ie=xe[0],Ce=xe[1],Ne=r.useState(null),Ee=Ne[0],Be=Ne[1],Oe=r.useState(""),Te=Oe[0],_e=Oe[1],Ae=r.useState(""),je=Ae[0],ze=Ae[1],Fe=r.useState([]),Re=Fe[0],De=Fe[1],Pe=r.useState([]),Le=Pe[0],Me=Pe[1],He=r.useState(!1),qe=He[0],We=He[1],Ue=r.useState("both"),Ke=Ue[0],$e=Ue[1],Xe=r.useState([]),Ye=Xe[0],Qe=Xe[1],Ze=r.useState(!1),nt=Ze[0],rt=Ze[1],ot=r.useState(!1),it=ot[0],at=ot[1],ct=r.useState(""),st=ct[0],lt=ct[1],ut=r.useState(""),dt=ut[0],ft=ut[1],mt=r.useState(!1),vt=mt[0],gt=mt[1],pt=r.useState(null),ht=pt[0],bt=pt[1],yt=r.useState(""),wt=yt[0],St=yt[1],xt=r.useState(!1),zt=xt[0],Ht=xt[1],Wt=r.useState(""),$t=Wt[0],nn=Wt[1],bn=r.useState(function(){return"favourites"===i.caseListScope?"favourites":"all"}),yn=bn[0],wn=bn[1];r.useEffect(function(){wn("favourites"===i.caseListScope?"favourites":"all")},[i.caseListScope]),r.useEffect(function(){var e=!0;return Ot(t,void 0,void 0,function(){var t;return Tt(this,function(n){switch(n.label){case 0:return[4,Kt()];case 1:return t=n.sent(),e&&nn(t||""),[2]}})}),function(){e=!1}},[m]),r.useEffect(function(){var e=!0;return Ot(t,void 0,void 0,function(){var t;return Tt(this,function(n){switch(n.label){case 0:return Zt()||qe?[2]:[4,new Et(function(e){return setTimeout(e,500)})];case 1:return n.sent(),e?[4,rn(s,d)]:[2];case 2:return t=n.sent(),e?t.includes(d)?(ne(!0),[2]):(t.includes(s),ne(!1),[2]):[2]}})}),function(){e=!1}},[m,s,d,qe]),r.useEffect(function(){g||"sent"===w&&(qe||on(s,d,ne))},[w,g,m,s,d,qe]);var Sn=r.useMemo(function(){return cn()},[m,h]),kn=r.useMemo(function(){return function(){var e,t,n,r,o,i;try{var a=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item,c=(null===(n=null==a?void 0:a.from)||void 0===n?void 0:n.displayName)||(null===(r=null==a?void 0:a.from)||void 0===r?void 0:r.name)||(null===(o=null==a?void 0:a.sender)||void 0===o?void 0:o.displayName)||(null===(i=null==a?void 0:a.sender)||void 0===i?void 0:i.name)||"";return String(c||"")}catch(e){return""}}()},[m,h]),xn=r.useMemo(function(){return function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return String((null==n?void 0:n.conversationId)||(null==n?void 0:n.conversationKey)||"")}catch(e){return""}}()},[m,h]),In=r.useMemo(function(){return function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return(Array.isArray(null==n?void 0:n.attachments)?n.attachments:[]).filter(function(e){return!(null==e?void 0:e.isInline)}).map(function(e){return{id:String(e.id),name:String(e.name||""),size:Number(e.size||0),isInline:Boolean(e.isInline)}})}catch(e){return[]}}()},[m,h]),Cn=r.useMemo(function(){return(In||[]).map(function(e){return String(e.id)}).filter(Boolean)},[In]);r.useEffect(function(){g&&$e("both")},[g,m]);var Nn=r.useMemo(function(){return hn(h,m,g)},[h,m,g]),En=r.useState(""),Bn=En[0],On=En[1],Tn=r.useState(!1),_n=Tn[0],An=Tn[1],jn=r.useMemo(function(){return(null==Ee?void 0:Ee.caseId)?String(Ee.caseId):""},[null==Ee?void 0:Ee.caseId]),zn=r.useState(!1),Fn=zn[0],Rn=zn[1],Dn=r.useMemo(function(){var e=(null==Ee?void 0:Ee.caseId)||Le.length>0;return!("sent"!==w||!e)||!("prompt"!==w||"filed"!==E.kind||!(null==Ee?void 0:Ee.caseId))},[w,E.kind,null==Ee?void 0:Ee.caseId,Le.length]),Pn=r.useMemo(function(){return"all"===yn?L:L.filter(function(e){return!((t=((null==e?void 0:e.status)||"").toLowerCase())&&(t.includes("closed")||t.includes("uzav")||t.includes("archiv")||t.includes("done")));var t})},[L,yn]),Ln=r.useState([]),Mn=Ln[0],Hn=Ln[1],qn=r.useState("idle"),Wn=qn[0],Un=qn[1],Kn=r.useState([]),$n=Kn[0],Gn=Kn[1],Jn=r.useState(""),Vn=Jn[0],Xn=Jn[1],Yn=r.useState(!0),Qn=Yn[0],Zn=Yn[1],er=r.useState(""),tr=er[0],nr=er[1],rr=r.useState(""),or=rr[0],ir=rr[1],ar=r.useState(""),cr=ar[0],sr=ar[1],lr=r.useState(""),ur=lr[0],dr=lr[1],fr=r.useState(!1),mr=fr[0],vr=fr[1],gr=r.useState(!1),pr=gr[0],hr=gr[1],br=r.useState(""),yr=br[0],wr=br[1],Sr=r.useState(""),kr=Sr[0],xr=Sr[1],Ir=r.useState(""),Cr=Ir[0],Nr=Ir[1],Er=r.useState(!1),Br=Er[0],Or=Er[1],Tr=r.useState(!1),_r=(Tr[0],Tr[1]),Ar=r.useMemo(function(){return g?(null==Mn?void 0:Mn[0])||"":Sn},[g,Sn,Mn]);function jr(e){return Ot(this,void 0,void 0,function(){var t,n,r,o;return Tt(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,(0,l.Ox)("sc_intent:".concat(e))];case 1:case 2:return i.sent(),[3,3];case 3:return i.trys.push([3,6,,7]),(t=String((null===(o=null===(r=null===(n=null===Office||void 0===Office?void 0:Office.context)||void 0===n?void 0:n.mailbox)||void 0===r?void 0:r.item)||void 0===o?void 0:o.itemId)||"").trim())&&t!==e?[4,(0,l.Ox)("sc_intent:".concat(t))]:[3,5];case 4:i.sent(),i.label=5;case 5:return[3,7];case 6:return i.sent(),[3,7];case 7:return[2]}})})}r.useEffect(function(){var e=!1;return Ot(t,void 0,void 0,function(){var t,n;return Tt(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,l.wv)(u.workspaceHost)];case 1:return t=r.sent()||"",n=t.replace(/^https?:\/\//i,"").split("/")[0].trim(),e||_e(n),[3,3];case 2:return r.sent(),[3,3];case 3:return[2]}})}),function(){e=!0}},[]),r.useEffect(function(){if(g)return function(){};var e=!0;return Ot(t,void 0,void 0,function(){var t;return Tt(this,function(n){switch(n.label){case 0:return m?[4,an(600)]:(e&&On(""),[2]);case 1:return t=n.sent(),e&&On(t||""),[2]}})}),function(){e=!1}},[m,g]),r.useEffect(function(){if(!g)return function(){};var e=!0,n="",r="",o=!1,i=function(){return Ot(t,void 0,void 0,function(){var t,i,a,c;return Tt(this,function(s){switch(s.label){case 0:if(!e||o)return[2];o=!0,s.label=1;case 1:return s.trys.push([1,,4,5]),i=String,[4,Kt()];case 2:return t=i.apply(void 0,[s.sent()]).trim(),c=String,[4,an(600)];case 3:return a=c.apply(void 0,[s.sent()]).trim(),e?(t!==n&&(n=t,nn(t)),a!==r&&(r=a,On(a)),[3,5]):[2];case 4:return o=!1,[7];case 5:return[2]}})})},a=window.setInterval(function(){i()},400);return i(),function(){e=!1,window.clearInterval(a)}},[g,h]),r.useEffect(function(){var e=!1;return Ot(t,void 0,void 0,function(){var t;return Tt(this,function(n){switch(n.label){case 0:if(!Nn)return e||(De([]),Me([])),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,et(Nn)];case 2:return t=n.sent(),e||De(Array.isArray(t)?t:[]),[3,4];case 3:return n.sent(),e||De([]),[3,4];case 4:return[2]}})}),function(){e=!0}},[Nn,w]),r.useEffect(function(){var e=!1;return Ot(t,void 0,void 0,function(){var t,n,r,o,i,a,c,s,l,u,d=this;return Tt(this,function(f){switch(f.label){case 0:return Nn?0===(t=Array.isArray(Re)?Re:[]).length?(e||Me([]),[2]):(n=String((null==Ee?void 0:Ee.caseId)||"").trim(),[4,(m=t.slice(0,10).map(function(e){return Ot(d,void 0,void 0,function(){var t,r,o,i,a;return Tt(this,function(c){switch(c.label){case 0:if(!(t=String((null==e?void 0:e.id)||"").trim()))return[2,null];r=null,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Ge(t)];case 2:return o=c.sent(),r=pn(o),[3,4];case 3:return c.sent(),r=null,[3,4];case 4:return r?(i=String(r.case_id||r.caseId||"").trim(),n&&i&&i!==n?[2,null]:(a=String(e.name||r.name||"").trim(),[2,Bt(Bt({},e),{name:a||e.name,caseId:i||e.caseId})])):[2,e]}})})}),Et.all(m.map(function(e){return e.then(function(e){return{status:"fulfilled",value:e}},function(e){return{status:"rejected",reason:e}})})))]):[2];case 1:for(r=f.sent(),o=r.filter(function(e){return"fulfilled"===e.status}).map(function(e){return e.value}).filter(Boolean),i=new Set,a=[],c=0,s=o;c<s.length;c++)l=s[c],(u=String(l.id||""))&&(i.has(u)||(i.add(u),a.push(l)));return e||Me(a),[2]}var m})}),function(){e=!0}},[Nn,Re,null==Ee?void 0:Ee.caseId]),r.useEffect(function(){"pickCase"===w&&"attachments"===I&&(Qe(Cn),requestAnimationFrame(function(){var e;null===(e=_.current)||void 0===e||e.scrollIntoView({block:"start",behavior:"smooth"})}))},[w,I,Cn]),r.useEffect(function(){var e;null===(e=z.current)||void 0===e||e.scrollIntoView({block:"end",behavior:"auto"})},[w,I,E.itemId,E.kind,E.text,$,nt,Le.length,null==Ee?void 0:Ee.sent]),r.useEffect(function(){if(console.log("[useEffect:saveIntent] Triggered",{composeMode:g,storeKey:Nn,selectedCaseId:$,autoFileOnSend:Qn}),g)if(Nn)if($&&Qn){var e=_n&&Boolean(dt)&&Boolean(st)&&String($)===String(st);Jt({itemKey:Nn,caseId:$,autoFileOnSend:Qn,baseCaseId:e?st:"",baseEmailDocId:e?dt:""})}else jr(Nn);else console.log("[useEffect:saveIntent] Skipping - no storeKey");else console.log("[useEffect:saveIntent] Skipping - not compose mode")},[g,Nn,$,Qn,_n,st,dt]),r.useEffect(function(){if("pickCase"===w||Dn||g){var e=!0;return Ot(t,void 0,void 0,function(){var t,n,r,a,c,s,l;return Tt(this,function(u){switch(u.label){case 0:U(!0),u.label=1;case 1:return u.trys.push([1,3,4,5]),[4,Et.all([J(o,i.caseListScope),X(o)])];case 2:if(t=u.sent(),n=t[0],r=t[1],!e)return[2];for(H(n),a={},c=0,s=r;c<s.length;c++)l=s[c],a[String(l.id)]=l.name;return D(a),[3,5];case 3:return u.sent(),e?(H([]),D({}),[3,5]):[2];case 4:return e&&U(!1),[7];case 5:return[2]}})}),function(){e=!1}}},[w,Dn,g,o,i.caseListScope]);var zr=ye({enabled:"pickCase"===w&&i.autoSuggestCase,emailItemId:m,conversationKey:xn,subject:$t,bodySnippet:Bn,fromEmail:Ar,attachments:In,cases:Pn,selectedCaseId:$,selectedSource:Q,onAutoSelectCaseId:function(e){G(e),Z("suggested")},topK:3}).suggestions;r.useEffect(function(){Vn&&"manual"!==Q&&"remembered"!==Q&&Zt()&&(or||$!==Vn&&(G(Vn),Z("suggested")))},[Vn,Q,$,or]),r.useEffect(function(){var e=!0,n=null,r=function(){return Ot(t,void 0,void 0,function(){var t;return Tt(this,function(n){switch(n.label){case 0:return e?Zt()?[4,sn()]:(Hn([]),[2]):[2];case 1:return t=n.sent(),e?(Hn(t),[2]):[2]}})})};return Ot(t,void 0,void 0,function(){return Tt(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),"function"!=typeof(null===Office||void 0===Office?void 0:Office.onReady)?[3,2]:[4,Office.onReady()];case 1:e.sent(),e.label=2;case 2:try{Office.context.mailbox.addHandlerAsync(Office.EventType.RecipientsChanged,function(){r()})}catch(e){}return n=window.setInterval(function(){r()},350),r(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}})}),function(){e=!1,n&&window.clearInterval(n);try{Office.context.mailbox.removeHandlerAsync(Office.EventType.RecipientsChanged,r)}catch(e){}}},[m]);var Fr=r.useRef(null);r.useEffect(function(){if(g){var e=Mn||[];if(0!==e.length&&Te){var t=function(e,t){if(!t||0===e.length)return[];for(var n=t.toLowerCase().replace(/^https?:\/\//,"").replace(/\/$/,""),r=[],o=0,i=e;o<i.length;o++){var a=i[o],c=a.toLowerCase().trim();if(c&&c.includes("@")){var s=c.split("@"),l=s[0],u=s[1];if(u&&l&&u===n){var d=l.trim();d&&(r.push(d),console.log("[extractSubmailCaseKeys] Found submail case key:",d,"from:",a))}}}return r}(e,Te);if(0!==t.length){if(Array.from(new Set(t)).length>1)return ir(""),sr(""),dr(""),void("suggested"===Q&&$===or&&(G(""),Z("")));var n=function(e,t){if(!e||!t||0===t.length)return null;var n=un(e),r=t.filter(function(e){var t=String((null==e?void 0:e.name)||(null==e?void 0:e.title)||"").toLowerCase(),r=t.match(/\(([^)]+)\)\s*$/);return!(!r||un(r[1])!==n)||t.replace(/-/g,".").includes(n)});if(0===r.length)return console.log("[resolveSubmailCaseKey] No case found for key:",e),null;if(r.length>1)return console.warn("[resolveSubmailCaseKey] Multiple cases match key:",e,r.length),null;var o=r[0],i=String((null==o?void 0:o.id)||""),a=String((null==o?void 0:o.name)||(null==o?void 0:o.title)||"");return console.log("[resolveSubmailCaseKey] Resolved case:",{caseKey:e,caseId:i,caseName:a}),{caseId:i,caseName:a,caseKey:e}}(t[0],L);n?(ir(n.caseId),sr(n.caseKey),dr(n.caseName),"manual"!==Q&&(G(n.caseId),Z("suggested"),Fn||Zn(!0))):or&&(ir(""),sr(""),dr(""),"suggested"===Q&&$===or&&(G(""),Z("")))}else or&&(ir(""),sr(""),dr(""),"suggested"===Q&&$===or&&(G(""),Z("")))}else or&&(ir(""),sr(""),dr(""),"suggested"===Q&&$===or&&(G(""),Z("")))}else or&&(ir(""),sr(""),dr(""))},[g,Mn,Te,L,Q,Fn,or,$]),r.useEffect(function(){var e,t,n;if(g){var r=Mn||[];if(0!==r.length){var o=String((null===(n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile)||void 0===n?void 0:n.emailAddress)||"");if(o){var i=ke(o,r);console.log("[internal-detect] compose",{senderEmail:o,recipientCount:r.length,isInternal:i}),le(i)}else le(!1)}else le(!1)}},[g,Mn]),r.useEffect(function(){var e,t,n;if(!g)if(m){var r=String((null===(n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile)||void 0===n?void 0:n.emailAddress)||"");if(r){var o=cn(),i=ln(),a=Array.from(new Set(_t([o],i,!0).map(function(e){return qt(e)}).filter(Boolean)));if(0!==a.length){var c=ke(r,a);console.log("[internal-detect] read",{userEmail:r,participantCount:a.length,isInternal:c}),le(c),B(function(e){return"unfiled"!==e.kind||"Checking..."!==e.text&&!e.text.includes("isn't filed yet")?e:Bt(Bt({},e),{text:c?"This looks like an internal email.":"This email isn't filed yet. Would you like me to file it to a case?"})})}else le(!1)}else le(!1)}else le(!1)},[g,m,h]),r.useEffect(function(){Se(!1),Ce(!1),console.log("[internal-guard] Reset overrides for new email item:",h)},[h]),r.useEffect(function(){!g&&m?"sent"===w&&mr?console.log("[checkIfFiled] Skipping check - already verified for this email"):(mr&&(vr(!1),hr(!1),wr(""),xr(""),Nr("")),o&&Ot(t,void 0,void 0,function(){var e,t,r,o,i,a,c,s,l,u,d,f,v,g,p,h,b,y,w;return Tt(this,function(S){switch(S.label){case 0:return S.trys.push([0,19,,20]),console.log("[checkIfFiled] Starting CACHE-BASED filed status check"),e=null===(w=null===(y=null===Office||void 0===Office?void 0:Office.context)||void 0===y?void 0:y.mailbox)||void 0===w?void 0:w.item,t=String((null==e?void 0:e.conversationId)||"").trim(),r=String((null==e?void 0:e.subject)||"").trim(),console.log("[checkIfFiled] Email identifiers:",{activeItemId:m,conversationId:t?t.substring(0,30)+"...":"MISSING",subject:r||"MISSING"}),[4,n.e(243).then(n.bind(n,1243))];case 1:return o=S.sent(),i=o.getFiledEmailFromCache,a=o.findFiledEmailBySubject,c=null,t?[4,i(t)]:[3,3];case 2:c=S.sent(),console.log("[checkIfFiled] Cache lookup by conversationId:",c?"FOUND":"NOT FOUND"),S.label=3;case 3:return c||!r?[3,5]:[4,a(r,t)];case 4:c=S.sent(),console.log("[checkIfFiled] Cache lookup by subject:",c?"FOUND":"NOT FOUND"),S.label=5;case 5:if(!c)return console.log("[checkIfFiled] âŒ Not found in cache"),vr(!0),hr(!1),wr(""),xr(""),Nr(""),[2];console.log("[checkIfFiled] âœ… Found in cache:",c),s=c.caseKey&&c.caseName?"".concat(c.caseKey," Â· ").concat(c.caseName):c.caseName||c.caseKey||c.caseId||"Unknown case",hr(!0),wr(c.caseId),xr(s),Nr(c.documentId),l=new Date(c.filedAt).toISOString(),console.log("[checkIfFiled] Updating sentPill for FiledSummary rendering"),Be({sent:!0,caseId:c.caseId,documentId:c.documentId,atIso:l}),S.label=6;case 6:return S.trys.push([6,8,,9]),[4,j(m,{sent:!0,caseId:c.caseId,documentId:c.documentId,atIso:l})];case 7:return S.sent(),console.log("[checkIfFiled] Persisted sentPill to storage"),[3,9];case 8:return u=S.sent(),console.warn("[checkIfFiled] Failed to persist sentPill (non-critical):",u),[3,9];case 9:if(!Te||!c.documentId)return[3,14];console.log("[checkIfFiled] Building document list for documentId:",c.documentId),d="https://".concat(Te,"/documents/").concat(c.documentId),f={id:c.documentId,name:c.subject?"".concat(c.subject,".eml"):c.caseName?"Email - ".concat(c.caseName):"Email",url:d,kind:"email",atIso:l},console.log("[checkIfFiled] Document item created:",f),S.label=10;case 10:return S.trys.push([10,13,,14]),[4,et(m)];case 11:return v=S.sent(),console.log("[checkIfFiled] Existing uploaded links:",v.length),g=_t([f],v.filter(function(e){return String(null==e?void 0:e.id)!==String(f.id)&&"email"!==(null==e?void 0:e.kind)}),!0).slice(0,25),console.log("[checkIfFiled] Merged document list:",g.length,"items"),Me(g),[4,tt(m,g)];case 12:return S.sent(),console.log("[checkIfFiled] Persisted merged document links to storage"),[3,14];case 13:return p=S.sent(),console.warn("[checkIfFiled] Failed to load/merge document links:",p),Me([f]),[3,14];case 14:return S.trys.push([14,17,,18]),console.log("[checkIfFiled] Applying filed category via Office.js"),[4,Et.resolve().then(n.bind(n,92245))];case 15:return[4,(0,S.sent().applyFiledCategoryToCurrentEmailOfficeJs)()];case 16:return S.sent(),console.log("[checkIfFiled] Category applied successfully"),[3,18];case 17:return h=S.sent(),console.warn("[checkIfFiled] Failed to apply category (non-critical):",h),[3,18];case 18:return vr(!0),[3,20];case 19:return b=S.sent(),console.error("[checkIfFiled] Unexpected error:",b),vr(!0),hr(!1),[3,20];case 20:return[2]}})})):mr&&(vr(!1),hr(!1),wr(""),xr(""),Nr(""))},[g,m,o,Te,w]),r.useEffect(function(){it||pr&&kr&&!g&&m&&(console.log("[useEffect:alreadyFiled] Updating UI for filed email",{caseLabel:kr,documentId:Cr}),k("prompt"),C("case"),Gn([{id:"mark_unfiled",label:"Mark as SC: Unfiled",intent:"mark_as_unfiled"}]),B({itemId:m,kind:"filed",text:""}))},[pr,kr,Cr,g,m,it]),r.useEffect(function(){!g&&mr&&m&&_r(!1)},[g,mr,pr,m]),r.useEffect(function(){var e=!1;return Ot(t,void 0,void 0,function(){var t,n,r;return Tt(this,function(o){switch(o.label){case 0:return Zt()?or||0===(t=Mn||[]).length?(Xn(""),[2]):(n="".concat(m,":").concat(t.slice().sort().join("|")),tr&&tr===n?(Xn(""),[2]):[4,Vt(t)]):(Xn(""),nr(""),[2]);case 1:return r=o.sent(),e||Xn((null==r?void 0:r.caseId)||""),[2]}})}),function(){e=!0}},[m,Mn,tr,or]),r.useEffect(function(){if(g){var e=!1;return Ot(t,void 0,void 0,function(){var t,n,r,o,i,a,c,s;return Tt(this,function(l){switch(l.label){case 0:return"manual"===Q||or?[2]:(t=Array.isArray(Mn)?Mn:[],n=t.length>0,r=String($t||"").trim().length>0,o=String(Bn||"").trim().length>0,n||r||o?(i="",a="",xn?[4,Mt(xn)]:[3,2]):[2]);case 1:if(i=l.sent(),a=i?"thread":"",e)return[2];l.label=2;case 2:return i?(G(i),Z("remembered"),Fn||Zn(!0),Un("compose_ready"),c=(L||[]).find(function(e){return String(null==e?void 0:e.id)===String(i)}),s=String((null==c?void 0:c.name)||(null==c?void 0:c.title)||(null==c?void 0:c.label)||"").trim()||"Case ".concat(i),"thread"===a&&B({itemId:m,kind:"unfiled",text:"The case was recognised from a previous email. Case: ".concat(s,".")}),[2]):[2]}})}),function(){e=!0}}},[g,xn,Q,m,L,Mn,$t,Bn]);var Rr=r.useMemo(function(){if(!Vn)return"";var e=(L||[]).find(function(e){return String(null==e?void 0:e.id)===String(Vn)});return String((null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.label)||"").trim()||"Case ".concat(Vn)},[L,Vn]);r.useEffect(function(){if(g){if(0===(Array.isArray(Mn)?Mn:[]).length){if(or)return;return Un("compose_wait_recipients"),Gn([]),console.log("[prompt:set] reason=wait_recipients"),void B({itemId:m,kind:"unfiled",text:"Add a recipient (To or Cc) and I will suggest a case and the next steps for filing."})}if(or){$||(G(or),Z("suggested"),Nn&&Jt({itemKey:Nn,caseId:or,autoFileOnSend:!0})),Un("compose_ready");var e=Qn?"Email will be filed on send.":"Email will not be filed on send.";return console.log("[prompt:set] reason=submail",{submailDetectedCaseId:or,submailDetectedCaseKey:cr}),B({itemId:m,kind:"unfiled",text:"I've matched this email to ".concat(cr," Â· ").concat(ur," based on the BCC address. ").concat(e)}),void Gn([{id:"s1",label:"Select a different case",intent:"pick_another_case"},{id:"s2",label:Qn?"Auto file on send: Enabled":"Auto file on send: Disabled",intent:"toggle_auto_file"}])}if(se&&!we&&!Ie)return console.log("[compose-flow] Internal email detected â€” showing guard prompt"),Un("compose_ready"),k("prompt"),C("case"),Gn([{id:"ig1",label:"File anyway",intent:"internal_guard_file_anyway"}]),void B({itemId:m,kind:"unfiled",text:"This looks like an internal email."});if(Ie)return Un("compose_ready"),k("prompt"),C("case"),Gn([{id:"fm1",label:"File manually",intent:"file_manually"}]),void B({itemId:m,kind:"unfiled",text:"No problem. I'll hide suggestions for this email, but you can still file it anytime."});if(Vn)return $||(G(Vn),Z("suggested"),Nn&&Jt({itemKey:Nn,caseId:Vn,autoFileOnSend:!0})),Un("compose_offer_frequent"),e=Qn?"Email will be filed on send.":"Email will not be filed on send.",B({itemId:m,kind:"unfiled",text:"I've matched this email to ".concat(Rr," based on previous interactions. ").concat(e)}),void Gn([{id:"a2",label:"Select a different case",intent:"pick_another_case"},{id:"a3",label:Qn?"Auto file on send: Enabled":"Auto file on send: Disabled",intent:"toggle_auto_file"}]);$||(Un("compose_choose_case"),Gn([{id:"b1",label:"Select a different case",intent:"pick_another_case"},{id:"b2",label:Qn?"Disable auto file on send":"Enable auto file on send",intent:"toggle_auto_file"}]),B({itemId:m,kind:"unfiled",text:"Select a case for this draft email."}))}else Un("idle")},[g,$,m,Mn,Vn,Rr,Qn,or,cr,ur,Nn,se,we,Ie]),r.useEffect(function(){if(g&&"compose_ready"===Wn&&!or){if(se&&!we&&!Ie)return console.log("[internal-guard] Showing internal email warning instead of suggestions"),k("prompt"),C("case"),Gn([{id:"ig1",label:"File anyway",intent:"internal_guard_file_anyway"}]),void B({itemId:m,kind:"unfiled",text:"This looks like an internal email."});if(Ie)return console.log("[internal-guard] Email marked as do-not-file, showing confirmation"),k("prompt"),C("case"),Gn([{id:"fm1",label:"File manually",intent:"file_manually"}]),void B({itemId:m,kind:"unfiled",text:"No problem. I'll hide suggestions for this email, but you can still file it anytime."});if($){var e=(L||[]).find(function(e){return String(null==e?void 0:e.id)===String($)}),t=String((null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.label)||"").trim()||"Case ".concat($);k("prompt"),C("case"),Gn([{id:"c1",label:"Select a different case",intent:"pick_another_case"},{id:"c2",label:Qn?"Auto file on send: Enabled":"Auto file on send: Disabled",intent:"toggle_auto_file"}]),console.log("[prompt:set] reason=compose_ready/frequent",{selectedCaseId:$,chatStep:Wn}),B({itemId:m,kind:"unfiled",text:"I've matched this email to ".concat(t," based on previous interactions.")})}}},[g,Wn,$,L,m,Qn,se,we,Ie,or]);var Dr=r.useCallback(function(e){return Ot(t,void 0,void 0,function(){var t,r,o,i,a,c,s,u,d,f,m,v,g,p,h,b,y,w,S,x,I,N,E,T,_,z,F,R,D,P,L,M,H,q,W,U,K,$;return Tt(this,function(J){switch(J.label){case 0:return J.trys.push([0,47,,48]),function(){var e,t;try{var n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item;return"message"===String((null==n?void 0:n.itemType)||"").toLowerCase()}catch(e){return!1}}()&&e?Zt()?(Be(null),De([]),Me([]),C("case"),Qe([]),An(!1),k("prompt"),B({itemId:e,kind:"unfiled",text:"Select a case and then use File Now."}),[2]):pr&&kr?(console.log("[evaluateItem] Email already filed",{caseId:yr,caseLabel:kr}),k("prompt"),C("case"),Gn([{id:"mark_unfiled",label:"Mark as SC: Unfiled",intent:"mark_as_unfiled"}]),B({itemId:e,kind:"filed",text:""}),[2]):O.current.has(e)?(k("prompt"),G(""),Z(""),Be(null),C("case"),Qe([]),An(!1),Gn([{id:"fm1",label:"File manually",intent:"file_manually"}]),B({itemId:e,kind:"unfiled",text:se?"No problem. I'll hide suggestions for this email, but you can still file it anytime.":"Got it. I'll step back for this email, but you can still file it later."}),[2]):[4,A(e)]:(k("prompt"),G(""),Z(""),Be(null),C("case"),ne(!1),Qe([]),An(!1),B({itemId:"",kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),[2]);case 1:return t=J.sent(),Be(t||null),r=tn(At),o=tn(jt),[4,rn(r,o)];case 2:return i=J.sent(),a=i.includes(r),c=i.includes(o),console.log("[evaluateItem] Category check:",{hasFiledCategory:a,hasUnfiledCategory:c,filedStatusChecked:mr,alreadyFiled:pr}),c?(s=String((null===(H=null===(M=null===(L=null===Office||void 0===Office?void 0:Office.context)||void 0===L?void 0:L.mailbox)||void 0===M?void 0:M.item)||void 0===H?void 0:H.conversationId)||"").trim())&&O.current.has("conv:".concat(s))?(k("prompt"),C("case"),An(!1),Gn([{id:"fm1",label:"File manually",intent:"file_manually"}]),_r(!1),B({itemId:e,kind:"unfiled",text:"Got it. I'll step back for this email, but you can still file it later."}),[2]):(k("prompt"),C("case"),An(!1),Gn([]),_r(!1),B({itemId:e,kind:"unfiled",text:"This email isn't filed yet. Would you like me to file it to a case?"}),[2]):(null==t?void 0:t.caseId)&&""!==String(t.caseId).trim()||Le.length>0||pr&&yr?[4,mn(t||null,e)]:[3,24];case 3:if(null!==(u=J.sent()))return[3,13];J.label=4;case 4:return J.trys.push([4,7,,8]),T=String((null==t?void 0:t.caseId)||"").trim(),_=String((null==t?void 0:t.documentId)||"").trim(),T&&_?[4,Dt({caseId:T,emailDocId:_})]:[3,6];case 5:J.sent(),J.label=6;case 6:return[3,8];case 7:return J.sent(),[3,8];case 8:return J.trys.push([8,11,,12]),(null==t?void 0:t.caseId)?[4,Pt(String(t.caseId))]:[3,10];case 9:J.sent(),J.label=10;case 10:return[3,12];case 11:return J.sent(),[3,12];case 12:return k("sent"),C("case"),An(!1),B({itemId:e,kind:"filed",text:"This email has been filed."}),[2];case 13:return!1!==u?[3,15]:[4,fn(e)];case 14:return J.sent(),Be(null),De([]),Me([]),k("prompt"),C("case"),An(!1),B(a?{itemId:e,kind:"deleted",text:"This email and its documents have been removed from the SingleCase platform. Do you want to file it again?"}:{itemId:e,kind:"deleted",text:"I've noticed that this email or its attachments were deleted from SingleCase. Do you want to re-file it?"}),[2];case 15:return J.trys.push([15,18,,19]),T=String((null==t?void 0:t.caseId)||"").trim(),_=String((null==t?void 0:t.documentId)||"").trim(),T&&_?[4,Dt({caseId:T,emailDocId:_})]:[3,17];case 16:J.sent(),J.label=17;case 17:return[3,19];case 18:return J.sent(),[3,19];case 19:return J.trys.push([19,22,,23]),(null==t?void 0:t.caseId)?[4,Pt(String(t.caseId))]:[3,21];case 20:J.sent(),J.label=21;case 21:return[3,23];case 22:return J.sent(),[3,23];case 23:return k("sent"),C("case"),An(!1),B({itemId:e,kind:"filed",text:"This email has been filed."}),[2];case 24:if(!a)return[3,46];d=null,J.label=25;case 25:return J.trys.push([25,37,,38]),f=null===(W=null===(q=null===Office||void 0===Office?void 0:Office.context)||void 0===q?void 0:q.mailbox)||void 0===W?void 0:W.item,(m=String((null==f?void 0:f.conversationId)||"").trim())?[4,A("draft:".concat(m))]:[3,36];case 26:return(null==(v=J.sent())?void 0:v.caseId)&&""!==String(v.caseId).trim()&&(d=v,console.log("[evaluateItem] State B recovery: found via draft key")),d?[3,28]:[4,(0,l.wv)("".concat(Ft).concat(m))];case 27:(g=J.sent())&&(null==(p=JSON.parse(String(g)))?void 0:p.caseId)&&(null==p?void 0:p.emailDocId)&&(d={sent:!0,caseId:p.caseId,documentId:p.emailDocId,atIso:(new Date).toISOString()},console.log("[evaluateItem] State B recovery: found via conv_ctx")),J.label=28;case 28:return d?[3,32]:[4,n.e(243).then(n.bind(n,1243))];case 29:return h=J.sent(),b=h.getFiledEmailFromCache,y=h.findFiledEmailBySubject,[4,b(m)];case 30:return(null==(w=J.sent())?void 0:w.caseId)&&(d={sent:!0,caseId:w.caseId,documentId:w.documentId,atIso:new Date(w.filedAt).toISOString()},console.log("[evaluateItem] State B recovery: found via filedCache by conversationId")),d?[3,32]:(S=String((null==f?void 0:f.subject)||"").trim())?[4,y(S,m)]:[3,32];case 31:(null==(x=J.sent())?void 0:x.caseId)&&(d={sent:!0,caseId:x.caseId,documentId:x.documentId,atIso:new Date(x.filedAt).toISOString()},console.log("[evaluateItem] State B recovery: found via filedCache by subject")),J.label=32;case 32:return d?[3,34]:[4,Mt(m)];case 33:(I=J.sent())&&(d={sent:!0,caseId:I},console.log("[evaluateItem] State B recovery: found via conv_case key (caseId only)")),J.label=34;case 34:return d?[3,36]:[4,A("conv:".concat(m))];case 35:(null==(N=J.sent())?void 0:N.caseId)&&""!==String(N.caseId).trim()&&(d=N,console.log("[evaluateItem] State B recovery: found via conv: backup key")),J.label=36;case 36:return[3,38];case 37:return E=J.sent(),console.warn("[evaluateItem] State B recovery error:",E),[3,38];case 38:return d?[4,j(e,d)]:[3,45];case 39:J.sent(),Be(d),J.label=40;case 40:return J.trys.push([40,43,,44]),T=String(d.caseId||"").trim(),_=String(d.documentId||"").trim(),T&&_?[4,Dt({caseId:T,emailDocId:_})]:[3,42];case 41:J.sent(),J.label=42;case 42:return[3,44];case 43:return J.sent(),[3,44];case 44:return k("sent"),C("case"),An(!1),B({itemId:e,kind:"filed",text:"This email has been filed."}),[2];case 45:return k("prompt"),C("case"),An(!1),B({itemId:e,kind:"deleted",text:"This email and its documents have been removed from the SingleCase platform. Do you want to file it again?"}),Gn([]),[2];case 46:return k("prompt"),C("case"),An(!1),Gn([]),Zt()?B({itemId:e,kind:"unfiled",text:"This email isn't filed yet. Would you like me to file it to a case?"}):(z=String((null===($=null===(K=null===(U=null===Office||void 0===Office?void 0:Office.context)||void 0===U?void 0:U.mailbox)||void 0===K?void 0:K.userProfile)||void 0===$?void 0:$.emailAddress)||""),F=cn(),R=ln(),D=Array.from(new Set(_t([F],R,!0).map(function(e){return qt(e)}).filter(Boolean))),P=!!(z&&D.length>0)&&ke(z,D),B({itemId:e,kind:"unfiled",text:P?"This looks like an internal email.":"This email isn't filed yet. Would you like me to file it to a case?"})),[3,48];case 47:return J.sent(),k("prompt"),C("case"),An(!1),B({itemId:"",kind:"none",text:"Select an email and Iâ€™ll show you relevant suggestions."}),[3,48];case 48:return[2]}})})},[]);r.useEffect(function(){var e=!0,n=null,r=function(){return Ot(t,void 0,void 0,function(){var t,n,r,o,i,a,c,s,l,u;return Tt(this,function(d){switch(d.label){case 0:return e?[4,en()]:[2];case 1:return t=d.sent(),n=Qt(),r=Zt(),[4,Kt().catch(function(){return""})];case 2:return d.sent(),String((null===(u=null===(l=null===(s=null===Office||void 0===Office?void 0:Office.context)||void 0===s?void 0:s.mailbox)||void 0===l?void 0:l.item)||void 0===u?void 0:u.conversationId)||""),o=n||"",i=t,a=String(o||"")!==String(m||"")||String(i||"")!==String(h||""),t&&a?(console.log("[active-item-change] Resetting filed state for new email",{activeItemKey:i,activeItemId:o}),at(!0),Be(null),De([]),Me([]),ze(""),lt(""),ft(""),vr(!1),hr(!1),wr(""),xr(""),Nr(""),Gn([]),v(o),b(i),G(""),Z(""),C("case"),Qe([]),An(!1),c=hn(i,o,r),[4,Dr(c)]):[3,4];case 3:return d.sent(),at(!1),console.log("[active-item-change] Evaluation complete",{activeItemKey:i,confirmedFiled:pr}),[2];case 4:return t&&t!==h&&b(t),[2]}})})},o=function(){r()},i=function(){r()};return Ot(t,void 0,void 0,function(){return Tt(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),"function"!=typeof(null===Office||void 0===Office?void 0:Office.onReady)?[3,2]:[4,Office.onReady()];case 1:e.sent(),e.label=2;case 2:try{Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged,o)}catch(e){}return window.addEventListener("focus",i),document.addEventListener("visibilitychange",i),n=window.setInterval(function(){r()},450),[4,r()];case 3:case 4:return e.sent(),[3,5];case 5:return[2]}})}),function(){e=!1;try{window.removeEventListener("focus",i),document.removeEventListener("visibilitychange",i)}catch(e){}n&&window.clearInterval(n);try{try{Office.context.mailbox.removeHandlerAsync(Office.EventType.ItemChanged,{handler:o})}catch(e){Office.context.mailbox.removeHandlerAsync(Office.EventType.ItemChanged,o)}}catch(e){}}},[m,h,Dr]);var Pr=r.useMemo(function(){return jn&&(L||[]).find(function(e){return String(null==e?void 0:e.id)===jn})||null},[L,jn]),Lr=r.useMemo(function(){var e=Pr;return String((null==e?void 0:e.name)||(null==e?void 0:e.title)||(null==e?void 0:e.label)||"").trim()||(jn?"Case ".concat(jn):"")},[Pr,jn]),Mr=r.useMemo(function(){if(!jn)return"";var e,t,n=function(e,t){if(!t)return"";var n=t.url||t.webUrl||t.web_url||t.href||t.link;if(n&&"string"==typeof n){if(/^https?:\/\//i.test(n))return n;var r=(e||"").trim().replace(/^https?:\/\//i,"").split("/")[0];return r?"https://".concat(r).concat(n.startsWith("/")?n:"/".concat(n)):""}return""}(Te,Pr);return n||(e=jn,(t=(Te||"").trim().replace(/^https?:\/\//i,"").split("/")[0])&&e?"https://".concat(t).concat("/?/cases/view/").concat(encodeURIComponent(e)):"")},[jn,Pr,Te]),Hr=r.useMemo(function(){var e=[];if(null==Ee?void 0:Ee.documentId){var t=String(Ee.documentId),n=Array.isArray(Le)?Le.find(function(e){return String(null==e?void 0:e.id)===t}):null;(null==n?void 0:n.url)&&e.push(n)}if(Array.isArray(Le))for(var r=0,o=Le;r<o.length;r++){var i=o[r];(null==i?void 0:i.id)&&(null==i?void 0:i.url)&&e.push(i)}var a=new Set;return e.filter(function(e){return!a.has(e.id)&&(a.add(e.id),!0)}).slice(0,25)},[Ee,Le]),qr=function(){gt(!1),bt(null),St(""),Ht(!1)},Wr=function(){return Ot(t,void 0,void 0,function(){var e,t,n,r,o;return Tt(this,function(i){switch(i.label){case 0:if(!ht)return[2];if(!(e=String(wt||"").trim()))return[2];if(e===ht.name)return qr(),[2];Ht(!0),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,et(Nn)];case 2:return t=i.sent(),n=Array.isArray(t)?t:[],r=n.map(function(t){return String(t.id)===String(ht.id)?Bt(Bt({},t),{name:e}):t}),[4,tt(Nn,r)];case 3:return i.sent(),De(r),Me(r),qr(),[3,5];case 4:return o=i.sent(),console.error(o),Ht(!1),[3,5];case 5:return[2]}})})},Ur=r.useCallback(function(){console.log("[internal-guard] User clicked 'File anyway', overriding guard"),Se(!0),Ce(!1)},[]),Kr=r.useCallback(function(){console.log("[internal-guard] User clicked 'Don't file', marking email as do-not-file"),Ce(!0),Se(!1),G(""),Z("")},[]),$r=r.useCallback(function(e){if(console.log("[handleQuickAction] enter",e),"toggle_auto_file"===e)return Rn(!0),void Zn(function(e){var t=!e;return g&&$&&Nn&&(t?Jt({itemKey:Nn,caseId:$,autoFileOnSend:!0}):jr(Nn)),Gn(function(e){return(e||[]).map(function(e){return"toggle_auto_file"===e.intent?Bt(Bt({},e),{label:t?"Auto-file on send: On":"Auto-file on send: Off"}):e})}),t});if("internal_guard_file_anyway"!==e)if("internal_guard_dont_file"!==e){if("file_manually"===e)return se&&Se(!0),k("pickCase"),C("case"),G(""),Z(""),Qe([]),void An(!1);if("show_suggestions"===e)return O.current.delete(Nn),O.current.delete(h),O.current.delete(m),se?(Gn([{id:"ig1",label:"File anyway",intent:"internal_guard_file_anyway"}]),void B({itemId:m,kind:"unfiled",text:"This looks like an internal email."})):(k("pickCase"),C("case"),G(""),Z(""),Qe([]),void An(!1));if("cancel_compose"===e)return G(""),Z("manual"),Nn&&jr(Nn),k("pickCase"),C("case"),Un("compose_choose_case"),Gn([]),void B({itemId:m,kind:"unfiled",text:"Select a case for this draft email."});if("accept_frequent_case"===e){if(!Vn)return;return G(Vn),Z("suggested"),g?(k("prompt"),C("case"),Gn([]),Un("compose_ready"),Nn&&Jt({itemKey:Nn,caseId:Vn,autoFileOnSend:Qn}),void B({itemId:m,kind:"unfiled",text:"OK. Click File Now. Then you can send the email normally. Case: ".concat(Rr,".")})):(Un("idle"),k("pickCase"),void C(In.length>0?"attachments":"case"))}if("pick_another_case"===e){var n="suggested"===Q||"remembered"===Q;return console.log("[pick_another_case] ðŸ”µ Button clicked",{wasAutoSelected:n,selectedSource:Q,visibleCasesCount:Pn.length}),g&&(G(""),Z("manual"),n?Ot(t,void 0,void 0,function(){var e,t,n,r,o;return Tt(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Kt()];case 1:return e=i.sent(),[4,an(600)];case 2:return t=i.sent(),n=e.trim()||t.trim(),console.log("[pick_another_case] ðŸ“¥ Fetched fresh content:",{subjectLength:e.length,bodyLength:t.length,hasContent:!!n}),n?(console.log("[pick_another_case] âœ… Triggering content analysis"),r=function(e){for(var t,n=null!==(t=e.topK)&&void 0!==t?t:5,r=String(e.subject||""),o=me(r),i=fe(r),a=String(e.bodySnippet||"").slice(0,1500),c=me(a),s=fe(a),l={},u={},d=function(e,t,n){e&&(u[e]=(u[e]||0)+t,n&&(l[e]||(l[e]=[]),l[e].includes(n)||l[e].push(n)))},f=0,m=e.cases;f<m.length;f++){var v=m[f],g=String((null==v?void 0:v.id)||""),p=fe(ue(v));if(g&&p){var h=i.includes(p),b=s.includes(p);(h||b)&&d(g,95,"Case reference found in email content")}}for(var y=0,w=e.cases;y<w.length;y++)if(v=w[y],g=String((null==v?void 0:v.id)||"")){var S=de(v),k=me(S);if(k){var x=ve(S);if(o&&(k===o||k.includes(o)||o.includes(k)))d(g,98,"Subject matches case name");else{if(x.length>0&&r){var I=ge(x,r);I.hits>=2&&d(g,60+30*pe(I.total>0?I.hits/I.total:0,0,1),"Case name matches subject keywords")}if(a&&x.length>0){var C=k.length>=4&&c.includes(k);if(x.length<=2)C&&d(g,45,"Case name found in email body");else{var N=ge(x,a);N.hits>=2?d(g,35+25*pe(N.total>0?N.hits/N.total:0,0,1),"Case name found in email body"):C&&d(g,40,"Case name found in email body")}}}}}var E=Object.entries(u).map(function(e){var t=e[0];return{caseId:t,score:e[1],reasons:l[t]||[]}}).sort(function(e,t){return t.score-e.score}),B=E.map(function(e){return e.score});return{suggestions:E.map(function(e,t){return{caseId:e.caseId,score:e.score,confidencePct:be(B,t),reasons:e.reasons}}).filter(function(e){return e.confidencePct>=10}).slice(0,n)}}({subject:e,bodySnippet:t,cases:Pn,topK:5}),console.log("[pick_another_case] ðŸ“Š Analysis complete:",{foundCount:r.suggestions.length,suggestions:r.suggestions.map(function(e){return{caseId:e.caseId,pct:e.confidencePct,score:e.score,reasons:e.reasons}})}),ie(r.suggestions),0===r.suggestions.length?(console.log("[pick_another_case] âŒ No suggestions found"),B({itemId:m,kind:"unfiled",text:"No suggestions based on content. Select case manually."})):(console.log("[pick_another_case] âœ… Set",r.suggestions.length,"suggestions in state"),B({itemId:m,kind:"unfiled",text:"Select case based on email content."})),[3,4]):(console.log("[pick_another_case] â­ï¸ Skipping analysis: no content"),ie([]),B({itemId:m,kind:"unfiled",text:"Select case."}),[2]);case 3:return o=i.sent(),console.error("[pick_another_case] âŒ Analysis failed:",o),ie([]),B({itemId:m,kind:"unfiled",text:"Select case."}),[3,4];case 4:return[2]}})}):(console.log("[pick_another_case] â­ï¸ Skipping analysis: not auto-selected"),ie([]),B({itemId:m,kind:"unfiled",text:"Select case."}))),k("pickCase"),C("case"),Un("compose_choose_case"),void Gn([])}if("skip_attachments"===e)return $e("both"),Qe([]),Un("compose_ready"),Gn([]),void B({itemId:m,kind:"unfiled",text:"OK. Click File Now. I will file only the email."});if("select_attachments"===e)return $e("both"),Qe(Cn),Un("compose_ready"),Gn([]),void B({itemId:m,kind:"unfiled",text:"OK. Click File Now. I will file the email and attachments."});if("view_in_singlecase"!==e)return"file_now_from_weak_signal"===e?(console.log("[handleQuickAction] File now - clearing weak signal state"),vr(!1),hr(!1),wr(""),Be(null),k("prompt"),C("case"),Gn([]),void B({itemId:h,kind:"none",text:"Select a case for this email."})):"refresh_filing_status"===e?(console.log("[handleQuickAction] Refreshing filing status"),vr(!1),_r(!1),void Dr(h)):"mark_as_unfiled"===e?(console.log("[handleQuickAction] Marking as SC: Unfiled (category only, no re-filing)"),_r(!1),void Ot(t,void 0,void 0,function(){var e;return Tt(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,3,4]),We(!0),[4,(0,Nt.applyUnfiledCategoryToCurrentEmailOfficeJs)()];case 1:return t.sent(),ne(!0),hr(!1),k("sent"),[3,4];case 2:return e=t.sent(),console.error("[handleQuickAction] Failed to apply SC: Unfiled category:",e),[3,4];case 3:return We(!1),[7];case 4:return[2]}})})):void 0;if(Cr&&Te){var r="https://".concat(Te,"/documents/").concat(Cr);console.log("[handleQuickAction] Opening SingleCase document:",r),window.open(r,"_blank")}else yr&&Te&&(r="https://".concat(Te,"/cases/").concat(yr),console.log("[handleQuickAction] Opening SingleCase case:",r),window.open(r,"_blank"))}else Kr();else Ur()},[m,Cn,In.length,Mn,Vn,g,Rr,Rr,Vn,$,Nn,Qn,Cr,yr,Te]),Gr=r.useCallback(function(e){return Ot(t,void 0,void 0,function(){var t,r,a,s,l,u,d,f,v,p,h,b,y,w,x,C,N,E,O,_,A,z,F,R,D,P,M,H,q,W,U,K,G,J,V,X,Q,Z,ee,te,re,oe,ie,ae,ce,le,ue,de,fe,me,ve,ge,pe,he,be,ye;return Tt(this,function(Se){switch(Se.label){case 0:if(nt)return[2];if(!(t=String((null==e?void 0:e.caseId)||$||"").trim()))return[2];if(Ie)return console.log("[doSubmit] Email marked as do-not-file, skipping filing"),ze("Email will not be filed (marked as internal)."),[2];if(se&&!we)return console.log("[doSubmit] Internal email detected without override, skipping filing"),ze("Internal email will not be filed. Click 'File anyway' to override."),[2];if(pr&&!g&&!Br)return console.log("[doSubmit] Email already filed, preventing double filing"),ze("This email is already filed in SingleCase."),[2];if(Br&&console.log("[doSubmit] Refiling override active - bypassing duplicate guard"),"attachments"===I&&In.length>0&&0===Ye.length)return[2];if(!Nn)return ze("Chyba: nelze urÄit klÃ­Ä emailu."),[2];rt(!0),k("sending"),ze(""),Se.label=1;case 1:return Se.trys.push([1,53,54,55]),[4,an(8e3)];case 2:return r=Se.sent(),a=(r||Bn||"").trim()||"[No body content available from Outlook]",[4,Kt().catch(function(){return""})];case 3:return s=Se.sent(),l=(s||$t||"email").trim().replace(/[<>:"/\\|?*\x00-\x1F]/g," ").replace(/\s+/g," ").trim().slice(0,80)||"email",u="From: ".concat(kn," <").concat(Sn,">\r\n")+"To: SingleCase <noreply@singlecase>\r\n"+"Subject: ".concat($t,"\r\n")+"Date: ".concat((new Date).toUTCString(),"\r\n")+"Message-ID: <".concat(m,"@outlook>\r\n")+"MIME-Version: 1.0\r\nContent-Type: text/plain; charset=UTF-8\r\nContent-Transfer-Encoding: 8bit\r\n\r\n"+"".concat(a,"\r\n"),d=function(e){for(var t=(new TextEncoder).encode(e),n="",r=0;r<t.length;r+=1)n+=String.fromCharCode(t[r]);return btoa(n)}(u),f=String((null==Ee?void 0:Ee.caseId)||st||""),v=String((null==Ee?void 0:Ee.documentId)||dt||""),console.log("[doSubmit] new version check",{isUploadingNewVersion:_n,existingEmailDocId:v,originalCaseId:f,caseId:t,replyBaseCaseId:st,replyBaseEmailDocId:dt,sentPillCaseId:null==Ee?void 0:Ee.caseId,sentPillDocId:null==Ee?void 0:Ee.documentId}),p=_n&&Boolean(v)&&Boolean(f)&&t===f,h=null==Ee?void 0:Ee.singlecaseRecordId,p?[3,5]:(b={caseId:t,outlookItemId:m&&!String(m).startsWith("draft:")?m:void 0,subject:$t,fromEmail:Sn,fromName:kn},i.includeBodySnippet&&r&&(b.bodySnippet=r),[4,Y(0,b)]);case 4:y=Se.sent(),h=null==y?void 0:y.singlecaseRecordId,Se.label=5;case 5:return w="",x=null!==(de=null==Ee?void 0:Ee.revisionNumber)&&void 0!==de?de:1,console.log("[doSubmit] About to upload email document",{caseId:t,filingMode:Ke,uploadAsNewVersion:p,workspaceHost:Te,hasToken:!!o}),"both"!==Ke?[3,19]:p?(console.log("[doSubmit] Uploading new version of existing document",{existingEmailDocId:v}),[4,Je({documentId:v,fileName:"".concat(l,".eml"),mimeType:"message/rfc822",dataBase64:d})]):[3,15];case 6:if(C=Se.sent(),N=function(e){var t,n,r,o,i,a,c,s;if(!e)return null;var l=e.data||e.result||e.document||e.version||e,u=null!==(s=null!==(c=null!==(a=null!==(o=null!==(n=null===(t=null==l?void 0:l.latest_version)||void 0===t?void 0:t.revision_number)&&void 0!==n?n:null===(r=null==l?void 0:l.latestVersion)||void 0===r?void 0:r.revisionNumber)&&void 0!==o?o:null===(i=null==l?void 0:l.latestVersion)||void 0===i?void 0:i.revision_number)&&void 0!==a?a:null==l?void 0:l.revision_number)&&void 0!==c?c:null==l?void 0:l.revisionNumber)&&void 0!==s?s:null==l?void 0:l.revision,d=Number(u);return Number.isFinite(d)&&d>0?d:null}(C),N)return[3,11];E=0,Se.label=7;case 7:return E<3?[4,Ge(v)]:[3,11];case 8:return O=Se.sent(),_=pn(O),N=function(e){var t,n=null===(t=null==e?void 0:e.latest_version)||void 0===t?void 0:t.revision_number,r=Number(n);return Number.isFinite(r)&&r>0?r:null}(_),N?[3,11]:[4,new Et(function(e){return setTimeout(e,300)})];case 9:Se.sent(),Se.label=10;case 10:return E+=1,[3,7];case 11:if(!N)throw new Error("Version upload succeeded but revision could not be determined. docId=".concat(v));return x=N,(R=vn(Te,w=v))?(A={id:w,name:"".concat(l,"-v").concat(x,".eml"),url:R,kind:"email",atIso:(new Date).toISOString(),uploadedBy:c,caseId:t},[4,et(Nn)]):[3,14];case 12:return P=Se.sent(),M=_t([A],P.filter(function(e){return String(null==e?void 0:e.id)!==String(A.id)}),!0).slice(0,25),[4,tt(Nn,M)];case 13:Se.sent(),De(M),Me(M),Se.label=14;case 14:return[3,19];case 15:return Z=null===(me=null===(fe=null===Office||void 0===Office?void 0:Office.context)||void 0===fe?void 0:fe.mailbox)||void 0===me?void 0:me.item,ee=String((null==Z?void 0:Z.conversationId)||"").trim(),console.log("[doSubmit] Creating new email document",{caseId:t,fileName:"".concat(l,".eml"),mimeType:"message/rfc822",conversationId:ee?ee.substring(0,30)+"...":"MISSING"}),[4,Ve({caseId:t,fileName:"".concat(l,".eml"),mimeType:"message/rfc822",dataBase64:d,metadata:{subject:$t,fromEmail:Sn,fromName:kn,conversationId:ee||void 0}})];case 16:return z=Se.sent(),console.log("[doSubmit] Email document created",{response:z}),F=(null===(ve=null==z?void 0:z.documents)||void 0===ve?void 0:ve[0])||null,w=(null==F?void 0:F.id)?String(F.id):"",x=null!==(pe=null===(ge=null==F?void 0:F.latest_version)||void 0===ge?void 0:ge.revision_number)&&void 0!==pe?pe:1,console.log("[doSubmit] Extracted document ID",{emailDocId:w,emailRevisionNumber:x}),R=w?vn(Te,w):"",w&&R?(D={id:w,name:x>1?"".concat(l,"-v").concat(x,".eml"):"".concat(l,".eml"),url:R,kind:"email",atIso:(new Date).toISOString(),uploadedBy:c,caseId:t},[4,et(Nn)]):[3,19];case 17:return P=Se.sent(),M=_t([D],P.filter(function(e){return String(null==e?void 0:e.id)!==String(D.id)}),!0).slice(0,25),[4,tt(Nn,M)];case 18:Se.sent(),De(M),Me(M),Se.label=19;case 19:if("attachments"!==Ke&&"both"!==Ke)return[3,23];H=function(e){var n,r,o,i,a,s,l,u,d;return Tt(this,function(f){switch(f.label){case 0:return n=In.find(function(t){return String(t.id)===String(e)}),[4,dn(e,null==n?void 0:n.name)];case 1:return r=f.sent(),[4,Ve({caseId:t,fileName:r.name,mimeType:r.mime,dataBase64:r.base64})];case 2:return o=f.sent(),i=(null===(he=null==o?void 0:o.documents)||void 0===he?void 0:he[0])||null,(a=(null==i?void 0:i.id)?String(i.id):"")&&(s=vn(Te,a))?(l={id:a,name:r.name,url:s,kind:"attachment",atIso:(new Date).toISOString(),uploadedBy:c,caseId:t},[4,et(Nn)]):[2,"continue"];case 3:return u=f.sent(),d=_t([l],u.filter(function(e){return String(null==e?void 0:e.id)!==String(l.id)}),!0).slice(0,25),[4,tt(Nn,d)];case 4:return f.sent(),De(d),Me(d),[2]}})},q=0,W=Ye,Se.label=20;case 20:return q<W.length?(U=W[q],[5,H(U)]):[3,23];case 21:Se.sent(),Se.label=22;case 22:return q++,[3,20];case 23:return K={sent:!0,atIso:(new Date).toISOString(),caseId:t,singlecaseRecordId:h,documentId:w||(p?v:void 0),revisionNumber:x,filedBy:c},[4,j(Nn,K)];case 24:if(Se.sent(),!xn)return[3,28];Se.label=25;case 25:return Se.trys.push([25,27,,28]),[4,j("conv:".concat(xn),K)];case 26:case 27:return Se.sent(),[3,28];case 28:Be(K),S(Nn),Se.label=29;case 29:return Se.trys.push([29,32,,33]),xn?[4,Lt(xn,t)]:[3,31];case 30:Se.sent(),Se.label=31;case 31:return[3,33];case 32:return Se.sent(),[3,33];case 33:return Se.trys.push([33,36,,37]),xn&&w?[4,Rt(xn,{caseId:t,emailDocId:w})]:[3,35];case 34:Se.sent(),Se.label=35;case 35:return[3,37];case 36:return Se.sent(),[3,37];case 37:return Se.trys.push([37,40,,41]),(G=g?Mn:[]).length>0?[4,Gt(G,t)]:[3,39];case 38:Se.sent(),Se.label=39;case 39:return[3,41];case 40:return Se.sent(),[3,41];case 41:return Se.trys.push([41,43,,44]),[4,(0,Nt.applyFiledCategoryToCurrentEmailOfficeJs)()];case 42:return Se.sent(),[3,44];case 43:return J=Se.sent(),console.warn("Office category apply failed:",J),[3,44];case 44:ne(!1),Se.label=45;case 45:return Se.trys.push([45,51,,52]),[4,n.e(243).then(n.bind(n,1243))];case 46:return V=Se.sent(),X=V.cacheFiledEmail,Q=V.cacheFiledEmailBySubject,Z=null===(ye=null===(be=null===Office||void 0===Office?void 0:Office.context)||void 0===be?void 0:be.mailbox)||void 0===ye?void 0:ye.item,ee=String((null==Z?void 0:Z.conversationId)||"").trim(),te=L.find(function(e){return String(e.id)===String(t)}),re=(null==te?void 0:te.title)||"",oe=re.split(" Â· "),ie=oe.length>1?oe[1]:re,ae=oe.length>1?oe[0]:void 0,ee&&w?[4,X(ee,t,w,$t,ie,ae)]:[3,48];case 47:return Se.sent(),console.log("[doSubmit] Cached filed email by conversationId"),[3,50];case 48:return $t&&w?[4,Q($t,t,w,ie,ae)]:[3,50];case 49:Se.sent(),console.log("[doSubmit] Cached filed email by subject (fallback)"),Se.label=50;case 50:return[3,52];case 51:return ce=Se.sent(),console.warn("[doSubmit] Failed to cache filed email:",ce),[3,52];case 52:return B(g?{itemId:Nn,kind:"filed",text:"Filed into SingleCase. You can now send the email normally in Outlook."}:{itemId:Nn,kind:"filed",text:"This email is already filed."}),k("sent"),An(!1),[3,55];case 53:return le=Se.sent(),console.error("[doSubmit] Upload failed",le),console.error("[doSubmit] Error details:",{name:le instanceof Error?le.name:"unknown",message:le instanceof Error?le.message:String(le),stack:le instanceof Error?le.stack:void 0}),ue="Unknown error",le instanceof Error?ue=le.message:"string"==typeof le?ue=le:le&&"object"==typeof le&&(ue=le.message||le.error||JSON.stringify(le)),ze("Error while saving: ".concat(ue)),k(g?"prompt":"pickCase"),setTimeout(function(){var e;try{null===(e=T.current)||void 0===e||e.scrollTo({top:0,behavior:"smooth"})}catch(e){}},50),[3,55];case 54:return rt(!1),[7];case 55:return[2]}})})},[nt,$,I,In.length,Ye,$t,Sn,kn,o,i.includeBodySnippet,Bn,Te,Ke,_n,st,dt,null==Ee?void 0:Ee.caseId,null==Ee?void 0:Ee.documentId,null==Ee?void 0:Ee.singlecaseRecordId,null==Ee?void 0:Ee.revisionNumber,c,g,pr,Mn,Nn,m]);return r.useEffect(function(){return Fr.current=function(){return Gr()},function(){Fr.current=null}},[Gr]),r.createElement("div",{className:"mwPage"},r.createElement("div",{className:"mwHero"},r.createElement("h1",{className:"mwGreeting"},a,", ",c),r.createElement("p",{className:"mwQuestion"},"What can I do for you?")),je?r.createElement("div",{className:"mwChatBubble mwChatBubbleError"},je):null,it?r.createElement("div",{className:"mwFiledSummaryCard"},r.createElement("div",{className:"mwChatBubble"},r.createElement("span",{className:"mwThinking"},"Loading email",r.createElement("span",{className:"mwDot mwDotBounce1"}),r.createElement("span",{className:"mwDot mwDotBounce2"}),r.createElement("span",{className:"mwDot mwDotBounce3"})))):Dn?r.createElement(kt,{caseUrl:Mr,filedCaseName:Lr,sentPill:Ee,documentsToShow:Hr,workspaceHost:Te,onOpenUrl:Xt,buildLiveEditUrl:Yt,fmtCs:gn}):null,r.createElement("div",{className:"mwChatCard"},r.createElement("div",{className:"mwChatBody",ref:T},it?r.createElement("div",{className:"mwChatBubble"},r.createElement("span",{className:"mwThinking"},"Loading",r.createElement("span",{className:"mwDot mwDotBounce1"}),r.createElement("span",{className:"mwDot mwDotBounce2"}),r.createElement("span",{className:"mwDot mwDotBounce3"}))):null,"prompt"!==w||"filed"===E.kind&&Dn?null:r.createElement(Ct,{text:E.text,isUnfiled:"unfiled"===E.kind||"deleted"===E.kind,tone:g&&$&&Qn||se&&!we&&!Ie?"success":"default",actions:($n||[]).map(function(e){return{id:e.id,label:e.label,onClick:function(){console.log("[UI] clicked",e.intent,{viewMode:w,chatStep:Wn}),$r(e.intent)}}})}),"pickCase"===w?r.createElement("div",null,r.createElement(M,{title:"Case",scope:yn,onScopeChange:function(e){return wn("favourites"===e?"favourites":"all")},selectedCaseId:$,onSelectCaseId:function(e){if(G(e),Z("manual"),lt(""),ft(""),An(!1),g){var t=(L||[]).find(function(t){return String(null==t?void 0:t.id)===String(e)}),n=String((null==t?void 0:t.name)||(null==t?void 0:t.title)||(null==t?void 0:t.label)||"").trim()||"Case ".concat(e);return k("prompt"),C("case"),Gn([]),Un("compose_ready"),Nn&&Jt({itemKey:Nn,caseId:e,autoFileOnSend:Qn}),void B({itemId:Nn||m,kind:"unfiled",text:"OK. Click File Now. Then you can send the email normally. Case: ".concat(n,".")})}In.length>0&&C("attachments")},suggestions:zr,cases:Pn,isLoadingCases:W,clientNamesById:R,contentSuggestions:oe,isLoadingContentSuggestions:ae}),"attachments"===I&&In.length>0?r.createElement(It,{attachmentsLite:In,attachmentIds:Cn,selectedAttachments:Ye,onSelectionChange:Qe,filingMode:Ke,onFilingModeChange:$e,containerRef:_}):null):null,"sending"===w?r.createElement("div",{className:"mwChatBubble"},r.createElement("span",{className:"mwThinking"},"Sending",r.createElement("span",{className:"mwDot mwDotBounce1"}),r.createElement("span",{className:"mwDot mwDotBounce2"}),r.createElement("span",{className:"mwDot mwDotBounce3"}))):null,"sent"===w?r.createElement(r.Fragment,null,Dn?r.createElement("div",{className:"mwChatBubble"},"Done"):r.createElement(Ct,{text:E.text||"Tento email je jiÅ¾ zaÅ™azen.",isUnfiled:!1,tone:"default",actions:[]}),r.createElement("div",{ref:z})):null,r.createElement("div",{ref:z})),"prompt"!==w||"unfiled"!==E.kind&&"deleted"!==E.kind||g||O.current.has(E.itemId)?null:r.createElement("div",{className:"mwActionsBar"},se&&!we?r.createElement("button",{className:"mwPrimaryBtn",type:"button",onClick:function(){Se(!0),Ce(!1),k("pickCase"),C("case"),G(""),Z(""),Qe([]),An(!1)}},"File anyway"):r.createElement(r.Fragment,null,r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){O.current.add(E.itemId),xn&&O.current.add("conv:".concat(xn)),Ot(t,void 0,void 0,function(){var e,t;return Tt(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,Nt.applyUnfiledCategoryToCurrentEmailOfficeJs)()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),console.warn("[No] Office.js applyUnfiledCategory failed:",e),[3,3];case 3:return n.trys.push([3,5,,6]),[4,(0,Nt.applyUnfiledCategoryToCurrentEmailGraph)()];case 4:return n.sent(),[3,6];case 5:return t=n.sent(),console.warn("[No] Graph applyUnfiledCategory failed:",t),[3,6];case 6:return ne(!0),[2]}})}),Gn([{id:"fm1",label:"File manually",intent:"file_manually"}]),B({itemId:E.itemId,kind:"unfiled",text:"Got it. I'll step back for this email, but you can still file it later."})}},"No"),r.createElement("button",{className:"mwPrimaryBtn",type:"button",onClick:function(){console.log("[UI] Yes, file it - setting refiling override"),Or(!0),k("pickCase"),C("case"),G(""),Z(""),Qe([]),An(!1)}},"Yes, file it"))),"pickCase"!==w||g?null:r.createElement("div",{className:"mwActionsBar"},"attachments"===I?r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){C("case"),Qe([])}},"Back"):r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){if(ze(""),_n)return An(!1),k("sent"),C("case"),void B({itemId:Nn,kind:"filed",text:"Tento email je jiÅ¾ zaÅ™azen."});O.current.delete(Nn),k("prompt"),C("case"),G(""),Z(""),Qe([]),B({itemId:Nn,kind:"unfiled",text:"This email isn't filed yet. Would you like me to file it to a case?"})}},"Close"),"case"===I?r.createElement("button",{className:"mwPrimaryBtn ".concat($?"":"mwPrimaryBtnDisabled"),type:"button",disabled:!$,onClick:function(){In.length>0?C("attachments"):Gr()}},"Continue"):r.createElement("button",{className:"mwPrimaryBtn ".concat(!$||nt||In.length>0&&0===Ye.length?"mwPrimaryBtnDisabled":""),type:"button",disabled:!$||nt||it||In.length>0&&0===Ye.length,onClick:function(){Gr()}},"Continue")),"sent"!==w||g?null:r.createElement("div",{className:"mwActionsBar"},r.createElement("button",{className:"mwGhostBtn",type:"button",onClick:function(){console.log("[toggleCategory] ðŸ”µ Button clicked!",{forceUnfiledLabel:te,viewMode:w,composeMode:g,activeItemId:m}),Ot(t,void 0,void 0,function(){var e,t,n,r,o,i,a,c,l,u,f,m,v,g=this;return Tt(this,function(p){switch(p.label){case 0:e=function(e){return new Et(function(t){return setTimeout(t,e)})},t=function(e){return Ot(g,void 0,void 0,function(){return Tt(this,function(t){return[2,new Et(function(t,n){var r,o;try{var i=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.item,a=null==i?void 0:i.categories;if(!(null==a?void 0:a.removeAsync))return console.log("[toggleCategory] âš ï¸ removeAsync not available"),t();console.log("[toggleCategory] Removing categories:",e),a.removeAsync(e,function(e){(null==e?void 0:e.status)===Office.AsyncResultStatus.Failed?(console.error("[toggleCategory] âŒ removeAsync failed:",null==e?void 0:e.error),n(null==e?void 0:e.error)):(console.log("[toggleCategory] âœ… removeAsync succeeded"),t())})}catch(e){console.error("[toggleCategory] âŒ removeAsync exception:",e),n(e)}})]})})},p.label=1;case 1:return p.trys.push([1,21,26,27]),We(!0),console.log("[toggleCategory] ðŸ“Š Starting toggle process",{forceUnfiledLabel:te,filed:At,unfiled:jt}),[4,Ut()];case 2:return n=p.sent(),r=n.includes(d),o=n.includes(s),i=!(!r||o)||!(o&&!r)&&Boolean(te),a=!i,console.log("[toggleCategory] beforeOffice",{beforeOffice:n,hasUnfiledBefore:r,hasFiledBefore:o,currentIsUnfiled:i,targetIsUnfiled:a}),ne(a),[4,t([At,jt])];case 3:return p.sent(),[4,e(150)];case 4:return p.sent(),console.log("[toggleCategory] ðŸŽ¯ Applying target category:",a?"UNFILED":"FILED"),a?[4,(0,Nt.applyUnfiledCategoryToCurrentEmailOfficeJs)()]:[3,6];case 5:return p.sent(),console.log("[toggleCategory] âœ… Applied UNFILED category"),[3,8];case 6:return[4,(0,Nt.applyFiledCategoryToCurrentEmailOfficeJs)()];case 7:p.sent(),console.log("[toggleCategory] âœ… Applied FILED category"),p.label=8;case 8:c=0,p.label=9;case 9:return c<12?[4,e(250)]:[3,20];case 10:return p.sent(),[4,Ut()];case 11:return l=p.sent(),u=l.includes(d),f=l.includes(s),console.log("[toggleCategory] verify",{i:c,afterOffice:l,hasUnfiled:u,hasFiled:f}),u&&f?[4,t([At,jt])]:[3,18];case 12:return p.sent(),[4,e(150)];case 13:return p.sent(),a?[4,(0,Nt.applyUnfiledCategoryToCurrentEmailOfficeJs)()]:[3,15];case 14:return p.sent(),[3,17];case 15:return[4,(0,Nt.applyFiledCategoryToCurrentEmailOfficeJs)()];case 16:p.sent(),p.label=17;case 17:return[3,19];case 18:if(a&&u&&!f)return ne(!0),[2];if(!a&&f&&!u)return ne(!1),[2];p.label=19;case 19:return c+=1,[3,9];case 20:return console.warn("[toggleCategory] âš ï¸ Could not observe category change after retries, keeping optimistic UI"),[3,27];case 21:m=p.sent(),console.error("[toggleCategory] âŒ FAILED:",m),console.error("[toggleCategory] Error details:",{message:m instanceof Error?m.message:String(m),stack:m instanceof Error?m.stack:void 0}),p.label=22;case 22:return p.trys.push([22,24,,25]),console.log("[toggleCategory] ðŸ”„ Attempting to revert state from Outlook"),[4,on(s,d,ne)];case 23:return p.sent(),console.log("[toggleCategory] âœ… State reverted successfully"),[3,25];case 24:return v=p.sent(),console.error("[toggleCategory] âŒ Could not revert state:",v),[3,25];case 25:return[3,27];case 26:return We(!1),console.log("[toggleCategory] ðŸ Toggle process completed"),[7];case 27:return[2]}})})}},te?"Mark as Filed":"Mark as Unfiled")),"prompt"===w&&"filed"===E.kind&&Dn&&!g&&!it&&($n||[]).length>0?r.createElement("div",{className:"mwActionsBar"},($n||[]).map(function(e){return r.createElement("button",{key:e.id,className:"mwGhostBtn",type:"button",onClick:function(){return $r(e.intent)}},e.label)})):null),vt?r.createElement("div",{className:"mwRenameOverlay",onClick:function(){zt||(gt(!1),bt(null))}},r.createElement("div",{className:"mwRenameDialog",onClick:function(e){return e.stopPropagation()}},r.createElement("div",{className:"mwRenameTitle"},"PÅ™ejmenovat dokument"),r.createElement("input",{type:"text",value:wt,onChange:function(e){return St(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&!zt&&String(wt||"").trim()&&Wr()},className:"mwRenameInput","aria-label":"NÃ¡zev dokumentu",autoFocus:!0}),r.createElement("div",{className:"mwRenameActions"},r.createElement("button",{type:"button",className:"mwGhostBtn",disabled:zt,onClick:function(){return qr()}},"ZruÅ¡it"),r.createElement("button",{type:"button",className:"mwPrimaryBtn",disabled:zt||!String(wt||"").trim(),onClick:function(){Wr()}},zt?"UklÃ¡dÃ¡m":"UloÅ¾it")))):null)}const yn=r.createContext(void 0);yn.Provider;const wn=(...e)=>{const t={};for(const n of e){const e=Array.isArray(n)?n:Object.keys(n);for(const n of e)t[n]=1}return t},Sn=wn(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),kn=wn(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","popover","ref","role","style","tabIndex","title","translate","spellCheck","name"]),xn=wn(["itemID","itemProp","itemRef","itemScope","itemType"]),In=wn(kn,Sn,xn),Cn=wn(In,["form"]),Nn=wn(In,["height","loop","muted","preload","src","width"]),En=wn(Nn,["poster"]),Bn=wn(In,["start"]),On=wn(In,["value"]),Tn=wn(In,["download","href","hrefLang","media","referrerPolicy","rel","target","type"]),_n=wn(In,["dateTime"]),An=wn(In,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","popoverTarget","popoverTargetAction","type","value"]),jn={label:Cn,audio:Nn,video:En,ol:Bn,li:On,a:Tn,button:An,input:wn(An,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:wn(An,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:wn(An,["form","multiple","required"]),option:wn(In,["selected","value"]),table:wn(In,["cellPadding","cellSpacing"]),tr:In,th:wn(In,["colSpan","rowSpan","scope"]),td:wn(In,["colSpan","headers","rowSpan","scope"]),colGroup:wn(In,["span"]),col:wn(In,["span"]),fieldset:wn(In,["disabled","form"]),form:wn(In,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:wn(In,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:wn(In,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:_n,dialog:wn(In,["open","onCancel","onClose"])};function zn(e,t,n){const r=e&&jn[e]||In;return r.as=1,function(e,t,n){const r=Array.isArray(t),o={},i=Object.keys(e);for(const a of i)!(!r&&t[a]||r&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(a))||(o[a]=e[a]);return o}(t,r,n)}const Fn=Symbol.for("fui.slotRenderFunction"),Rn=Symbol.for("fui.slotElementType"),Dn=Symbol.for("fui.slotClassNameProp");function Pn(e,t){const{defaultProps:n,elementType:o}=t,i=function(e){return"string"==typeof e||"number"==typeof e||Mn(e)||r.isValidElement(e)?{children:e}:e}(e),a={...n,...i,[Rn]:o,[Dn]:(null==i?void 0:i.className)||(null==n?void 0:n.className)};return i&&"function"==typeof i.children&&(a[Fn]=i.children,a.children=null==n?void 0:n.children),a}function Ln(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return Pn(e,t)}const Mn=e=>"object"==typeof e&&null!==e&&Symbol.iterator in e;function Hn(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const qn=Hn()?r.useLayoutEffect:r.useEffect,Wn=e=>{const t=r.useRef(()=>{throw new Error("Cannot call an event handler while rendering")});return qn(()=>{t.current=e},[e]),r.useCallback((...e)=>(0,t.current)(...e),[t])},Un=r.createContext(void 0),Kn=Un.Provider;function $n(){var e;return null!==(e=r.useContext(Un))&&void 0!==e?e:{}}const Gn=(e,t)=>{e=function(e,t){return function(e,t,n){if(!e)return t;t={...t};const{generatedControlId:r,hintId:o,labelFor:i,labelId:a,required:c,validationMessageId:s,validationState:l}=e;var u,d,f,m,v,g,p,h,b,y,w,S,k;return r&&(null!==(d=(u=t).id)&&void 0!==d||(u.id=r)),!a||(null==n?void 0:n.supportsLabelFor)&&i===t.id||null!==(v=(f=t)[m="aria-labelledby"])&&void 0!==v||(f[m]=a),(s||o)&&(t["aria-describedby"]=[s,o,null==t?void 0:t["aria-describedby"]].filter(Boolean).join(" ")),"error"===l&&(null!==(p=(g=t)["aria-invalid"])&&void 0!==p||(g["aria-invalid"]=!0)),c&&((null==n?void 0:n.supportsRequired)?null!==(w=(y=t).required)&&void 0!==w||(y.required=!0):null!==(k=(S=t)["aria-required"])&&void 0!==k||(S["aria-required"]=!0)),(null==n?void 0:n.supportsSize)&&(null!==(b=(h=t).size)&&void 0!==b||(h.size=e.size)),t}(r.useContext(yn),e,t)}(e,{supportsLabelFor:!0,supportsRequired:!0,supportsSize:!0});const n=$n();var o;const{size:i="medium",appearance:a=(null!==(o=n.inputDefaultAppearance)&&void 0!==o?o:"outline"),onChange:c}=e,[s,l]=(e=>{const[t,n]=r.useState(()=>void 0===e.defaultState?e.initialState:"function"==typeof e.defaultState?e.defaultState():e.defaultState),o=r.useRef(e.state);r.useEffect(()=>{o.current=e.state},[e.state]);const i=r.useCallback(e=>{(function(e){return"function"==typeof e})(e)&&e(o.current)},[]);return(e=>{const[t]=r.useState(()=>void 0!==e);return t})(e.state)?[e.state,i]:[t,n]})({state:e.value,defaultState:e.defaultValue,initialState:""}),u=(({primarySlotTagName:e,props:t,excludedPropNames:n})=>({root:{style:t.style,className:t.className},primary:zn(e,t,[...n||[],"style","className"])}))({props:e,primarySlotTagName:"input",excludedPropNames:["size","onChange","value","defaultValue"]}),d={size:i,appearance:a,components:{root:"span",input:"input",contentBefore:"span",contentAfter:"span"},input:Pn(e.input,{defaultProps:{type:"text",ref:t,...u.primary},elementType:"input"}),contentAfter:Ln(e.contentAfter,{elementType:"span"}),contentBefore:Ln(e.contentBefore,{elementType:"span"}),root:Pn(e.root,{defaultProps:u.root,elementType:"span"})};return d.input.value=s,d.input.onChange=Wn(e=>{const t=e.target.value;null==c||c(e,{value:t}),l(t)}),d};function Jn(e){return Boolean(null==e?void 0:e.hasOwnProperty(Rn))}function Vn(e,t){return function(n,r,o,i,a){return Jn(r)?t(function(e,t){return{...t,[Rn]:e}}(n,r),null,o,i,a):Jn(n)?t(n,r,o,i,a):e(n,r,o,i,a)}}function Xn(e){const{as:t,[Dn]:n,[Rn]:r,[Fn]:o,...i}=e,a=i,c="string"==typeof r&&null!=t?t:r;return"string"!=typeof c&&t&&(a.as=t),{elementType:c,props:a,renderFunction:o}}n(44363);var Yn=n(74848);const Qn=n.t(Yn,2),Zn=Vn(Qn.jsx,(e,t,n)=>{const{elementType:o,renderFunction:i,props:a}=Xn(e),c={...a,...t};return i?Qn.jsx(r.Fragment,{children:i(o,c)},n):Qn.jsx(o,c,n)}),er=Vn(Qn.jsxs,(e,t,n)=>{const{elementType:o,renderFunction:i,props:a}=Xn(e),c={...a,...t};return i?Qn.jsx(r.Fragment,{children:i(o,{...c,children:Qn.jsxs(r.Fragment,{children:c.children},void 0)})},n):Qn.jsxs(o,c,n)});function tr(e,t,n){const r=function(e,t,n,r=ut.A){const o=r();return function(r){const{dir:i,renderer:a}=r,c="ltr"===i?e:t||e;return o(a,Array.isArray(n)?{r:n}:n),c}}(e,t,n,ft.A);return function(){const e=(0,vt.m)(),t=(0,mt.J)();return r({dir:e,renderer:t})}}const nr=tr("r1oeeo9n","r9sxh5",{r:[".r1oeeo9n{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r1oeeo9n::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-left-radius:var(--borderRadiusMedium);border-bottom-right-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r1oeeo9n:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r1oeeo9n:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r1oeeo9n:focus-within{outline:2px solid transparent;}",".r9sxh5{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r9sxh5::after{box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-right-radius:var(--borderRadiusMedium);border-bottom-left-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r9sxh5:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r9sxh5:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r9sxh5:focus-within{outline:2px solid transparent;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]}),rr=gt({small:{sshi5w:"f1pha7fy",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},medium:{},large:{sshi5w:"f1w5jphr",Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},outline:{},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1l4zc64",gg5e9n:["f1m52nbi","f1ub3y4t"],Drbcw7:"f8vnjqi",udz0bu:["fz1etlk","f1hc16gm"],Be8ivqh:"f1klwx88",ofdepl:["f1hc16gm","fz1etlk"]},underline:{De3pzq:"f1c21dwh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],wvpqe5:["f1deefiw","f1n71otn"],Eqx8gd:["f1n6gb5g","f15yvnhg"],B1piin3:["f15yvnhg","f1n6gb5g"]},underlineInteractive:{oetu4i:"f1l4zc64",Be8ivqh:"f1klwx88",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f2ale1x"},filled:{g2u3we:"fghlq4f",h3c5rm:["f1gn591s","fjscplz"],B9xav0g:"fb073pr",zhjwy3:["fjscplz","f1gn591s"]},filledInteractive:{q7v0qe:"ftmjh5b",kmh5ft:["f17blpuu","fsrcdbj"],nagaa4:"f1tpwn32",B1yhkcb:["fsrcdbj","f17blpuu"]},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},"filled-darker":{De3pzq:"f16xq7d1"},"filled-lighter":{De3pzq:"fxugw4r"},"filled-darker-shadow":{De3pzq:"f16xq7d1",E5pizo:"fyed02w"},"filled-lighter-shadow":{De3pzq:"fxugw4r",E5pizo:"fyed02w"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"],Bsft5z2:"fhr9occ",Bduesf4:"f99w1ws"},smallWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},smallWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},mediumWithContentBefore:{uwmqm3:["f1ng84yb","f11gcy0p"]},mediumWithContentAfter:{z189sj:["f11gcy0p","f1ng84yb"]},largeWithContentBefore:{uwmqm3:["f1uw59to","fw5db7e"]},largeWithContentAfter:{z189sj:["fw5db7e","f1uw59to"]}},{d:[".f1pha7fy{min-height:24px;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1w5jphr{min-height:40px;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".fokr779{border-radius:0;}",{p:-1}],".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",[".f2ale1x::after{border-radius:0;}",{p:-1}],".fghlq4f{border-top-color:var(--colorTransparentStroke);}",".f1gn591s{border-right-color:var(--colorTransparentStroke);}",".fjscplz{border-left-color:var(--colorTransparentStroke);}",".fb073pr{border-bottom-color:var(--colorTransparentStroke);}",".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".fyed02w{box-shadow:var(--shadow2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fhr9occ::after{content:unset;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}"],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".ftmjh5b:hover,.ftmjh5b:focus-within{border-top-color:var(--colorTransparentStrokeInteractive);}",".f17blpuu:hover,.f17blpuu:focus-within{border-right-color:var(--colorTransparentStrokeInteractive);}",".fsrcdbj:hover,.fsrcdbj:focus-within{border-left-color:var(--colorTransparentStrokeInteractive);}",".f1tpwn32:hover,.f1tpwn32:focus-within{border-bottom-color:var(--colorTransparentStrokeInteractive);}"],a:[".f8vnjqi:active,.f8vnjqi:focus-within{border-top-color:var(--colorNeutralStroke1Pressed);}",".fz1etlk:active,.fz1etlk:focus-within{border-right-color:var(--colorNeutralStroke1Pressed);}",".f1hc16gm:active,.f1hc16gm:focus-within{border-left-color:var(--colorNeutralStroke1Pressed);}",".f1klwx88:active,.f1klwx88:focus-within{border-bottom-color:var(--colorNeutralStrokeAccessiblePressed);}"],m:[["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],w:[".f99w1ws:focus-within{outline-style:none;}"]}),or=tr("r12stul0",null,[".r12stul0{align-self:stretch;box-sizing:border-box;flex-grow:1;min-width:0;border-style:none;padding:0 var(--spacingHorizontalM);color:var(--colorNeutralForeground1);background-color:transparent;outline-style:none;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;}",".r12stul0::-webkit-input-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::-moz-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::placeholder{color:var(--colorNeutralForeground4);opacity:1;}"]),ir=gt({small:{uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},medium:{},large:{uwmqm3:["fnphzt9","flt1dlf"],z189sj:["flt1dlf","fnphzt9"]},smallWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},smallWithContentAfter:{z189sj:["ffczdla","fgiv446"]},mediumWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},mediumWithContentAfter:{z189sj:["ffczdla","fgiv446"]},largeWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},largeWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},disabled:{sj55zd:"f1s2aq7o",De3pzq:"f1c21dwh",Bceei9c:"fdrzuqr",yvdlaj:"fahhnxm"}},{d:[".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".fnphzt9{padding-left:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".flt1dlf{padding-right:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".fgiv446{padding-left:var(--spacingHorizontalXXS);}",".ffczdla{padding-right:var(--spacingHorizontalXXS);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fdrzuqr{cursor:not-allowed;}",".fahhnxm::-webkit-input-placeholder{color:var(--colorNeutralForegroundDisabled);}",".fahhnxm::-moz-placeholder{color:var(--colorNeutralForegroundDisabled);}"]}),ar=tr("r1572tok",null,[".r1572tok{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;}",".r1572tok>svg{font-size:20px;}"]),cr=gt({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),sr=r.createContext(void 0),lr=()=>{},ur=sr.Provider,dr=e=>{var t,n;return null!==(n=null===(t=r.useContext(sr))||void 0===t?void 0:t[e])&&void 0!==n?n:lr},fr=r.forwardRef((e,t)=>{const n=Gn(e,t);return(e=>{const{size:t,appearance:n}=e,r=e.input.disabled,o="true"==`${e.input["aria-invalid"]}`,i=n.startsWith("filled"),a=rr(),c=ir(),s=cr();e.root.className=at("fui-Input",nr(),a[t],e.contentBefore&&a[`${t}WithContentBefore`],e.contentAfter&&a[`${t}WithContentAfter`],a[n],!r&&"outline"===n&&a.outlineInteractive,!r&&"underline"===n&&a.underlineInteractive,!r&&i&&a.filledInteractive,i&&a.filled,!r&&o&&a.invalid,r&&a.disabled,e.root.className),e.input.className=at("fui-Input__input",or(),c[t],e.contentBefore&&c[`${t}WithContentBefore`],e.contentAfter&&c[`${t}WithContentAfter`],r&&c.disabled,e.input.className);const l=[ar(),r&&s.disabled,s[t]];e.contentBefore&&(e.contentBefore.className=at("fui-Input__contentBefore",...l,e.contentBefore.className)),e.contentAfter&&(e.contentAfter.className=at("fui-Input__contentAfter",...l,e.contentAfter.className))})(n),dr("useInputStyles_unstable")(n),(e=>er(e.root,{children:[e.contentBefore&&Zn(e.contentBefore,{}),Zn(e.input,{}),e.contentAfter&&Zn(e.contentAfter,{})]}))(n)});fr.displayName="Input";const mr="Enter",vr=" ";function gr(e,t){const{disabled:n,disabledFocusable:r=!1,"aria-disabled":o,onClick:i,onKeyDown:a,onKeyUp:c,...s}=null!=t?t:{},l="string"==typeof o?"true"===o:o,u=n||r||l,d=Wn(e=>{u?(e.preventDefault(),e.stopPropagation()):null==i||i(e)}),f=Wn(e=>{if(null==a||a(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===mr||t===vr))return e.preventDefault(),void e.stopPropagation();t!==vr?t===mr&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()}),m=Wn(e=>{if(null==c||c(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===mr||t===vr))return e.preventDefault(),void e.stopPropagation();t===vr&&(e.preventDefault(),e.currentTarget.click())});if("button"===e||void 0===e)return{...s,disabled:n&&!r,"aria-disabled":!!r||l,onClick:r?void 0:d,onKeyUp:r?void 0:c,onKeyDown:r?void 0:a};{const t=!!s.href;let o=t?void 0:"button";!o&&u&&(o="link");const i={role:o,tabIndex:r||!t&&!n?0:void 0,...s,onClick:d,onKeyUp:m,onKeyDown:f,"aria-disabled":u};return"a"===e&&u&&(i.href=void 0),i}}const pr=(e,t,n)=>{var r;return zn(null!==(r=t.as)&&void 0!==r?r:e,t,n)},hr=r.createContext(void 0),br={},yr=(hr.Provider,(e,t)=>{const{size:n}=null!==(o=r.useContext(hr))&&void 0!==o?o:br;var o;const{appearance:i="secondary",as:a="button",disabled:c=!1,disabledFocusable:s=!1,icon:l,iconPosition:u="before",shape:d="rounded",size:f=(null!=n?n:"medium")}=e,m=Ln(l,{elementType:"span"});return{appearance:i,disabled:c,disabledFocusable:s,iconPosition:u,shape:d,size:f,iconOnly:Boolean((null==m?void 0:m.children)&&!e.children),components:{root:"button",icon:"span"},root:Pn(pr(a,gr(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"===a?"button":void 0}}),icon:m}}),wr=tr("r1f29ykk",null,{r:[".r1f29ykk{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1f29ykk:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1f29ykk:hover:active,.r1f29ykk:active:focus-visible{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1f29ykk[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1f29ykk{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1f29ykk:focus{border-color:ButtonText;}.r1f29ykk:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1f29ykk:hover:active,.r1f29ykk:active:focus-visible{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1f29ykk[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),Sr=tr("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]),kr=gt({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",Bpjbzib:"fkoldzo"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",Bpjbzib:"f1ksv2xa",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"f1d6mv4x",By8wz76:"f1nz3ub2",Bcq6wej:"fag2qd2",Jcjdmf:["fmvhcg7","f14bpyus"],sc4o1m:"f1o3dhpw",Bosien3:["f14bpyus","fmvhcg7"],B7iucu3:"fqc85l4",B8gzw0y:"f1h3a8gf",Bbkh6qg:"fkiggi6",F230oe:"f8gmj8i",Bdw8ktp:["f1ap8nzx","fjag8bx"],Bj1xduy:"f1igan7k",Bhh2cfd:["fjag8bx","f1ap8nzx"],Bahaeuw:"f1v3eptx",Bv2bamp:"f1ysmecq",vxuvv6:"faulsx",Bli9q98:["f79t15f","f8qmx7k"],Bx2tt8t:"fbtzoaq",yad0b3:["f8qmx7k","f79t15f"],j2fop7:"fd4bjan"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",Bpjbzib:"f1q1yqic",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"fwga7ee",Bqou3pl:"f1nhwcv0",Bsnehw8:"f1gm6xmp",wsxvnf:"f1xxsver",Bahaeuw:"f1v3eptx",Buhizc3:"fivsta0",j2fop7:"fd4bjan",Bqabnb4:"f3m6zum"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bpjbzib:"fkoldzo",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"],Brsut9c:"f1l983o9",Bqou3pl:"f1nhwcv0",Bsnehw8:"f1gm6xmp",Bbkh6qg:"fxoo9op",Bahaeuw:"f1v3eptx",Bv2bamp:"f1i0gk12",j2fop7:"fd4bjan"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fkoldzo:hover:active,.fkoldzo:active:focus-visible{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".f1ksv2xa:hover:active,.f1ksv2xa:active:focus-visible{background-color:var(--colorBrandBackgroundPressed);}",".fhvnf4x:hover:active,.fhvnf4x:active:focus-visible{border-top-color:transparent;}",".fb6swo4:hover:active,.fb6swo4:active:focus-visible{border-right-color:transparent;}",".f232fm2:hover:active,.f232fm2:active:focus-visible{border-left-color:transparent;}",".f1klyf7k:hover:active,.f1klyf7k:active:focus-visible{border-bottom-color:transparent;}",".f1d6mv4x:hover:active,.f1d6mv4x:active:focus-visible{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".f1q1yqic:hover:active,.f1q1yqic:active:focus-visible{background-color:var(--colorSubtleBackgroundPressed);}",".fwga7ee:hover:active,.fwga7ee:active:focus-visible{color:var(--colorNeutralForeground2Pressed);}",".f1nhwcv0:hover:active .fui-Icon-filled,.f1nhwcv0:active:focus-visible .fui-Icon-filled{display:inline;}",".f1gm6xmp:hover:active .fui-Icon-regular,.f1gm6xmp:active:focus-visible .fui-Icon-regular{display:none;}",".f1xxsver:hover:active .fui-Button__icon,.f1xxsver:active:focus-visible .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1l983o9:hover:active,.f1l983o9:active:focus-visible{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1nz3ub2{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fag2qd2{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14bpyus{border-left-color:HighlightText;}.fmvhcg7{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o3dhpw{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fqc85l4{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1h3a8gf{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkiggi6:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f8gmj8i:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ap8nzx:hover{border-right-color:Highlight;}.fjag8bx:hover{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1igan7k:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1v3eptx:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ysmecq:hover:active,.f1ysmecq:active:focus-visible{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.faulsx:hover:active,.faulsx:active:focus-visible{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f79t15f:hover:active,.f79t15f:active:focus-visible{border-right-color:Highlight;}.f8qmx7k:hover:active,.f8qmx7k:active:focus-visible{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbtzoaq:hover:active,.fbtzoaq:active:focus-visible{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fd4bjan:hover:active,.fd4bjan:active:focus-visible{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fivsta0:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3m6zum:hover:active .fui-Button__icon,.f3m6zum:active:focus-visible .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fxoo9op:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1i0gk12:hover:active,.f1i0gk12:active:focus-visible{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),xr=gt({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",Bpjbzib:"f1jct5ie",im15vp:"f13txml0",Hjvxdg:["f1ncddno","f1axfvow"],Gpfmf1:"f1z04ada",ustxxc:["f1axfvow","f1ncddno"],Brsut9c:"f1uhomfy",Bses4qk:"fy9mucy",Bqou3pl:"f1g9va8i",Bsnehw8:"fwgvudy",wsxvnf:"fom6jww"},highContrast:{By8wz76:"f14ptb23",Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"],B7iucu3:"f1cyfu5x",Grqk0h:"f127ot8j",h3ptyc:"f19etb0b",Buw724y:["f4f984j","fw441p0"],Buk7464:"f3d22hf",Hwei09:["fw441p0","f4f984j"],Bbkh6qg:"fj8k9ua",F230oe:"fifrq0d",Bdw8ktp:["f196mwp7","fnekfq"],Bj1xduy:"f1l6uprw",Bhh2cfd:["fnekfq","f196mwp7"],Bahaeuw:"fa9u7a5",Buhizc3:"f1m71e0y",Bv2bamp:"fw24f3",vxuvv6:"f1nznrny",Bli9q98:["fq8nxuu","f1ao3jkc"],Bx2tt8t:"ftoixeo",yad0b3:["f1ao3jkc","fq8nxuu"],j2fop7:"fpmuzpx",Bqabnb4:"f168odog"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",Bpjbzib:"f9r0db0"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bpjbzib:"f9r0db0",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bpjbzib:"f9r0db0",im15vp:"fhvnf4x",Hjvxdg:["fb6swo4","f232fm2"],Gpfmf1:"f1klyf7k",ustxxc:["f232fm2","fb6swo4"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1jct5ie:hover:active,.f1jct5ie:active:focus-visible{background-color:var(--colorNeutralBackgroundDisabled);}",".f13txml0:hover:active,.f13txml0:active:focus-visible{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ncddno:hover:active,.f1ncddno:active:focus-visible{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1axfvow:hover:active,.f1axfvow:active:focus-visible{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1z04ada:hover:active,.f1z04ada:active:focus-visible{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1uhomfy:hover:active,.f1uhomfy:active:focus-visible{color:var(--colorNeutralForegroundDisabled);}",".fy9mucy:hover:active,.fy9mucy:active:focus-visible{cursor:not-allowed;}",".f1g9va8i:hover:active .fui-Icon-filled,.f1g9va8i:active:focus-visible .fui-Icon-filled{display:none;}",".fwgvudy:hover:active .fui-Icon-regular,.fwgvudy:active:focus-visible .fui-Icon-regular{display:inline;}",".fom6jww:hover:active .fui-Button__icon,.fom6jww:active:focus-visible .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f9r0db0:hover:active,.f9r0db0:active:focus-visible{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".fhvnf4x:hover:active,.fhvnf4x:active:focus-visible{border-top-color:transparent;}",".fb6swo4:hover:active,.fb6swo4:active:focus-visible{border-right-color:transparent;}",".f232fm2:hover:active,.f232fm2:active:focus-visible{border-left-color:transparent;}",".f1klyf7k:hover:active,.f1klyf7k:active:focus-visible{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f14ptb23{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cyfu5x{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f127ot8j .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f19etb0b:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4f984j:focus{border-right-color:GrayText;}.fw441p0:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3d22hf:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fj8k9ua:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fifrq0d:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f196mwp7:hover{border-right-color:GrayText;}.fnekfq:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1l6uprw:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fa9u7a5:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1m71e0y:hover .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fw24f3:hover:active,.fw24f3:active:focus-visible{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1nznrny:hover:active,.f1nznrny:active:focus-visible{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ao3jkc:hover:active,.f1ao3jkc:active:focus-visible{border-left-color:GrayText;}.fq8nxuu:hover:active,.fq8nxuu:active:focus-visible{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ftoixeo:hover:active,.ftoixeo:active:focus-visible{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fpmuzpx:hover:active,.fpmuzpx:active:focus-visible{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f168odog:hover:active .fui-Button__icon,.f168odog:active:focus-visible .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),Ir=gt({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Bqsb82s:["fixhny3","f18mfu3r"],jg1oma:"feygou5"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f18mfu3r[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fixhny3[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.feygou5[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),Cr=gt({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),Nr=gt({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]}),Er=r.forwardRef((e,t)=>{const n=yr(e,t);return(e=>{const t=wr(),n=Sr(),r=kr(),o=xr(),i=Ir(),a=Cr(),c=Nr(),{appearance:s,disabled:l,disabledFocusable:u,icon:d,iconOnly:f,iconPosition:m,shape:v,size:g}=e;e.root.className=at("fui-Button",t,s&&r[s],r[g],d&&"small"===g&&r.smallWithIcon,d&&"large"===g&&r.largeWithIcon,r[v],(l||u)&&o.base,(l||u)&&o.highContrast,s&&(l||u)&&o[s],"primary"===s&&i.primary,i[g],i[v],f&&a[g],e.root.className),e.icon&&(e.icon.className=at("fui-Button__icon",n,!!e.root.children&&c[m],c[g],e.icon.className))})(n),dr("useButtonStyles_unstable")(n),(e=>{const{iconOnly:t,iconPosition:n}=e;return er(e.root,{children:["after"!==n&&e.icon&&Zn(e.icon,{}),!t&&e.root.children,"after"===n&&e.icon&&Zn(e.icon,{})]})})(n)});Er.displayName="Button";var Br=n(64583).Promise,Or=function(e,t,n,r){return new(n||(n=Br))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Tr=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},_r=(0,a.n)({page:{minHeight:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",padding:"18px",background:"rgb(63, 74, 86)",boxSizing:"border-box",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif'},shell:{width:"100%",maxWidth:"720px",marginLeft:"auto",marginRight:"auto",borderRadius:"16px",border:"1px solid rgba(0,0,0,0.10)",background:"white",boxShadow:"0 12px 30px rgba(0,0,0,0.12)",padding:"22px",boxSizing:"border-box"},brandRow:{display:"flex",justifyContent:"center",marginBottom:"14px"},logo:{height:"40px",width:"auto",display:"block"},title:{margin:0,textAlign:"center",fontSize:"30px",lineHeight:1.12,letterSpacing:"-0.02em",fontWeight:800,color:"rgba(17,24,39,0.95)"},subtitle:{margin:"10px 0 0 0",textAlign:"center",fontSize:"13.5px",lineHeight:1.45,opacity:.72},formBlock:{marginTop:"18px",maxWidth:"640px",marginLeft:"auto",marginRight:"auto"},fieldLabel:{fontSize:"12.5px",fontWeight:800,opacity:.85,marginBottom:"8px"},inputWrap:{borderRadius:"14px",border:"1px solid rgba(0,0,0,0.14)",background:"white",padding:"8px",boxShadow:"0 1px 0 rgba(0,0,0,0.02)"},input:{width:"100%","& input::placeholder":{color:"rgba(0,0,0,0.35)"}},continueBtn:{marginTop:"12px",width:"100%",minHeight:"42px",borderRadius:"14px",fontWeight:800},errorBox:{marginTop:"12px",borderRadius:"12px",padding:"10px 12px",border:"1px solid rgba(180, 0, 0, 0.25)",background:"rgba(220, 0, 0, 0.05)",color:"rgba(120, 0, 0, 0.95)",fontSize:"12.5px",lineHeight:1.35},signedInTitle:{marginTop:"18px",textAlign:"center",fontSize:"13px",fontWeight:900,opacity:.9},connectedList:{marginTop:"12px",display:"flex",flexDirection:"column",gap:"10px",maxWidth:"640px",marginLeft:"auto",marginRight:"auto"},connectedCard:{borderRadius:"16px",border:"1px solid rgba(0,0,0,0.10)",background:"white",padding:"12px 14px",display:"flex",alignItems:"center",gap:"12px",boxShadow:"0 1px 0 rgba(0,0,0,0.02)",transition:"background 120ms ease",":hover":{background:"rgba(0,0,0,0.015)"}},iconImg:{width:"40px",height:"40px",borderRadius:"14px",border:"1px solid rgba(0,0,0,0.10)",background:"white",padding:"8px",boxSizing:"border-box",flex:"0 0 auto"},cardMain:{flex:"1 1 auto",minWidth:0},hostLine:{fontSize:"14px",fontWeight:900,color:"rgba(17,24,39,0.95)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},nameLine:{marginTop:"3px",fontSize:"12.5px",opacity:.72,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},openBtn:{flex:"0 0 auto",minHeight:"36px",padding:"0 16px",borderRadius:"999px",fontWeight:800,fontSize:"13px",background:"rgba(37, 99, 235, 0.08)",color:"rgba(37, 99, 235, 0.95)",border:"1px solid rgba(37, 99, 235, 0.25)",boxShadow:"0 1px 0 rgba(0,0,0,0.02)"}}),Ar="sc:connectedWorkspaces";function jr(e){var t=this,n=e.email,o=e.onSelect,i=_r(),a=r.useState(""),c=a[0],s=a[1],u=r.useState(null),d=u[0],f=u[1],m=r.useState(!1),v=m[0],g=m[1],p=r.useState([]),h=p[0],b=p[1];r.useEffect(function(){Or(t,void 0,void 0,function(){var e,t;return Tr(this,function(n){switch(n.label){case 0:return[4,(0,l.wv)(Ar)];case 1:if(!(e=n.sent()))return[2];try{t=JSON.parse(e),Array.isArray(t)&&t.length>0&&b(t)}catch(e){}return[2]}})})},[]);var y=r.useCallback(function(e){return Or(t,void 0,void 0,function(){var t,n,r,i;return Tr(this,function(a){switch(a.label){case 0:if(f(null),t=function(e){var t=(e||"").trim();return t?t.replace(/^https?:\/\//i,"").split(/[\/?#]/)[0].trim().toLowerCase():""}(e),!t)return[2];g(!0),a.label=1;case 1:return a.trys.push([1,3,4,5]),n=function(e){return{workspaceId:e,name:e,host:e}}(t),o(n),r=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([n],h.filter(function(e){return e.workspaceId!==n.workspaceId}),!0).slice(0,10),b(r),[4,(0,l.Kg)(Ar,JSON.stringify(r))];case 2:return a.sent(),[3,5];case 3:return i=a.sent(),f(i instanceof Error?i.message:String(i)),[3,5];case 4:return g(!1),[7];case 5:return[2]}})})},[h,o]),w=function(){y(c.trim())};return r.createElement("div",{className:i.page},r.createElement("div",{className:i.shell},r.createElement("div",{className:i.brandRow},r.createElement("img",{src:"assets/SingleCaseFullLogo.svg",alt:"SingleCase",className:i.logo})),r.createElement("h1",{className:i.title},"Select your workspace"),r.createElement("p",{className:i.subtitle},"Signed in as ",n,". Enter your SingleCase workspace host."),r.createElement("div",{className:i.formBlock},r.createElement("div",{className:i.fieldLabel},"Workspace host"),r.createElement("div",{className:i.inputWrap},r.createElement(fr,{value:c,onChange:function(e,t){return s(t.value)},placeholder:"valfor-demo.singlecase.ch",appearance:"outline",className:i.input,onKeyDown:function(e){"Enter"===e.key&&!v&&c.trim().length>0&&w()}})),r.createElement(Er,{appearance:"primary",onClick:w,disabled:v||0===c.trim().length,className:i.continueBtn},v?"Checking...":"Continue"),d?r.createElement("div",{className:i.errorBox},d):null),h.length>0?r.createElement(r.Fragment,null,r.createElement("div",{className:i.signedInTitle},"Recent workspaces"),r.createElement("div",{className:i.connectedList},h.slice(0,2).map(function(e){return r.createElement("div",{key:e.workspaceId,className:i.connectedCard},r.createElement("img",{src:"assets/icon.svg",alt:"",className:i.iconImg}),r.createElement("div",{className:i.cardMain},r.createElement("div",{className:i.hostLine},e.host),r.createElement("div",{className:i.nameLine},e.name)),r.createElement(Er,{appearance:"secondary",onClick:function(){return o(e)},className:i.openBtn},"Open"))}))):null))}var zr=(0,a.n)({card:{border:"1px solid ".concat("rgba(0, 0, 0, 0.08)"),borderRadius:"16px",padding:"14px",backgroundColor:"rgba(255, 255, 255, 0.7)",color:"#111827"}});function Fr(e){var t=zr();return r.createElement("div",{className:t.card},e.children)}var Rr=n(64583).Promise;function Dr(e){return Dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dr(e)}var Pr=function(e,t,n,r){return new(n||(n=Rr))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Lr=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function Mr(e){var t,n,r=null==e?void 0:e.status,o=null===(n=null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.Office)||void 0===t?void 0:t.AsyncResultStatus)||void 0===n?void 0:n.Succeeded;return void 0!==o?r===o:"succeeded"===String(r||"").toLowerCase()}function Hr(e,t){return"read"===t?Rr.resolve(String((null==e?void 0:e.subject)||"")):new Rr(function(t){var n;try{var r=null===(n=null==e?void 0:e.subject)||void 0===n?void 0:n.getAsync;if("function"!=typeof r)return void t("");r.call(e.subject,function(e){try{Mr(e)?t(String((null==e?void 0:e.value)||"")):t("")}catch(e){t("")}})}catch(e){t("")}})}function qr(e,t,n){var r=String((null==e?void 0:e.conversationId)||"").trim();if(r)return Rr.resolve("cid:".concat(r));var o=null==e?void 0:e.getConversationIndexAsync;return"read"===n&&"function"==typeof o?new Rr(function(e){try{o(function(n){try{if(Mr(n)){var r=String((null==n?void 0:n.value)||"").trim();e(r?"cidx:".concat(r):t?"item:".concat(t):"")}else e(t?"item:".concat(t):"")}catch(n){e(t?"item:".concat(t):"")}})}catch(n){e(t?"item:".concat(t):"")}}):Rr.resolve(t?"item:".concat(t):"")}var Wr=n(64583).Promise,Ur=function(e,t,n,r){return new(n||(n=Wr))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Kr=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};function $r(e){return String(e).padStart(2,"0")}function Gr(e){return"".concat(e.getFullYear(),"-").concat($r(e.getMonth()+1),"-").concat($r(e.getDate()))}function Jr(e){var t=Math.max(0,Number(e||0));return{h:Math.floor(t/3600),m:Math.floor(t%3600/60)}}function Vr(e,t){return 3600*(Number.isFinite(e)?Math.max(0,Math.floor(e)):0)+60*(Number.isFinite(t)?Math.max(0,Math.floor(t)):0)}function Xr(){var e=new Date;return{from:Gr(new Date(e.getFullYear(),e.getMonth(),1)),to:Gr(e)}}function Yr(e){var t,n,o,i=this,a=e.token,c=e.onBack,s=function(){var e=this,t=(0,r.useState)(null),n=t[0],o=t[1],i=(0,r.useState)([]),a=i[0],c=i[1],s=(0,r.useState)(!1),l=s[0],u=s[1],d=(0,r.useState)(null),f=d[0],m=d[1],v=(0,r.useRef)(""),g=(0,r.useRef)(null),p=(0,r.useRef)(!1),h=(0,r.useCallback)(function(){return Pr(e,void 0,void 0,function(){var e,t,n,r,i,a,s,l,d,f,g,h,b,y,w,S,k;return Lr(this,function(x){switch(x.label){case 0:if(p.current)return[2];p.current=!0,x.label=1;case 1:return x.trys.push([1,4,5,6]),m(null),e=null===globalThis||void 0===globalThis?void 0:globalThis.Office,(t=null===(y=null===(b=null==e?void 0:e.context)||void 0===b?void 0:b.mailbox)||void 0===y?void 0:y.item)?(n=function(e){var t=null==e?void 0:e.subject;return t&&"object"===Dr(t)&&"function"==typeof t.getAsync?"compose":"read"}(t),r=String((null==t?void 0:t.itemId)||""),i="compose:".concat(String((null==t?void 0:t.conversationId)||""),":").concat(String((null==t?void 0:t.dateTimeCreated)||"")).trim(),(a=r||i||"compose:".concat(Date.now()))&&a===v.current?[2]:(v.current=a,[4,Hr(t,n)])):[2];case 2:return s=x.sent(),l="",d="","read"===n?(l=String((null===(w=null==t?void 0:t.from)||void 0===w?void 0:w.displayName)||""),d=String((null===(S=null==t?void 0:t.from)||void 0===S?void 0:S.emailAddress)||(null===(k=null==t?void 0:t.from)||void 0===k?void 0:k.address)||"")):(f=function(){var e,t;try{var n=null===globalThis||void 0===globalThis?void 0:globalThis.Office,r=null===(t=null===(e=null==n?void 0:n.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.userProfile;return{name:(null==r?void 0:r.displayName)?String(r.displayName):void 0,email:(null==r?void 0:r.emailAddress)?String(r.emailAddress):void 0}}catch(e){return{}}}(),l=String(f.name||""),d=String(f.email||"")),[4,qr(t,r,n)];case 3:return g=x.sent(),o({itemId:r,itemKey:a,mode:n,subject:s,fromName:l,fromEmail:d,conversationKey:g}),u(!0),c([]),[3,6];case 4:return h=x.sent(),m(h instanceof Error?h.message:String(h)),c([]),[3,6];case 5:return u(!1),p.current=!1,[7];case 6:return[2]}})})},[]);return(0,r.useEffect)(function(){var t=!1;return Pr(e,void 0,void 0,function(){var e,n,r,o;return Lr(this,function(i){switch(i.label){case 0:return[4,new Rr(function(e){try{var t=null===globalThis||void 0===globalThis?void 0:globalThis.Office;t&&"function"==typeof t.onReady?t.onReady(function(){return e()}):e()}catch(t){e()}})];case 1:return i.sent(),t?[2]:[4,h()];case 2:if(i.sent(),t)return[2];if(e=null===globalThis||void 0===globalThis?void 0:globalThis.Office,!(null==(n=null===(o=null==e?void 0:e.context)||void 0===o?void 0:o.mailbox)?void 0:n.addHandlerAsync))return[2];r=function(){try{h()}catch(e){}},g.current=r;try{n.addHandlerAsync(e.EventType.ItemChanged,r,function(){})}catch(e){}return[2]}})}),function(){var e;t=!0;try{var n=null===globalThis||void 0===globalThis?void 0:globalThis.Office,r=null===(e=null==n?void 0:n.context)||void 0===e?void 0:e.mailbox,o=g.current;(null==r?void 0:r.removeHandlerAsync)&&o&&r.removeHandlerAsync(n.EventType.ItemChanged,{handler:o},function(){})}catch(e){}g.current=null,v.current="",p.current=!1}},[h]),{email:n,suggestions:a,isLoading:l,error:f,refresh:h}}(),l=s.email,u=s.error,d=((null==l?void 0:l.itemId)||(null==l?void 0:l.id)||"").toString(),f=((null==l?void 0:l.subject)||"").toString(),m=((null==l?void 0:l.conversationKey)||"").toString(),v=((null==l?void 0:l.fromEmail)||(null===(t=null==l?void 0:l.from)||void 0===t?void 0:t.email)||(null===(n=null==l?void 0:l.from)||void 0===n?void 0:n.emailAddress)||(null===(o=null==l?void 0:l.from)||void 0===o?void 0:o.address)||"").toString(),g=r.useState([]),p=g[0],h=g[1],b=r.useState({}),y=b[0],w=b[1],S=r.useState([]),k=S[0],x=S[1],I=r.useState("my"),C=I[0],N=I[1],E=r.useState(!1),B=E[0],O=E[1],T=r.useState(""),_=T[0],j=T[1],z=r.useState(""),F=z[0],R=z[1],D=r.useState(!1),P=D[0],L=D[1],H=r.useState([]),q=H[0],W=H[1],U=r.useState(null),K=U[0],$=U[1],G=r.useState(!1),V=G[0],Y=G[1],Q=r.useState(null),ee=Q[0],te=Q[1];r.useEffect(function(){var e=!0;return Ur(i,void 0,void 0,function(){var t,n,r,o,i,c,s,l,u;return Kr(this,function(d){switch(d.label){case 0:O(!0),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,Wr.all([J(a,C),X(a),Z(a)])];case 2:if(t=d.sent(),n=t[0],r=t[1],o=t[2],!e)return[2];for(h(n),x(o),i={},c=0,s=r;c<s.length;c++)l=s[c],i[l.id]=l.name;return w(i),[3,5];case 3:return u=d.sent(),e?($(u instanceof Error?u.message:String(u)),[3,5]):[2];case 4:return e&&O(!1),[7];case 5:return[2]}})}),function(){e=!1}},[a,C]);var ie=r.useMemo(function(){return"all"===C?p:p.filter(function(e){return!((t=((null==e?void 0:e.status)||"").toLowerCase())&&(t.includes("closed")||t.includes("uzav")||t.includes("archiv")||t.includes("done")));var t})},[p,C]);r.useEffect(function(){var e=!0;return Ur(i,void 0,void 0,function(){var t,n,r,o;return Kr(this,function(i){switch(i.label){case 0:if(!d)return[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,A(d)];case 2:return t=i.sent(),n=(null==t?void 0:t.caseId)?String(t.caseId):"",r=!n&&m?se(m):"",(o=n||r)&&e?(j(o),R(n?"attached":"thread"),[3,4]):[2];case 3:return i.sent(),[3,4];case 4:return[2]}})}),function(){e=!1}},[d,m]);var ae=r.useCallback(function(e){"attached"!==F&&"thread"!==F&&(j(e),R("suggested"))},[F]),ce=ye({enabled:!0,emailItemId:d,conversationKey:m,subject:f,bodySnippet:"",fromEmail:v,attachments:[],cases:ie,selectedCaseId:_,selectedSource:"suggested"===F?"suggested":"manual"===F?"manual":"",onAutoSelectCaseId:ae,topK:3}).suggestions;r.useEffect(function(){_&&(ie.some(function(e){return String(e.id)===String(_)})||"all"!==C&&N("all"))},[_,ie,C]),r.useEffect(function(){var e=!0;return _?(Ur(i,void 0,void 0,function(){var t,n,r,o,i;return Kr(this,function(c){switch(c.label){case 0:L(!0),$(null),c.label=1;case 1:return c.trys.push([1,3,4,5]),t=Xr(),n=t.from,r=t.to,[4,ne(a,{projectId:_,from:n,to:r})];case 2:return o=c.sent(),e?(W(o),[3,5]):[2];case 3:return i=c.sent(),e?($(i instanceof Error?i.message:String(i)),W([]),[3,5]):[2];case 4:return e&&L(!1),[7];case 5:return[2]}})}),function(){e=!1}):(W([]),function(){})},[a,_]);var le=r.useMemo(function(){return{total:q.reduce(function(e,t){return e+Number(t.total_time||0)},0),billed:q.reduce(function(e,t){return e+Number(t.total_billed_time||0)},0)}},[q]),ue=function(e){te(e.id?String(e.id):null),Y(!0)},de=Jr(le.total),fe=Jr(le.billed);return r.createElement(Fr,null,r.createElement("div",{className:"ts-root"},r.createElement("div",{className:"ts-body"},r.createElement("div",{className:"ts-topbar"},r.createElement("button",{type:"button",className:"ts-back",onClick:c},"â€¹ Back"),r.createElement("div",{className:"ts-title"},"Timesheets"),r.createElement("div",{className:"ts-spacer"})),u?r.createElement("div",{className:"ts-error"},String(u)):null,r.createElement("div",{className:"ts-section"},r.createElement(M,{title:"Case",scope:C,onScopeChange:function(e){return N(e)},selectedCaseId:_,onSelectCaseId:function(e){j(e),R("manual")},suggestions:ce,cases:ie,isLoadingCases:B,clientNamesById:y}),"attached"===F?r.createElement("div",{className:"ts-muted",style:{marginTop:6}},"Case preselected from attached email"):null,"thread"===F?r.createElement("div",{className:"ts-muted",style:{marginTop:6}},"Case preselected from this email thread"):null),r.createElement("div",{className:"ts-summary"},r.createElement("div",{className:"ts-summary-left"},r.createElement("div",{className:"ts-summary-title"},"Vykazy"),r.createElement("div",{className:"ts-summary-sub"},"Total ",de.h,"h ",$r(de.m),"m Billed ",fe.h,"h ",$r(fe.m),"m"))),K?r.createElement("div",{className:"ts-error"},K):null,P?r.createElement("div",{className:"ts-muted"},"Loadingâ€¦"):null,r.createElement("div",{className:"ts-list"},q.map(function(e,t){var n=(e.date||"").slice(0,10),o=Jr(Number(e.total_time||0)),i=Jr(Number(e.total_billed_time||0)),a=(e.note||"").trim();return r.createElement("div",{key:e.id||"".concat(n,"-").concat(t),className:"ts-row",onClick:function(){return ue(e)},role:"button",tabIndex:0,onKeyDown:function(t){"Enter"!==t.key&&" "!==t.key||ue(e)}},r.createElement("div",{className:"ts-row-left"},r.createElement("div",{className:"ts-row-date"},n),r.createElement("div",{className:"ts-row-note"},a||"No note")),r.createElement("div",{className:"ts-row-right"},r.createElement("div",{className:"ts-row-time"},o.h,"h ",$r(o.m),"m"),Number(e.total_billed_time||0)!==Number(e.total_time||0)?r.createElement("div",{className:"ts-row-billed"},"Billed ",i.h,"h ",$r(i.m),"m"):null))}))),r.createElement("div",{className:"ts-footer"},r.createElement("button",{type:"button",className:"ts-primary",onClick:function(){te(null),Y(!0)},disabled:!_},"Add timesheet")),V?r.createElement(Qr,{token:a,caseId:_,users:k,editingId:ee,onClose:function(){Y(!1),te(null)},onSave:function(e){return Ur(i,void 0,void 0,function(){var t,n,r,o;return Kr(this,function(i){switch(i.label){case 0:return _?ee?[4,oe(a,ee,e)]:[3,2]:[2];case 1:return i.sent(),[3,4];case 2:return[4,re(a,e)];case 3:i.sent(),i.label=4;case 4:return t=Xr(),n=t.from,r=t.to,[4,ne(a,{projectId:_,from:n,to:r})];case 5:return o=i.sent(),W(o),Y(!1),te(null),[2]}})})}}):null))}function Qr(e){var t=this,n=(e.token,e.caseId),o=e.users,i=e.editingId,a=e.onClose,c=e.onSave,s=r.useState(function(){return Gr(new Date)}),l=s[0],u=s[1],d=r.useState(0),f=d[0],m=d[1],v=r.useState(0),g=v[0],p=v[1],h=r.useState(!1),b=h[0],y=h[1],w=r.useState(0),S=w[0],k=w[1],x=r.useState(0),I=x[0],C=x[1],N=r.useState(""),E=N[0],B=N[1],O=r.useState(""),T=O[0],_=O[1];r.useEffect(function(){1===o.length&&_(o[0].id)},[o]);var A=r.useState(!1),j=A[0],z=A[1],F=r.useState(null),R=F[0],D=F[1];return r.createElement("div",{className:"ts-modal-overlay",role:"dialog","aria-modal":"true"},r.createElement("div",{className:"ts-modal"},r.createElement("div",{className:"ts-modal-header"},r.createElement("div",{className:"ts-modal-title"},i?"Edit timesheet":"Create timesheet"),r.createElement("button",{type:"button",className:"ts-x",onClick:a},"Ã—")),r.createElement("div",{className:"ts-modal-grid"},r.createElement("div",null,r.createElement("div",{className:"ts-label"},"User"),r.createElement("select",{className:"ts-select",value:T,onChange:function(e){return _(e.target.value)}},r.createElement("option",{value:""},"Select user"),o.map(function(e){return r.createElement("option",{key:e.id,value:e.id},function(e){var t="".concat((e.firstName||"").trim()," ").concat((e.lastName||"").trim()).trim();return t&&e.username?"".concat(t," (").concat(e.username,")"):t||e.username||"User ".concat(e.id)}(e))}))),r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Date"),r.createElement("input",{className:"ts-input",type:"date",value:l,onChange:function(e){return u(e.target.value)}})),r.createElement("div",{className:"ts-time-row"},r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Hours"),r.createElement("input",{className:"ts-input",type:"number",value:f,onChange:function(e){return m(Number(e.target.value))}})),r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Minutes"),r.createElement("input",{className:"ts-input",type:"number",value:g,onChange:function(e){return p(Number(e.target.value))}}))),r.createElement("label",{className:"ts-check"},r.createElement("input",{type:"checkbox",checked:b,onChange:function(e){return y(e.target.checked)}}),"Billable time is different"),b?r.createElement("div",{className:"ts-time-row"},r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Billed hours"),r.createElement("input",{className:"ts-input",type:"number",value:S,onChange:function(e){return k(Number(e.target.value))}})),r.createElement("div",null,r.createElement("div",{className:"ts-label"},"Billed minutes"),r.createElement("input",{className:"ts-input",type:"number",value:I,onChange:function(e){return C(Number(e.target.value))}}))):null,r.createElement("div",{className:"ts-note"},r.createElement("div",{className:"ts-label"},"Details"),r.createElement("textarea",{className:"ts-textarea",value:E,onChange:function(e){return B(e.target.value)},placeholder:"Note"})),R?r.createElement("div",{className:"ts-error"},R):null),r.createElement("div",{className:"ts-modal-actions"},r.createElement("button",{type:"button",className:"ts-secondary",onClick:a,disabled:j},"Cancel"),r.createElement("button",{type:"button",className:"ts-primary",onClick:function(){return Ur(t,void 0,void 0,function(){var e,t,r,o;return Kr(this,function(i){switch(i.label){case 0:if(D(null),!n)return D("Select a case first."),[2];if(!T)return D("User is required."),[2];if(!l)return D("Date is required."),[2];if(g<0||g>59||I<0||I>59)return D("Minutes must be 0 to 59."),[2];if((e=Vr(f,g))<=0)return D("Time must be greater than 0."),[2];if((t=b?Vr(S,I):e)<0)return D("Billed time must be valid."),[2];r={user_id:Number(T),project_id:Number(n),date:"".concat(l," 00:00:00"),total_time:e,total_billed_time:t,sheet_activity_id:1,note:E||""},z(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,c(r)];case 2:return i.sent(),[3,5];case 3:return o=i.sent(),D(o instanceof Error?o.message:String(o)),[3,5];case 4:return z(!1),[7];case 5:return[2]}})})},disabled:j},j?"Savingâ€¦":"Save"))))}var Zr=function(){return Zr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Zr.apply(this,arguments)};function eo(e){var t=e.isOpen,n=e.settings,o=e.onClose,i=e.onChange,a=e.onReset;if(r.useEffect(function(){if(t){var e=function(e){"Escape"===e.key&&o()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}},[t,o]),!t)return null;var c={display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},s={fontSize:12,opacity:.85,lineHeight:"1.3"},l={fontSize:12,opacity:.65,marginTop:4,lineHeight:"1.35"},u={width:18,height:18},d={borderRadius:12,border:"1px solid rgba(0,0,0,0.08)",padding:12};return r.createElement("div",{onClick:o,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.25)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:9999}},r.createElement("div",{onClick:function(e){return e.stopPropagation()},style:{width:"100%",maxWidth:420,borderRadius:14,border:"1px solid rgba(0,0,0,0.10)",background:"rgba(255,255,255,0.98)",boxShadow:"0 10px 30px rgba(0,0,0,0.18)",padding:14}},r.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12}},r.createElement("div",{style:{fontWeight:600}},"Settings"),r.createElement("button",{onClick:o,style:{border:"none",background:"transparent",cursor:"pointer",fontSize:16,lineHeight:1,padding:6,opacity:.75},"aria-label":"Close",type:"button"},"Ã—")),r.createElement("div",{style:{marginTop:12,display:"flex",flexDirection:"column",gap:12}},r.createElement("div",{style:Zr(Zr({},d),{background:"rgba(17,24,39,0.02)"})},r.createElement("div",{style:c},r.createElement("div",null,r.createElement("div",{style:s},"Default case group"),r.createElement("div",{style:l},"Select which case group should be shown by default when opening the add-in.")),r.createElement("select",{style:{height:32,borderRadius:10,border:"1px solid rgba(0,0,0,0.12)",padding:"0 10px",background:"rgba(255,255,255,0.9)"},value:n.caseListScope,onChange:function(e){return i(Zr(Zr({},n),{caseListScope:e.target.value}))}},r.createElement("option",{value:"favourites"},"Favourites"),r.createElement("option",{value:"all"},"All")))),r.createElement("div",{style:d},r.createElement("div",{style:c},r.createElement("div",null,r.createElement("div",{style:s},"Auto suggest case from subject"),r.createElement("div",{style:l},"Preselect a case based on the email subject.")),r.createElement("input",{style:u,type:"checkbox",checked:n.autoSuggestCase,onChange:function(e){return i(Zr(Zr({},n),{autoSuggestCase:e.target.checked}))}})),r.createElement("div",{style:Zr({marginTop:10},c)},r.createElement("div",null,r.createElement("div",{style:s},"Remember last selected case"),r.createElement("div",{style:l},"Start with your last case when opening new emails.")),r.createElement("input",{style:u,type:"checkbox",checked:n.rememberLastCase,onChange:function(e){return i(Zr(Zr({},n),{rememberLastCase:e.target.checked}))}}))),r.createElement("div",{style:d},r.createElement("div",{style:c},r.createElement("div",null,r.createElement("div",{style:s},"Prevent duplicates"),r.createElement("div",{style:l},"Block sending if the same email was already attached to the same case.")),r.createElement("input",{style:u,type:"checkbox",checked:n.preventDuplicates,onChange:function(e){return i(Zr(Zr({},n),{preventDuplicates:e.target.checked}))}})),r.createElement("div",{style:Zr({marginTop:10},c)},r.createElement("div",null,r.createElement("div",{style:s},"Include body snippet"),r.createElement("div",{style:l},"Send a short plain text excerpt.")),r.createElement("input",{style:u,type:"checkbox",checked:n.includeBodySnippet,onChange:function(e){return i(Zr(Zr({},n),{includeBodySnippet:e.target.checked}))}})),r.createElement("div",{style:Zr({marginTop:10},c)},r.createElement("div",null,r.createElement("div",{style:s},"Include attachments"),r.createElement("div",{style:l},"Allow selecting attachments to send to SingleCase.")),r.createElement("input",{style:u,type:"checkbox",checked:n.includeAttachments,onChange:function(e){return i(Zr(Zr({},n),{includeAttachments:e.target.checked}))}}))),r.createElement("div",{style:{display:"flex",justifyContent:"space-between",gap:10}},e.onSignOut?r.createElement("button",{onClick:e.onSignOut,style:{height:34,borderRadius:10,border:"1px solid rgba(220,38,38,0.25)",padding:"0 12px",background:"rgba(220,38,38,0.06)",color:"rgb(153,27,27)",cursor:"pointer",fontWeight:600},type:"button"},"Sign out"):r.createElement("div",null),r.createElement("div",{style:{display:"flex",gap:10}},r.createElement("button",{onClick:a,style:{height:34,borderRadius:10,border:"1px solid rgba(0,0,0,0.12)",padding:"0 12px",background:"transparent",cursor:"pointer"},type:"button"},"Reset"),r.createElement("button",{onClick:o,style:{height:34,borderRadius:10,border:"none",padding:"0 12px",background:"#111827",color:"white",cursor:"pointer"},type:"button"},"Done"))))))}var to=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},no=(0,a.n)({page:{display:"flex",flexDirection:"column",height:"100%",minHeight:0},header:{marginBottom:"10px"},title:{margin:0,fontSize:"18px",fontWeight:800,color:"rgba(17,24,39,0.92)"},subtitle:{margin:"4px 0 0 0",fontSize:"13px",color:"rgba(17,24,39,0.62)",lineHeight:1.35},actionsDock:{position:"fixed",left:0,right:0,bottom:"120px",padding:"10px 12px 12px",zIndex:20,backgroundColor:"rgba(255,255,255,0.92)",borderTop:"1px solid rgba(0,0,0,0.06)",backdropFilter:"blur(8px)"},chat:{flex:1,minHeight:0,overflowY:"auto",padding:"6px 0 120px 0",display:"flex",flexDirection:"column",gap:"10px"},bubble:{maxWidth:"92%",borderRadius:"16px",padding:"10px 12px",border:"1px solid rgba(0,0,0,0.08)",boxShadow:"0 10px 24px rgba(0,0,0,0.06)",fontSize:"13px",lineHeight:1.4,color:"rgba(17,24,39,0.92)",whiteSpace:"pre-wrap",wordBreak:"break-word"},bubbleAssistant:{alignSelf:"flex-start",backgroundColor:"rgba(255,255,255,0.92)"},bubbleUser:{alignSelf:"flex-end",backgroundColor:"rgba(0,32,74,0.06)"},pillsWrap:{paddingTop:"10px",display:"flex",flexWrap:"wrap",gap:"8px"},pill:{height:"34px",padding:"0 12px",borderRadius:"999px",border:"1px solid rgba(0,0,0,0.12)",backgroundColor:"rgba(255,255,255,0.92)",cursor:"pointer",fontSize:"12px",fontWeight:800,color:"rgba(17,24,39,0.86)",boxShadow:"0 10px 24px rgba(0,0,0,0.06)",transitionProperty:"transform, background-color, border-color",transitionDuration:"120ms",transitionTimingFunction:"ease",":hover":{backgroundColor:"rgba(255,255,255,1)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)",backgroundColor:"rgba(255,255,255,0.94)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.16), 0 10px 24px rgba(0,0,0,0.06)"}},footerHint:{marginTop:"10px",fontSize:"12px",color:"rgba(17,24,39,0.55)",lineHeight:1.35}});function ro(){return"".concat(Date.now(),"_").concat(Math.random().toString(16).slice(2))}function oo(e){switch(e){case"add_timesheet":return"OK. This will create a timesheet entry.\n\nNext step: choose case, date, and duration (prototype only).";case"add_task":return"OK. This will create a task.\n\nNext step: pick case, assignee, due date (prototype only).";case"create_note":return"OK. This will create a note linked to the current case or email.\n\nNext step: enter the note text (prototype only).";case"summarise_email":return"OK. This will summarise the currently selected email.\n\nNext step: generate a short summary and key actions (prototype only).";default:return"OK."}}function io(e){var t=no(),n=r.useState([]),o=n[0],i=n[1],a=r.useRef(null);r.useEffect(function(){var e;0!==o.length&&(null===(e=a.current)||void 0===e||e.scrollIntoView({block:"end",behavior:"smooth"}))},[o.length]);var c=function(t){var n,r=function(e){switch(e){case"add_timesheet":return"Add timesheet";case"add_task":return"Add task";case"create_note":return"Create note";case"summarise_email":return"Summarise email";default:return"Action"}}(t);i(function(e){return to(to([],e,!0),[{id:ro(),role:"user",text:r},{id:ro(),role:"assistant",text:oo(t)}],!1)}),"add_timesheet"===t&&(null===(n=e.onOpenTab)||void 0===n||n.call(e,"timesheets"))};return r.createElement("div",{className:t.page},r.createElement("div",{className:t.header},r.createElement("p",{className:t.title},"Quick Actions")),r.createElement("div",{className:t.chat,role:"log","aria-label":"Quick actions chat"},o.length>0?o.map(function(e){return r.createElement("div",{key:e.id,className:[t.bubble,"assistant"===e.role?t.bubbleAssistant:t.bubbleUser].join(" ")},e.text)}):null,r.createElement("div",{ref:a})),r.createElement("div",{className:t.actionsDock},r.createElement("div",{className:t.pillsWrap,"aria-label":"Quick action options"},r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("add_timesheet")}},"Add timesheet"),r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("add_task")}},"Add task"),r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("create_note")}},"Create note"),r.createElement("button",{type:"button",className:t.pill,onClick:function(){return c("summarise_email")}},"Summarise email"))))}var ao=n(64583).Promise,co=function(e,t,n,r){return new(n||(n=ao))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},so=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},lo={autoSuggestCase:!0,caseListScope:"all",preventDuplicates:!0,includeBodySnippet:!1,rememberLastCase:!0,includeAttachments:!0},uo=(0,a.n)({root:{minHeight:"100vh",display:"flex",flexDirection:"column",backgroundColor:"rgb(255, 255, 255)"},content:{flex:1,padding:"12px",paddingBottom:"".concat(86,"px"),minHeight:0},topRow:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"10px",minHeight:"48px"},logoCenterWrap:{position:"absolute",left:"50%",transform:"translateX(-50%)"},topLeft:{display:"flex",alignItems:"center",gap:"10px",minWidth:0},logoCenter:{position:"absolute",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},backBtn:{height:"40px",padding:"0 16px",borderRadius:"999px",border:"1px solid rgba(0,0,0,0.12)",backgroundColor:"rgba(255,255,255,0.92)",cursor:"pointer",fontSize:"14px",fontWeight:700,color:"rgba(17,24,39,0.92)",boxShadow:"0 10px 26px rgba(0,0,0,0.06)",transitionProperty:"transform, background-color, border-color",transitionDuration:"120ms",transitionTimingFunction:"ease",":hover":{backgroundColor:"rgba(255,255,255,1)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)",backgroundColor:"rgba(255,255,255,0.94)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.18), 0 10px 26px rgba(0,0,0,0.06)"}},brandLogo:{height:"38px",width:"auto",objectFit:"contain",userSelect:"none"},settingsBtn:{width:"44px",height:"44px",borderRadius:"14px",border:"1px solid rgba(0,0,0,0.10)",backgroundColor:"rgba(255,255,255,0.92)",display:"inline-flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 10px 26px rgba(0,0,0,0.06)",transitionProperty:"transform, background-color, border-color",transitionDuration:"120ms",transitionTimingFunction:"ease",padding:0,color:"#111827",":hover":{backgroundColor:"rgba(255,255,255,1)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)",backgroundColor:"rgba(255,255,255,0.94)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.18), 0 10px 26px rgba(0,0,0,0.06)"}},settingsIcon:{fontSize:"18px",lineHeight:1,opacity:.9,userSelect:"none"},bottomNavWrap:{position:"fixed",left:0,right:0,bottom:0,padding:"10px 12px 12px",zIndex:50,pointerEvents:"none"},bottomNav:{pointerEvents:"auto",maxWidth:"720px",marginLeft:"auto",marginRight:"auto",backgroundColor:"rgba(255,255,255,0.92)",border:"1px solid rgba(0,0,0,0.08)",borderRadius:"18px",boxShadow:"0 14px 34px rgba(0,0,0,0.12)",height:"".concat(74,"px"),display:"grid",gridTemplateColumns:"repeat(4, 1fr)",alignItems:"center",padding:"6px",gap:"6px"},navItem:{height:"100%",borderRadius:"14px",border:"1px solid transparent",background:"transparent",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"6px",padding:0,color:"rgba(17,24,39,0.65)",transitionProperty:"background-color, border-color, transform",transitionDuration:"120ms",transitionTimingFunction:"ease",":hover":{backgroundColor:"rgba(0,0,0,0.04)",transform:"translateY(-1px)"},":active":{transform:"translateY(0px)"},":focus-visible":{outlineStyle:"none",boxShadow:"0 0 0 3px rgba(0,32,74,0.14)"}},navItemActive:{backgroundColor:"rgba(0,32,74,0.06)",color:"rgba(17,24,39,0.92)"},navIcon:{fontSize:"18px",lineHeight:1,userSelect:"none"},navLabel:{fontSize:"12px",fontWeight:700,lineHeight:1}});function fo(e){var t=uo(),n=[{id:"quick",icon:"âš¡",label:"Quick Actions"}];return r.createElement("div",{className:t.bottomNavWrap},r.createElement("div",{className:t.bottomNav,style:{gridTemplateColumns:"repeat(".concat(n.length,", 1fr)")}},n.map(function(n){var o=n.id===e.active;return r.createElement("button",{key:n.id,type:"button",className:[t.navItem,o?t.navItemActive:""].filter(Boolean).join(" "),onClick:function(){return e.onSelect(n.id)},"aria-current":o?"page":void 0},r.createElement("span",{className:t.navIcon,"aria-hidden":"true"},n.icon),r.createElement("span",{className:t.navLabel},n.label))})))}var mo=function(e){var t=uo(),n=r.useState(!1),o=n[0],i=n[1],a=r.useState(function(){return Re()}),c=a[0],s=a[1],d=r.useState(null),f=d[0],m=d[1],v=r.useState(!1),p=v[0],b=v[1],w=r.useState(function(){return function(e){try{var t=localStorage.getItem(y());if(!t)return e;var n=JSON.parse(t);return h(h({},e),n)}catch(t){return e}}(lo)}),S=w[0],x=w[1],I=r.useState(!1),C=I[0],N=I[1],E=r.useState("cases"),B=E[0],O=E[1],T=r.useState("home"),_=T[0],A=T[1],j=r.useRef(null);r.useEffect(function(){!function(){var e=Re(),t=e.token,n=e.issuedAt;if(t){var r=Date.now()-(n||0);(!n||r>288e5)&&Le()}}(),s(Re())},[]),r.useEffect(function(){co(void 0,void 0,void 0,function(){var e;return so(this,function(t){switch(t.label){case 0:return(e="124b900bca27f725a8258adc7ce50d5b3bf38877521dab95f87cf92a45acfb2db320e9257e3d317b")?[4,(0,l.Kg)(u.publicToken,e)]:(console.error("SINGLECASE_PUBLIC_TOKEN is not defined in environment variables"),[2]);case 1:return t.sent(),Pe(e,Re().email||"unknown@singlecase.local"),s(Re()),[2]}})})},[]),r.useEffect(function(){co(void 0,void 0,void 0,function(){var e,t;return so(this,function(n){switch(n.label){case 0:return c.token?o?(m(null),A("home"),b(!0),[2]):[4,(0,l.wv)(u.workspaceId)]:(m(null),i(!1),A("home"),b(!0),[2]);case 1:return e=n.sent(),t=e&&e.length>0?e:null,m(t),A("home"),b(!0),[2]}})})},[c.token,o]);var z=function(){var e;try{null===(e=j.current)||void 0===e||e.close()}catch(e){}finally{j.current=null}},F=function(){return co(void 0,void 0,void 0,function(){return so(this,function(e){switch(e.label){case 0:return Le(),[4,(0,l.Kg)(u.onboardingDone,"false")];case 1:return e.sent(),[4,(0,l.Kg)(u.workspaceId,"")];case 2:return e.sent(),[4,(0,l.Kg)(u.workspaceName,"")];case 3:return e.sent(),[4,(0,l.Kg)(u.workspaceHost,"")];case 4:return e.sent(),[4,(0,l.Kg)(u.agreementAccepted,"false")];case 5:return e.sent(),s(Re()),m(null),A("home"),b(!0),[2]}})})},R=Boolean(c.token)&&Boolean(f),D=R&&"app"===_;return p?r.createElement("div",{className:t.root},c.token?r.createElement(r.Fragment,null,r.createElement(eo,{isOpen:C,settings:S,onClose:function(){return N(!1)},onChange:function(e){k(e),x(e)},onReset:function(){k(lo),x(lo)},onSignOut:F}),r.createElement("div",{className:t.content},R?r.createElement("div",{className:t.topRow},r.createElement("div",{className:t.topLeft},D?r.createElement("button",{type:"button",className:t.backBtn,onClick:function(){return A("home")}},"â€¹ Back"):r.createElement("div",null)),r.createElement("div",{className:t.logoCenter},r.createElement("img",{src:"".concat(window.location.origin,"/assets/sc.png"),alt:"SingleCase",className:t.brandLogo})),r.createElement("button",{type:"button",className:t.settingsBtn,onClick:function(){return N(!0)},"aria-label":"NastavenÃ­",title:"NastavenÃ­"},r.createElement("span",{className:t.settingsIcon,"aria-hidden":"true"},"âš™"))):null,f?"home"===_?r.createElement(bn,{email:c.email,token:c.token,settings:S,onChangeSettings:x,onSignOut:F,onOpenTab:function(e){A("app"),O(e)}}):"timesheets"===B?r.createElement(Yr,{token:c.token,onBack:function(){return A("home")}}):"quick"===B?r.createElement(io,{onOpenTab:function(e){A("app"),O(e)}}):null:r.createElement(jr,{email:c.email,onSelect:function(e){return co(void 0,void 0,void 0,function(){var t;return so(this,function(n){switch(n.label){case 0:return[4,(0,l.Kg)(u.workspaceId,e.workspaceId)];case 1:return n.sent(),[4,(0,l.Kg)(u.workspaceName,e.name)];case 2:return n.sent(),[4,(0,l.Kg)(u.workspaceHost,e.host)];case 3:return n.sent(),m(e.workspaceId),i(!1),[4,(0,l.wv)(u.onboardingDone)];case 4:return t="true"===n.sent(),A(t?"app":"home"),[2]}})})}})),R?r.createElement(fo,{active:B,onSelect:function(e){A("app"),O(e)}}):null):r.createElement(g,{title:e.title,onOpenLoginDialog:function(e){return co(void 0,void 0,void 0,function(){var t,n,r,o,a,c,d;return so(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),(null===(d=null===(c=null===Office||void 0===Office?void 0:Office.context)||void 0===c?void 0:c.ui)||void 0===d?void 0:d.displayDialogAsync)?[4,(0,l.wv)(u.publicToken)]:(console.warn("Office UI dialog API not ready yet."),[2]);case 1:return t=f.sent(),(n=(t||"").trim())?((r=new URLSearchParams).set("workspaceHost",e.workspaceHost),r.set("token",n),o="".concat(window.location.origin,"/dialog.html?").concat(r.toString()),Office.context.ui.displayDialogAsync(o,{height:70,width:45,displayInIframe:!1},function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var t=e.value;j.current=t,t.addEventHandler(Office.EventType.DialogMessageReceived,function(e){return co(void 0,void 0,void 0,function(){var t;return so(this,function(n){switch(n.label){case 0:if(!e||"string"!=typeof e.message)return[2];try{t=JSON.parse(e.message)}catch(e){return[2]}return"auth_cancel"===(null==t?void 0:t.type)?(z(),[2]):"auth_complete"!==(null==t?void 0:t.type)?[3,2]:[4,(r={token:String(t.token||""),email:String(t.email||""),agreed:Boolean(t.agreed),workspace:t.workspace?{workspaceId:String(t.workspace.workspaceId||""),name:String(t.workspace.name||""),host:String(t.workspace.host||"")}:void 0},co(void 0,void 0,void 0,function(){var e;return so(this,function(t){switch(t.label){case 0:return r.agreed?(N(!1),Pe(r.token,r.email),[4,(0,l.Kg)(u.agreementAccepted,"true")]):[2];case 1:return t.sent(),(null===(e=r.workspace)||void 0===e?void 0:e.workspaceId)?[4,(0,l.Kg)(u.workspaceId,r.workspace.workspaceId)]:[3,6];case 2:return t.sent(),[4,(0,l.Kg)(u.workspaceName,r.workspace.name||"")];case 3:return t.sent(),[4,(0,l.Kg)(u.workspaceHost,r.workspace.host||"")];case 4:return t.sent(),m(r.workspace.workspaceId),i(!1),[4,(0,l.Kg)(u.onboardingDone,"false")];case 5:return t.sent(),A("home"),[3,11];case 6:return[4,(0,l.Kg)(u.onboardingDone,"false")];case 7:return t.sent(),[4,(0,l.Kg)(u.workspaceId,"")];case 8:return t.sent(),[4,(0,l.Kg)(u.workspaceName,"")];case 9:return t.sent(),[4,(0,l.Kg)(u.workspaceHost,"")];case 10:t.sent(),i(!0),m(null),A("home"),t.label=11;case 11:return s(Re()),[2]}})}))];case 1:n.sent(),z(),n.label=2;case 2:return[2]}var r})})}),t.addEventHandler(Office.EventType.DialogEventReceived,function(){z()})}else console.error("displayDialogAsync failed",e.error)}),[3,3]):(console.error("Missing sc:publicToken in storage."),[2]);case 2:return a=f.sent(),console.error("Open dialog crashed",a),[3,3];case 3:return[2]}})})},onAuthCompleted:function(){}})):r.createElement("div",{className:t.root})};const vo=r.createContext(void 0),go={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},po=vo.Provider;function ho(){var e;return null!==(e=r.useContext(vo))&&void 0!==e?e:go}const bo=r.createContext(void 0),yo=bo.Provider,wo=r.createContext(void 0).Provider,So=r.createContext(void 0).Provider;function ko(e,t){var n;const r=e;var o;return Boolean((null==r||null===(n=r.ownerDocument)||void 0===n?void 0:n.defaultView)&&r instanceof r.ownerDocument.defaultView[null!==(o=null==t?void 0:t.constructorName)&&void 0!==o?o:"HTMLElement"])}var xo="undefined"!=typeof WeakRef,Io=class{constructor(e){xo&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let n;return this._weakRef?(n=null==(e=this._weakRef)?void 0:e.deref(),n||delete this._weakRef):(n=this._instance,(null==(t=null==n?void 0:n.isDisposed)?void 0:t.call(n))&&delete this._instance),n}},Co="keyborg:focusin",No=!1,Eo=0,Bo=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout(()=>{delete this._isMouseOrTouchUsedTimer},1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++Eo,this._win=e;const n=e.document;if(t){const e=t.triggerKeys,n=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==n?void 0:n.length)&&(this._dismissKeys=new Set(n))}n.addEventListener(Co,this._onFocusIn,!0),n.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),n.addEventListener("touchstart",this._onMouseOrTouch,!0),n.addEventListener("touchend",this._onMouseOrTouch,!0),n.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;No||(No=function(e){const t=e.HTMLElement,n=t.prototype.focus;let r=!1;return t.prototype.focus=function(){r=!0},e.document.createElement("button").focus(),t.prototype.focus=n,r}(t));const n=t.HTMLElement.prototype.focus;if(n.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=s;const r=new Set,o=e=>{const t=e.target;if(!t)return;const n=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(n)},i=e=>{const t=e.target;if(!t)return;let n=e.composedPath()[0];const c=new Set;for(;n;)n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(c.add(n),n=n.host):n=n.parentNode;for(const e of r){const t=e.deref();t&&c.has(t)||(r.delete(e),t&&(t.removeEventListener("focusin",i,!0),t.removeEventListener("focusout",o,!0)))}a(t,e.relatedTarget||void 0)},a=(e,t,n)=>{var a;const s=e.shadowRoot;if(s){for(const e of r)if(e.deref()===s)return;return s.addEventListener("focusin",i,!0),s.addEventListener("focusout",o,!0),void r.add(new Io(s))}const l={relatedTarget:t,originalEvent:n},u=new CustomEvent(Co,{cancelable:!0,bubbles:!0,composed:!0,detail:l});u.details=l,(No||c.lastFocusedProgrammatically)&&(l.isFocusedProgrammatically=e===(null==(a=c.lastFocusedProgrammatically)?void 0:a.deref()),c.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},c=t.__keyborgData={focusInHandler:i,focusOutHandler:o,shadowTargets:r};function s(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new Io(this)),n.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let l=t.document.activeElement;for(;l&&l.shadowRoot;)a(l),l=l.shadowRoot.activeElement;s.__keyborgNativeFocus=n}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,n=t.HTMLElement.prototype,r=n.focus.__keyborgNativeFocus,o=t.__keyborgData;if(o){t.document.removeEventListener("focusin",o.focusInHandler,!0),t.document.removeEventListener("focusout",o.focusOutHandler,!0);for(const e of o.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",o.focusInHandler,!0),t.removeEventListener("focusout",o.focusOutHandler,!0))}o.shadowTargets.clear(),delete t.__keyborgData}r&&(n.focus=r)}(e);const t=e.document;t.removeEventListener(Co,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const n=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(n)for(const e of Object.keys(n))Oo.update(n[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const n=null==(t=this._win)?void 0:t.document.activeElement,r=!this._triggerKeys||this._triggerKeys.has(e.keyCode),o=n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable);return r&&!o}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout(()=>{this._dismissTimer=void 0;const n=e.document.activeElement;t&&n&&t===n&&(this.isNavigatingWithKeyboard=!1)},500)}}},Oo=class e{constructor(e,t){this._cb=[],this._id="k"+ ++Eo,this._win=e;const n=e.__keyborg;n?(this._core=n.core,n.refs[this._id]=this):(this._core=new Bo(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,n){return new e(t,n)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach(e=>e(t))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const To="data-fui-focus-visible";function _o(e,t){if(Ao(e))return()=>{};const n={current:void 0},r=(o=t,Oo.create(o,void 0));var o;function i(e){r.isNavigatingWithKeyboard()&&ko(e)&&(n.current=e,e.setAttribute(To,""))}function a(){n.current&&(n.current.removeAttribute(To),n.current=void 0)}r.subscribe(e=>{e?i(t.document.activeElement):a()});const c=e=>{a(),i(e.composedPath()[0])},s=t=>{(!t.relatedTarget||ko(t.relatedTarget)&&!e.contains(t.relatedTarget))&&a()};return e.addEventListener(Co,c),e.addEventListener("focusout",s),e.focusVisible=!0,e.contains(t.document.activeElement)&&i(t.document.activeElement),()=>{var t;a(),e.removeEventListener(Co,c),e.removeEventListener("focusout",s),e.focusVisible=void 0,t=r,Oo.dispose(t)}}function Ao(e){return!!e&&(!!e.focusVisible||Ao(null==e?void 0:e.parentElement))}function jo(e={}){const t=ho(),n=r.useRef(null);var o;const i=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return r.useEffect(()=>{if((null==i?void 0:i.defaultView)&&n.current)return _o(n.current,i.defaultView)},[n,i]),n}function zo(...e){const t=r.useCallback(n=>{t.current=n;for(const t of e)"function"==typeof t?t(n):t&&(t.current=n)},[...e]);return t}const Fo={current:0},Ro=r.createContext(void 0);const Do=r.createContext(void 0);function Po(e="fui-",t){const n=null!==(c=r.useContext(Ro))&&void 0!==c?c:Fo,i=r.useContext(Do)||"",a=o.useId;var c;if(a){const n=a(),o=r.useMemo(()=>n.replace(/:/g,""),[n]);return t||`${i}${e}${o}`}return r.useMemo(()=>t||`${i}${e}${++n.current}`,[i,e,t,n])}Do.Provider;const Lo="fui-FluentProvider",Mo=dt({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),Ho=o.useInsertionEffect?o.useInsertionEffect:qn,qo={},Wo={},Uo=(e,t)=>{const n=ho(),o=r.useContext(bo),i=$n(),a=r.useContext(sr)||qo,{applyStylesToPortals:c=!0,customStyleHooks_unstable:s,dir:l=n.dir,targetDocument:u=n.targetDocument,theme:d,overrides_unstable:f={}}=e,m=Ko(o,d),v=Ko(i,f),g=Ko(a,s),p=(0,mt.J)();var h;const{styleTagId:b,rule:y}=(e=>{const{targetDocument:t,theme:n,rendererAttributes:o}=e,i=r.useRef(void 0),a=Po(Lo),c=o,s=r.useMemo(()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce((e,n)=>`${e}--${n}: ${t[n]}; `,"")} }`:`${e} {}`}(`.${a}`,n),[n,a]);return function(e,t){r.useState(()=>{if(!e)return;const n=e.getElementById(t);n&&e.head.append(n)})}(t,a),Ho(()=>{const e=null==t?void 0:t.getElementById(a);return e?i.current=e:(i.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const n=e.createElement("style");return Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),e.head.appendChild(n),n})(t,{...c,id:a}),i.current&&((e,t)=>{const n=e.sheet;n&&(n.cssRules.length>0&&n.deleteRule(0),n.insertRule(t,0))})(i.current,s)),()=>{var e;null===(e=i.current)||void 0===e||e.remove()}},[a,t,s,c]),{styleTagId:a,rule:s}})({theme:m,targetDocument:u,rendererAttributes:null!==(h=p.styleElementAttributes)&&void 0!==h?h:Wo});return{applyStylesToPortals:c,customStyleHooks_unstable:g,dir:l,targetDocument:u,theme:m,overrides_unstable:v,themeClassName:b,components:{root:"div"},root:Pn(pr("div",{...e,dir:l,ref:zo(t,jo({targetDocument:u}))}),{elementType:"div"}),serverStyleProps:{cssRule:y,attributes:{...p.styleElementAttributes,id:b}}}};function Ko(e,t){return e&&t?{...e,...t}:e||t}const $o=r.forwardRef((e,t)=>{const n=Uo(e,t);(e=>{const t=(0,mt.J)(),n=Mo({dir:e.dir,renderer:t});e.root.className=at(Lo,e.themeClassName,n.root,e.root.className)})(n);const o=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:n,dir:o,root:i,targetDocument:a,theme:c,themeClassName:s,overrides_unstable:l}=e,u=r.useMemo(()=>({dir:o,targetDocument:a}),[o,a]),[d]=r.useState(()=>({})),f=r.useMemo(()=>({textDirection:o}),[o]);return{customStyleHooks_unstable:n,overrides_unstable:l,provider:u,textDirection:o,iconDirection:f,tooltip:d,theme:c,themeClassName:t?i.className:s}}(n);return((e,t)=>Zn(po,{value:t.provider,children:Zn(yo,{value:t.theme,children:Zn(wo,{value:t.themeClassName,children:Zn(ur,{value:t.customStyleHooks_unstable,children:Zn(So,{value:t.tooltip,children:Zn(vt.e,{dir:t.textDirection,children:Zn(lt,{value:t.iconDirection,children:Zn(Kn,{value:t.overrides_unstable,children:er(e.root,{children:[Hn()?null:Zn("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(n,o)});$o.displayName="FluentProvider";const Go="#242424",Jo="#424242",Vo="#616161",Xo="#bdbdbd",Yo="#e0e0e0",Qo="#e6e6e6",Zo="#ebebeb",ei="#f0f0f0",ti="#f5f5f5",ni="#fafafa",ri="rgba(255, 255, 255, 0.4)",oi="rgba(255, 255, 255, 0.5)",ii="rgba(0, 0, 0, 0.05)",ai="rgba(0, 0, 0, 0.1)",ci="#ffffff",si={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},li={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},ui={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:li,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},di={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:si,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},fi={cranberry:si,green:li,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},mi={success:"green",warning:"orange",danger:"cranberry"},vi=["red","green","darkOrange","yellow","berry","lightGreen","marigold"].reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:ui[t].tint60,[`colorPalette${n}Background2`]:ui[t].tint40,[`colorPalette${n}Background3`]:ui[t].primary,[`colorPalette${n}Foreground1`]:ui[t].shade10,[`colorPalette${n}Foreground2`]:ui[t].shade30,[`colorPalette${n}Foreground3`]:ui[t].primary,[`colorPalette${n}BorderActive`]:ui[t].primary,[`colorPalette${n}Border1`]:ui[t].tint40,[`colorPalette${n}Border2`]:ui[t].primary};return Object.assign(e,r)},{});vi.colorPaletteYellowForeground1=ui.yellow.shade30,vi.colorPaletteRedForegroundInverted=ui.red.tint20,vi.colorPaletteGreenForegroundInverted=ui.green.tint20,vi.colorPaletteYellowForegroundInverted=ui.yellow.tint40;const gi=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"].reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:di[t].tint40,[`colorPalette${n}Foreground2`]:di[t].shade30,[`colorPalette${n}BorderActive`]:di[t].primary};return Object.assign(e,r)},{}),pi={...vi,...gi},hi=Object.entries(mi).reduce((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${r}Background1`]:fi[n].tint60,[`colorStatus${r}Background2`]:fi[n].tint40,[`colorStatus${r}Background3`]:fi[n].primary,[`colorStatus${r}Foreground1`]:fi[n].shade10,[`colorStatus${r}Foreground2`]:fi[n].shade30,[`colorStatus${r}Foreground3`]:fi[n].primary,[`colorStatus${r}ForegroundInverted`]:fi[n].tint30,[`colorStatus${r}BorderActive`]:fi[n].primary,[`colorStatus${r}Border1`]:fi[n].tint40,[`colorStatus${r}Border2`]:fi[n].primary};return Object.assign(e,o)},{});hi.colorStatusDangerBackground3Hover=fi[mi.danger].shade10,hi.colorStatusDangerBackground3Pressed=fi[mi.danger].shade20,hi.colorStatusWarningForeground1=fi[mi.warning].shade20,hi.colorStatusWarningForeground3=fi[mi.warning].shade20,hi.colorStatusWarningBorder2=fi[mi.warning].shade20;const bi={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},yi={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},wi={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},Si={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},ki={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},xi={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function Ii(e,t,n=""){return{[`shadow2${n}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${n}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${n}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${n}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${n}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${n}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const Ci={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},Ni={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},Ei="10px",Bi="12px",Oi="16px",Ti="20px",_i="24px",Ai="32px",ji={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:Ei,spacingHorizontalM:Bi,spacingHorizontalL:Oi,spacingHorizontalXL:Ti,spacingHorizontalXXL:_i,spacingHorizontalXXXL:Ai},zi={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:Ei,spacingVerticalM:Bi,spacingVerticalL:Oi,spacingVerticalXL:Ti,spacingVerticalXXL:_i,spacingVerticalXXXL:Ai},Fi=(()=>{const e=(e=>({colorNeutralForeground1:Go,colorNeutralForeground1Hover:Go,colorNeutralForeground1Pressed:Go,colorNeutralForeground1Selected:Go,colorNeutralForeground2:Jo,colorNeutralForeground2Hover:Go,colorNeutralForeground2Pressed:Go,colorNeutralForeground2Selected:Go,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:Vo,colorNeutralForeground3Hover:Jo,colorNeutralForeground3Pressed:Jo,colorNeutralForeground3Selected:Jo,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:"#707070",colorNeutralForegroundDisabled:Xo,colorNeutralForegroundInvertedDisabled:ri,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:Jo,colorNeutralForeground2LinkHover:Go,colorNeutralForeground2LinkPressed:Go,colorNeutralForeground2LinkSelected:Go,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:Go,colorNeutralForegroundStaticInverted:ci,colorNeutralForegroundInverted:ci,colorNeutralForegroundInvertedHover:ci,colorNeutralForegroundInvertedPressed:ci,colorNeutralForegroundInvertedSelected:ci,colorNeutralForegroundInverted2:ci,colorNeutralForegroundOnBrand:ci,colorNeutralForegroundInvertedLink:ci,colorNeutralForegroundInvertedLinkHover:ci,colorNeutralForegroundInvertedLinkPressed:ci,colorNeutralForegroundInvertedLinkSelected:ci,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:ci,colorNeutralBackground1Hover:ti,colorNeutralBackground1Pressed:Yo,colorNeutralBackground1Selected:Zo,colorNeutralBackground2:ni,colorNeutralBackground2Hover:ei,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:Qo,colorNeutralBackground3:ti,colorNeutralBackground3Hover:Zo,colorNeutralBackground3Pressed:"#d6d6d6",colorNeutralBackground3Selected:Yo,colorNeutralBackground4:ei,colorNeutralBackground4Hover:ni,colorNeutralBackground4Pressed:ti,colorNeutralBackground4Selected:ci,colorNeutralBackground5:Zo,colorNeutralBackground5Hover:ti,colorNeutralBackground5Pressed:ei,colorNeutralBackground5Selected:ni,colorNeutralBackground6:Qo,colorNeutralBackgroundInverted:"#292929",colorNeutralBackgroundStatic:"#333333",colorNeutralBackgroundAlpha:oi,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:ti,colorSubtleBackgroundPressed:Yo,colorSubtleBackgroundSelected:Zo,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:oi,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:ai,colorSubtleBackgroundInvertedPressed:"rgba(0, 0, 0, 0.3)",colorSubtleBackgroundInvertedSelected:"rgba(0, 0, 0, 0.2)",colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:ei,colorNeutralBackgroundInvertedDisabled:"rgba(255, 255, 255, 0.1)",colorNeutralStencil1:Qo,colorNeutralStencil2:ni,colorNeutralStencil1Alpha:ai,colorNeutralStencil2Alpha:ii,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:"rgba(0, 0, 0, 0.5)",colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:ci,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:ni,colorNeutralCardBackgroundHover:ci,colorNeutralCardBackgroundPressed:ti,colorNeutralCardBackgroundSelected:Zo,colorNeutralCardBackgroundDisabled:ei,colorNeutralStrokeAccessible:Vo,colorNeutralStrokeAccessibleHover:"#575757",colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:"#b3b3b3",colorNeutralStroke1Selected:Xo,colorNeutralStroke2:Yo,colorNeutralStroke3:ei,colorNeutralStrokeSubtle:Yo,colorNeutralStrokeOnBrand:ci,colorNeutralStrokeOnBrand2:ci,colorNeutralStrokeOnBrand2Hover:ci,colorNeutralStrokeOnBrand2Pressed:ci,colorNeutralStrokeOnBrand2Selected:ci,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:Yo,colorNeutralStrokeInvertedDisabled:ri,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:ii,colorNeutralStrokeAlpha2:"rgba(255, 255, 255, 0.2)",colorStrokeFocus1:ci,colorStrokeFocus2:"#000000",colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"});return{...bi,...yi,...wi,...ki,...Si,...xi,...ji,...zi,...Ci,...Ni,...e,...pi,...hi,...Ii(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...Ii(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})();var Ri=n(64583).Promise,Di=function(e,t,n,r){return new(n||(n=Ri))(function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((r=r.apply(e,t||[])).next())})},Pi=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},Li="sc:filedEmailsCache";function Mi(){return Di(this,void 0,void 0,function(){var e,t,n,r,o,i,a,c,s,u,d;return Pi(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,(0,l.wv)(Li)];case 1:return(e=f.sent())?(t=JSON.parse(String(e)),n=Object.entries(t),console.log("ðŸ“¦ Cache contains ".concat(n.length," entries:")),console.log("â”€".repeat(80)),r=n.map(function(e){var t=e[0],n=e[1];return{Key:t.substring(0,40)+(t.length>40?"...":""),Type:t.startsWith("subj:")?"Subject":"ConversationId",CaseId:n.caseId,DocumentId:n.documentId,Subject:n.subject,FiledAt:new Date(n.filedAt).toISOString()}}),console.table(r),console.log("\nðŸ“Š Statistics:"),o=n.filter(function(e){return!e[0].startsWith("subj:")}).length,i=n.filter(function(e){return e[0].startsWith("subj:")}).length,console.log("  - ConversationId entries: ".concat(o)),console.log("  - Subject entries: ".concat(i)),console.log("  - Total: ".concat(n.length)),console.log("\nðŸ’¡ Most recent entry:"),(a=n.sort(function(e,t){return t[1].filedAt-e[1].filedAt})).length>0&&(c=a[0],s=c[0],u=c[1],console.log("  - Key: ".concat(s)),console.log("  - Subject: ".concat(u.subject)),console.log("  - Filed: ".concat(new Date(u.filedAt).toISOString()))),console.log("\nðŸ“ Raw cache data:"),console.log(JSON.stringify(t,null,2)),[3,3]):(console.log("ðŸ“¦ Cache is EMPTY"),[2]);case 2:return d=f.sent(),console.error("âŒ Failed to read cache:",d),[3,3];case 3:return[2]}})})}function Hi(){var e,t,n,r,o,i,a,c,s,l;try{var u={host:null===(n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.diagnostics)||void 0===n?void 0:n.hostName,hostVersion:null===(i=null===(o=null===(r=null===Office||void 0===Office?void 0:Office.context)||void 0===r?void 0:r.mailbox)||void 0===o?void 0:o.diagnostics)||void 0===i?void 0:i.hostVersion,platform:null===(a=null===Office||void 0===Office?void 0:Office.context)||void 0===a?void 0:a.platform,officeVersion:null===(s=null===(c=null===Office||void 0===Office?void 0:Office.context)||void 0===c?void 0:c.diagnostics)||void 0===s?void 0:s.version,hasOfficeRuntime:"undefined"!=typeof OfficeRuntime,hasRoamingSettings:!!(null===(l=null===Office||void 0===Office?void 0:Office.context)||void 0===l?void 0:l.roamingSettings)};console.log("ðŸ–¥ï¸  Platform Information:"),console.log("â”€".repeat(80)),console.table(u)}catch(e){console.error("âŒ Failed to get platform info:",e)}}function qi(){return Di(this,void 0,void 0,function(){var e,t;return Pi(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,l.S8)()];case 1:return(e=n.sent())?(console.log("ðŸ“„ Debug Log (persistent):"),console.log("â”€".repeat(80)),console.log(e),console.log("â”€".repeat(80)),console.log("Total size: ".concat(e.length," characters")),[3,3]):(console.log("ðŸ“„ Debug log is EMPTY"),[2]);case 2:return t=n.sent(),console.error("âŒ Failed to read debug log:",t),[3,3];case 3:return[2]}})})}function Wi(){return Di(this,void 0,void 0,function(){var e;return Pi(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,l.L1)()];case 1:return t.sent(),console.log("âœ… Debug log cleared"),[3,3];case 2:return e=t.sent(),console.error("âŒ Failed to clear debug log:",e),[3,3];case 3:return[2]}})})}function Ui(e){return Di(this,void 0,void 0,function(){var t,n,r,o,i,a;return Pi(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,(0,l.wv)(Li)];case 1:return(t=c.sent())?(n=JSON.parse(String(t)),r="subj:".concat(e.trim().toLowerCase()),console.log('ðŸ” Searching for subject: "'.concat(e,'"')),console.log('ðŸ”‘ Looking for key: "'.concat(r,'"')),(o=n[r])?(console.log("âœ… Found entry:"),console.table({CaseId:o.caseId,DocumentId:o.documentId,Subject:o.subject,FiledAt:new Date(o.filedAt).toISOString()})):(console.log("âŒ No entry found for this subject"),(i=Object.keys(n).filter(function(e){return e.startsWith("subj:")})).length>0&&(console.log("\nðŸ“ Available subject keys:"),i.forEach(function(e){var t=e.substring(5);console.log('  - "'.concat(t,'"'))}))),[3,3]):(console.log("ðŸ“¦ Cache is empty"),[2]);case 2:return a=c.sent(),console.error("âŒ Failed to search cache:",a),[3,3];case 3:return[2]}})})}var Ki=document.getElementById("container"),$i=Ki?(0,i.H)(Ki):void 0;Office.onReady(function(){"undefined"!=typeof window&&(window.scDebug={showCache:Mi,showPlatform:Hi,showDebugLog:qi,clearDebugLog:Wi,searchBySubject:Ui,help:function(){console.log("ðŸ› ï¸  SingleCase Debug Commands:"),console.log("â”€".repeat(80)),console.log("scDebug.showCache()           - Show all cached filed emails"),console.log("scDebug.showPlatform()        - Show platform information"),console.log("scDebug.showDebugLog()        - Show persistent debug log"),console.log("scDebug.clearDebugLog()       - Clear debug log"),console.log("scDebug.searchBySubject('...')- Search cache by email subject"),console.log("scDebug.help()                - Show this help"),console.log("â”€".repeat(80))}},console.log("âœ… Debug commands installed! Type scDebug.help() for available commands")),null==$i||$i.render(r.createElement($o,{theme:Fi},r.createElement(mo,{title:"Contoso Task Pane Add-in"})))})},35137:function(e,t,n){function r(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}n.d(t,{A:function(){return r}})},39046:function(){},44363:function(e,t,n){n(22799)},44541:function(e,t,n){n.d(t,{n:function(){return lt}});var r=n(53864),o=n(35137);function i(e){return e.reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e[r]=n,e},{})}function a(e){return"number"==typeof e}function c(e,t){return-1!==e.indexOf(t)}function s(e,t,n,r){return t+(o=n,0===parseFloat(o)?o:"-"===o[0]?o.slice(1):"-"+o)+r;var o}function l(e){return e.replace(/ +/g," ").split(" ").map(function(e){return e.trim()}).filter(Boolean).reduce(function(e,t){var n=e.list,r=e.state,o=(t.match(/\(/g)||[]).length,i=(t.match(/\)/g)||[]).length;return r.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),r.parensDepth+=o-i,{list:n,state:r}},{list:[],state:{parensDepth:0}}).list}function u(e){var t=l(e);if(t.length<=3||t.length>4)return e;var n=t[0],r=t[1],o=t[2];return[n,t[3],o,r].join(" ")}var d={padding:function(e){var t=e.value;return a(t)?t:u(t)},textShadow:function(e){return function(e){for(var t=[],n=0,r=0,o=!1;r<e.length;)o||","!==e[r]?"("===e[r]?(o=!0,r++):")"===e[r]?(o=!1,r++):r++:(t.push(e.substring(n,r).trim()),n=++r);return n!=r&&t.push(e.substring(n,r+1)),t}(e.value).map(function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,function(e,t,n,r){return"0"===r?e:t+(""===n?"-":"")+r})}).join(",")},borderColor:function(e){return u(e.value)},borderRadius:function(e){var t=e.value;if(a(t))return t;if(c(t,"/")){var n=t.split("/"),r=n[0],o=n[1];return d.borderRadius({value:r.trim()})+" / "+d.borderRadius({value:o.trim()})}var i=l(t);switch(i.length){case 2:return i.reverse().join(" ");case 4:var s=i[0],u=i[1],f=i[2];return[u,s,i[3],f].join(" ");default:return t}},background:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgImgDirectionRegex,i=e.bgPosDirectionRegex;if(a(t))return t;var c=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(c,d.backgroundPosition({value:c,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:i})),d.backgroundImage({value:t,valuesToConvert:n,bgImgDirectionRegex:o})},backgroundImage:function(e){var t=e.value,n=e.valuesToConvert,r=e.bgImgDirectionRegex;return c(t,"url(")||c(t,"linear-gradient(")?t.replace(r,function(e,t,r){return e.replace(r,n[r])}):t},backgroundPosition:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return t.replace(r?/^((-|\d|\.)+%)/:null,function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var n=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(n)+"%"}return e}(t)}).replace(o,function(e){return n[e]})},backgroundPositionX:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return a(t)?t:d.backgroundPosition({value:t,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:o})},transition:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){var t=e.split(" ");return t[0]=n[t[0]]||t[0],t.join(" ")}).join(", ")},transitionProperty:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){return n[e]||e}).join(", ")},transform:function(e){var t=e.value,n="[^\\u0020-\\u007e]",r="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",o="((?:-?(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|-?(?:[_a-z]|"+n+"|"+r+")(?:[_a-z0-9-]|"+n+"|"+r+")*)?)|(?:inherit|auto))",i=new RegExp("(translateX\\s*\\(\\s*)"+o+"(\\s*\\))","gi"),a=new RegExp("(translate\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,1}\\s*\\))","gi"),c=new RegExp("(translate3d\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,2}\\s*\\))","gi"),l=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+o+"(\\s*\\))","gi");return t.replace(i,s).replace(a,s).replace(c,s).replace(l,s)}};d.objectPosition=d.backgroundPosition,d.margin=d.padding,d.borderWidth=d.padding,d.boxShadow=d.textShadow,d.webkitBoxShadow=d.boxShadow,d.mozBoxShadow=d.boxShadow,d.WebkitBoxShadow=d.boxShadow,d.MozBoxShadow=d.boxShadow,d.borderStyle=d.borderColor,d.webkitTransform=d.transform,d.mozTransform=d.transform,d.WebkitTransform=d.transform,d.MozTransform=d.transform,d.transformOrigin=d.backgroundPosition,d.webkitTransformOrigin=d.transformOrigin,d.mozTransformOrigin=d.transformOrigin,d.WebkitTransformOrigin=d.transformOrigin,d.MozTransformOrigin=d.transformOrigin,d.webkitTransition=d.transition,d.mozTransition=d.transition,d.WebkitTransition=d.transition,d.MozTransition=d.transition,d.webkitTransitionProperty=d.transitionProperty,d.mozTransitionProperty=d.transitionProperty,d.WebkitTransitionProperty=d.transitionProperty,d.MozTransitionProperty=d.transitionProperty,d["text-shadow"]=d.textShadow,d["border-color"]=d.borderColor,d["border-radius"]=d.borderRadius,d["background-image"]=d.backgroundImage,d["background-position"]=d.backgroundPosition,d["background-position-x"]=d.backgroundPositionX,d["object-position"]=d.objectPosition,d["border-width"]=d.padding,d["box-shadow"]=d.textShadow,d["-webkit-box-shadow"]=d.textShadow,d["-moz-box-shadow"]=d.textShadow,d["border-style"]=d.borderColor,d["-webkit-transform"]=d.transform,d["-moz-transform"]=d.transform,d["transform-origin"]=d.transformOrigin,d["-webkit-transform-origin"]=d.transformOrigin,d["-moz-transform-origin"]=d.transformOrigin,d["-webkit-transition"]=d.transition,d["-moz-transition"]=d.transition,d["transition-property"]=d.transitionProperty,d["-webkit-transition-property"]=d.transitionProperty,d["-moz-transition-property"]=d.transitionProperty;var f=i([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),m=["content"],v=i([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),g=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),p=new RegExp("(left)|(right)");function h(e){return Object.keys(e).reduce(function(t,n){var r=e[n];if("string"==typeof r&&(r=r.trim()),c(m,n))return t[n]=r,t;var o=b(n,r),i=o.key,a=o.value;return t[i]=a,t},Array.isArray(e)?[]:{})}function b(e,t){var n,r=/\/\*\s?@noflip\s?\*\//.test(t),o=r?e:f[n=e]||n,i=r?t:function(e,t){if(!function(e){return!("boolean"==typeof e||function(e){return null==e}(e))}(t))return t;if((n=t)&&"object"==typeof n)return h(t);var n,r,o=a(t),i=function(e){return"function"==typeof e}(t),c=o||i?t:t.replace(/ !important.*?$/,""),s=!o&&c.length!==t.length,l=d[e];return r=l?l({value:c,valuesToConvert:v,propertiesToConvert:f,isRtl:!0,bgImgDirectionRegex:g,bgPosDirectionRegex:p}):v[c]||c,s?r+" !important":r}(o,t);return{key:o,value:i}}var y=n(45614);const w=/[A-Z]/g,S=/^ms-/,k={};function x(e){return"-"+e.toLowerCase()}function I(e){if(Object.prototype.hasOwnProperty.call(k,e))return k[e];if("--"===e.substr(0,2))return e;const t=e.replace(w,x);return k[e]=S.test(t)?"-"+t:t}function C(e){return"&"===e.charAt(0)?e.slice(1):e}var N="-moz-",E="-webkit-",B="comm",O="rule",T="decl",_="@import",A="@namespace",j="@keyframes",z="@layer",F=Math.abs,R=String.fromCharCode,D=Object.assign;function P(e){return e.trim()}function L(e,t){return(e=t.exec(e))?e[0]:e}function M(e,t,n){return e.replace(t,n)}function H(e,t,n){return e.indexOf(t,n)}function q(e,t){return 0|e.charCodeAt(t)}function W(e,t,n){return e.slice(t,n)}function U(e){return e.length}function K(e){return e.length}function $(e,t){return t.push(e),e}function G(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function J(e,t,n,r){switch(e.type){case z:if(e.children.length)break;case _:case A:case T:return e.return=e.return||e.value;case B:return"";case j:return e.return=e.value+"{"+G(e.children,r)+"}";case O:if(!U(e.value=e.props.join(",")))return""}return U(n=G(e.children,r))?e.return=e.value+"{"+n+"}":""}var V=1,X=1,Y=0,Q=0,Z=0,ee="";function te(e,t,n,r,o,i,a,c){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:V,column:X,length:a,return:"",siblings:c}}function ne(e,t){return D(te("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function re(){return Z=Q>0?q(ee,--Q):0,X--,10===Z&&(X=1,V--),Z}function oe(){return Z=Q<Y?q(ee,Q++):0,X++,10===Z&&(X=1,V++),Z}function ie(){return q(ee,Q)}function ae(){return Q}function ce(e,t){return W(ee,e,t)}function se(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function le(e){return V=X=1,Y=U(ee=e),Q=0,[]}function ue(e){return ee="",e}function de(e){return P(ce(Q-1,ve(91===e?e+2:40===e?e+1:e)))}function fe(e){for(;(Z=ie())&&Z<33;)oe();return se(e)>2||se(Z)>3?"":" "}function me(e,t){for(;--t&&oe()&&!(Z<48||Z>102||Z>57&&Z<65||Z>70&&Z<97););return ce(e,ae()+(t<6&&32==ie()&&32==oe()))}function ve(e){for(;oe();)switch(Z){case e:return Q;case 34:case 39:34!==e&&39!==e&&ve(Z);break;case 40:41===e&&ve(e);break;case 92:oe()}return Q}function ge(e,t){for(;oe()&&e+Z!==57&&(e+Z!==84||47!==ie()););return"/*"+ce(t,Q-1)+"*"+R(47===e?e:oe())}function pe(e){for(;!se(ie());)oe();return ce(e,Q)}function he(e){return ue(be("",null,null,null,[""],e=le(e),0,[0],e))}function be(e,t,n,r,o,i,a,c,s){for(var l=0,u=0,d=a,f=0,m=0,v=0,g=1,p=1,h=1,b=0,y="",w=o,S=i,k=r,x=y;p;)switch(v=b,b=oe()){case 40:if(108!=v&&58==q(x,d-1)){-1!=H(x+=M(de(b),"&","&\f"),"&\f",F(l?c[l-1]:0))&&(h=-1);break}case 34:case 39:case 91:x+=de(b);break;case 9:case 10:case 13:case 32:x+=fe(v);break;case 92:x+=me(ae()-1,7);continue;case 47:switch(ie()){case 42:case 47:$(we(ge(oe(),ae()),t,n,s),s),5!=se(v||1)&&5!=se(ie()||1)||!U(x)||" "===W(x,-1,void 0)||(x+=" ");break;default:x+="/"}break;case 123*g:c[l++]=U(x)*h;case 125*g:case 59:case 0:switch(b){case 0:case 125:p=0;case 59+u:-1==h&&(x=M(x,/\f/g,"")),m>0&&(U(x)-d||0===g&&47===v)&&$(m>32?Se(x+";",r,n,d-1,s):Se(M(x," ","")+";",r,n,d-2,s),s);break;case 59:x+=";";default:if($(k=ye(x,t,n,l,u,o,c,y,w=[],S=[],d,i),i),123===b)if(0===u)be(x,t,k,k,w,i,d,c,S);else{switch(f){case 99:if(110===q(x,3))break;case 108:if(97===q(x,2))break;default:u=0;case 100:case 109:case 115:}u?be(e,k,k,r&&$(ye(e,k,k,0,0,o,c,y,o,w=[],d,S),S),o,S,d,c,r?w:S):be(x,k,k,k,[""],S,0,c,S)}}l=u=m=0,g=h=1,y=x="",d=a;break;case 58:d=1+U(x),m=v;default:if(g<1)if(123==b)--g;else if(125==b&&0==g++&&125==re())continue;switch(x+=R(b),b*g){case 38:h=u>0?1:(x+="\f",-1);break;case 44:c[l++]=(U(x)-1)*h,h=1;break;case 64:45===ie()&&(x+=de(oe())),f=ie(),u=d=U(y=x+=pe(ae())),b++;break;case 45:45===v&&2==U(x)&&(g=0)}}return i}function ye(e,t,n,r,o,i,a,c,s,l,u,d){for(var f=o-1,m=0===o?i:[""],v=K(m),g=0,p=0,h=0;g<r;++g)for(var b=0,y=W(e,f+1,f=F(p=a[g])),w=e;b<v;++b)(w=P(p>0?m[b]+" "+y:M(y,/&\f/g,m[b])))&&(s[h++]=w);return te(e,t,n,0===o?O:c,s,l,u,d)}function we(e,t,n,r){return te(e,t,n,B,R(Z),W(e,2,-2),0,r)}function Se(e,t,n,r,o){return te(e,t,n,T,W(e,0,r),W(e,r+1,-1),r,o)}function ke(e){var t=K(e);return function(n,r,o,i){for(var a="",c=0;c<t;c++)a+=e[c](n,r,o,i)||"";return a}}function xe(e){return function(t){t.root||(t=t.return)&&e(t)}}const Ie=e=>{if(e.type===O){if("string"==typeof e.props)return;e.props=e.props.map(e=>-1===e.indexOf(":global(")?e:function(e){return ue(function(e){for(;oe();)switch(se(Z)){case 0:$(pe(Q-1),e);break;case 2:$(de(Z),e);break;default:$(R(Z),e)}return e}(le(e)))}(e).reduce((e,t,n,r)=>{if(""===t)return e;if(":"===t&&"global"===r[n+1]){const t=r[n+2].slice(1,-1)+" ";return e.unshift(t),r[n+1]="",r[n+2]="",e}return e.push(t),e},[]).join(""))}};function Ce(e,t,n){switch(function(e,t){return 45^q(e,0)?(((t<<2^q(e,0))<<2^q(e,1))<<2^q(e,2))<<2^q(e,3):0}(e,t)){case 5103:return E+"print-"+e+e;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return E+e+e;case 4215:if(102===q(e,9))return E+e+e;if(116===q(e,t+1))return E+e+e;break;case 4789:return N+e+e;case 5349:case 4246:case 6968:return E+e+N+e+e;case 6187:if(!L(e,/grab/))return M(M(M(e,/(zoom-|grab)/,E+"$1"),/(image-set)/,E+"$1"),e,"")+e;case 5495:case 3959:return M(e,/(image-set\([^]*)/,E+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return M(e,/(.+)-inline(.+)/,E+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(U(e)-1-t>6)switch(q(e,t+1)){case 102:if(108===q(e,t+3))return M(e,/(.+:)(.+)-([^]+)/,"$1"+E+"$2-$3$1"+N+(108==q(e,t+3)?"$3":"$2-$3"))+e;case 115:return~H(e,"stretch")?Ce(M(e,"stretch","fill-available"),t)+e:e}}return e}function Ne(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case T:return void(e.return=Ce(e.value,e.length));case O:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(L(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return G([ne(e,{props:[M(t,/:(read-\w+)/,":"+N+"$1")]})],r);case"::placeholder":return G([ne(e,{props:[M(t,/:(plac\w+)/,":"+E+"input-$1")]}),ne(e,{props:[M(t,/:(plac\w+)/,":"+N+"$1")]})],r)}return""})}}const Ee=e=>{(function(e){switch(e.type){case"@container":case"@media":case"@supports":case z:return!0}return!1})(e)&&Array.isArray(e.children)&&e.children.sort((e,t)=>e.props[0]>t.props[0]?1:-1)};const Be=/,( *[^ &])/g;function Oe(e,t,n){let r=t;return n.length>0&&(r=n.reduceRight((e,t)=>{return`${n=t,"&"+C(n.replace(Be,",&$1"))} { ${e} }`;var n},t)),`${e}{${r}}`}function Te(e,t){const{className:n,selectors:r,property:o,rtlClassName:i,rtlProperty:a,rtlValue:c,value:s}=e,{container:l,layer:u,media:d,supports:f}=t;let m=Oe(`.${n}`,Array.isArray(s)?`${s.map(e=>`${I(o)}: ${e}`).join(";")};`:`${I(o)}: ${s};`,r);return a&&i&&(m+=Oe(`.${i}`,Array.isArray(c)?`${c.map(e=>`${I(a)}: ${e}`).join(";")};`:`${I(a)}: ${c};`,r)),d&&(m=`@media ${d} { ${m} }`),u&&(m=`@layer ${u} { ${m} }`),f&&(m=`@supports ${f} { ${m} }`),l&&(m=`@container ${l} { ${m} }`),function(e){const t=[];return G(he(e),ke([Ie,Ee,Ne,J,xe(e=>t.push(e))])),t}(m)}function _e(e){let t="";for(const n in e){const r=e[n];if("string"!=typeof r&&"number"!=typeof r){if(Array.isArray(r))for(const e of r)t+=I(n)+":"+e+";"}else t+=I(n)+":"+r+";"}return t}function Ae(e){let t="";for(const n in e)t+=`${n}{${_e(e[n])}}`;return t}function je(e,t){const n=[];return G(he(`@keyframes ${e} {${t}}`),ke([J,Ne,xe(e=>n.push(e))])),n}const ze={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]};function Fe(e,t){return 0===e.length?t:`${e} and ${t}`}function Re(e){return"@media"===e.substr(0,6)}function De(e){return"@layer"===e.substr(0,6)}const Pe=/^(:|\[|>|&)/;function Le(e){return Pe.test(e)}function Me(e){return"@supports"===e.substr(0,9)}function He(e){return"@container"===e.substring(0,10)}function qe(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}const We={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function Ue(e,t){if(t.media)return"m";if(t.layer||t.supports)return"t";if(t.container)return"c";if(e.length>0){const t=e[0].trim();if(58===t.charCodeAt(0))return We[t.slice(4,8)]||We[t.slice(3,5)]||"d"}return"d"}function Ke(e,t){return e?t+e:e}function $e(e){return Ke(e.container,"c")+Ke(e.media,"m")+Ke(e.layer,"l")+Ke(e.supports,"s")}function Ge(e,t,n){const r=e+$e(n)+t,i=(0,o.A)(r),a=i.charCodeAt(0);return a>=48&&a<=57?String.fromCharCode(a+17)+i.slice(1):i}function Je({property:e,selector:t,salt:n,value:r},i){return y.aN+(0,o.A)(n+t+$e(i)+e+r.trim())}function Ve(e){return e===y.Ut}function Xe(e){return e.replace(/>\s+/g,">")}function Ye(e,t){}function Qe(e,t){}function Ze(e){return ze[e]}function et(e){var t;return null!==(t=null==e?void 0:e[0])&&void 0!==t?t:0}function tt(e,t,n,r){e[t]=r?[n,r]:n}function nt(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function rt(e,t,n,r,o,i){var a;const c=[];0!==i&&c.push(["p",i]),"m"===t&&o&&c.push(["m",o]),null!==(a=e[t])&&void 0!==a||(e[t]=[]),n&&e[t].push(nt(n,c)),r&&e[t].push(nt(r,c))}function ot(e,t="",n=[],r={container:"",layer:"",media:"",supports:""},i={},a={},c){for(const s in e){if(y.qw.hasOwnProperty(s)){Qe(0,e[s]);continue}const l=e[s];if(null!=l){if(Ve(l)){tt(i,Ge(Xe(n.join("")),s,r),0,void 0);continue}if("string"==typeof l||"number"==typeof l){const e=Xe(n.join("")),o=Ze(s);if(o){const e=o[1],c=Object.fromEntries(e.map(e=>[e,y.Ut]));ot(c,t,n,r,i,a)}const u=Ge(e,s,r),d=Je({value:l.toString(),salt:t,selector:e,property:s},r),f=c&&{key:s,value:c}||b(s,l),m=f.key!==s||f.value!==l,v=m?Je({value:f.value.toString(),property:f.key,salt:t,selector:e},r):void 0,g=m?{rtlClassName:v,rtlProperty:f.key,rtlValue:f.value}:void 0,p=Ue(n,r),[h,w]=Te(Object.assign({className:d,selectors:n,property:s,value:l},g),r);tt(i,u,d,v),rt(a,p,h,w,r.media,et(o))}else if("animationName"===s){const e=Array.isArray(l)?l:[l],c=[],s=[];for(const t of e){const e=Ae(t),n=Ae(h(t)),i=y.aN+(0,o.A)(e);let l;const u=je(i,e);let d=[];e===n?l=i:(l=y.aN+(0,o.A)(n),d=je(l,n));for(let e=0;e<u.length;e++)rt(a,"k",u[e],d[e],r.media,0);c.push(i),s.push(l)}ot({animationName:c.join(", ")},t,n,r,i,a,s.join(", "))}else if(Array.isArray(l)){if(0===l.length)continue;const e=Xe(n.join("")),o=Ze(s);if(o){const e=o[1],c=Object.fromEntries(e.map(e=>[e,y.Ut]));ot(c,t,n,r,i,a)}const c=Ge(e,s,r),u=Je({value:l.map(e=>(null!=e?e:"").toString()).join(";"),salt:t,selector:e,property:s},r),d=l.map(e=>b(s,e));if(d.some(e=>e.key!==d[0].key))continue;const f=d[0].key!==s||d.some((e,t)=>e.value!==l[t]),m=f?Je({value:d.map(e=>{var t;return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").toString()}).join(";"),salt:t,property:d[0].key,selector:e},r):void 0,v=f?{rtlClassName:m,rtlProperty:d[0].key,rtlValue:d.map(e=>e.value)}:void 0,g=Ue(n,r),[p,h]=Te(Object.assign({className:u,selectors:n,property:s,value:l},v),r);tt(i,c,u,m),rt(a,g,p,h,r.media,et(o))}else if(qe(l))if(Le(s))ot(l,t,n.concat(C(s)),r,i,a);else if(Re(s)){const e=Fe(r.media,s.slice(6).trim());ot(l,t,n,Object.assign({},r,{media:e}),i,a)}else if(De(s)){const e=(r.layer?`${r.layer}.`:"")+s.slice(6).trim();ot(l,t,n,Object.assign({},r,{layer:e}),i,a)}else if(Me(s)){const e=Fe(r.supports,s.slice(9).trim());ot(l,t,n,Object.assign({},r,{supports:e}),i,a)}else if(He(s)){const e=s.slice(10).trim();ot(l,t,n,Object.assign({},r,{container:e}),i,a)}else Ye()}}return[i,a]}var it=n(87294);var at=n(49264),ct=n(26312),st=n(56004);function lt(e){const t=function(e,t=r.A){const n=t();let o=null,i=null,a=null,c=null;return function(t){const{dir:r,renderer:s}=t;null===o&&([o,i]=function(e,t=""){const n={},r={};for(const o in e){const i=e[o],[a,c]=ot(i,t);n[o]=a,Object.keys(c).forEach(e=>{r[e]=(r[e]||[]).concat(c[e])})}return[n,r]}(e,s.classNameHashSalt));const l="ltr"===r;return l?null===a&&(a=(0,it.N)(o,r)):null===c&&(c=(0,it.N)(o,r)),n(s,i),l?a:c}}(e,at.A);return function(){const e=(0,st.m)(),n=(0,ct.J)();return t({dir:e,renderer:n})}}},45614:function(e,t,n){n.d(t,{AX:function(){return v},EJ:function(){return s},FS:function(){return m},Ut:function(){return p},aN:function(){return l},ed:function(){return c},ez:function(){return u},fj:function(){return d},k1:function(){return a},qw:function(){return g},wn:function(){return f}});const r="undefined"==typeof window?n.g:window,o="@griffel/";function i(e,t){return r[Symbol.for(o+e)]||(r[Symbol.for(o+e)]=t),r[Symbol.for(o+e)]}const a=i("DEFINITION_LOOKUP_TABLE",{}),c="data-make-styles-bucket",s="data-priority",l="f",u=7,d="___",f=d.length+u,m=0,v=1,g={all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1},p="DO_NOT_USE_DIRECTLY: @griffel/reset-value"},49264:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(96540),o=n.t(r,2);const i=o.useInsertionEffect?o.useInsertionEffect:void 0,a=()=>{const e={};return function(t,n){i&&"undefined"!=typeof window&&window.document&&window.document.createElement?i(()=>{t.insertCSSRules(n)},[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}}},50134:function(e,t,n){n.d(t,{Kg:function(){return g},L1:function(){return u},Ox:function(){return p},S8:function(){return l},wv:function(){return v}});var r=n(64583).Promise;function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var i=function(e,t,n,o){return new(n||(n=r))(function(r,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},a=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},c=!1,s="sc:debugLog";function l(){return i(this,void 0,void 0,function(){return a(this,function(e){try{return f()?[2,String(Office.context.roamingSettings.get(s)||"")]:"undefined"!=typeof localStorage?[2,localStorage.getItem(s)||""]:[2,""]}catch(e){return[2,""]}})})}function u(){return i(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),f()?(Office.context.roamingSettings.remove(s),[4,m()]):[3,2];case 1:return e.sent(),[3,3];case 2:"undefined"!=typeof localStorage&&localStorage.removeItem(s),e.label=3;case 3:return[3,5];case 4:return e.sent(),[3,5];case 5:return[2]}})})}function d(){try{return"undefined"!=typeof OfficeRuntime&&!!(null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.storage)}catch(e){return!1}}function f(){var e;try{return!!(null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.roamingSettings)}catch(e){return!1}}function m(){return i(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return e=Date.now(),c&&console.log("[saveRoamingSettings] Starting saveAsync..."),[4,new r(function(t,n){try{Office.context.roamingSettings.saveAsync(function(r){var o,i,a,s=Date.now()-e;if((null==r?void 0:r.status)===Office.AsyncResultStatus.Succeeded)c&&console.log("[saveRoamingSettings] âœ… Succeeded in ".concat(s,"ms")),t();else{var l=(null===(o=null==r?void 0:r.error)||void 0===o?void 0:o.message)||"roamingSettings.saveAsync failed";console.error("[saveRoamingSettings] âŒ Failed in ".concat(s,"ms:"),l,{status:null==r?void 0:r.status,errorCode:null===(i=null==r?void 0:r.error)||void 0===i?void 0:i.code,errorName:null===(a=null==r?void 0:r.error)||void 0===a?void 0:a.name}),n(new Error(l))}})}catch(t){var r=Date.now()-e;console.error("[saveRoamingSettings] âŒ Exception in ".concat(r,"ms:"),t),n(t)}})];case 1:return t.sent(),[4,new r(function(e){return setTimeout(e,100)})];case 2:return t.sent(),[2]}})})}function v(e){return i(this,arguments,void 0,function(e,t){var n,o,i,s,l,u,m,v,g;return void 0===t&&(t=!1),a(this,function(a){switch(a.label){case 0:if(!(n=String(e||"").trim()))return[2,null];o=d()?"OfficeRuntime.storage":f()?"roamingSettings":"localStorage",(i=c&&!n.includes("recipientHistory")&&!n.includes("recentCases"))&&console.log("[getStored] Using storage backend:",o,"for key:",n,t?"(force fresh)":""),s=function(){try{return"undefined"!=typeof localStorage?localStorage.getItem(n):null}catch(e){return null}},a.label=1;case 1:return a.trys.push([1,7,,8]),d()?[4,OfficeRuntime.storage.getItem(n)]:[3,3];case 2:return l=a.sent(),i&&console.log("[getStored] Got from OfficeRuntime.storage:",n,l?"found (".concat(l.length," chars)"):"not found"),"string"==typeof l?[2,l]:f()&&"string"==typeof(u=Office.context.roamingSettings.get(n))?[2,u]:[2,s()];case 3:return f()?t&&c?(console.log("[getStored] Waiting 500ms for roamingSettings sync..."),[4,new r(function(e){return setTimeout(e,500)})]):[3,5]:[3,6];case 4:a.sent(),a.label=5;case 5:return m=Office.context.roamingSettings.get(n),i&&console.log("[getStored] Got from roamingSettings:",n,m?"found (".concat(String(m).length," chars)"):"not found"),"string"==typeof m?[2,m]:[2,s()];case 6:return v=localStorage.getItem(n),i&&console.warn("[getStored] No Office storage, using localStorage:",n,v?"found (".concat(v.length," chars)"):"not found"),[2,v];case 7:return g=a.sent(),console.warn("[getStored] Failed, falling back to localStorage:",g),[2,s()];case 8:return[2]}})})}function g(e,t){return i(this,arguments,void 0,function(e,t,n){var i,l,u,v,p,h,b,y,w,S,k;return void 0===n&&(n=0),a(this,function(a){switch(a.label){case 0:if(!(i=String(e||"").trim()))return[2];l=String(null!=t?t:""),u=2,v=d()?"OfficeRuntime.storage":f()?"roamingSettings":"localStorage",c&&console.log("[setStored] Using storage backend:",v,"for key:",i,"(".concat(l.length," chars)"),n>0?"[retry ".concat(n,"]"):""),p=function(){try{"undefined"!=typeof localStorage&&localStorage.setItem(i,l)}catch(e){}},a.label=1;case 1:return a.trys.push([1,14,,15]),d()?(c&&console.log("[setStored] Writing to OfficeRuntime.storage..."),[4,OfficeRuntime.storage.setItem(i,l)]):[3,3];case 2:return a.sent(),p(),c&&console.log("[setStored] âœ… Write to OfficeRuntime.storage completed"),[2];case 3:if(!f())return[3,13];c&&console.log("[setStored] Writing to roamingSettings..."),Office.context.roamingSettings.set(i,l),c&&console.log("[setStored] Calling saveAsync..."),a.label=4;case 4:return a.trys.push([4,6,,13]),[4,m()];case 5:return a.sent(),p(),c&&console.log("[setStored] âœ… saveAsync completed"),[2];case 6:if(h=a.sent(),console.error("[setStored] saveAsync failed:",h),!(null===(S=null==h?void 0:h.message)||void 0===S?void 0:S.includes("32 KB"))&&!(null===(k=null==h?void 0:h.message)||void 0===k?void 0:k.includes("size limit"))||0!==n)return[3,10];console.warn("[setStored] roamingSettings overflow â€” emergency pruning and retrying"),function(){var e,t,n;try{Office.context.roamingSettings.remove(s)}catch(e){}try{var r=Office.context.roamingSettings,i=null!==(n=null!==(e=r._data)&&void 0!==e?e:null===(t=r._settings)||void 0===t?void 0:t.data)&&void 0!==n?n:null;if(i&&"object"===o(i)){for(var a=Object.keys(i),c=0,l=0,u=a;l<u.length;l++){var d=u[l];if(d.startsWith("sc:sent:")||d.startsWith("sc_conv_ctx:")||d===s)try{Office.context.roamingSettings.remove(d),c++}catch(e){}}c>0&&console.warn("[emergencyPrune] Removed",c,"legacy individual storage entries")}}catch(e){}try{if(v=Office.context.roamingSettings.get("sc:sentPills")){var f=JSON.parse(String(v));if((g=Object.entries(f)).length>3){g.sort(function(e,t){return(t[1]._savedAt||0)-(e[1]._savedAt||0)});var m={};g.slice(0,3).forEach(function(e){var t=e[0],n=e[1];m[t]=n}),Office.context.roamingSettings.set("sc:sentPills",JSON.stringify(m)),console.warn("[emergencyPrune] Pruned sentPills from",g.length,"to 3 entries")}}}catch(e){}try{var v;if(v=Office.context.roamingSettings.get("sc:filedEmailsCache")){var g,p=JSON.parse(String(v));if((g=Object.entries(p)).length>3){g.sort(function(e,t){return(t[1].filedAt||0)-(e[1].filedAt||0)});var h={};g.slice(0,3).forEach(function(e){var t=e[0],n=e[1];h[t]=n}),Office.context.roamingSettings.set("sc:filedEmailsCache",JSON.stringify(h)),console.warn("[emergencyPrune] Pruned filedCache from",g.length,"to 3 entries")}}}catch(e){}}(),a.label=7;case 7:return a.trys.push([7,9,,10]),[4,m()];case 8:return a.sent(),console.log("[setStored] âœ… saveAsync succeeded after emergency prune"),[2];case 9:return b=a.sent(),console.warn("[setStored] saveAsync still failed after emergency prune:",b),[3,10];case 10:return n<u?(y=200*(n+1),c&&console.log("[setStored] Retrying in ".concat(y,"ms...")),[4,new r(function(e){return setTimeout(e,y)})]):[3,12];case 11:return a.sent(),[2,g(e,t,n+1)];case 12:throw h;case 13:return c&&console.warn("[setStored] No Office storage, using localStorage for key:",i),localStorage.setItem(i,l),[3,15];case 14:return w=a.sent(),console.warn("[setStored] âŒ Failed after retries, falling back to localStorage:",w),localStorage.setItem(i,l),[3,15];case 15:return[2]}})})}function p(e){return i(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:if(!(t=String(e||"").trim()))return[2];n.label=1;case 1:return n.trys.push([1,6,,7]),d()?[4,OfficeRuntime.storage.removeItem(t)]:[3,3];case 2:return n.sent(),[2];case 3:return f()?(Office.context.roamingSettings.remove(t),[4,m()]):[3,5];case 4:return n.sent(),[2];case 5:return localStorage.removeItem(t),[3,7];case 6:return n.sent(),localStorage.removeItem(t),[3,7];case 7:return[2]}})})}},53864:function(e,t,n){n.d(t,{A:function(){return r}});const r=()=>{const e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}}},56004:function(e,t,n){n.d(t,{e:function(){return i},m:function(){return a}});var r=n(96540);const o=r.createContext("ltr"),i=({children:e,dir:t})=>r.createElement(o.Provider,{value:t},e);function a(){return r.useContext(o)}},74848:function(e,t,n){e.exports=n(21020)},87294:function(e,t,n){n.d(t,{N:function(){return a},z:function(){return i}});var r=n(45614),o=n(29255);function i(e,t){let n="",r="";for(const o in e){const i=e[o];if(0===i){r+=o+" ";continue}const a=Array.isArray(i),c="rtl"===t?(a?i[1]:i)+" ":(a?i[0]:i)+" ";n+=c,r+=c}return[n.slice(0,-1),r.slice(0,-1)]}function a(e,t){const n={};for(const a in e){const[c,s]=i(e[a],t);if(""===s){n[a]="";continue}const l=(0,o.G)(s,t),u=l+(""===c?"":" "+c);r.k1[l]=[e[a],t],n[a]=u}return n}},92245:function(e,t,n){n.r(t),n.d(t,{applyCategoryToMessageById:function(){return I},applyFiledCategoryToCurrentEmail:function(){return w},applyFiledCategoryToCurrentEmailOfficeJs:function(){return d},applyUnfiledCategoryToCurrentEmailGraph:function(){return y},applyUnfiledCategoryToCurrentEmailOfficeJs:function(){return f},findInternetMessageIdInSentItems:function(){return C},getCurrentEmailCategoriesGraph:function(){return b},getFiledCategoryName:function(){return S},getInternetMessageIdViaGraph:function(){return x},getUnfiledCategoryName:function(){return k}});var r=n(64583).Promise,o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},o.apply(this,arguments)},i=function(e,t,n,o){return new(n||(n=r))(function(r,i){function a(e){try{s(o.next(e))}catch(e){i(e)}}function c(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,c)}s((o=o.apply(e,t||[])).next())})},a=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=c(0),a.throw=c(1),a.return=c(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},c="https://graph.microsoft.com/v1.0",s="SC: Filed",l="SC: Unfiled",u="preset4";function d(){return i(this,void 0,void 0,function(){var e,t,n;return a(this,function(o){switch(o.label){case 0:if(!(e=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item))throw new Error("No current Outlook item.");return[4,new r(function(e){var t,n;try{var r=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.masterCategories;if(!(null==r?void 0:r.addAsync))return e();r.addAsync([{displayName:s,color:Office.MailboxEnums.CategoryColor.Preset4}],function(){return e()})}catch(t){e()}})];case 1:return o.sent(),[4,new r(function(t){try{var n=null==e?void 0:e.categories;if(!(null==n?void 0:n.removeAsync))return t();n.removeAsync([l],function(){return t()})}catch(e){t()}})];case 2:return o.sent(),[4,new r(function(t,n){try{var r=null==e?void 0:e.categories;if(!(null==r?void 0:r.addAsync))return n(new Error("Categories API unavailable."));r.addAsync([s],function(e){var r;if((null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded)return t();n(new Error((null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.message)||"categories.addAsync failed"))})}catch(e){n(e)}})];case 3:return o.sent(),[2]}})})}function f(){return i(this,void 0,void 0,function(){var e,t,n;return a(this,function(o){switch(o.label){case 0:if(!(e=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.item))throw new Error("No current Outlook item.");return[4,new r(function(e){var t,n;try{var r=null===(n=null===(t=null===Office||void 0===Office?void 0:Office.context)||void 0===t?void 0:t.mailbox)||void 0===n?void 0:n.masterCategories;if(!(null==r?void 0:r.addAsync))return e();r.addAsync([{displayName:l,color:Office.MailboxEnums.CategoryColor.Preset7}],function(){return e()})}catch(t){e()}})];case 1:return o.sent(),[4,new r(function(t){try{var n=null==e?void 0:e.categories;if(!(null==n?void 0:n.removeAsync))return t();n.removeAsync([s],function(){return t()})}catch(e){t()}})];case 2:return o.sent(),[4,new r(function(t,n){try{var r=null==e?void 0:e.categories;if(!(null==r?void 0:r.addAsync))return n(new Error("Categories API unavailable."));r.addAsync([l],function(e){var r;if((null==e?void 0:e.status)===Office.AsyncResultStatus.Succeeded)return t();n(new Error((null===(r=null==e?void 0:e.error)||void 0===r?void 0:r.message)||"categories.addAsync failed"))})}catch(e){n(e)}})];case 3:return o.sent(),[2]}})})}function m(){var e,t,n=null===(t=null===(e=null===Office||void 0===Office?void 0:Office.context)||void 0===e?void 0:e.mailbox)||void 0===t?void 0:t.item,r=String((null==n?void 0:n.itemId)||"");if(!r)return"";try{return Office.context.mailbox.convertToRestId(r,Office.MailboxEnums.RestVersion.v2_0)}catch(e){return""}}function v(e,t,n){return i(this,void 0,void 0,function(){return a(this,function(r){return[2,fetch("".concat(c).concat(t),o(o({},n),{headers:o({Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},(null==n?void 0:n.headers)||{})}))]})})}function g(e){return i(this,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return[4,e.text().catch(function(){return""})];case 1:if(!(t=n.sent()))return[2,null];try{return[2,JSON.parse(t)]}catch(e){return[2,null]}}})})}function p(e,t,n){return i(this,void 0,void 0,function(){var r,o,i,c,s;return a(this,function(a){switch(a.label){case 0:return[4,v(e,"/me/outlook/masterCategories?$filter=displayName eq '".concat(t.replace(/'/g,"''"),"'"))];case 1:return(r=a.sent()).ok?[4,g(r)]:[3,3];case 2:if(o=a.sent(),Array.isArray(null==o?void 0:o.value)&&o.value.length>0)return[2];a.label=3;case 3:return[4,v(e,"/me/outlook/masterCategories",{method:"POST",body:JSON.stringify({displayName:t,color:n})})];case 4:return(i=a.sent()).ok||409===i.status?[2]:[4,g(i)];case 5:throw c=a.sent(),new Error((null===(s=null==c?void 0:c.error)||void 0===s?void 0:s.message)||"Failed to create category (".concat(i.status,")"))}})})}function h(){return i(this,void 0,void 0,function(){var e,t,n;return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),"undefined"!=typeof OfficeRuntime&&(null===(n=null===OfficeRuntime||void 0===OfficeRuntime?void 0:OfficeRuntime.auth)||void 0===n?void 0:n.getAccessToken)?[4,OfficeRuntime.auth.getAccessToken({allowSignInPrompt:!0,forMSGraphAccess:!0})]:[3,2];case 1:return e=r.sent(),[2,String(e||"")];case 2:return[3,4];case 3:return t=r.sent(),console.warn("[graphMail] OfficeRuntime.auth.getAccessToken failed:",t),[3,4];case 4:return[2,""]}})})}function b(){return i(this,void 0,void 0,function(){var e,t,n,r,o,i;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),(e=m())?[4,h()]:[2,[]];case 1:return(t=a.sent())?[4,v(t,"/me/messages/".concat(encodeURIComponent(e),"?$select=categories"))]:[2,[]];case 2:return(n=a.sent()).ok?[3,4]:[4,g(n)];case 3:return r=a.sent(),console.warn("[graphMail] getCurrentEmailCategoriesGraph not ok",n.status,r),[2,[]];case 4:return[4,g(n)];case 5:return o=a.sent(),[2,(Array.isArray(null==o?void 0:o.categories)?o.categories:[]).map(function(e){return String(e||"")}).filter(Boolean)];case 6:return i=a.sent(),console.warn("[graphMail] getCurrentEmailCategoriesGraph failed:",i),[2,[]];case 7:return[2]}})})}function y(){return i(this,void 0,void 0,function(){var e,t,n,r,o;return a(this,function(i){switch(i.label){case 0:if(!(e=m()))throw new Error("Cannot resolve REST id.");return[4,h()];case 1:if(!(t=i.sent()))throw new Error("Cannot get Graph access token.");return[4,p(t,l,"preset7")];case 2:return i.sent(),[4,v(t,"/me/messages/".concat(encodeURIComponent(e)),{method:"PATCH",body:JSON.stringify({categories:[l]})})];case 3:return(n=i.sent()).ok?[3,5]:[4,g(n)];case 4:throw r=i.sent(),new Error((null===(o=null==r?void 0:r.error)||void 0===o?void 0:o.message)||"Failed to apply Unfiled category (".concat(n.status,")"));case 5:return[2]}})})}function w(e){return i(this,void 0,void 0,function(){var t,n,r,o;return a(this,function(i){switch(i.label){case 0:if(!(t=m()))throw new Error("Cannot resolve REST id.");return[4,p(e,s,u)];case 1:return i.sent(),[4,v(e,"/me/messages/".concat(encodeURIComponent(t)),{method:"PATCH",body:JSON.stringify({categories:[s]})})];case 2:return(n=i.sent()).ok?[3,4]:[4,g(n)];case 3:throw r=i.sent(),new Error((null===(o=null==r?void 0:r.error)||void 0===o?void 0:o.message)||"Failed to apply category (".concat(n.status,")"));case 4:return[2]}})})}function S(){return s}function k(){return l}function x(e){return i(this,void 0,void 0,function(){var t,n,r,o,i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),console.log("[getInternetMessageIdViaGraph] Fetching for message:",e.substring(0,50)+"..."),[4,h()];case 1:return t=a.sent(),n="/me/messages/".concat(encodeURIComponent(e),"?$select=internetMessageId"),[4,v(t,n,{method:"GET"})];case 2:return(r=a.sent()).ok?[4,r.json()]:(console.warn("[getInternetMessageIdViaGraph] Failed:",r.status),[2,null]);case 3:return o=a.sent(),(i=null==o?void 0:o.internetMessageId)?(console.log("[getInternetMessageIdViaGraph] Found:",i),[2,String(i)]):(console.log("[getInternetMessageIdViaGraph] No internetMessageId in response"),[2,null]);case 4:return c=a.sent(),console.error("[getInternetMessageIdViaGraph] Error:",c),[2,null];case 5:return[2]}})})}function I(e){return i(this,void 0,void 0,function(){var t,n,r,o,i,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),console.log("[applyCategoryToMessageById] Applying category to:",e.substring(0,50)+"..."),[4,h()];case 1:return[4,p(t=a.sent(),s,u)];case 2:return a.sent(),[4,v(t,"/me/messages/".concat(encodeURIComponent(e)),{method:"PATCH",body:JSON.stringify({categories:[s]})})];case 3:return(n=a.sent()).ok?[3,5]:[4,g(n)];case 4:throw r=a.sent(),console.warn("[applyCategoryToMessageById] Failed:",(null===(i=null==r?void 0:r.error)||void 0===i?void 0:i.message)||n.status),new Error((null===(c=null==r?void 0:r.error)||void 0===c?void 0:c.message)||"Failed to apply category (".concat(n.status,")"));case 5:return console.log("[applyCategoryToMessageById] Category applied successfully"),[3,7];case 6:throw o=a.sent(),console.error("[applyCategoryToMessageById] Error:",o),o;case 7:return[2]}})})}function C(e,t,n){return i(this,void 0,void 0,function(){var r,o,i,c,s,l,u,d,f;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),console.log("[findInternetMessageIdInSentItems] Searching",{conversationId:e.substring(0,30)+"...",subject:t,sentAfter:n}),[4,h()];case 1:return r=a.sent(),o=t.replace(/'/g,"''"),i="subject eq '".concat(o,"' and sentDateTime ge ").concat(n),c="/me/mailFolders/SentItems/messages?$filter=".concat(encodeURIComponent(i),"&$select=internetMessageId,subject,sentDateTime&$top=5"),[4,v(r,c,{method:"GET"})];case 2:return(s=a.sent()).ok?[4,s.json()]:(console.warn("[findInternetMessageIdInSentItems] Failed:",s.status),[2,null]);case 3:return l=a.sent(),u=(null==l?void 0:l.value)||[],console.log("[findInternetMessageIdInSentItems] Found",u.length,"messages in window"),u.length>0&&u[0].internetMessageId?(d=String(u[0].internetMessageId),console.log("[findInternetMessageIdInSentItems] Match:",d),[2,d]):(console.log("[findInternetMessageIdInSentItems] No match found"),[2,null]);case 4:return f=a.sent(),console.error("[findInternetMessageIdInSentItems] Error:",f),[2,null];case 5:return[2]}})})}}},function(e){var t=function(t){return e(e.s=t)};t(34680),t(39046)}]);
//# sourceMappingURL=taskpane.js.map