{"version":3,"file":"src_utils_filedCache_ts.js","mappings":"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","sources":["webpack://office-addin-taskpane-react/./src/utils/filedCache.ts"],"sourcesContent":["import { getStored, setStored } from \"./storage\";\n\nconst FILED_CACHE_KEY = \"sc:filedEmailsCache\";\n\nexport type FiledEmailCache = {\n  [conversationId: string]: {\n    caseId: string;\n    documentId: string;\n    subject: string;\n    caseName?: string;\n    caseKey?: string;\n    filedAt: number; // timestamp\n  };\n};\n\n/**\n * Store filed email info by conversationId\n * This enables \"already filed\" detection for self-sent emails and replies\n *\n * Works for:\n * - Self-sent emails (sender opens received copy)\n * - Sent items (user reopens their own sent email)\n * - Replies in same thread (same conversationId)\n */\nexport async function cacheFiledEmail(\n  conversationId: string,\n  caseId: string,\n  documentId: string,\n  subject: string,\n  caseName?: string,\n  caseKey?: string\n): Promise<void> {\n  if (!conversationId) {\n    console.warn(\"[cacheFiledEmail] No conversationId provided, skipping cache\");\n    return;\n  }\n\n  try {\n    // Platform detection\n    const platform = {\n      host: (Office as any)?.context?.mailbox?.diagnostics?.hostName,\n      hostVersion: (Office as any)?.context?.mailbox?.diagnostics?.hostVersion,\n      platform: (Office as any)?.context?.platform,\n    };\n    console.log(\"[cacheFiledEmail] Platform info:\", platform);\n\n    const raw = await getStored(FILED_CACHE_KEY);\n    const cache: FiledEmailCache = raw ? JSON.parse(String(raw)) : {};\n    console.log(\"[cacheFiledEmail] Current cache size:\", Object.keys(cache).length);\n\n    cache[conversationId] = {\n      caseId,\n      documentId,\n      subject,\n      caseName,\n      caseKey,\n      filedAt: Date.now(),\n    };\n\n    // Clean old entries (keep last 100 filed emails)\n    const entries = Object.entries(cache);\n    if (entries.length > 100) {\n      entries.sort((a, b) => b[1].filedAt - a[1].filedAt);\n      const keep = entries.slice(0, 100);\n      const newCache: FiledEmailCache = {};\n      keep.forEach(([key, val]) => {\n        newCache[key] = val;\n      });\n      await setStored(FILED_CACHE_KEY, JSON.stringify(newCache));\n      console.log(\"[cacheFiledEmail] Cleaned cache, kept 100 most recent entries\");\n    } else {\n      await setStored(FILED_CACHE_KEY, JSON.stringify(cache));\n    }\n\n    // Verify write succeeded\n    const verification = await getStored(FILED_CACHE_KEY);\n    const verifiedCache = verification ? JSON.parse(String(verification)) : {};\n    const writeSuccess = !!verifiedCache[conversationId];\n    console.log(\"[cacheFiledEmail] Write verification:\", {\n      success: writeSuccess,\n      cacheSize: Object.keys(verifiedCache).length,\n    });\n\n    console.log(\"[cacheFiledEmail] Cached filed email\", {\n      conversationId: conversationId.substring(0, 20) + \"...\",\n      caseId,\n      documentId,\n      subject,\n      writeVerified: writeSuccess,\n    });\n  } catch (e) {\n    console.warn(\"[cacheFiledEmail] Failed to cache:\", e);\n    // Non-critical, don't throw\n  }\n}\n\n/**\n * Check if email with this conversationId was filed\n * Returns cached info if found, null otherwise\n */\nexport async function getFiledEmailFromCache(\n  conversationId: string\n): Promise<FiledEmailCache[string] | null> {\n  if (!conversationId) {\n    return null;\n  }\n\n  try {\n    // Platform detection\n    const platform = {\n      host: (Office as any)?.context?.mailbox?.diagnostics?.hostName,\n      hostVersion: (Office as any)?.context?.mailbox?.diagnostics?.hostVersion,\n      platform: (Office as any)?.context?.platform,\n    };\n    console.log(\"[getFiledEmailFromCache] Platform info:\", platform);\n\n    // Force fresh read to avoid stale roamingSettings after recent write\n    const raw = await getStored(FILED_CACHE_KEY, true);\n    if (!raw) {\n      console.log(\"[getFiledEmailFromCache] No cache found in storage\");\n      return null;\n    }\n\n    const cache: FiledEmailCache = JSON.parse(String(raw));\n    const cacheKeys = Object.keys(cache);\n    console.log(\"[getFiledEmailFromCache] Cache size:\", cacheKeys.length, \"keys\");\n    console.log(\"[getFiledEmailFromCache] Looking for conversationId:\", conversationId.substring(0, 30) + \"...\");\n    console.log(\"[getFiledEmailFromCache] Sample cache keys:\", cacheKeys.slice(0, 3).map(k => k.substring(0, 30) + \"...\"));\n\n    const entry = cache[conversationId];\n\n    if (entry) {\n      console.log(\"[getFiledEmailFromCache] ✅ Found cache entry\", {\n        conversationId: conversationId.substring(0, 20) + \"...\",\n        caseId: entry.caseId,\n        documentId: entry.documentId,\n        filedAt: new Date(entry.filedAt).toISOString(),\n        subject: entry.subject,\n      });\n      return entry;\n    }\n\n    console.log(\"[getFiledEmailFromCache] ❌ No entry for this conversationId\");\n    return null;\n  } catch (e) {\n    console.warn(\"[getFiledEmailFromCache] Failed to read cache:\", e);\n    return null;\n  }\n}\n\n/**\n * Cache filed email by subject (fallback when conversationId not available at send time)\n * Used for NEW compose emails where conversationId isn't assigned until after send\n */\nexport async function cacheFiledEmailBySubject(\n  subject: string,\n  caseId: string,\n  documentId: string,\n  caseName?: string,\n  caseKey?: string\n): Promise<void> {\n  if (!subject) {\n    console.warn(\"[cacheFiledEmailBySubject] No subject provided, skipping cache\");\n    return;\n  }\n\n  try {\n    // Platform detection\n    const platform = {\n      host: (Office as any)?.context?.mailbox?.diagnostics?.hostName,\n      hostVersion: (Office as any)?.context?.mailbox?.diagnostics?.hostVersion,\n      platform: (Office as any)?.context?.platform,\n    };\n    console.log(\"[cacheFiledEmailBySubject] Platform info:\", platform);\n\n    const raw = await getStored(FILED_CACHE_KEY);\n    const cache: FiledEmailCache = raw ? JSON.parse(String(raw)) : {};\n    console.log(\"[cacheFiledEmailBySubject] Current cache size:\", Object.keys(cache).length);\n\n    // Use subject as temporary key (prefixed with \"subj:\")\n    const tempKey = `subj:${subject.trim().toLowerCase()}`;\n    console.log(\"[cacheFiledEmailBySubject] Using temp key:\", tempKey);\n\n    cache[tempKey] = {\n      caseId,\n      documentId,\n      subject,\n      caseName,\n      caseKey,\n      filedAt: Date.now(),\n    };\n\n    // Clean old entries\n    const entries = Object.entries(cache);\n    if (entries.length > 100) {\n      entries.sort((a, b) => b[1].filedAt - a[1].filedAt);\n      const keep = entries.slice(0, 100);\n      const newCache: FiledEmailCache = {};\n      keep.forEach(([key, val]) => {\n        newCache[key] = val;\n      });\n      await setStored(FILED_CACHE_KEY, JSON.stringify(newCache));\n      console.log(\"[cacheFiledEmailBySubject] Cleaned cache, kept 100 most recent entries\");\n    } else {\n      await setStored(FILED_CACHE_KEY, JSON.stringify(cache));\n    }\n\n    // Verify write succeeded\n    const verification = await getStored(FILED_CACHE_KEY);\n    const verifiedCache = verification ? JSON.parse(String(verification)) : {};\n    const writeSuccess = !!verifiedCache[tempKey];\n    console.log(\"[cacheFiledEmailBySubject] Write verification:\", {\n      success: writeSuccess,\n      cacheSize: Object.keys(verifiedCache).length,\n      tempKey,\n    });\n\n    console.log(\"[cacheFiledEmailBySubject] Cached filed email by subject\", {\n      subject,\n      caseId,\n      documentId,\n      writeVerified: writeSuccess,\n    });\n  } catch (e) {\n    console.warn(\"[cacheFiledEmailBySubject] Failed to cache:\", e);\n  }\n}\n\n/**\n * Search cache by subject (fallback when conversationId lookup fails)\n * Also upgrades the cache entry to use conversationId for future lookups\n */\nexport async function findFiledEmailBySubject(\n  subject: string,\n  conversationId?: string\n): Promise<FiledEmailCache[string] | null> {\n  if (!subject) {\n    return null;\n  }\n\n  try {\n    // Platform detection\n    const platform = {\n      host: (Office as any)?.context?.mailbox?.diagnostics?.hostName,\n      hostVersion: (Office as any)?.context?.mailbox?.diagnostics?.hostVersion,\n      platform: (Office as any)?.context?.platform,\n    };\n    console.log(\"[findFiledEmailBySubject] Platform info:\", platform);\n\n    // Force fresh read to avoid stale roamingSettings after recent write\n    const raw = await getStored(FILED_CACHE_KEY, true);\n    if (!raw) {\n      console.log(\"[findFiledEmailBySubject] No cache found in storage\");\n      return null;\n    }\n\n    const cache: FiledEmailCache = JSON.parse(String(raw));\n    const cacheKeys = Object.keys(cache);\n    console.log(\"[findFiledEmailBySubject] Cache size:\", cacheKeys.length, \"keys\");\n\n    const tempKey = `subj:${subject.trim().toLowerCase()}`;\n    console.log(\"[findFiledEmailBySubject] Looking for temp key:\", tempKey);\n    console.log(\"[findFiledEmailBySubject] Subject-based keys in cache:\", cacheKeys.filter(k => k.startsWith(\"subj:\")).length);\n\n    const entry = cache[tempKey];\n\n    if (entry) {\n      console.log(\"[findFiledEmailBySubject] ✅ Found cache entry by subject\", {\n        subject,\n        caseId: entry.caseId,\n        documentId: entry.documentId,\n        filedAt: new Date(entry.filedAt).toISOString(),\n      });\n\n      // Upgrade cache: If we now have conversationId, store under that key too\n      if (conversationId) {\n        console.log(\"[findFiledEmailBySubject] Upgrading cache with conversationId:\", conversationId.substring(0, 30) + \"...\");\n        cache[conversationId] = entry;\n        // Keep the subject-based entry for a while (don't delete)\n        await setStored(FILED_CACHE_KEY, JSON.stringify(cache));\n\n        // Verify upgrade succeeded\n        const verification = await getStored(FILED_CACHE_KEY);\n        const verifiedCache = verification ? JSON.parse(String(verification)) : {};\n        const upgradeSuccess = !!verifiedCache[conversationId];\n        console.log(\"[findFiledEmailBySubject] Cache upgrade verification:\", {\n          success: upgradeSuccess,\n          cacheSize: Object.keys(verifiedCache).length,\n        });\n      }\n\n      return entry;\n    }\n\n    console.log(\"[findFiledEmailBySubject] ❌ No entry for this subject\");\n    return null;\n  } catch (e) {\n    console.warn(\"[findFiledEmailBySubject] Failed:\", e);\n    return null;\n  }\n}\n\n/**\n * Remove filed email from cache (e.g., if document was deleted)\n */\nexport async function removeFiledEmailFromCache(conversationId: string): Promise<void> {\n  if (!conversationId) {\n    return;\n  }\n\n  try {\n    const raw = await getStored(FILED_CACHE_KEY);\n    if (!raw) return;\n\n    const cache: FiledEmailCache = JSON.parse(String(raw));\n    delete cache[conversationId];\n\n    await setStored(FILED_CACHE_KEY, JSON.stringify(cache));\n    console.log(\"[removeFiledEmailFromCache] Removed entry\", {\n      conversationId: conversationId.substring(0, 20) + \"...\",\n    });\n  } catch (e) {\n    console.warn(\"[removeFiledEmailFromCache] Failed:\", e);\n  }\n}\n"],"names":["getStored","setStored","FILED_CACHE_KEY","cacheFiledEmail","conversationId","caseId","documentId","subject","caseName","caseKey","console","warn","platform","host","_c","_b","_a","Office","context","mailbox","diagnostics","hostName","hostVersion","_f","_e","_d","_g","log","raw","_h","sent","cache","JSON","parse","String","Object","keys","length","filedAt","Date","now","entries","sort","a","b","keep","slice","newCache_1","forEach","key","val","stringify","verification","verifiedCache","writeSuccess","success","cacheSize","substring","writeVerified","e_1","getFiledEmailFromCache","cacheKeys","map","k","entry","toISOString","e_2","cacheFiledEmailBySubject","tempKey","concat","trim","toLowerCase","newCache_2","e_3","findFiledEmailBySubject","filter","startsWith","upgradeSuccess","e_4","removeFiledEmailFromCache","e_5"],"ignoreList":[],"sourceRoot":""}