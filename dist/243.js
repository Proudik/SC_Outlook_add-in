"use strict";(self.webpackChunkoffice_addin_taskpane_react=self.webpackChunkoffice_addin_taskpane_react||[]).push([[243],{1243:function(e,i,n){n.r(i),n.d(i,{cacheFiledEmail:function(){return a},cacheFiledEmailBySubject:function(){return u},findFiledEmailBySubject:function(){return d},getFiledEmailFromCache:function(){return s},removeFiledEmailFromCache:function(){return f}});var t=n(50134),o=n(64583).Promise,c=function(e,i,n,t){return new(n||(n=o))(function(o,c){function l(e){try{a(t.next(e))}catch(e){c(e)}}function r(e){try{a(t.throw(e))}catch(e){c(e)}}function a(e){var i;e.done?o(e.value):(i=e.value,i instanceof n?i:new n(function(e){e(i)})).then(l,r)}a((t=t.apply(e,i||[])).next())})},l=function(e,i){var n,t,o,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=r(0),l.throw=r(1),l.return=r(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function r(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,r[0]&&(c=0)),c;)try{if(n=1,t&&(o=2&r[0]?t.return:r[0]?t.throw||((o=t.return)&&o.call(t),0):t.next)&&!(o=o.call(t,r[1])).done)return o;switch(t=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,t=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){c=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){c.label=r[1];break}if(6===r[0]&&c.label<o[1]){c.label=o[1],o=r;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(r);break}o[2]&&c.ops.pop(),c.trys.pop();continue}r=i.call(e,c)}catch(e){r=[6,e],t=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}},r="sc:filedEmailsCache";function a(e,i,n,o,a,s){return c(this,void 0,void 0,function(){var c,u,d,f,v,h,m,g,b,y,O,p,F,S,j,E,w;return l(this,function(l){switch(l.label){case 0:if(!e)return console.warn("[cacheFiledEmail] No conversationId provided, skipping cache"),[2];l.label=1;case 1:return l.trys.push([1,8,,9]),c={host:null===(F=null===(p=null===(O=null===Office||void 0===Office?void 0:Office.context)||void 0===O?void 0:O.mailbox)||void 0===p?void 0:p.diagnostics)||void 0===F?void 0:F.hostName,hostVersion:null===(E=null===(j=null===(S=null===Office||void 0===Office?void 0:Office.context)||void 0===S?void 0:S.mailbox)||void 0===j?void 0:j.diagnostics)||void 0===E?void 0:E.hostVersion,platform:null===(w=null===Office||void 0===Office?void 0:Office.context)||void 0===w?void 0:w.platform},console.log("[cacheFiledEmail] Platform info:",c),[4,(0,t.wv)(r)];case 2:return u=l.sent(),d=u?JSON.parse(String(u)):{},console.log("[cacheFiledEmail] Current cache size:",Object.keys(d).length),d[e]={caseId:i,documentId:n,subject:o,caseName:a,caseKey:s,filedAt:Date.now()},(f=Object.entries(d)).length>100?(f.sort(function(e,i){return i[1].filedAt-e[1].filedAt}),v=f.slice(0,100),h={},v.forEach(function(e){var i=e[0],n=e[1];h[i]=n}),[4,(0,t.Kg)(r,JSON.stringify(h))]):[3,4];case 3:return l.sent(),console.log("[cacheFiledEmail] Cleaned cache, kept 100 most recent entries"),[3,6];case 4:return[4,(0,t.Kg)(r,JSON.stringify(d))];case 5:l.sent(),l.label=6;case 6:return[4,(0,t.wv)(r)];case 7:return m=l.sent(),g=m?JSON.parse(String(m)):{},b=!!g[e],console.log("[cacheFiledEmail] Write verification:",{success:b,cacheSize:Object.keys(g).length}),console.log("[cacheFiledEmail] Cached filed email",{conversationId:e.substring(0,20)+"...",caseId:i,documentId:n,subject:o,writeVerified:b}),[3,9];case 8:return y=l.sent(),console.warn("[cacheFiledEmail] Failed to cache:",y),[3,9];case 9:return[2]}})})}function s(e){return c(this,void 0,void 0,function(){var i,n,o,c,a,s,u,d,f,v,h,m,g;return l(this,function(l){switch(l.label){case 0:if(!e)return[2,null];l.label=1;case 1:return l.trys.push([1,3,,4]),i={host:null===(f=null===(d=null===(u=null===Office||void 0===Office?void 0:Office.context)||void 0===u?void 0:u.mailbox)||void 0===d?void 0:d.diagnostics)||void 0===f?void 0:f.hostName,hostVersion:null===(m=null===(h=null===(v=null===Office||void 0===Office?void 0:Office.context)||void 0===v?void 0:v.mailbox)||void 0===h?void 0:h.diagnostics)||void 0===m?void 0:m.hostVersion,platform:null===(g=null===Office||void 0===Office?void 0:Office.context)||void 0===g?void 0:g.platform},console.log("[getFiledEmailFromCache] Platform info:",i),[4,(0,t.wv)(r,!0)];case 2:return(n=l.sent())?(o=JSON.parse(String(n)),c=Object.keys(o),console.log("[getFiledEmailFromCache] Cache size:",c.length,"keys"),console.log("[getFiledEmailFromCache] Looking for conversationId:",e.substring(0,30)+"..."),console.log("[getFiledEmailFromCache] Sample cache keys:",c.slice(0,3).map(function(e){return e.substring(0,30)+"..."})),(a=o[e])?(console.log("[getFiledEmailFromCache] ✅ Found cache entry",{conversationId:e.substring(0,20)+"...",caseId:a.caseId,documentId:a.documentId,filedAt:new Date(a.filedAt).toISOString(),subject:a.subject}),[2,a]):(console.log("[getFiledEmailFromCache] ❌ No entry for this conversationId"),[2,null])):(console.log("[getFiledEmailFromCache] No cache found in storage"),[2,null]);case 3:return s=l.sent(),console.warn("[getFiledEmailFromCache] Failed to read cache:",s),[2,null];case 4:return[2]}})})}function u(e,i,n,o,a){return c(this,void 0,void 0,function(){var c,s,u,d,f,v,h,m,g,b,y,O,p,F,S,j,E,w;return l(this,function(l){switch(l.label){case 0:if(!e)return console.warn("[cacheFiledEmailBySubject] No subject provided, skipping cache"),[2];l.label=1;case 1:return l.trys.push([1,8,,9]),c={host:null===(F=null===(p=null===(O=null===Office||void 0===Office?void 0:Office.context)||void 0===O?void 0:O.mailbox)||void 0===p?void 0:p.diagnostics)||void 0===F?void 0:F.hostName,hostVersion:null===(E=null===(j=null===(S=null===Office||void 0===Office?void 0:Office.context)||void 0===S?void 0:S.mailbox)||void 0===j?void 0:j.diagnostics)||void 0===E?void 0:E.hostVersion,platform:null===(w=null===Office||void 0===Office?void 0:Office.context)||void 0===w?void 0:w.platform},console.log("[cacheFiledEmailBySubject] Platform info:",c),[4,(0,t.wv)(r)];case 2:return s=l.sent(),u=s?JSON.parse(String(s)):{},console.log("[cacheFiledEmailBySubject] Current cache size:",Object.keys(u).length),d="subj:".concat(e.trim().toLowerCase()),console.log("[cacheFiledEmailBySubject] Using temp key:",d),u[d]={caseId:i,documentId:n,subject:e,caseName:o,caseKey:a,filedAt:Date.now()},(f=Object.entries(u)).length>100?(f.sort(function(e,i){return i[1].filedAt-e[1].filedAt}),v=f.slice(0,100),h={},v.forEach(function(e){var i=e[0],n=e[1];h[i]=n}),[4,(0,t.Kg)(r,JSON.stringify(h))]):[3,4];case 3:return l.sent(),console.log("[cacheFiledEmailBySubject] Cleaned cache, kept 100 most recent entries"),[3,6];case 4:return[4,(0,t.Kg)(r,JSON.stringify(u))];case 5:l.sent(),l.label=6;case 6:return[4,(0,t.wv)(r)];case 7:return m=l.sent(),g=m?JSON.parse(String(m)):{},b=!!g[d],console.log("[cacheFiledEmailBySubject] Write verification:",{success:b,cacheSize:Object.keys(g).length,tempKey:d}),console.log("[cacheFiledEmailBySubject] Cached filed email by subject",{subject:e,caseId:i,documentId:n,writeVerified:b}),[3,9];case 8:return y=l.sent(),console.warn("[cacheFiledEmailBySubject] Failed to cache:",y),[3,9];case 9:return[2]}})})}function d(e,i){return c(this,void 0,void 0,function(){var n,o,c,a,s,u,d,f,v,h,m,g,b,y,O,p,F;return l(this,function(l){switch(l.label){case 0:if(!e)return[2,null];l.label=1;case 1:return l.trys.push([1,7,,8]),n={host:null===(b=null===(g=null===(m=null===Office||void 0===Office?void 0:Office.context)||void 0===m?void 0:m.mailbox)||void 0===g?void 0:g.diagnostics)||void 0===b?void 0:b.hostName,hostVersion:null===(p=null===(O=null===(y=null===Office||void 0===Office?void 0:Office.context)||void 0===y?void 0:y.mailbox)||void 0===O?void 0:O.diagnostics)||void 0===p?void 0:p.hostVersion,platform:null===(F=null===Office||void 0===Office?void 0:Office.context)||void 0===F?void 0:F.platform},console.log("[findFiledEmailBySubject] Platform info:",n),[4,(0,t.wv)(r,!0)];case 2:return(o=l.sent())?(c=JSON.parse(String(o)),a=Object.keys(c),console.log("[findFiledEmailBySubject] Cache size:",a.length,"keys"),s="subj:".concat(e.trim().toLowerCase()),console.log("[findFiledEmailBySubject] Looking for temp key:",s),console.log("[findFiledEmailBySubject] Subject-based keys in cache:",a.filter(function(e){return e.startsWith("subj:")}).length),(u=c[s])?(console.log("[findFiledEmailBySubject] ✅ Found cache entry by subject",{subject:e,caseId:u.caseId,documentId:u.documentId,filedAt:new Date(u.filedAt).toISOString()}),i?(console.log("[findFiledEmailBySubject] Upgrading cache with conversationId:",i.substring(0,30)+"..."),c[i]=u,[4,(0,t.Kg)(r,JSON.stringify(c))]):[3,5]):[3,6]):(console.log("[findFiledEmailBySubject] No cache found in storage"),[2,null]);case 3:return l.sent(),[4,(0,t.wv)(r)];case 4:d=l.sent(),f=d?JSON.parse(String(d)):{},v=!!f[i],console.log("[findFiledEmailBySubject] Cache upgrade verification:",{success:v,cacheSize:Object.keys(f).length}),l.label=5;case 5:return[2,u];case 6:return console.log("[findFiledEmailBySubject] ❌ No entry for this subject"),[2,null];case 7:return h=l.sent(),console.warn("[findFiledEmailBySubject] Failed:",h),[2,null];case 8:return[2]}})})}function f(e){return c(this,void 0,void 0,function(){var i,n,o;return l(this,function(c){switch(c.label){case 0:if(!e)return[2];c.label=1;case 1:return c.trys.push([1,4,,5]),[4,(0,t.wv)(r)];case 2:return(i=c.sent())?(delete(n=JSON.parse(String(i)))[e],[4,(0,t.Kg)(r,JSON.stringify(n))]):[2];case 3:return c.sent(),console.log("[removeFiledEmailFromCache] Removed entry",{conversationId:e.substring(0,20)+"..."}),[3,5];case 4:return o=c.sent(),console.warn("[removeFiledEmailFromCache] Failed:",o),[3,5];case 5:return[2]}})})}}}]);
//# sourceMappingURL=243.js.map